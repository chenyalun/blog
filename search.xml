<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[ÂºÄÊ∫êÈ°πÁõÆÔºöYAPageView]]></title>
    <url>%2F2019%2F08%2F07%2F%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%EF%BC%9AYAPageView%2F</url>
    <content type="text"><![CDATA[ËΩªÈáèÁ∫ß„ÄÅÊñ∞Ê†∑ÂºèËΩÆÊí≠ËßÜÂõæ„ÄÇ ‰∏Ä„ÄÅÂâçË®ÄÂú®ÊãúËØªÈáåËÑä‰∏≤ÁöÑÂºÄÂèëÈöèÁ¨îÂ§ßÁ•ûÁöÑÂçöÂÆ¢Êó∂ÔºåÂèëÁé∞‰∏™Â•ΩÁé©ÁöÑ‰∏úË•øÔºö„ÄäÂºÄÊ∫êÈ°πÁõÆ:XXPagingScrollView„Äã„ÄÇËôΩÁÑ∂ÊòØÂæàÂ∏∏ËßÅÁöÑËΩÆÊí≠ËßÜÂõæÔºå‰ΩÜÊòØËøôÁßçÊñ∞Ê†∑ÂºèÁöÑÂÆûÁé∞ÊÄùË∑ØÊå∫ÊúâÊÑèÊÄù„ÄÇËÆ∞Âæó‰∏§Âπ¥ÂâçÂú®ÂÜôÊüê‰∏™È°πÁõÆÊó∂‰πüÈÅáÂà∞ËøáËøô‰∏™Ôºå‰ΩÜÊòØÂΩìÁÑ∂Á°ÆÂÆûÊ≤°ÊúâÊÉ≥Âá∫Êù•ÂíãÂÆûÁé∞ËøôÁßçÈùûÂÖ®Â±èÊúâÈó¥ÈöôÁöÑËΩÆÊí≠Êéß‰ª∂„ÄÇ ËØªÂÆåÂ§ßÁ•ûÁöÑÊñáÁ´†ÔºåÂæàÊòØÂÖ¥Â•ãÔºå‰∏ÄËà¨ÊòØ‰∏çÁà±ÈÄ†ÈáçÂ§çÁöÑËΩÆÂ≠êÔºå‰ΩÜÊòØ‰ΩúËÄÖËøô‰∏™ÊòØSwiftÁâàÊú¨ÁöÑÔºåËÄå‰∏îÊòØÂü∫Á°ÄÁªÑ‰ª∂ÔºåÂ∞ë‰∫ÜÂæàÂ§öÂäüËÉΩÔºåÊâÄ‰ª•ÂøÉË°ÄÊù•ÊΩÆÔºåÂú®Â§ßÁ•ûÂü∫Á°Ä‰∏äÂÜçËøõ‰∏ÄÊ≠•„ÄÇ Áõ∏ÊØîËæÉÊù•ËØ¥Êõ¥Âä†ÂÆåÂñÑ‰∫ÜÔºö ÊîØÊåÅËÆæÁΩÆpagingWidth ÊîØÊåÅËÆæÁΩÆpageInset ÊîØÊåÅÊó†ÈôêÂæ™ÁéØËΩÆÊí≠ ÊîØÊåÅÊú¨Âú∞ÂõæÁâá ÊîØÊåÅÁΩëÁªúÂõæÁâá ÊîØÊåÅËá™Âä®ËΩÆÊí≠„ÄÅËÆæÁΩÆËΩÆÊí≠Êó∂Èó¥Èó¥Èöî ÊîØÊåÅÁÇπÂáªÂõûË∞É Êï¥‰Ωì‰ª£Á†ÅÁ∫¶150Ë°åÂ∑¶Âè≥ÔºåÊõ¥Âä†Á≤æÁÆÄ„ÄÇÈ°πÁõÆÂú∞ÂùÄ:https://github.com/ChenYalun/YAPageView ‰∫å„ÄÅÊÄùË∑ØÂÆûÈôÖ‰∏äËΩÆÊí≠ËßÜÂõæÊòØÁÉÇÂ§ßË°óÁöÑ‰∏úË•ø‰∫ÜÔºåÁΩë‰∏äÁé∞Êàê‰ª£Á†ÅÁâπÂà´Â§ö„ÄÇ‰∏ÄËà¨ËÄåË®ÄÔºåÂÅáÂÆöÈúÄË¶Ån‰∏™È°µÈù¢ÔºåÂÆûÁé∞ÊñπÂºèÊúâÔºö ‰ΩøÁî®UIScrollViewÔºåÊ∑ªÂä† n ‰∏™UIImageView„ÄÇ ‰ΩøÁî®UIScrollViewÔºåÊ∑ªÂä†‰∏§‰∏™UIImageViewÔºåÂä®ÊÄÅÂæ™ÁéØË∞ÉÊï¥„ÄÇ ‰ΩøÁî®UICollectionView„ÄÇ ÊñπÊ≥ï1ÊØîËæÉÂü∫Á°ÄÔºåÊõ¥ÈÄÇÂêàÈùûÂæ™ÁéØÔºõÊñπÊ≥ï3ÊØîËæÉÁÆÄÂçïÔºå‰ΩÜÊòØUICollectionViewËøá‰∫éheavily„ÄÇÊñπÊ≥ï2ÔºåÂæàÁ≤æÁÆÄËΩªÈáèÔºåÂ∞±ÊòØÂ§ÑÁêÜËµ∑Êù•ÊúâÁÇπÁªï„ÄÇÁÑ∂ËÄåÔºåÁªï‰∏ÄÊ¨°ÔºåÊç¢Êù•Ê∞∏‰πÖÁöÑËàíÈÄÇÔºåÂæàÂÄºÂæó„ÄÇ Â¶Ç‰ΩïÂÆûÁé∞Ëá™ÂÆö‰πâPage widthÁöÑËßÜÂõæÔºå‰ΩúËÄÖÁªôÂá∫ÁöÑÊñπÊ°àÊòØÔºö ÊñπÊ°à1: ‰∏ç‰ΩøÁî®pagingEnabledÂ±ûÊÄß ËÄåÊòØÊâãÂä®ÁöÑËÆ°ÁÆóÂπ∂ËÆæÁΩÆÊªëÂä®ÂÅèÁßªÊñπÊ°à2: ‰ΩøÁî®pagingEnabledÂ±ûÊÄß Êâ©Â§ßUIScrollviewÁöÑÊòæÁ§∫ËåÉÂõ¥Âç≥ÂèØ ÂæàÊòéÊòæÔºåÊñπÊ°à2Êõ¥Â•Ω„ÄÇÊÄùË∑ØÊòØÔºåÊâ©Â§ßUIScrollViewÁöÑÂèØÊòæÁ§∫ËåÉÂõ¥Âπ∂ËÆ©UIScrollViewÂìçÂ∫îË∂ÖÂá∫ÂÖ∂Êú¨Ë∫´ËåÉÂõ¥ÁöÑËß¶Êë∏‰∫ã‰ª∂„ÄÇÊÄùË∑ØÁü•ÈÅì‰∫ÜÔºåÂÆûÁé∞Ëµ∑Êù•ÂæàÁÆÄÂçïÔºåÂ∞±ÊòØclipsToBoundsÂ±ûÊÄßÂíåpointInsideÊñπÊ≥ï„ÄÇ Èó¥Ë∑ùÂ§ÑÁêÜÊ†∏ÂøÉÊúâ‰∏âÊù°Ôºö UIScrollViewÁöÑÂÆΩÂ∫¶Â∞±ÊòØpageWidth + pageInset„ÄÇ ‰∏∫‰∫Ü‰øùÊåÅÂ∑¶Âè≥ÊòæÁ§∫Âå∫ÂüüÁöÑÂØπÁß∞ÊÄßÔºåUIScrollViewÁöÑxÊòØ(superView.width - pageWidth) * 0.5„ÄÇ Â≠êËßÜÂõæÁöÑframeÊòØCGRectMake(idx * (pageWidth + pageInset), 0, pageWidth, height)Ôºå‰πüÂç≥ÔºåÂ≠êËßÜÂõæÁöÑÂÆΩÂ∫¶‰∏éUIScrollViewÁöÑÂÆΩÂ∫¶‰øùÊåÅ‰∏ÄËá¥„ÄÇ Êó†ÈôêÂæ™ÁéØÂ§ÑÁêÜ ËßÜÂõæÂæ™ÁéØÂà©Áî®‰ΩøÁî®‰∏â‰∏™UIImageViewÔºåËÆ∞‰∏∫Â∑¶„ÄÅ‰∏≠„ÄÅÂè≥ÔºåÈáçÂ§çÂà©Áî®„ÄÇÈªòËÆ§ÊòæÁ§∫‰∏≠Èó¥ÁöÑimageView„ÄÇ Âà∑Êñ∞ÈÄªËæëÂú®scrollViewDidScrollÂõûË∞É‰∏≠ÔºåÂΩìUIScrollViewÂç≥Â∞ÜÊòæÁ§∫Âá∫‰∏ã‰∏Ä‰∏™ÔºàÂèØËÉΩÊòØÂ∑¶„ÄÅ‰πüÂèØËÉΩÊòØÂè≥ÔºâËßÜÂõæÊó∂ÔºåÁ´ãÂç≥Ë∞ÉÁî®Âà∑Êñ∞ÊñπÊ≥ï„ÄÇÂà∑Êñ∞ÁöÑÈÄªËæëÊòØÔºö ÈáçÊñ∞ËÆ°ÁÆóleft„ÄÅcurrentIndex„ÄÅright‰∏â‰∏™Á¥¢Âºï #define kLeft (_currentIndex == 0 ? kCount - 1 : _currentIndex - 1)#define kRight (_currentIndex == kCount - 1 ? 0 : _currentIndex + 1) ÂØπÂ∑¶„ÄÅ‰∏≠„ÄÅÂè≥‰∏â‰∏™UIImageViewÈáçÊñ∞ËÆæÁΩÆÈÖçÂõæ self.pageArray[0].image = self.imageArray[kLeft];self.pageArray[1].image = self.imageArray[_currentIndex];self.pageArray[2].image = self.imageArray[kRight]; ‰ª•ÈùûÂä®ÁîªÊñπÂºèËÆæÁΩÆUIScrollViewÁöÑÂÅèÁßªÈáè CGFloat x = self.scrollView.contentOffset.x;CGFloat width = self.pageWidth + self.pageInset;if (x == 0) &#123; x = width;&#125; else &#123; x += x &gt; width ? -width : width;&#125;[self.scrollView setContentOffset:CGPointMake(x, 0)]; ËøôÊ†∑‰æøÂÆûÁé∞‰∫ÜÊó†ÈôêÂæ™ÁéØ„ÄÇ Âà∑Êñ∞Êó∂Êú∫Â§ÑÁêÜscrollViewDidScroll‰ºöÂõûË∞ÉÂæàÂ§öÊ¨°ÔºåÊú¨Êù•‰ª•‰∏∫‰ΩøÁî®‰∏Ä‰∏™Ê†áÂøó‰ΩçÂ∞±ÂèØ‰ª•ÊéßÂà∂Âè™Âà∑Êñ∞‰∏ÄÊ¨°Ôºå‰ΩÜÊòØÂπ∂Ê≤°ÊúâÂÆûÁé∞üòÇ ÊâÄ‰ª•ÔºåÈÄÄ‰∏ÄÊ≠•ÔºåÁî®‰∫Ü‰∏§‰∏™Ê†áÂøó‰ΩçÔºö @property (nonatomic, assign) BOOL leftLock;@property (nonatomic, assign) BOOL rightLock; ÈÄªËæëÊòØËøôÊ†∑ÁöÑÔºö // Turn left.if (offsetX &gt; 2 * (width - self.pageInset)) self.rightLock = NO;if (!self.leftLock &amp;&amp; offsetX &lt; width - 2 * self.pageInset) &#123; self.leftLock = YES; _currentIndex = kLeft; [self refresh];&#125;// Turn right.if (offsetX &lt; 2 * self.pageInset) self.leftLock = NO;if (!self.rightLock &amp;&amp; offsetX &gt; width + 2 * self.pageInset) &#123; self.rightLock = YES; _currentIndex = kRight; [self refresh];&#125; ËØ∑Áâ¢ËÆ∞UIScrollViewÁöÑÂÆΩÂ∫¶widthÊòØwidth=pageWidth+pageInsetÔºåËøôÈáå‰ª•Âç≥Â∞ÜÊòæÁ§∫Âè≥ËæπËßÜÂõæ‰∏∫‰æãÔºö scrollViewÁöÑÂàùÂßãÂÅèÁßªÈáèÊòØwidthÔºåÈÄêÊ∏êÂÅèÁßªÔºåÁõ¥Âà∞Ë∂äËøáÁ©∫ÁôΩÈó¥Ë∑ù(pageInset)Ë¶ÅÊòæÁ§∫‰∏ã‰∏Ä‰∏™ËßÜÂõæÊó∂ÔºåÊ≠§Êó∂offsetX‰∏∫width + (pageWidth - pageInset)Ôºå‰πüÂç≥‰ª£Á†Å‰∏≠ÁöÑ2 * (width - pageInset)ÔºåÁ´ãÂç≥Â∞ÜoffsetXËøòÂéü‰∏∫2 * (width - pageInset) - (width)‰πüÂ∞±ÊòØpageWidth-pageInsetÔºåÂØπleftLockÂä†ÈîÅÔºåÊõ¥Êñ∞ÂΩìÂâçÁ¥¢Âºï„ÄÇ ÁÇπÂáª‰∫ã‰ª∂Â§ÑÁêÜÂØπUIScrollViewÊ∑ªÂä†ÁÇπÂáªÊâãÂäøÔºåËÆ°ÁÆóÂá∫ÂΩìÂâçÁÇπÂáª‰ΩçÁΩÆÂú®ÂõæÁâáÊï∞ÁªÑ‰∏≠ÁöÑÁ¥¢ÂºïÂç≥ÂèØÔºöCGFloat pointX = [tap locationInView:tap.view].x;NSUInteger idx = _currentIndex;if (pointX &lt; self.pageWidth + self.pageInset) &#123; idx = kLeft;&#125; else if (pointX &gt; 2 * self.pageWidth + self.pageInset) &#123; idx = kRight;&#125; Ëá™Âä®ËΩÆÊí≠Â§ÑÁêÜÂΩìËÆæÁΩÆtimeIntervalÂ±ûÊÄßÊó∂ÔºåËØ¥ÊòéÈúÄË¶ÅËá™Âä®ËΩÆÊí≠ÔºåÊáíÂä†ËΩΩÂàõÂª∫ÂÆöÊó∂Âô®Ôºö _timer = [NSTimer timerWithTimeInterval:_timeInterval repeats:YES block:^(NSTimer *timer) &#123; [self.scrollView setContentOffset:CGPointMake(CGRectGetWidth(self.scrollView.frame) * 2, 0) animated:YES];&#125;]; Âπ∂ÊääÂÆöÊó∂Âô®ÊîæÂà∞currentRunLoop‰∏≠ÔºåËÆæÁΩÆNSRunLoopCommonModes„ÄÇÂΩìÁÑ∂ÔºåÈúÄË¶ÅÂú®ScrollViewÁöÑ‰∏Ä‰∫õ‰ª£ÁêÜ‰∏≠Â§ÑÁêÜÁî®Êà∑ÊâãÂä®ÊªëÂä®‰∏éÂÆöÊó∂Âô®ËÆæÁΩÆÁöÑÊªëÂä®ÁöÑÂÜ≤Á™Å„ÄÇ ÂÆöÊó∂Âô®Âæ™ÁéØÂºïÁî®Â§ÑÁêÜÂú®„ÄäËØ¶Ëß£performSelector„Äã‰∏ÄÊñá‰∏≠ÔºåÂ∑≤ÁªèËØ¶ÁªÜÂàÜÊûê‰∫ÜÂÆöÊó∂Âô®ÈÄ†ÊàêÂæ™ÁéØÂºïÁî®ÁöÑÂéüÂõ†ÔºåËøôÈáå‰∏çÂÅöËµòËø∞„ÄÇËß£ÂÜ≥ÊñπÂºèÊòØÔºåÂΩìPageView‰ªéÁà∂ËßÜÂõæ‰∏äÁßªÈô§Êó∂ÔºåÊâãÂä®ÈîÄÊØÅÂÆöÊó∂Âô®Ôºö- (void)willMoveToSuperview:(UIView *)newSuperview &#123; [super willMoveToSuperview:newSuperview]; if (newSuperview == nil) &#123; // ËßÜÂõæ‰ªéÁà∂ËßÜÂõæÁßªÈô§Êó∂, ÈîÄÊØÅÂÆöÊó∂Âô® [_timer invalidate]; _timer = nil; &#125;&#125; ÁÇπÂáªÂõûË∞ÉÂæ™ÁéØÂºïÁî®Â§ÑÁêÜÁÇπÂáª‰∫ã‰ª∂ÁªôÂá∫ÁöÑÊé•Âè£ÊàëÈÄâÊã©‰ΩøÁî®blockÔºåÔºà‰ΩøÁî®Âº±ÂºïÁî®ÁöÑ‰ª£ÁêÜÂ∞±‰∏ç‰ºöÊúâËøô‰∏™ÈóÆÈ¢ò‰∫ÜÔºå‰ΩÜÊòØ‰ª£ÁêÜ‰ºöÂ¢ûÂä†Ë∞ÉÁî®ÁöÑÂ§çÊùÇÊÄßÔºåËÆæÁΩÆ‰ª£ÁêÜ„ÄÅÈÅµÂÆàÂçèËÆÆ„ÄÅÂÆûÁé∞ÊñπÊ≥ïÂ∑¥ÊãâÂ∑¥Êãâ„ÄÇ„ÄÇ„ÄÇÔºâ ÁÑ∂ËÄåÔºåÂêåËÆ∏Â§öËßÜÂõæÁöÑblockÂõûË∞É‰∏ÄÊ†∑Ôºå‰ºöÊúâÂæ™ÁéØÂºïÁî®ÁöÑÈóÆÈ¢òÔºåÂè™ËÉΩËøôÊ†∑‰ΩøÁî®Ôºö __weak typeof(self) weakSelf = self;pageView.tapHandler = ^(NSUInteger idx, UIImage *img, NSURL *url) &#123; __strong typeof(weakSelf) self = weakSelf; NSLog(@"self = %@, index = %lu, url = %@", self, (unsigned long)idx, url); [self.navigationController popViewControllerAnimated:YES];&#125;; ‰∏á‰∏ÄË∞ÉÁî®ÊñπÂøò‰∫ÜÂë¢ÔºåÈÇ£Â∞±ÂÜÖÂ≠òÊ≥ÑÊºè‰∫Ü„ÄÇ Â§ßÁ•ûÁéâ‰ª§Â§©‰∏ãÁöÑÊñπÂºèÊòØ‰ΩøÁî®Âº±ÂºïÁî®ÁöÑÂèòÈáèÊåÅÊúâÂ§ñÁïåÁöÑË∞ÉÁî®ËÄÖÔºåÁÑ∂ÂêéÂú®ÈÄÇÂΩìÊó∂Êú∫Â∞ÜÁªÑ‰ª∂‚ÄúËá™Â∑±‚ÄùÁΩÆ‰∏∫Á©∫„ÄÇ‰∏çËøáÈúÄË¶ÅÁªôË∞ÉÁî®ËÄÖÂÜô‰∏™ÂàÜÁ±ªÔºàÂ±ûÊÄßÔºâÊåÅÊúâÁªÑ‰ª∂ÔºåËøòÈúÄË¶ÅÊòéÁ°ÆÂàáÊñ≠Âæ™ÁéØÂºïÁî®ÁöÑÊó∂Êú∫ÔºåÂØπ‰∫éÊàëÁöÑËøô‰∏™100Êù•Ë°åÁöÑPageViewÔºåÂèØËÉΩÊúâÁÇπ‰∏çÂ§™ÂêàÈÄÇ„ÄÇ ÊÉ≥Âà∞‰∏Ä‰∏™ÊñπÊ≥ïÔºåÊòæÂºèËÆ©‰ΩøÁî®Êñπ‰º†ËøõÊù•Ë∞ÉÁî®ËÄÖÔºåÈáçÊñ∞ÂÆö‰πâÂ§ñÁïåÁöÑselfÔºåÂ∞ÜÂÖ∂‰Ωú‰∏∫‰∏Ä‰∏™ÂõûË∞ÉÂèÇÊï∞‰º†ÈÄíÁªô‰ΩøÁî®ÊñπÔºàPageViewÂÜÖÈÉ®‰ΩøÁî®weakÊåÅÊúâÂ§ñÁïåÁöÑselfÔºâ„ÄÇ @property (nonatomic, copy) void (^tapHandler)(NSUInteger idx, UIImage *img, NSURL *url, id self); Â§ñÁïå‰ΩøÁî®ÁöÑÊó∂ÂÄôÂÉèËøôÊ†∑Ôºö pageView.tapHandler = ^(NSUInteger idx, UIImage *img, NSURL *url, UIViewController *self) &#123; [self.navigationController popViewControllerAnimated:YES];&#125;; Á°ÆÂÆûËÉΩËß£ÂÜ≥Âæ™ÁéØÂºïÁî®ÔºåËÄå‰∏î‰∏çÊòØÂæàË¥π‰∫ã„ÄÇ‰ΩÜÊòØÔºåÂÆûÈôÖ‰ΩøÁî®ÁöÑÊó∂ÂÄôÊòØËøôÊ†∑ÁöÑÔºö pageView.tapHandler = ^(NSUInteger idx, UIImage *img, NSURL *url, id controller) &#123; // ÈúÄË¶ÅÊâãÂä®ÊääidÁ±ªÂûãÊîπÊàêÂÆûÈôÖÁöÑÁ±ªÂûãÔºåÂ¶ÇUIViewController„ÄÅUIViewÁ≠âÁ≠â&#125;; Âπ∂‰∏çÁü•ÈÅìÂ§ñÁïåÁöÑselfÊòØÂï•Á±ªÂûãÔºåÂè™ËÉΩÁî®id„ÄÇÊàëÊÑüËßâ‰πü‰∏çÊòØÂæàÂ∑ßÂ¶ô„ÄÇÊàëËøòÊ≤°ÊúâÊÉ≥Âà∞Êõ¥Â•ΩÁöÑÂäûÊ≥ïÔºåÊâÄ‰ª•ÔºåÊöÇÊó∂ËøòÊòØ‰ΩøÁî®‰∏ªÊµÅÁöÑÊñπÂºèÂêßÔºö @property (nonatomic, copy) void (^tapHandler)(NSUInteger idx, UIImage *img, NSURL *url); Â∞±ËÆ©Â§ñÁïå‰ΩøÁî®weak-strongÊù•Ëß£ÂÜ≥Âæ™ÁéØÂºïÁî®ÈóÆÈ¢ò„ÄÇ ‰∏â„ÄÅ‰ΩøÁî®Êú¨Âú∞ÂõæÁâáÊú¨Âú∞ÂõæÁâáÁõ¥Êé•‰º†ÂÖ•UIImageÊï∞ÁªÑÂç≥ÂèØ„ÄÇ // ÊåáÂÆöÊûÑÈÄ†Âô®ÔºåËÆæÂÆöpageWidth„ÄÅpageInsetÁ≠âYAPageView *pageView = [[YAPageView alloc] initWithFrame:CGRectMake(0, 200, kScreenWidth, 200) controller:self pageWidth:300 pageInset:20];pageView.imageArray = @[ [UIImage imageNamed:@"1"], [UIImage imageNamed:@"2"], [UIImage imageNamed:@"3"], [UIImage imageNamed:@"4"], [UIImage imageNamed:@"5"], [UIImage imageNamed:@"6"],]; ÁΩëÁªúÂõæÁâáÁΩëÁªúÂõæÁâá‰º†ÂÖ•ÂõæÁâáURLÊï∞ÁªÑÔºåÂπ∂ËÆæÁΩÆÂ§ÑÁêÜÂõæÁâáÁöÑblock„ÄÇËøô‰∏™blockÊåáÁöÑÊòØÁªôUIImageViewËÆæÁΩÆÂõæÁâáURLÁöÑÊñπÂºè„ÄÇ // Â¶ÇÊûú‰ΩøÁî®SDWebImageÔºåÂèØ‰ª•Ëøô‰πàËÆæÁΩÆpageView.configImageHandler = ^(UIImageView *imageView, NSURL *url) &#123; [imageView sd_setImageWithURL:url];&#125;;pageView.imageURLArray = @[ [NSURL URLWithString:@"https://picsum.photos/id/230/350/200"], [NSURL URLWithString:@"https://picsum.photos/id/231/350/200"], [NSURL URLWithString:@"https://picsum.photos/id/232/350/200"], [NSURL URLWithString:@"https://picsum.photos/id/233/350/200"], [NSURL URLWithString:@"https://picsum.photos/id/234/350/200"], [NSURL URLWithString:@"https://picsum.photos/id/235/350/200"]]; ËÆæÁΩÆËá™Âä®ËΩÆÊí≠Êó∂Èó¥pageView.timeInterval = 3.f; ËÆæÁΩÆÁÇπÂáªÂõûË∞ÉÂà´Âøò‰∫ÜÂæ™ÁéØÂºïÁî®ÁöÑÈóÆÈ¢ò„ÄÇ __weak typeof(self) weakSelf = self;pageView.tapHandler = ^(NSUInteger idx, UIImage *img, NSURL *url) &#123; __strong typeof(weakSelf) self = weakSelf; NSLog(@"self = %@, index = %lu, url = %@", self, (unsigned long)idx, url); [self.navigationController popViewControllerAnimated:YES];&#125;; Âõõ„ÄÅÊÄªÁªìÊï¥‰ΩìËÄåË®ÄÔºåÊ≤°ÊúâÂÜó‰ΩôÈÄªËæëÔºåËÉΩ‰ºòÂåñÁöÑ‰πü‰ºòÂåñ‰∫ÜÔºàÊØîÂ¶ÇÁ¥¢ÂºïËÆ°ÁÆóÂØπÂèñÊ®°ÁöÑ‰ºòÂåñ„ÄÅÂÆöÊó∂Âô®ÊáíÂä†ËΩΩ„ÄÅÂà∑Êñ∞Êó∂Êú∫Ê¨°Êï∞Á≠âÁ≠âÔºâÔºåÂ∫îËØ•ÁÆóÊòØÊØîËæÉËΩªÈáè‰∫ÜÂêßÂìàÂìàÂìàÂìà„ÄÇ ÂÖ∑‰ΩìÂ∫îÁî®ÊñπÈù¢ÔºåÊØîÂ¶ÇËÖæËÆØËßÜÈ¢ëApp‰∏≠ÁöÑÈ¶ñÈ°µTab„ÄÅ‰ºöÂëòTabÈÉΩÊúâËøôÁßçcustom widthÁöÑËΩÆÊí≠Âõæ„ÄÇ QQÈü≥‰πê‰∏≠ÁöÑÂèëÁé∞Tab‰πüÊòØËøôÁßçËΩÆÊí≠ÂõæÔºå‰∏çËøá‰∏çËÉΩÊó†ÈôêÂæ™ÁéØÔºà‰∏çËÉΩÊó†ÈôêÂæ™ÁéØÂ≤Ç‰∏çÊòØÊõ¥ÁÆÄÂçï„ÄÇ„ÄÇÔºâ„ÄÇ Â•Ω‰∫ÜÔºåÊää‰∏§Âπ¥ÂâçÁöÑÂùëÂ°´‰∏ä‰∫Ü„ÄÇ]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÂºÄÊ∫êÈ°πÁõÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êï∞ÊçÆÁªìÊûÑÁöÑSwiftÂÆûÁé∞]]></title>
    <url>%2F2019%2F07%2F31%2F%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84Swift%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[‰ΩøÁî®SwiftÂÆûÁé∞Â∏∏ËßÅÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇ 1.Âä®ÊÄÅÊï∞ÁªÑclass ArrayList&lt;T: Equatable&gt; &#123; // ÂÖÉÁ¥†Êï∞Èáè(Âè™ËØª) private(set) var count: Int = 0 // ‰ΩøÁî®nil‰Ωú‰∏∫Âç†‰Ωç private var elements: [T?] // ÈªòËÆ§10‰∏™ÂÖÉÁ¥† private let DEFAULT_CAPACITY = 10 private let ELEMENT_NOT_FOUND = -1 // ÊûÑÈÄ†Âô®, ÂàùÂßãÂåñÂÆπÈáè‰∏∫capaticyÁöÑÊï∞ÁªÑ init(_ capaticy: Int) &#123; let capaticy = capaticy &lt; DEFAULT_CAPACITY ? DEFAULT_CAPACITY : capaticy elements = [T?](repeating: nil, count: capaticy) &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return count == 0 &#125; // ÊèíÂÖ•ÂÖÉÁ¥† func insert(_ item: T, _ index: Int) &#123; if index &lt; 0 || index &gt; count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; ensureCapacity() for idx in (index...count).reversed() &#123; elements[idx + 1] = elements[idx] &#125; count += 1 elements[index] = item &#125; // ËøΩÂä†ÂÖÉÁ¥† func append(_ item: T) &#123; insert(item, count) &#125; // Ëé∑ÂèñÁ¥¢ÂºïÊâÄÂú®ÂÖÉÁ¥† func get(_ index: Int) -&gt; T &#123; checkBounds(index) return elements[index]! &#125; // ËÆæÁΩÆÂÖÉÁ¥† func set(_ item: T, _ index: Int) &#123; checkBounds(index) elements[index] = item &#125; // ÁßªÈô§ÂÖÉÁ¥† func remove(_ index: Int) -&gt; T &#123; let ele = get(index) for idx in index..&lt;count &#123; elements[idx] = elements[idx + 1] &#125; elements[count - 1] = nil count -= 1 return ele &#125; // Ê∏ÖÁ©∫ÂÖÉÁ¥† func clear() &#123; for idx in 0..&lt;count &#123; elements[idx] = nil &#125; count = 0 &#125; // ÊòØÂê¶ÂåÖÂê´Êüê‰∏™ÂÖÉÁ¥† func contains(_ item: T) -&gt; Bool &#123; // item ‰∏çÂèØËÉΩ‰∏∫nil return indexOf(item) != ELEMENT_NOT_FOUND &#125; // Ëé∑ÂèñÊüê‰∏™ÂÖÉÁ¥†ÂØπÂ∫îÁöÑÁ¥¢Âºï private func indexOf(_ item: T) -&gt; Int &#123; // ËøôÈáåÁöÑitem‰∏çÂèØËÉΩ‰∏∫nil for idx in 0..&lt;count &#123; if elements[idx]! == item &#123; return idx &#125; &#125; return ELEMENT_NOT_FOUND &#125; // Êï∞ÁªÑÊâ©ÂÆπ private func ensureCapacity() &#123; if count &gt; elements.count &gt;&gt; 1 &#123; var elements = self.elements // Êâ©ÂÆπ1.5ÂÄç let newCapacity = elements.count + elements.count &gt;&gt; 1 self.elements = [T?](repeating: nil, count: newCapacity) for idx in 0..&lt;count &#123; self.elements[idx] = elements[idx] &#125; &#125; &#125; // Á¥¢ÂºïË∂äÁïåÊ£ÄÊü• private func checkBounds(_ index: Int) &#123; if index &lt; 0 || index &gt;= count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; &#125;&#125; ÂÆûÁé∞ËøáÁ®ã‰∏≠Âá†‰∏™ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÁÇπ: Âú®indexOf()ÂáΩÊï∞‰∏≠ÔºåÂÖÉÁ¥†‰ΩøÁî®==Âà§Á≠âÔºåÈúÄË¶ÅÈÅµÂÆàEquatableÂçèËÆÆ Êï∞ÁªÑÁöÑÊâ©ÂÆπ‰∏≠Ôºå‰ΩøÁî®‰ΩçËøêÁÆóÁ¨¶ÂèØ‰ª•ÈÅøÂÖç‰∫ßÁîüÊµÆÁÇπÊï∞ Áî±‰∫éSwift‰∏≠ÂèØÈÄâÁ±ªÂûãÁöÑÂ≠òÂú®ÔºåÂèØ‰ª•‰ΩøÁî®nilÊù•Âç†‰Ωç„ÄÇÂΩìÁÑ∂ÔºåÂú®set()„ÄÅappend()Á≠âÂáΩÊï∞‰∏≠ÔºåÁî±‰∫éÁ±ªÂûãÁ°ÆÂÆö‰πüÁúÅÁï•‰∫ÜÂ§ñÁïå‰º†ÂèÇÊó∂ÂØπÁ©∫ÂÄºÁöÑÂà§Êñ≠ Âä®ÊÄÅÊï∞ÁªÑ‰ºòÂåñclass OPArrayList&lt;T: Equatable&gt; &#123; // ÂÖÉÁ¥†Êï∞Èáè(Âè™ËØª) private(set) var count: Int = 0 // ‰ΩøÁî®nil‰Ωú‰∏∫Âç†‰Ωç private var elements: [T?] // È¶ñ‰ΩçÂÖÉÁ¥†Á¥¢Âºï private var frontIndex = 0 // ÈªòËÆ§10‰∏™ÂÖÉÁ¥† private let DEFAULT_CAPACITY = 10 private let ELEMENT_NOT_FOUND = -1 // ÊûÑÈÄ†Âô®, ÂàùÂßãÂåñÂÆπÈáè‰∏∫capaticyÁöÑÊï∞ÁªÑ init(_ capaticy: Int) &#123; let capaticy = capaticy &lt; DEFAULT_CAPACITY ? DEFAULT_CAPACITY : capaticy elements = [T?](repeating: nil, count: capaticy) &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return count == 0 &#125; // ÊèíÂÖ•ÂÖÉÁ¥† func insert(_ item: T, _ index: Int) &#123; if index &lt; 0 || index &gt; count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; ensureCapacity() for idx in (index..&lt;count).reversed() &#123; elements[actualIndex(idx + 1)] = elements[actualIndex(idx)] &#125; count += 1 elements[actualIndex(index)] = item &#125; // ËøΩÂä†ÂÖÉÁ¥† func append(_ item: T) &#123; insert(item, count) &#125; // Ëé∑ÂèñÁ¥¢ÂºïÊâÄÂú®ÂÖÉÁ¥† func get(_ index: Int) -&gt; T &#123; checkBounds(index) return elements[actualIndex(index)]! &#125; // ËÆæÁΩÆÂÖÉÁ¥† func set(_ item: T, _ index: Int) &#123; checkBounds(index) elements[actualIndex(index)] = item &#125; // ÁßªÈô§ÂÖÉÁ¥† func remove(_ index: Int) -&gt; T &#123; let ele = elements[actualIndex(index)]! if index == 0 &#123; elements[frontIndex] = nil frontIndex += 1 &#125; else &#123; for idx in index..&lt;count &#123; elements[actualIndex(idx)] = elements[actualIndex(idx + 1)] &#125; elements[actualIndex(count - 1)] = nil &#125; count -= 1 return ele &#125; // Ê∏ÖÁ©∫ÂÖÉÁ¥† func clear() &#123; for idx in 0..&lt;count &#123; elements[actualIndex(idx)] = nil &#125; count = 0 &#125; // ÊòØÂê¶ÂåÖÂê´Êüê‰∏™ÂÖÉÁ¥† func contains(_ item: T) -&gt; Bool &#123; // item ‰∏çÂèØËÉΩ‰∏∫nil return indexOf(item) != ELEMENT_NOT_FOUND &#125; // Ëé∑ÂèñÊüê‰∏™ÂÖÉÁ¥†ÂØπÂ∫îÁöÑÁ¥¢Âºï private func indexOf(_ item: T) -&gt; Int &#123; // ËøôÈáåÁöÑitem‰∏çÂèØËÉΩ‰∏∫nil for idx in 0..&lt;count &#123; if elements[actualIndex(idx)]! == item &#123; return idx &#125; &#125; return ELEMENT_NOT_FOUND &#125; // Ëé∑ÂèñÁúüÂÆûÁ¥¢Âºï: (frontIndex + index) % elements.count private func actualIndex(_ idx: Int) -&gt; Int &#123; return (frontIndex + idx) % elements.count &#125; // Êï∞ÁªÑÊâ©ÂÆπ private func ensureCapacity() &#123; if count == elements.count &#123; var elements = self.elements // Êâ©ÂÆπ1.5ÂÄç let newCapacity = elements.count + elements.count &gt;&gt; 1 self.elements = [T?](repeating: nil, count: newCapacity) for idx in 0..&lt;count &#123; let index = (frontIndex + idx) % elements.count self.elements[idx] = elements[index] &#125; frontIndex = 0 &#125; &#125; // Á¥¢ÂºïË∂äÁïåÊ£ÄÊü• private func checkBounds(_ index: Int) &#123; if index &lt; 0 || index &gt;= count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; &#125; // Êï∞ÁªÑÂÜÖÂÆπÊâìÂç∞ public func desc() &#123; var str = "[" for idx in 0..&lt;elements.count &#123; var a = ", " if idx == 0 &#123; a = "" &#125; if elements[idx] != nil &#123; str += "\(a)\(elements[idx]!)" &#125; else &#123; str += "\(a)nil" &#125; &#125; str += "], frontIndex = \(frontIndex), count = \(count)" print(str) &#125;&#125; 2.ÂçïÂêëÈìæË°®class OneWayLinkedList&lt;T: Equatable&gt; &#123; // ÂÖÉÁ¥†Ê≤°ÊúâÊâæÂà∞ private let ELEMENT_NOT_FOUND = -1 fileprivate var first: Node&lt;T&gt;? fileprivate var count: Int = 0 init(_ firstEle: T?) &#123; if firstEle == nil &#123; first = nil &#125; else &#123; first = Node(ele: firstEle!, next: nil) count += 1 &#125; &#125; // ‰æøÂà©ÊûÑÈÄ† convenience init() &#123; self.init(nil) &#125; // ÁªìÁÇπÁ±ª fileprivate class Node&lt;T&gt; &#123; var ele: T var next: Node&lt;T&gt;? init(ele: T, next: Node?) &#123; self.ele = ele self.next = next &#125; &#125; // Á¥¢ÂºïÊâÄÂú®ÂÖÉÁ¥†Ëé∑Âèñ func get(_ index: Int) -&gt; T &#123; return node(index).ele &#125; // Âú®ÊüêÁ¥¢ÂºïÂ§ÑÊèíÂÖ•ÂÖÉÁ¥† func insert(_ item: T, _ index: Int) &#123; if index &lt; 0 || index &gt; count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; if index == 0 &#123; let prev = first let newNode = Node(ele: item, next: prev) first = newNode &#125; else &#123; let prev = node(index - 1) let newNode = Node(ele: item, next: prev.next) prev.next = newNode &#125; count += 1 &#125; // ËøΩÂä†ÂÖÉÁ¥† func append(_ item: T) &#123; insert(item, count) &#125; // ÁßªÈô§ÊüêÁ¥¢ÂºïÁöÑÂÖÉÁ¥† func remove(_ index: Int) &#123; checkBounds(index) if index == 0 &#123; first = first?.next &#125; else &#123; let noe = node(index - 1) noe.next = noe.next?.next &#125; count -= 1 &#125; // Ëé∑ÂèñÊüêÂÖÉÁ¥†ÊâÄÂú®Á¥¢Âºï func indexOf(_ item: T) -&gt; Int &#123; var node = first var idx = 0 while node != nil &#123; if node!.ele == item &#123; return idx &#125; node = node!.next idx += 1 &#125; return ELEMENT_NOT_FOUND &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; count = 0 self.first = nil &#125; // ÊâìÂç∞ func desc() &#123; var node = first var str = "" for idx in 0..&lt;count &#123; if idx == 0 &#123; str += "first:\(node!.ele)," &#125; if node!.next != nil &#123; str += " [\(node!.ele), \(node!.next!.ele)]" &#125; else &#123; str += " [\(node!.ele), nil]" &#125; node = node!.next if node != nil &#123; str += "," &#125; &#125; print(str) &#125; // Ëé∑ÂèñÁ¥¢ÂºïÊâÄÂú®ÁöÑÁªìÁÇπ fileprivate func node(_ index: Int) -&gt; Node&lt;T&gt; &#123; checkBounds(index) var node = self.first for _ in 0..&lt;index &#123; node = node?.next &#125; return node! &#125; // Á¥¢ÂºïË∂äÁïåÊ£ÄÊü• fileprivate func checkBounds(_ index: Int) &#123; if index &lt; 0 || index &gt;= count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; &#125;&#125; 3.ÂçïÂêëÂæ™ÁéØÈìæË°®class OneWayCircularLinkedList&lt;T: Equatable&gt;: OneWayLinkedList&lt;T&gt; &#123; override func insert(_ item: T, _ index: Int) &#123; if index &lt; 0 || index &gt; count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; if index == 0 &#123; let prev = first let newNode = Node(ele: item, next: prev) if prev == nil &#123; // Âè™Êúâ‰∏Ä‰∏™ÂÖÉÁ¥† newNode.next = newNode &#125; first = newNode &#125; else &#123; let prev = node(index - 1) // Â§ÑÁêÜÊ∑ªÂä†Âà∞ÊúÄÂêé‰∏Ä‰∏™‰ΩçÁΩÆ let fir = (index == count) ? first : prev.next let newNode = Node(ele: item, next: fir) prev.next = newNode &#125; count += 1 &#125; override func remove(_ index: Int) &#123; checkBounds(index) if index == 0 &#123; let last = node(count - 1) // ÂØπÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂ§ÑÁêÜ first = (count - 1 == index) ? nil : first?.next last.next = first &#125; else &#123; let noe = node(index - 1) noe.next = noe.next?.next &#125; count -= 1 &#125; override func clear() &#123; let last = node(count - 1) // ÊâìÁ†¥Âæ™ÁéØÂºïÁî® last.next = nil // Ë∞ÉÁî®Áà∂Á±ª super.clear() &#125;&#125; 4.ÂèåÂêëÈìæË°®class TwoWayLinkedList&lt;T: Equatable&gt; &#123; // ÂÖÉÁ¥†Ê≤°ÊúâÊâæÂà∞ private let ELEMENT_NOT_FOUND = -1 fileprivate(set) var first: Node&lt;T&gt;? fileprivate(set) var last: Node&lt;T&gt;? fileprivate(set) var count: Int = 0 init(_ ele: T?) &#123; if ele == nil &#123; first = nil last = nil &#125; else &#123; first = Node(ele: ele!, prev: nil, next: nil) last = first count += 1 &#125; &#125; // ‰æøÂà©ÊûÑÈÄ† convenience init() &#123; self.init(nil) &#125; // ÁªìÁÇπÁ±ª class Node&lt;T&gt; &#123; var ele: T var prev: Node&lt;T&gt;? var next: Node&lt;T&gt;? init(ele: T, prev: Node?, next: Node?) &#123; self.ele = ele self.prev = prev self.next = next &#125; &#125; // Á¥¢ÂºïÊâÄÂú®ÂÖÉÁ¥†Ëé∑Âèñ func get(_ index: Int) -&gt; T &#123; checkBounds(index) return node(index).ele &#125; // Âú®ÊüêÁ¥¢ÂºïÂ§ÑÊèíÂÖ•ÂÖÉÁ¥† func insert(_ item: T, _ index: Int) &#123; if index &lt; 0 || index &gt; count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; if index == count &#123; let prev = last let newNode = Node(ele: item, prev: prev, next: nil) last = newNode prev?.next = newNode if index == 0 &#123; first = last &#125; &#125; else &#123; let next = node(index) let prev = next.prev let newNode = Node(ele: item, prev: prev, next: next) next.prev = newNode prev?.next = newNode if newNode.prev == nil &#123; first = newNode &#125; &#125; count += 1 &#125; // ËøΩÂä†ÂÖÉÁ¥† func append(_ item: T) &#123; insert(item, count) &#125; // ÁßªÈô§ÊüêÁ¥¢ÂºïÁöÑÂÖÉÁ¥† func remove(_ index: Int) -&gt; T &#123; checkBounds(index) let old = node(index) let prev = old.prev let next = old.next if next == nil &#123; last = prev &#125; else &#123; next?.prev = prev &#125; if prev == nil &#123; first = next &#125; else &#123; prev?.next = next &#125; count -= 1 return old.ele &#125; // Ëé∑ÂèñÊüêÂÖÉÁ¥†ÊâÄÂú®Á¥¢Âºï func indexOf(_ item: T) -&gt; Int &#123; var node = first var idx = 0 while node != nil &#123; if node!.ele == item &#123; return idx &#125; node = node!.next idx += 1 &#125; return ELEMENT_NOT_FOUND &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; // ÊâìÁ†¥Âæ™ÁéØÂºïÁî® var first = self.first while first != nil &#123; first?.prev = nil first = first?.next &#125; self.first = nil self.last = nil count = 0 &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return count == 0 &#125; // ÊâìÂç∞ func desc() &#123; var node = first var str = "" for idx in 0..&lt;count &#123; if idx == 0 &#123; str += "first:\(node!.ele)," &#125; if node!.next != nil &#123; str += " [\(node!.ele), \(node!.next!.ele)]" &#125; else &#123; str += " [\(node!.ele), nil]" &#125; if node != nil &#123; str += "," &#125; if idx == count - 1 &#123; str += " last:\(node!.ele)" &#125; node = node!.next &#125; print(str) &#125; // Ëé∑ÂèñÁ¥¢ÂºïÊâÄÂú®ÁöÑÁªìÁÇπ fileprivate func node(_ index: Int) -&gt; Node&lt;T&gt; &#123; checkBounds(index) if index &lt; count &gt;&gt; 1 &#123; // Âú®ÂâçÂçäÈÉ®ÂàÜÊü•Êâæ var node = self.first for _ in 0..&lt;index &#123; node = node?.next &#125; return node! &#125; else &#123; // Âú®ÂêéÂçäÈÉ®ÂàÜÊü•Êâæ var node = self.last for _ in (index + 1..&lt;count).reversed() &#123; node = node?.prev &#125; return node! &#125; &#125; // Á¥¢ÂºïË∂äÁïåÊ£ÄÊü• fileprivate func checkBounds(_ index: Int) &#123; if index &lt; 0 || index &gt;= count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; &#125;&#125; 5.ÂèåÂêëÂæ™ÁéØÈìæË°®class TwoWayCircularLinkedList&lt;T: Equatable&gt;: TwoWayLinkedList&lt;T&gt; &#123; override func insert(_ item: T, _ index: Int) &#123; if index &lt; 0 || index &gt; count &#123; // Ë∂äÁïå fatalError("Á¥¢ÂºïÊúâËØØ, Â∑≤ÁªèË∂äÁïå") &#125; if index == count &#123; let prev = last let newNode = Node(ele: item, prev: prev, next: first) last = newNode prev?.next = newNode if index == 0 &#123; first = last last?.next = newNode &#125; first?.prev = newNode &#125; else &#123; let next = node(index) let prev = next.prev let newNode = Node(ele: item, prev: prev, next: next) next.prev = newNode prev?.next = newNode if index == 0 &#123; // È¶ñ‰ΩçÊèíÂÖ•ÂÖÉÁ¥† first = newNode &#125; &#125; count += 1 &#125; override func remove(_ index: Int) -&gt; T &#123; checkBounds(index) let old: Node = node(index) var prev = old.prev var next = old.next if count == 1 &amp;&amp; index == 0 &#123; // Âè™Êúâ‰∏Ä‰∏™ÂÖÉÁ¥† prev = nil next = nil old.next = nil old.prev = nil &#125; if index == 0 &#123; first = next &#125; if index == count - 1 &#123; last = prev &#125; prev?.next = next next?.prev = prev count -= 1 return old.ele &#125; override func clear() &#123; // ÊâìÁ†¥Âæ™ÁéØÂºïÁî® var first = self.first for idx in 0..&lt;count &#123; first?.prev = nil first = first?.next if idx == count - 1 &#123; first?.next = nil &#125; &#125; self.first = nil self.last = nil count = 0 &#125;&#125; 6.Ê†à‰ΩøÁî®Âä®ÊÄÅÊï∞ÁªÑÂÆûÁé∞„ÄÇ class Stack&lt;T: Equatable&gt; &#123; // ËÆæÁΩÆÂÆπÈáèÈªòËÆ§‰∏∫10, ÂèØËá™Âä®Êâ©ÂÆπ private var list: ArrayList&lt;T&gt; = ArrayList(10) // ÂÖÉÁ¥†Êï∞Èáè func size() -&gt; Int &#123; return list.count &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return list.isEmpty() &#125; // ÂÖ•Ê†à func push(_ item: T) &#123; list.append(item) &#125; // Âá∫Ê†à func pop() -&gt; T &#123; return list.remove(size() - 1) &#125; // Ëé∑ÂèñÊ†àÈ°∂ÂÖÉÁ¥† func top() -&gt; T? &#123; return size() == 0 ? nil : list.get(size() - 1) &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; list.clear() &#125;&#125; 7.ÈòüÂàóÂõ†‰∏∫È¢ëÁπÅÂú∞Âú®ÂºÄÂ§¥Êú´Â∞æÊ∑ªÂä†Âà†Èô§ÂÖÉÁ¥†ÊâÄ‰ª•‰ΩøÁî®ÈìæË°®ÂÆûÁé∞ÂèàÂõ†‰∏∫ÂèåÂêëÈìæË°®ÊúâÂ§¥ÊåáÈíàÂíåÂ∞æÊåáÈíàËÄåÂçïÂêëÈìæË°®Âè™ÊúâÂ§¥ÊåáÈíàÊâÄ‰ª•‰ΩøÁî®ÂèåÂêëÈìæË°®ÂÆûÁé∞(ÂáèÂ∞ëÈÅçÂéÜ) class Queue&lt;T: Equatable&gt; &#123; private var list: TwoWayLinkedList&lt;T&gt; = TwoWayLinkedList() // ÂÖÉÁ¥†Êï∞Èáè func size() -&gt; Int &#123; return list.count &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return list.isEmpty() &#125; // ÂÖ•Èòü func enQueue(_ item: T) &#123; list.append(item) &#125; // Âá∫Èòü func deQueue() -&gt; T &#123; return list.remove(0) &#125; // Ëé∑ÂèñÈòüÂ§¥ÂÖÉÁ¥† func front() -&gt; T? &#123; return list.first?.ele &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; list.clear() &#125; // ÊâìÂç∞ÂÖÉÁ¥† func desc() &#123; list.desc() &#125;&#125; ‰ΩøÁî®Ê†àÂÆûÁé∞ÈòüÂàóÂéüÁêÜ: ÂÖ•ÈòüÊó∂, ÊääÂÖÉÁ¥†ÊîæÂÖ•inStack‰∏≠ Âá∫ÈòüÊó∂, Â¶ÇÊûúoutStack‰∏∫Á©∫, ÂàôÊääinStack‰∏≠ÁöÑÂÖ®ÈÉ®Ê†àÈ°∂ÂÖÉÁ¥†‰æùÊ¨°ÊîæÂà∞outStack‰∏≠, ËøîÂõûoutStackÁöÑÊ†àÈ°∂ÂÖÉÁ¥†, Âê¶Âàô, Áõ¥Êé•ËøîÂõûoutStackÁöÑÊ†àÈ°∂ÂÖÉÁ¥†class Queue_UseStack&lt;T: Equatable&gt; &#123; // Áª¥Êä§‰∏§‰∏™Ê†à private var inStack: Stack&lt;T&gt; = Stack() private var outStack: Stack&lt;T&gt; = Stack() // ÂÖÉÁ¥†Êï∞Èáè func size() -&gt; Int &#123; return inStack.size() + outStack.size() &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return size() == 0 &#125; // ÂÖ•Èòü func enQueue(_ item: T) &#123; inStack.push(item) &#125; // Âá∫Èòü func deQueue() -&gt; T &#123; if outStack.isEmpty() &#123; while inStack.isEmpty() == false &#123; outStack.push(inStack.pop()) &#125; &#125; return outStack.pop() &#125; // Ëé∑ÂèñÈòüÂ§¥ÂÖÉÁ¥† func front() -&gt; T? &#123; if outStack.isEmpty() &#123; while inStack.isEmpty() == false &#123; outStack.push(inStack.pop()) &#125; &#125; return outStack.top() &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; inStack.clear() outStack.clear() &#125;&#125; 8.Âæ™ÁéØÈòüÂàó‰ΩøÁî®Âä®ÊÄÅÊï∞ÁªÑÂÆûÁé∞, ‰∏îÂêÑÊé•Âè£‰ºòÂåñÂà∞O(1)Êó∂Èó¥Â§çÊùÇÂ∫¶Ë¶ÅÁÇπ: Êúâ‰∏Ä‰∏™ÊåáÂêëÈòüÂ§¥ÂÖÉÁ¥†ÁöÑÁ¥¢ÂºïfrontIndex, ÂøÖ‰∏çÂèØÂ∞ë Êé•Âè£Á¥¢Âºï‰∏éÁúüÂÆûÁ¥¢ÂºïÁöÑ‰∫íÊç¢: ÁúüÂÆûÁ¥¢Âºï = (frontIndex + index) % elements.count ÂÖ•Èòü class CircleQueue&lt;T: Equatable&gt; &#123; // ÂÖÉÁ¥†Êï∞Èáè private var count: Int = 0 // ÊåáÂêëÈòüÂ§¥ÁöÑÁ¥¢Âºï private var frontIndex: Int = 0 // ‰ΩøÁî®nil‰Ωú‰∏∫Âç†‰Ωç private var elements: [T?] // ÈªòËÆ§10‰∏™ÂÖÉÁ¥† private let DEFAULT_CAPACITY = 10 private let ELEMENT_NOT_FOUND = -1 // ÊûÑÈÄ†Âô®, ÂàùÂßãÂåñÂÆπÈáè‰∏∫capaticyÁöÑÊï∞ÁªÑ init(_ capaticy: Int) &#123; let capaticy = capaticy &lt; DEFAULT_CAPACITY ? DEFAULT_CAPACITY : capaticy elements = [T?](repeating: nil, count: capaticy) &#125; // ÂÖÉÁ¥†Êï∞Èáè func size() -&gt; Int &#123; return count &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return count == 0 &#125; // ÂÖ•Èòü func enQueue(_ item: T) &#123; ensureCapacity(count + 1) elements[index(count)] = item count += 1 &#125; // Âá∫Èòü func deQueue() -&gt; T &#123; let ele = elements[frontIndex] if ele == nil &#123; fatalError("ÈòüÂàó‰∏∫Á©∫") &#125; elements[frontIndex] = nil // ‰∏çÊòØfrontIndex += 1, Ë¶ÅËÄÉËôëfrontIndex == elements.count‰ΩÜÊòØelementsÊúâÁ©∫Èó≤‰ΩçÁΩÆÁöÑÊÉÖÂÜµ // ËøôÊó∂Â∫îËØ•ÊòØfrontIndex = (frontIndex + 1) % elements.count, ‰πüÂ∞±ÊòØindex(1) frontIndex = index(1) count -= 1 return ele! &#125; // Ëé∑ÂèñÈòüÂ§¥ÂÖÉÁ¥† func front() -&gt; T? &#123; return elements[frontIndex] &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; for idx in 0..&lt;elements.count &#123; elements[idx] = nil &#125; frontIndex = 0 count = 0 &#125; // Êï∞ÁªÑÊâ©ÂÆπ private func ensureCapacity(_ capacity: Int) &#123; // ‰∏çÈúÄË¶ÅÊâ©ÂÆπ if elements.count &gt;= capacity &#123; return &#125; var elements = self.elements // Êâ©ÂÆπ1.5ÂÄç let newCapacity = elements.count + elements.count &gt;&gt; 1 var newElements = [T?](repeating: nil, count: newCapacity) for idx in 0..&lt;count &#123; newElements[idx] = elements[index(idx)] &#125; self.elements = newElements frontIndex = 0 &#125; // Ëé∑ÂèñÁ¥¢ÂºïÂØπÂ∫îÁúüÂÆûÁ¥¢Âºï private func index(_ index: Int) -&gt; Int &#123; return (frontIndex + index) % elements.count &#125; // ÊâìÂç∞ÂÖÉÁ¥† func desc() &#123; print("frontIndex: \(frontIndex)" + " eles: \(elements)") &#125;&#125; 9.ÂèåÁ´ØÈòüÂàó‰∏§Á´ØÈÉΩÂèØ‰ª•ÂÖ•ÈòüÂíåÂá∫Èòü class DoubleEndedQueue&lt;T: Equatable&gt; &#123; private var list: TwoWayLinkedList&lt;T&gt; = TwoWayLinkedList() // ÂÖÉÁ¥†Êï∞Èáè func size() -&gt; Int &#123; return list.count &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return list.isEmpty() &#125; // ‰ªéÈòüÂ§¥ÂÖ•Èòü func enQueueFront(_ item: T) &#123; list.insert(item, 0) &#125; // ‰ªéÈòüÂ∞æÂÖ•Èòü func enQueueRear(_ item: T) &#123; list.append(item) &#125; // ‰ªéÈòüÂ§¥Âá∫Èòü func deQueueFront() -&gt; T &#123; return list.remove(0) &#125; // ‰ªéÈòüÂ∞æÂá∫Èòü func deQueueRear() -&gt; T &#123; return list.remove(list.count - 1) &#125; // Ëé∑ÂèñÈòüÂ§¥ÂÖÉÁ¥† func front() -&gt; T? &#123; return list.first?.ele &#125; // Ëé∑ÂèñÈòüÂ∞æÂÖÉÁ¥† func rear() -&gt; T? &#123; return list.last?.ele &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; list.clear() &#125; // ÊâìÂç∞ÂÖÉÁ¥† func desc() &#123; list.desc() &#125;&#125; 10.Âæ™ÁéØÂèåÁ´ØÈòüÂàóclass CircleDoubleEndedQueue&lt;T: Equatable&gt; &#123; // ÂÖÉÁ¥†Êï∞Èáè private var count: Int = 0 // ÊåáÂêëÈòüÂ§¥ÁöÑÁ¥¢Âºï private var frontIndex: Int = 0 // ‰ΩøÁî®nil‰Ωú‰∏∫Âç†‰Ωç private var elements: [T?] // ÈªòËÆ§10‰∏™ÂÖÉÁ¥† private let DEFAULT_CAPACITY = 10 private let ELEMENT_NOT_FOUND = -1 // ÊûÑÈÄ†Âô®, ÂàùÂßãÂåñÂÆπÈáè‰∏∫capaticyÁöÑÊï∞ÁªÑ init(_ capaticy: Int) &#123; let capaticy = capaticy &lt; DEFAULT_CAPACITY ? DEFAULT_CAPACITY : capaticy elements = [T?](repeating: nil, count: capaticy) &#125; // ÂÖÉÁ¥†Êï∞Èáè func size() -&gt; Int &#123; return count &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return count == 0 &#125; // ‰ªéÈòüÂ§¥ÂÖ•Èòü func enQueueFront(_ item: T) &#123; ensureCapacity(count + 1) frontIndex = index(-1) elements[frontIndex] = item count += 1 &#125; // ‰ªéÈòüÂ∞æÂÖ•Èòü func enQueueRear(_ item: T) &#123; ensureCapacity(count + 1) elements[index(count)] = item count += 1 &#125; // ‰ªéÈòüÂ§¥Âá∫Èòü func deQueueFront() -&gt; T &#123; if count &lt;= 0 &#123; fatalError("ÈòüÂàó‰∏∫Á©∫") &#125; let ele = elements[frontIndex] elements[frontIndex] = nil frontIndex = index(1) count -= 1 return ele! &#125; // ‰ªéÈòüÂ∞æÂá∫Èòü func deQueueRear() -&gt; T &#123; if count &lt;= 0 &#123; fatalError("ÈòüÂàó‰∏∫Á©∫") &#125; let ele = elements[index(count - 1)]! elements[index(count - 1)] = nil count -= 1 return ele &#125; // Ëé∑ÂèñÈòüÂ§¥ÂÖÉÁ¥† func front() -&gt; T? &#123; return elements[frontIndex] &#125; // Ëé∑ÂèñÈòüÂ∞æÂÖÉÁ¥† func rear() -&gt; T? &#123; return elements[index(count - 1)] &#125; // Ê∏ÖÁ©∫ÊâÄÊúâÂÖÉÁ¥† func clear() &#123; for idx in 0..&lt;elements.count &#123; elements[idx] = nil &#125; frontIndex = 0 count = 0 &#125; // Êï∞ÁªÑÊâ©ÂÆπ private func ensureCapacity(_ capacity: Int) &#123; // ‰∏çÈúÄË¶ÅÊâ©ÂÆπ if elements.count &gt;= capacity &#123; return &#125; var elements = self.elements // Êâ©ÂÆπ1.5ÂÄç let newCapacity = elements.count + elements.count &gt;&gt; 1 var newElements = [T?](repeating: nil, count: newCapacity) for idx in 0..&lt;count &#123; newElements[idx] = elements[index(idx)] &#125; self.elements = newElements frontIndex = 0 &#125; // Ëé∑ÂèñÁ¥¢ÂºïÂØπÂ∫îÁúüÂÆûÁ¥¢Âºï private func index(_ index: Int) -&gt; Int &#123; var index = index index += frontIndex if index &lt; 0 &#123; return index + elements.count &#125; // return index % elements.count return index - (index &gt;= elements.count ? elements.count : 0) &#125; // ÊâìÂç∞ÂÖÉÁ¥† func desc() &#123; print("frontIndex: \(frontIndex)" + ",eles: \(elements)") &#125;&#125; 11. ‰∫åÂèâÊ†ëclass BinaryTree&lt;T: Comparable&gt; &#123; fileprivate var nodeCount = 0 // ÁªìÁÇπÊï∞Èáè fileprivate var root: Node&lt;T&gt;? // Ê†πËäÇÁÇπ // ‰∫åÂèâÊ†ëÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return nodeCount == 0 &#125; // Ê∏ÖÁ©∫ func clear() &#123; root = nil nodeCount = 0 &#125; // ÂâçÂ∫èÈÅçÂéÜ(‰∏ÄËà¨ÊòØÊ†πÂ∑¶Âè≥) func preorderTraversal() &#123; print("---------‰ª•‰∏ãÊòØÂâçÂ∫èÈÅçÂéÜÁöÑÈÄíÂΩíÊñπÂºèÁªìÊûú---------") preorderTraversal(root) print("---------‰ª•‰∏ãÊòØÂâçÂ∫èÈÅçÂéÜÁöÑÈùûÈÄíÂΩíÊñπÂºèÁªìÊûú---------") if root == nil &#123; return &#125; var results = [T]() let stack = Stack&lt;Node&lt;T&gt;&gt;() var p = root while p != nil || stack.size() != 0 &#123; while p != nil &#123; // ÂÖàËÆøÈóÆ Ê†π results.append(p!.ele) stack.push(p!) // ÂÜçËÆøÈóÆ Â∑¶ (ÊåÅÁª≠ÈÅçÂéÜÂ∑¶Â≠êÊ†ë) p = p?.left &#125; p = stack.pop() // ÊúÄÂêéËÆøÈóÆ Âè≥ p = p?.right &#125; print(results) &#125; fileprivate func preorderTraversal(_ node: Node&lt;T&gt;?) &#123; if node == nil &#123; return &#125; print(node!.ele) preorderTraversal(node!.left) preorderTraversal(node!.right) &#125; // ‰∏≠Â∫èÈÅçÂéÜ(‰∏ÄËà¨ÊòØÂ∑¶Ê†πÂè≥) func inorderTraversal() &#123; print("---------‰ª•‰∏ãÊòØ‰∏≠Â∫èÈÅçÂéÜÁöÑÈÄíÂΩíÊñπÂºèÁªìÊûú---------") inorderTraversal(root) print("---------‰ª•‰∏ãÊòØ‰∏≠Â∫èÈÅçÂéÜÁöÑÈùûÈÄíÂΩíÊñπÂºèÁªìÊûú---------") if root == nil &#123; return &#125; var results = [T]() let stack = Stack&lt;Node&lt;T&gt;&gt;() var p = root while p != nil || stack.size() != 0 &#123; while p != nil &#123; // ÊåÅÁª≠ËÆøÈóÆÂ∑¶Â≠êÊ†ë stack.push(p!) p = p?.left &#125; // ÂºπÂá∫Ê†àÈ°∂ÂÖÉÁ¥† p = stack.pop() // ÂÖàËÆøÈóÆÂ∑¶Â≠êÊ†ë results.append(p!.ele) p = p?.right &#125; print(results) &#125; fileprivate func inorderTraversal(_ node: Node&lt;T&gt;?) &#123; if node == nil &#123; return &#125; inorderTraversal(node!.left) print(node!.ele) inorderTraversal(node!.right) &#125; // ÂêéÂ∫èÈÅçÂéÜ(‰∏ÄËà¨ÊòØÂ∑¶Âè≥Ê†π) func postorderTraversal() &#123; print("---------‰ª•‰∏ãÊòØÂêéÂ∫èÈÅçÂéÜÁöÑÈÄíÂΩíÊñπÂºèÁªìÊûú---------") postorderTraversal(root) print("---------‰ª•‰∏ãÊòØÂêéÂ∫èÈÅçÂéÜÁöÑÈùûÈÄíÂΩíÊñπÂºèÁªìÊûú---------") var results = [T]() let stack = Stack&lt;Node&lt;T&gt;&gt;() var p = root var last: Node&lt;T&gt;? = nil while p != nil || stack.size() != 0 &#123; while p != nil &#123; // ÊåÅÁª≠ËÆøÈóÆÂ∑¶Â≠êÊ†ë stack.push(p!) p = p?.left &#125; p = stack.top() if p?.right == nil || p?.right == last &#123; // Ê≤°ÊúâÂè≥Â≠êÊ†ëÊàñËÄÖËÆøÈóÆËøáÂè≥Â≠êÊ†ë results.append(p!.ele) _ = stack.pop() last = p p = nil &#125; else &#123; p = p?.right &#125; &#125; print(results) &#125; fileprivate func postorderTraversal(_ node: Node&lt;T&gt;?) &#123; if node == nil &#123; return &#125; postorderTraversal(node!.left) postorderTraversal(node!.right) print(node!.ele) &#125; // Â±ÇÂ∫èÈÅçÂéÜ--‰ΩøÁî®ÈòüÂàóÂÆûÁé∞ func levelOrderTranversal() &#123; let queue = Queue&lt;Node&lt;T&gt;&gt;() if root == nil &#123; return &#125; var results = [T]() queue.enQueue(root!) while queue.size() != 0 &#123; let r = queue.deQueue() results.append(r.ele) if r.left != nil &#123; queue.enQueue(r.left!) &#125; if r.right != nil &#123; queue.enQueue(r.right!) &#125; &#125; print("---------‰ª•‰∏ãÊòØÂ±ÇÂ∫èÈÅçÂéÜÁöÑÁªìÊûú---------") print(results) &#125; // ÊòØÂê¶ÊòØ‰∏ÄÈ¢óÂÆåÂÖ®‰∫åÂèâÊ†ë func isComplete() -&gt; Bool &#123; if root == nil &#123; // Ê†ë‰∏∫Á©∫ return false &#125; var isAllLeaf = false let queue = Queue&lt;Node&lt;T&gt;&gt;() queue.enQueue(root!) while queue.size() != 0 &#123; let r = queue.deQueue() if isAllLeaf &amp;&amp; !r.isLeaf() &#123; return false &#125; if r.left != nil &#123; queue.enQueue(r.left!) &#125; else if r.left == nil &amp;&amp; r.right != nil &#123; // Â∑¶Â≠êÊ†ë‰∏∫Á©∫ËÄåÂè≥Â≠êÊ†ë‰∏ç‰∏∫Á©∫, ‰∏çÊòØÂÆåÂÖ®‰∫åÂèâÊ†ë return false &#125; if r.right != nil &#123; queue.enQueue(r.right!) &#125; else &#123; // Â∑¶‰∏ç‰∏∫Á©∫Âè≥‰∏∫Á©∫ ÊàñËÄÖ Â∑¶Âè≥ÈÉΩ‰∏∫Á©∫, Ë¶ÅÊ±Ç‰πãÂêéÁöÑÂøÖÈ°ªÈÉΩÊòØÂè∂Â≠êÁªìÁÇπ isAllLeaf = true &#125; &#125; return true &#125; // Êü•ÊâæÂâçÈ©±ÁªìÁÇπ fileprivate func precursor(_ node: Node&lt;T&gt;?) -&gt; Node&lt;T&gt;? &#123; // 1. Á©∫ÁªìÁÇπ, ÂÖ∂ÂâçÈ©±‰∏∫Á©∫ if node == nil &#123; return nil &#125; // 2. ÂâçÈ©±ÁªìÁÇπÂú®Â∑¶ÁªìÁÇπÁöÑÂè≥Â≠êÊ†ë‰∏ä, ÊØîÂ¶ÇÊâæ6ÁöÑÂâçÈ©± var p = node!.left if p != nil &#123; while p!.right != nil &#123; p = p!.right &#125; return p &#125; // 3. ÂâçÈ©±ÁªìÁÇπÂú®Áà∂ËäÇÁÇπ\Á•ñÁà∂ÁªìÁÇπ‰∏ä, ÊØîÂ¶ÇÊâæ9ÁöÑÂâçÈ©± p = node while p!.parent != nil &amp;&amp; p == p!.parent?.left &#123; p = p!.parent &#125; return p!.parent &#125; // Êü•ÊâæÂêéÁªßÁªìÁÇπ fileprivate func successor(_ node: Node&lt;T&gt;?) -&gt; Node&lt;T&gt;? &#123; // 1. Á©∫ÁªìÁÇπ, ÂÖ∂ÂêéÁªß‰∏∫Á©∫ if node == nil &#123; return nil &#125; // 2. ÂêéÁªßÁªìÁÇπÂú®Âè≥ÁªìÁÇπÁöÑÂ∑¶Â≠êÊ†ë‰∏ä, ÊØîÂ¶ÇÊâæ7ÁöÑÂêéÁªß var p = node!.right if p != nil &#123; while p!.left != nil &#123; p = p!.left &#125; return p &#125; // 3. ÂêéÁªßÁªìÁÇπÂú®Áà∂ËäÇÁÇπ\Á•ñÁà∂ÁªìÁÇπ‰∏ä, ÊØîÂ¶ÇÊâæ5ÁöÑÂêéÁªß p = node while p!.parent != nil &amp;&amp; p == p!.parent?.right &#123; p = p!.parent &#125; return p!.parent &#125; // Ê†ëÁöÑÈ´òÂ∫¶--Ëø≠‰ª£ÂÜôÊ≥ï func height() -&gt; Int &#123; // Â±ÇÂ∫èÈÅçÂéÜÊ≥ï let queue = Queue&lt;Node&lt;T&gt;&gt;() if root == nil &#123; return 0 &#125; var level = 1 var height = 0 queue.enQueue(root!) while queue.size() != 0 &#123; let r = queue.deQueue() level -= 1 if r.left != nil &#123; queue.enQueue(r.left!) &#125; if r.right != nil &#123; queue.enQueue(r.right!) &#125; if level == 0 &#123; // Ëøô‰∏ÄÂ±ÇÈÅçÂéÜÁªìÊùü level = queue.size() height += 1 &#125; &#125; return height //return height(root) &#125; // Ê†ëÁöÑÈ´òÂ∫¶--ÈÄíÂΩíÂÜôÊ≥ï fileprivate func height(_ node: Node&lt;T&gt;?) -&gt; Int &#123; if node == nil &#123; return 0 &#125; return 1 + max(height(node!.left), height(node!.right)) &#125; // ÁªìÁÇπÁ±ª fileprivate class Node&lt;T: Equatable&gt;: Equatable &#123; var ele: T var left: Node&lt;T&gt;? var right: Node&lt;T&gt;? var parent: Node&lt;T&gt;? init(_ ele: T, _ parent: Node?) &#123; self.ele = ele self.parent = parent &#125; // Âè∂Â≠êÁªìÁÇπ, Â∑¶Âè≥ÁªìÁÇπÂùá‰∏∫Á©∫ func isLeaf() -&gt; Bool &#123; return left == nil &amp;&amp; right == nil &#125; // Êúâ‰∏§‰∏™ÁªìÁÇπ func hasTwoChildren() -&gt; Bool &#123; return left != nil &amp;&amp; right != nil &#125; // ÊòØÂ∑¶Â≠êÁªìÁÇπ func isLeftChild() -&gt; Bool &#123; // ÊØîËæÉÊåáÈíàÊòØÂê¶‰∏ÄËá¥ return parent != nil &amp;&amp; parent?.left === self &#125; // ÊòØÂè≥Â≠êÁªìÁÇπ func isRightChild() -&gt; Bool &#123; // ÊØîËæÉÊåáÈíàÊòØÂê¶‰∏ÄËá¥ return parent != nil &amp;&amp; parent?.right === self &#125; // ÂØπÁ≠âÊØîËæÉ static func == (lhs: Node&lt;T&gt;, rhs: Node&lt;T&gt;) -&gt; Bool &#123; return lhs.ele == rhs.ele &#125; &#125;&#125; 12.‰∫åÂèâÊêúÁ¥¢Ê†ëclass BinarySearchTree&lt;T: Comparable&gt;: BinaryTree&lt;T&gt; &#123; // Êü•ÊâæÁªìÁÇπ fileprivate func findNode(_ ele: T) -&gt; Node&lt;T&gt;? &#123; var p = root while p != nil &#123; if ele == p!.ele &#123; // ÂÖÉÁ¥†Áõ∏Á≠â, Áõ¥Êé•ÊõøÊç¢ return p &#125; else if ele &lt; p!.ele &#123; // ‰Ωç‰∫éÂ∑¶Â≠êÊ†ë p = p!.left &#125; else &#123; // ‰Ωç‰∫éÂè≥Â≠êÊ†ë p = p!.right &#125; &#125; return p &#125; // Ê∑ªÂä†ÁªìÁÇπ func addNode(_ ele: T) &#123; // Ê∑ªÂä†ÁöÑÊòØÊ†πËäÇÁÇπ if root == nil &#123; root = Node(ele, nil) nodeCount += 1 afterAdd(root!) return &#125; // Ê∑ªÂä†ÁöÑ‰∏çÊòØÊ†πÁªìÁÇπ else &#123; var p = root var parent = root while p != nil &#123; parent = p if ele == p!.ele &#123; // ÂÖÉÁ¥†Áõ∏Á≠â, Áõ¥Êé•ÊõøÊç¢ p?.ele = ele return &#125; else if ele &lt; p!.ele &#123; // ‰Ωç‰∫éÂ∑¶Â≠êÊ†ë p = p!.left &#125; else &#123; // ‰Ωç‰∫éÂè≥Â≠êÊ†ë p = p!.right &#125; &#125; // ÂæóÂà∞parentÁªìÁÇπ let newNode = Node(ele, parent) if ele &gt; parent!.ele &#123; parent?.right = newNode &#125; else &#123; parent?.left = newNode &#125; // ÊÄªÁªìÁÇπÊï∞ÈáèÂä†1 nodeCount += 1 afterAdd(newNode) &#125; &#125; // ÁßªÈô§ÁªìÁÇπ func remove(_ ele: T) &#123; var node: Node&lt;T&gt;? = findNode(ele) if node == nil &#123; // Ê≤°ÊúâÊâæÂà∞ÈúÄË¶ÅÂà†Èô§ÁöÑÁªìÁÇπ return &#125; // ÁªìÁÇπÊï∞ÈáèÂáè1 nodeCount -= 1 // Â∫¶‰∏∫2ÁöÑÁªìÁÇπ if node!.hasTwoChildren() &#123; // ÊâæÂÆÉÁöÑÂêéÁªßÁªìÁÇπ let p = successor(node) // Áî®ÂêéÁªßÁªìÁÇπÂÜÖÂÆπÊõøÊç¢ÂæÖÂà†Èô§ÁªìÁÇπÂÜÖÂÆπ node!.ele = p!.ele // ÈúÄË¶ÅÂà†ÁöÑÁªìÁÇπÂ∞±ÊòØnodeÁªìÁÇπ‰∫Ü node = p &#125; // nodeÊòØÂè∂Â≠êÁªìÁÇπËÄå‰∏î‰πüÊòØÊ†πÁªìÁÇπ if node?.parent == nil &#123; root = nil afterRemove(node!) return &#125; // ÈúÄË¶ÅÊõøÊç¢ÁöÑÁªìÁÇπ let replace = node?.left == nil ? node?.right : node?.left if replace == nil &#123; // nodeÊ≤°ÊúâÂ∑¶Â≠êÊ†ë‰πüÊ≤°ÊúâÂè≥Â≠êÊ†ë, ËØ¥ÊòénodeÊòØÂè∂Â≠êÁªìÁÇπ if node?.parent?.left == node &#123; // nodeÊòØÁà∂ÁªìÁÇπÁöÑÂ∑¶ÁªìÁÇπ node?.parent?.left = nil &#125; else &#123; // nodeÊòØÁà∂ÁªìÁÇπÁöÑÂè≥ÁªìÁÇπ node?.parent?.right = nil &#125; afterRemove(node!) &#125; else &#123; if node?.parent == nil &#123; // ÊòØÊ†πÁªìÁÇπ root = replace &#125; else if node?.parent?.left == node &#123; // ÊòØÂ∑¶ÁªìÁÇπ node?.parent?.left = replace &#125; else &#123; // ÊòØÂè≥ÁªìÁÇπ node?.parent?.right = replace &#125; afterRemove(node!) &#125; &#125; fileprivate func afterAdd(_ node: Node&lt;T&gt;) &#123; &#125; fileprivate func afterRemove(_ node: Node&lt;T&gt;) &#123; &#125;&#125; 13.AVLTreeclass AVLTree&lt;T: Comparable&gt;: BinarySearchTree&lt;T&gt; &#123; fileprivate override func afterAdd(_ node: Node&lt;T&gt;) &#123; print("Â∑≤ÁªèÊ∑ªÂä†\(node)") &#125; fileprivate override func afterRemove(_ node: Node&lt;T&gt;) &#123; print("Â∑≤ÁªèÁßªÈô§\(node)") &#125;&#125; ËøòÊú®ÊúâÂÜôÂÆå„ÄÇ„ÄÇ„ÄÇ„ÄÇ 14.Á∫¢ÈªëÊ†ë15.‰∫åÂèâÂ†Üprotocol Heap &#123; associatedtype T var size: Int &#123; get set &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool // Ê∏ÖÁ©∫ func clear() // Ê∑ªÂä†ÂÖÉÁ¥† func add(_ ele: T) // Ëé∑ÂèñÂ†ÜÈ°∂ÂÖÉÁ¥† func get() -&gt; T // Âà†Èô§Â†ÜÈ°∂ÂÖÉÁ¥† func remove() -&gt; T // Âà†Èô§Â†ÜÈ°∂ÂÖÉÁ¥†ÁöÑÂêåÊó∂ÊèíÂÖ•‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥† func replace(_ ele: T) -&gt; T?&#125;class BinaryHeap&lt;T: Comparable&gt;: Heap &#123; // ‰ΩøÁî®nil‰Ωú‰∏∫Âç†‰Ωç private var list: [T?] // ÂÖÉÁ¥†Êï∞Èáè internal var size = 0 // ÈªòËÆ§10‰∏™ÂÖÉÁ¥† private let DEFAULT_CAPACITY = 10 // ÊûÑÈÄ†Âô® init(_ capaticy: Int) &#123; let capaticy = capaticy &lt; DEFAULT_CAPACITY ? DEFAULT_CAPACITY : capaticy list = [T?](repeating: nil, count: capaticy) &#125; // Êï∞ÁªÑÊâ©ÂÆπ private func ensureCapacity(_ count: Int) &#123; if count &gt; list.count &#123; var oldList = self.list // Êâ©ÂÆπ1.5ÂÄç let newCapacity = oldList.count + oldList.count &gt;&gt; 1 self.list = [T?](repeating: nil, count: newCapacity) for idx in 0..&lt;size &#123; self.list[idx] = oldList[idx] &#125; &#125; &#125; // ÊòØÂê¶‰∏∫Á©∫ func isEmpty() -&gt; Bool &#123; return size == 0 &#125; // Ê∏ÖÁ©∫ func clear() &#123; for idx in 0..&lt;size &#123; list[idx] = nil &#125; size = 0 &#125; // Ê∑ªÂä†ÂÖÉÁ¥† func add(_ ele: T) &#123; ensureCapacity(size + 1) list[size] = ele size += 1 siftUp(size - 1) &#125; // Ëé∑ÂèñÂ†ÜÈ°∂ÂÖÉÁ¥† func get() -&gt; T &#123; if self.isEmpty() &#123; fatalError("Â†Ü‰∏∫Á©∫, Êó†Ê≥ïÂà†Èô§") &#125; return list[0]! &#125; // Âà†Èô§Â†ÜÈ°∂ÂÖÉÁ¥† func remove() -&gt; T &#123; if self.isEmpty() &#123; fatalError("Â†Ü‰∏∫Á©∫, Êó†Ê≥ïÂà†Èô§") &#125; size -= 1 let first = list[0]! list[0] = list[size] list[size] = nil siftDown(0); return first &#125; // Âà†Èô§Â†ÜÈ°∂ÂÖÉÁ¥†ÁöÑÂêåÊó∂ÊèíÂÖ•‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥† func replace(_ ele: T) -&gt; T? &#123; if self.isEmpty() &#123; fatalError("Â†Ü‰∏∫Á©∫, Êó†Ê≥ïÂà†Èô§") &#125; var root: T? if (size == 0) &#123; list[0] = ele size += 1 &#125; else &#123; root = list[0]; list[0] = ele; siftDown(0); &#125; return root; &#125; // Âª∫Â†Ü func heapify(_ eles: [T]) &#123; size = eles.count for idx in 0..&lt;eles.count &#123; list[idx] = eles[idx] &#125; // Ëá™‰∏äËÄå‰∏ãÁöÑ‰∏äÊª§O(nlogn) /* for idx in 0..&lt;size &#123; siftUp(idx) &#125; */ // Ëá™‰∏ãËÄå‰∏äÁöÑ‰∏äÊª§O(n) for idx in (0...size &gt;&gt; 1).reversed() &#123; siftDown(idx) &#125; &#125; // index‰ΩçÁΩÆÁöÑÂÖÉÁ¥†‰∏ãÊª§ private func siftDown(_ idx: Int) &#123; let ele = list[idx]! var idx = idx while idx &lt; size &gt;&gt; 1 &#123; // Â∑¶ÁªìÁÇπ var childIdx = idx &lt;&lt; 1 + 1 var child = list[childIdx]! // Âè≥ÁªìÁÇπÁ¥¢Âºï let rightIdx = childIdx + 1 // Â¶ÇÊûúÂè≥ÁªìÁÇπÂ≠òÂú®, ÂàôÂèñÂá∫Â∑¶Âè≥ÁªìÁÇπ‰∏≠ËæÉÂ§ßÁöÑ‰∏Ä‰∏™ if rightIdx &lt; size &amp;&amp; list[rightIdx]! &gt; child &#123; childIdx = rightIdx child = list[childIdx]! &#125; // Â¶ÇÊûúËá™Â∑±‰∏çÂ∞è‰∫éËæÉÂ§ßÂ≠êÁªìÁÇπ, ÂÅúÊ≠¢‰∏ãÊª§ if ele &gt;= child &#123; break &#125; // ‰∫§Êç¢Ëá™Â∑±‰∏éËæÉÂ§ßÂ≠êÁªìÁÇπÁöÑ‰ΩçÁΩÆ list[idx] = child idx = childIdx &#125; list[idx] = ele &#125; // index‰ΩçÁΩÆÁöÑÂÖÉÁ¥†‰∏äÊª§ private func siftUp(_ idx: Int) &#123; var idx = idx let ele = list[idx]! while idx &gt; 0 &#123; let parentIdx = (idx - 1) &gt;&gt; 1 let parent = list[parentIdx]! if parent &gt;= ele &#123; // Áà∂ÁªìÁÇπ‰∏çÂ∞è‰∫éËá™Â∑±, ÂÅúÊ≠¢‰∏äÊª§ break &#125; // ‰∫§Êç¢Ëá™Â∑±‰∏éÁà∂ÁªìÁÇπÁöÑ‰ΩçÁΩÆ list[idx] = parent idx = parentIdx &#125; list[idx] = ele &#125; func desc() &#123; print(list) &#125;&#125; ‰∏äÊª§1„ÄÅÂΩìÊèíÂÖ•‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥†Êó∂ÔºåÊîæÂú®ÊúÄÊú´Â∞æ„ÄÇ2„ÄÅËã•ÊúâÁà∂ËäÇÁÇπÔºåÂ∞ÜÊèíÂÖ•ËäÇÁÇπÂíåÁà∂ËäÇÁÇπÊØîËæÉÔºåÂ¶ÇÊûúÊèíÂÖ•ËäÇÁÇπÂ§ß‰∫éÁà∂ËäÇÁÇπÔºå‰∫§Êç¢‰ΩçÁΩÆ„ÄÇ3„ÄÅÈáçÂ§ç2ÔºåÁõ¥Ëá≥ÊèíÂÖ•ËäÇÁÇπ‰∏çÂ∞è‰∫éÁà∂ËäÇÁÇπÊàñËÄÖÊ≤°ÊúâÁà∂ËäÇÁÇπÔºå‰∏äÊª§ÁªìÊùü„ÄÇ ‰∏ãÊª§1„ÄÅÂà†Èô§È¶ñÂÖÉÁ¥†ÔºåÂ∞ÜÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁßªÂà∞È¶ñËäÇÁÇπ„ÄÇ2„ÄÅËã•ÊúâÂ≠©Â≠êÔºåÂàôÊØîËæÉËØ•ËäÇÁÇπÂíåÊúÄÂ§ßÂ≠©Â≠êÁöÑÂÄºÔºåËã•Â∞è‰∫éÊúÄÂ§ßÂ≠©Â≠êÁöÑÂÄºÔºå‰∏éÊúÄÂ§ßÁöÑÂ≠©Â≠ê‰∫íÊç¢‰ΩçÁΩÆ„ÄÇ3„ÄÅÈáçÂ§ç2ÔºåÁõ¥Ëá≥ËØ•ËäÇÁÇπÁöÑÂÄºÂ§ß‰∫éÊúÄÂ§ßÂ≠©Â≠êÁöÑÂÄºÊàñËÄÖÊ≤°ÊúâÂ≠©Â≠êÔºå‰∏ãÊª§ÁªìÊùüÔºåÂ†ÜÂ∫èÊÄßÂæó‰ª•Êª°Ë∂≥„ÄÇ 16.‰ºòÂÖàÁ∫ßÈòüÂàó‰ΩøÁî®‰∫åÂèâÂ†ÜÂÆûÁé∞„ÄÇ class PriorityQueue&lt;T: Comparable&gt; &#123; private var heap: BinaryHeap = BinaryHeap&lt;T&gt;(10) func size() -&gt; Int &#123; return heap.size &#125; func isEmpty() -&gt; Bool &#123; return heap.isEmpty() &#125; func clear() &#123; heap.clear() &#125; func enQueue(_ ele: T) &#123; heap.add(ele) &#125; func deQueue() -&gt; T &#123; return heap.remove() &#125; func front() -&gt; T &#123; return heap.get() &#125;&#125;]]></content>
      <tags>
        <tag>ÁÆóÊ≥ï</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØªKVOÊ∫êÁ†Å]]></title>
    <url>%2F2019%2F05%2F31%2F%E8%AF%BBKVO%E6%BA%90%E7%A0%81%2F</url>
    <content type="text"><![CDATA[KVOÊ∫êÁ†ÅÈòÖËØª„ÄÇ Â∞ùËØïÂéªËØª‰∏ÄÈÅçKVOÁöÑÊ∫êÁ†ÅÔºåÂèëÁé∞ÂÆÉÊØîKVCÂ§çÊùÇÁöÑÂ§öÔºåÂè™ËÉΩÊòéÁôΩ‰∏™Â§ßÊ¶Ç„ÄÇÊñáÁ´†ÊúÄÂêéÊåâÁÖßËá™Â∑±ÁöÑÁêÜËß£ÔºåÂÜçÁªìÂêàÊ∫êÁ†ÅÁöÑÂÆûÁé∞ÊµÅÁ®ãËá™Â∑±ÂÜô‰∫Ü‰∏Ä‰∏™KVOÔºåÈîªÁÇºÈîªÁÇº„ÄÇ ‰∏Ä„ÄÅÂ∏∏Áî®Êé•Âè£// KVOÁöÑÂõûË∞É@interface NSObject(NSKeyValueObserving)- (void)observeValueForKeyPath:(nullable NSString *)keyPath ofObject:(nullable id)object change:(nullable NSDictionary&lt;NSKeyValueChangeKey, id&gt; *)change context:(nullable void *)context;@end// Ê∑ªÂä†ÂèäÁßªÈô§ËßÇÂØüËÄÖ@interface NSObject(NSKeyValueObserverRegistration)- (void)addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(nullable void *)context;- (void)removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath context:(nullable void *)context API_AVAILABLE(macos(10.7), ios(5.0), watchos(2.0), tvos(9.0));- (void)removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath;@end ‰∫å„ÄÅÊäÄÂ∑ßÂõûÈ°æ1.Â¶Ç‰Ωï‰ΩøÂæóÂ±ûÊÄßÂú®Êú™ÊîπÂèòÁöÑÊÉÖÂÜµ‰∏ã‰∏çÂèëÈÄÅÈÄöÁü•(ÊâãÂä®ÊéßÂà∂)?Á§∫‰æãÂ¶Ç‰∏ãÔºå‰∏ªË¶ÅÊúâ: ÈáçÂÜôautomaticallyNotifiesObserversForKey:ÊñπÊ≥ï ÈáçÂÜôsetterÊñπÊ≥ï @interface YAObject : NSObject@property (nonatomic, copy) NSString *name;@end@implementation YAObject+ (BOOL)automaticallyNotifiesObserversForKey:(NSString *)key &#123; if ([key isEqualToString:@"name"]) return NO; return [super automaticallyNotifiesObserversForKey:key];&#125;- (void)setName:(NSString *)name &#123; if (name != _name) &#123; [self willChangeValueForKey:@"name"]; _name = name; [self didChangeValueForKey:@"name"]; &#125;&#125;@end 2.Â¶Ç‰ΩïÊ≥®ÂÜå‰æùËµñÈîÆ(Â§ö‰∏™Â±ûÊÄßÂΩ±ÂìçÂà∞Êüê‰∏Ä‰∏™Â±ûÊÄß)? ÈáçÂÜôgetterÊñπÊ≥ïÔºåÂÆö‰πâ‰æùËµñÂÖ≥Á≥ª ÈáçÂÜôkeyPathsForValuesAffectingValueForKey:ÊñπÊ≥ïÔºåÊ∑ªÂä†‰æùËµñÁöÑkeyÈõÜÂêà @interface YAObject : NSObject@property (nonatomic, copy) NSString *name;@property (nonatomic, copy) NSString *firstName;@property (nonatomic, copy) NSString *lastName;@end@implementation YAObject- (NSString *)name &#123; // ÂÆö‰πâ‰æùËµñÂÖ≥Á≥ª return [NSString stringWithFormat:@"firstName is %@ and lastName is %@", self.firstName, self.lastName];&#125;+ (NSSet&lt;NSString *&gt; *)keyPathsForValuesAffectingValueForKey:(NSString *)key &#123; NSSet *keyPaths = [super keyPathsForValuesAffectingValueForKey:key]; if ([key isEqualToString:@"name"]) &#123; keyPaths = [keyPaths setByAddingObjectsFromArray:@[@"firstName", @"lastName"]]; &#125; return keyPaths;&#125;/* // ‰πüÂèØ‰ª•ÂëΩÂêç‰∏∫keyPathsForValuesAffecting&lt;Key&gt;ÁöÑÁ±ªÊñπÊ≥ïÊù•ËææÂà∞ÂêåÊ†∑ÁöÑÁõÆÁöÑ + (NSSet&lt;NSString *&gt; *)keyPathsForValuesAffectingName &#123; return [NSSet setWithObjects:@"firstName", @"lastName", nil]; &#125; */@end 3.ÂΩìNSMutableArray‰∏≠ÂÖÉÁ¥†Â¢ûÂä†ÂíåÂáèÂ∞ëÊó∂Â¶Ç‰ΩïÁõëÂê¨Âà∞?Á§∫‰æã‰ª£Á†Å: @interface YAObject : NSObject@property (nonatomic, strong) NSMutableArray *nameList;@end@implementation YAObject// ÂÆûÁé∞ÈõÜÂêà‰ª£ÁêÜÂØπË±°: ‰∏ÄËà¨Âª∫ËÆÆ-countOf&lt;Key&gt;Âíå-objectIn&lt;Key&gt;AtIndex:- (NSUInteger)countOfNameList &#123; return [_nameList count];&#125;- (id)objectInNameListAtIndex:(NSUInteger)index &#123; return [_nameList objectAtIndex:index];&#125;// Ëá≥Â∞ëÂÆûÁé∞‰∏Ä‰∏™ÊèíÂÖ•ÊñπÊ≥ïÂíå‰∏Ä‰∏™Âà†Èô§ÊñπÊ≥ï- (void)insertObject:(id)object inNameListAtIndex:(NSUInteger)index &#123; [_nameList insertObject:object atIndex:index];&#125;- (void)removeObjectFromNameListAtIndex:(NSUInteger)index &#123; [_nameList removeObjectAtIndex:index];&#125;@end ‰ΩøÁî®: Âä°ÂøÖ‰ΩøÁî®mutableArrayValueForKeyËé∑ÂèñÈõÜÂêà ‰ΩøÁî®insertObjectÊñπÊ≥ïÊ∑ªÂä†ÂÖÉÁ¥† ÊØîÂ¶Ç: NSMutableArray *nameList = [self.obj mutableArrayValueForKey:@"nameList"];[nameList insertObject:obj atIndex:0]; ‰∏â„ÄÅÂá†‰∏™ÈóÆÈ¢òÊÄªÁªìÁöÑÂá†‰∏™ÈóÆÈ¢ò„ÄÇ 1.KVOÁöÑÂÆûÁé∞ÂéüÁêÜÊòØ‰ªÄ‰πà? Objective-C‰æùÊâò‰∫éÂº∫Â§ßÁöÑruntimeÊú∫Âà∂Êù•ÂÆûÁé∞KVO„ÄÇÂΩìÊàë‰ª¨Á¨¨‰∏ÄÊ¨°ËßÇÂØüÊüê‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßÊó∂Ôºåruntime‰ºöÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÁªßÊâøËá™Ëøô‰∏™ÂØπË±°ÁöÑclassÁöÑsubclass(ÂâçÁºÄÊòØNSKVONotifying_)„ÄÇÂú®Ëøô‰∏™Êñ∞ÁöÑsubclass‰∏≠ÔºåÂÆÉ‰ºöÈáçÂÜôÊâÄÊúâË¢´ËßÇÂØüÁöÑkeyÁöÑsetterÔºåÁÑ∂ÂêéÂ∞ÜobjectÁöÑisaÊåáÈíàÊåáÂêëÊñ∞ÂàõÂª∫ÁöÑclass(Ëøô‰∏™ÊåáÈíàÂëäËØâObjective-CËøêË°åÊó∂Êüê‰∏™objectÂà∞Â∫ïÊòØ‰ªÄ‰πàÁ±ªÂûãÁöÑ)„ÄÇÊâÄ‰ª•objectÁ•ûÂ•áÂú∞ÂèòÊàê‰∫ÜÊñ∞ÁöÑÂ≠êÁ±ªÁöÑÂÆû‰æã„ÄÇ ‚Äî‚ÄîÊëòËá™ÂçóÂ≥∞Â≠êÁöÑÂçöÂÆ¢„ÄÇ 2.KVOÊ∫êÁ†Å‰∏≠Ê∑ªÂä†ËßÇÂØüËÄÖÊó∂Êï¥‰ΩìÁöÑÂ§ßËá¥ÊµÅÁ®ãÊòØ‰ªÄ‰πà? Â∞ÜkeyPath„ÄÅclassÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàêNSKeyValuePropertyÔºåÂàÜÂà´Ëß£Êûê‰∏ÄËà¨Â±ûÊÄß(@&quot;aa&quot;)„ÄÅÂèØËÆ°ÁÆóÂ±ûÊÄß(@&quot;@aa&quot;)„ÄÅÂ±ûÊÄßÈìæ(@&quot;aa.bb.@cc.dd&quot;)ÔºåËøõË°åÂ≠êÁ±ªÂåñÔºåÁºìÂ≠òÂú®CFMutableSet‰∏≠Êñπ‰æø‰∏ãÊ¨°Âø´ÈÄüÂèñÂá∫„ÄÇ Â∞ÜNSKeyValueProperty„ÄÅcontext„ÄÅoptions„ÄÅobserverÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàêNSKeyValueObservanceÔºåÁºìÂ≠òÂú®NSHashTable‰∏≠„ÄÇ ÂÄòËã•ËÆæÁΩÆ‰∫ÜNSKeyValueObservingOptionInitialÈÄâÈ°πÔºå‰ºöÂú®Ê≥®ÂÜåËßÇÂØüÊúçÂä°Êó∂Ë∞ÉÁî®‰∏ÄÊ¨°Ëß¶ÂèëÊñπÊ≥ï„ÄÇ Âä®ÊÄÅÂàõÂª∫Âêç‰∏∫NSKVONotifying_+ÂéüÊù•Á±ªÂêçÁöÑÊñ∞Á±ªÔºåÈáçÂÜôÂÖ∂dealloc„ÄÅ_isKVOAÊñπÊ≥ïÔºåÂÜçÈáçÂÜôclassÊñπÊ≥ïÔºåÂà©Áî®object_setClass()ÂáΩÊï∞Â∞ÜÂÖ∂isaÊåáÈíàÊåáÂêëÂéüÂÖàÁöÑÁ±ª„ÄÇ ÈáçÂÜôwillChangeValueForKey:ÂíådidChangeValueForKey:ÊñπÊ≥ïÔºåÈáçÂÜôË¢´ËßÇÂØüÂ±ûÊÄßÁöÑsetterÊñπÊ≥ïÔºåÂú®setter‰∏≠ÂÖàË∞ÉÁî®willChangeValueForKey:ÊñπÊ≥ïÔºåÁÑ∂ÂêéË∞ÉÁî®Áà∂Á±ªÁöÑ setter ÊñπÊ≥ïÂØπÊàêÂëòÂèòÈáèËµãÂÄºÔºå‰πãÂêéÂÜçË∞ÉÁî® didChangeValueForKey: ÊñπÊ≥ï„ÄÇ didChangeValueForKey: ÊñπÊ≥ï‰∏≠‰ºöË∞ÉÁî®observeValueForKeyPath:ofObject:change:context:ÊñπÊ≥ï„ÄÇ 3.KVO‰∏≠ÊâÄÂ∞ÅË£ÖÁªÑ‰ª∂ÁöÑÂÖ≥Á≥ªÊòØÊÄéÊ†∑ÁöÑ? Â∞ÜkeyPath„ÄÅclassÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàêNSKeyValuePropertyÔºå‰ΩøÁî®CFMutableSetÁºìÂ≠òNSKeyValueProperty„ÄÇ Â∞Üobserver„ÄÅproperty„ÄÅoptions„ÄÅcontext „ÄÅoriginalObservableÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàêNSKeyValueObservanceÔºå‰ΩøÁî®NSHashTable(NSKeyValueShareableObservationInfos)ÁºìÂ≠ò„ÄÇ NSKeyValueObservationInfo‰∏éNSKeyValueObservanceÁöÑÂÖ≥Á≥ªÊòØ: NSKeyValueObservationInfo‰∏≠Êúâ‰∏Ä‰∏™observancesÊï∞ÁªÑÔºåÊï∞ÁªÑÈáåÈù¢ÊòØNSKeyValueObservanceÂØπË±°„ÄÇ ÊØè‰∏Ä‰∏™objectÈÉΩÊúâ‰∏Ä‰∏™observationInfoÂ±ûÊÄß(void *Á±ªÂûã)ÔºåÂÆÉ‰∏éNSKeyValueObservationInfo‰ºöÁõ∏‰∫íËΩ¨Âåñ„ÄÇ Â¶ÇÂõæÊâÄÁ§∫: ÂõæÁâá classÂíåkeyPathÂÜ≥ÂÆö‰∫ÜÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™NSKeyValueProperty„ÄÇNSKeyValueProperty„ÄÅObserver„ÄÅoptions„ÄÅcontext ÂÜ≥ÂÆö‰∫ÜÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™NSKeyValueObservance„ÄÇ 4.KVOÂ§öÊ¨°‰ΩøÁî®ÂÆåÂÖ®Áõ∏ÂêåÁöÑÂèÇÊï∞ËøõË°åaddObserverÊìç‰ΩúÔºå‰πü‰ºöÂæóÂà∞Áõ∏Â∫îÊ¨°Êï∞ÁöÑÂõûË∞ÉÔºåÂ¶Ç‰ΩïÂÅöÂà∞?[self.obj addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:NULL];[self.obj addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:NULL];[self.obj addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:NULL];[self.obj addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:NULL]; Â¶Ç‰∏äÈù¢‰ª£Á†ÅÔºå‰ºöÊúâÂõõÊ¨°ÂõûË∞É„ÄÇ Âú®ÊØèÊ¨°Ê∑ªÂä†ËßÇÂØüËÄÖÊó∂ÔºåÈÉΩ‰ºöËé∑ÂèñNSKeyValueObservanceÂØπË±°(ÂèØËÉΩ‰ªéÁºìÂ≠ò‰∏≠Ëé∑Âèñ‰πüÂèØËÉΩÊñ∞Âª∫)ÔºåÂπ∂ÊääÂÆÉËøΩÂä†Âà∞objectÁöÑobservancesÊï∞ÁªÑ‰∏≠(Âç≥‰ΩøËØ•Êï∞ÁªÑ‰∏≠Â∑≤ÁªèÂ≠òÂú®ÂÆåÂÖ®Áõ∏ÂêåÔºàÊåáÈíà‰∏ÄËá¥ÔºâÁöÑNSKeyValueObservanceÂØπË±°)ÔºåÁî±Ê≠§‰øùËØÅ‰∫ÜÂ§öÊ¨°addObserverÊìç‰Ωú‰ºöÊúâÂ§öÊ¨°ÂõûË∞É„ÄÇ ÈÄöËøáÊâìÂç∞ÂèØ‰ª•ËØÅÊòéÔºö Âõõ„ÄÅÊ∑ªÂä†ËßÇÂØüËÄÖËøô‰∏ÄÊ≠•È™§‰∏≠Â∞ÅË£ÖÂá∫‰∫ÜËÆ∏Â§öÁöÑÁ±ªÔºåÂêåÊó∂‰πüÊää‰∫ßÁîüÁöÑËÆ∏Â§öÂØπË±°ÂÅö‰∫ÜËøõ‰∏ÄÊ≠•ÁöÑÁºìÂ≠òÂ§ÑÁêÜ„ÄÇ 1.Â∞ÅË£Ö1.1Êé•Âè£ÊñπÊ≥ïÂä†ÈîÅÔºåÊé•Âè£ÊñπÊ≥ï‰∏≠‰ΩøÁî®pthread‰∏≠ÁöÑpthread_mutex_lock()Âíåpthread_mutex_unlockÂáΩÊï∞„ÄÇ // ËøôÊòØ‰∏™Êé•Âè£ÊñπÊ≥ï, Ê∑ªÂä†ËßÇÂØüËÄÖÂàÜ‰∏∫‰∏§‰∏™ÊµÅÁ®ã: 1ÔºåÊ†πÊçÆclassÂíåkeyPathËé∑ÂèñNSKeyValuePropertyÂØπË±°„ÄÇ2ÔºåÊ∑ªÂä†ÂØπpropertyÁöÑËßÇÂØü„ÄÇ- (void)d_addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(void *)context &#123; // Âä†ÈîÅ pthread_mutex_lock(&amp;_NSKeyValueObserverRegistrationLock); // Ëé∑ÂèñÂΩìÂâçÁ∫øÁ®ãpthread _NSKeyValueObserverRegistrationLockOwner = pthread_self(); // Ê†πÊçÆclassÂíåkeyPathËé∑ÂèñNSKeyValueProperty NSKeyValueProperty *property = NSKeyValuePropertyForIsaAndKeyPath(object_getClass(self),keyPath); // Ê∑ªÂä†ÂØπpropertyÁöÑËßÇÂØü [self _d_addObserver:observer forProperty:property options:options context:context]; // Ëß£ÈîÅ pthread_mutex_unlock(&amp;_NSKeyValueObserverRegistrationLock);&#125; 1.2.Ê∑ªÂä†ÂØπNSKeyValuePropertyÁöÑËßÇÂØüÁöÑÂÖ∑‰ΩìÂÆûÁé∞// Ê∑ªÂä†ËßÇÂØüËÄÖËøáÁ®ã‰∏≠, ‰∏çÊòØÂçïÁ∫ØÂú∞'ËßÇÂØü'keyPath, ËÄåÊòØËßÇÂØüÂØπkeyPathÂ∞ÅË£ÖÁöÑNSKeyValueProperty- (void)_addObserver:(id)observer forProperty:(NSKeyValueProperty *)property options:(int)options context:(void *)context &#123; if(options &amp; NSKeyValueObservingOptionInitial) &#123; // NSKeyValueObservingOptionInitial: ËßÇÂØüÊúÄÂàùÁöÑÂÄºÔºàÂú®Ê≥®ÂÜåËßÇÂØüÊúçÂä°Êó∂‰ºöË∞ÉÁî®‰∏ÄÊ¨°Ëß¶ÂèëÊñπÊ≥ïÔºâ NSString *keyPath = [property keyPath]; _NSKeyValueObserverRegistrationLockOwner = NULL; // Ëß£ÈîÅ pthread_mutex_unlock(&amp;_NSKeyValueObserverRegistrationLock); id newValue = nil; if (options &amp; NSKeyValueObservingOptionNew) &#123; // newValueÂ∞±ÊòØÂΩìÂâçÁöÑÂÄº newValue = [self valueForKeyPath:keyPath]; if (!newValue) &#123; newValue = [NSNull null]; // ‰ΩøÁî®NSNullÂØπË±° &#125; &#125; NSKeyValueChangeDictionary *changeDictionary = nil; // ÂàõÂª∫NSKeyValueChangeDetailsÁªìÊûÑ‰Ωì /* typedef struct &#123; NSKeyValueChange kind; id oldValue; id newValue; NSIndexSet *indexes; id extraData; &#125; NSKeyValueChangeDetails; */ NSKeyValueChangeDetails changeDetails = &#123;0&#125;; changeDetails.kind = NSKeyValueChangeSetting; changeDetails.oldValue = nil; changeDetails.newValue = newValue; changeDetails.indexes = nil; changeDetails.extraData = nil; // ÂáΩÊï∞1: ÈÄöÁü•ËßÇÂØüËÄÖ, ‰º†ÈÄíÁªìÊûÑ‰ΩìchangeDetails NSKeyValueNotifyObserver(observer,keyPath, self, context, nil, NO,changeDetails, &amp;changeDictionary); [changeDictionary release]; // Âä†ÈîÅ pthread_mutex_lock(&amp;_NSKeyValueObserverRegistrationLock); // Ëé∑ÂèñÂΩìÂâçpthread _NSKeyValueObserverRegistrationLockOwner = pthread_self(); &#125; // ÂáΩÊï∞2: Ëé∑ÂèñoldObservationInfo NSKeyValueObservationInfo *oldObservationInfo = _NSKeyValueRetainedObservationInfoForObject(self,property.containerClass); BOOL cacheHit = NO; NSKeyValueObservance *addedObservance = nil; id originalObservable = nil; if((options &gt;&gt; 8) &amp; 0x01) &#123; // _CFGetTSD: Ëé∑ÂèñÁ∫øÁ®ã‰ø°ÊÅØ // Get some thread specific data from a pre-assigned slot. NSKeyValueObservingTSD *TSD = _CFGetTSD(NSKeyValueObservingTSDKey); if (TSD) &#123; originalObservable = TSD-&gt;implicitObservanceAdditionInfo.originalObservable; &#125; &#125; // ÂáΩÊï∞3: Ëé∑ÂèñnewObservationInfo NSKeyValueObservationInfo *newObservationInfo = _NSKeyValueObservationInfoCreateByAdding(oldObservationInfo, observer, property, options, context, originalObservable,&amp;cacheHit,&amp;addedObservance); // ÂáΩÊï∞4: Â∞ÜselfÁöÑobservationInfoËÆæÁΩÆ‰∏∫newObservationInfo _NSKeyValueReplaceObservationInfoForObject(self,property.containerClass,oldObservationInfo,newObservationInfo); // - (void)object:(id)object didAddObservance:(NSKeyValueObservance *)observance recurse:(BOOL)recurse &#123;&#125; // ÂÆûÈôÖ‰∏äËøô‰∏™ÊñπÊ≥ïÂï•‰∫ã‰πüÊ≤°ÂÅö [property object:self didAddObservance:addedObservance recurse:YES]; // Ê†∏ÂøÉÊñπÊ≥ï: Ëé∑Âèñproperty‰∏≠Â∑≤Áªè‰øÆÊîπËøáÁöÑclass Class isaForAutonotifying = [property isaForAutonotifying]; if(isaForAutonotifying) &#123; Class cls = object_getClass(self); if(cls != isaForAutonotifying) &#123; // ÈÄöËøá object_setClass()‰øÆÊîπisaÊåáÈíà, ËÆæÁΩÆËá™Â∑±ÁöÑclass‰∏∫propertyÁöÑisaForAutonotifying object_setClass(self,isaForAutonotifying); &#125; &#125; [newObservationInfo release]; [oldObservationInfo release];&#125; ÂáΩÊï∞1: ËÆæÁΩÆchangeDictionaryÂπ∂Ë∞ÉÁî®NSKVONotify()ÂáΩÊï∞void NSKeyValueNotifyObserver(id observer,NSString * keyPath, id object, void *context, id originalObservable, BOOL isPriorNotification, NSKeyValueChangeDetails changeDetails, NSKeyValueChangeDictionary **changeDictionary) &#123; if(*changeDictionary) &#123; [*changeDictionary setDetailsNoCopy:changeDetails originalObservable:originalObservable]; &#125; else &#123; *changeDictionary = [[NSKeyValueChangeDictionary alloc] initWithDetailsNoCopy:changeDetails originalObservable:originalObservable isPriorNotification:isPriorNotification]; &#125; NSUInteger retainCountBefore = [*changeDictionary retainCount]; NSKVONotify(observer, keyPath, object, *changeDictionary, context); if(retainCountBefore != (NSUInteger)INTMAX_MAX &amp;&amp; retainCountBefore != [*changeDictionary retainCount]) &#123; [*changeDictionary retainObjects]; &#125;&#125; // NSKVONotify()ÂáΩÊï∞Â∞±ÊòØË∞ÉÁî®observeValueForKeyPathÊñπÊ≥ïvoid NSKVONotify(id observer, NSString *keyPath, id object, NSDictionary *changeDictionary, void *context) &#123; NSKeyValueObservingAssertRegistrationLockNotHeld(); [observer observeValueForKeyPath:keyPath ofObject:object change:changeDictionary context:context];&#125; ÂáΩÊï∞2: Ëé∑ÂèñobjectÁöÑobservationInfoÂØπË±°NSKeyValueObservationInfo *_NSKeyValueRetainedObservationInfoForObject(id object, NSKeyValueContainerClass *containerClass) &#123; NSKeyValueObservationInfo *observationInfo = nil; os_lock_lock(&amp;NSKeyValueObservationInfoSpinLock); if (containerClass) &#123; // Ë∞ÉÁî®containerClassÁöÑcachedObservationInfoImplementationÂÆûÁé∞ observationInfo = ((NSKeyValueObservationInfo * (*)(id,SEL))containerClass.cachedObservationInfoImplementation)(object, @selector(observationInfo)); &#125; else &#123; // Áõ¥Êé•Ëé∑ÂèñobjectÁöÑd_observationInfoÂØπË±° observationInfo = (NSKeyValueObservationInfo *)[object d_observationInfo]; &#125; [observationInfo retain]; os_lock_unlock(&amp;NSKeyValueObservationInfoSpinLock); return observationInfo;&#125; ÂáΩÊï∞3: Ëé∑Âèñ‚ÄôÊ∑ªÂä†ËßÇÂØüËÄÖ‚ÄôÊó∂ÊâÄÈúÄË¶ÅÁöÑNSKeyValueObservationInfoÂ¶ÇÊûúbaseObservationInfoÂ≠òÂú®ÔºåÂàô‰∏ÄÈ°øÂ∞ÅË£ÖÊìç‰ΩúÂêéÔºå‰ºöÊääÂ∞ÅË£ÖÂÆåÊØïÁöÑNSKeyValueObservance‚ÄúËøΩÂä†‚ÄùÂà∞baseObservationInfoÁöÑobservancesÊï∞ÁªÑ‰∏≠„ÄÇÂ¶ÇÊûúbaseObservationInfo‰∏çÂ≠òÂú®ÔºåÂàô‰∏ÄÈ°øÂ∞ÅË£ÖÊìç‰ΩúÂêéÔºå‰ºöÊääÂ∞ÅË£ÖÂÆåÊØïÁöÑNSKeyValueObservanceÊîæÂà∞Êñ∞ÂàõÂª∫ÁöÑNSKeyValueObservationInfoÂØπË±°ÁöÑobservancesÊï∞ÁªÑ‰∏≠„ÄÇÊúÄÂêéÔºåcacheHitÂëäËØâË∞ÉÁî®ËÄÖÊòØÂê¶ÊúâÂëΩ‰∏≠ÁºìÂ≠òÔºå*addedObservanceÊåáÂêë‰∫ÜobservanceÂØπË±°„ÄÇ NSKeyValueObservationInfo *_NSKeyValueObservationInfoCreateByAdding(NSKeyValueObservationInfo *baseObservationInfo, id observer, NSKeyValueProperty *property, int options, void *context, id originalObservable, BOOL *cacheHit, NSKeyValueObservance **addedObservance) &#123; NSKeyValueObservationInfo *createdObservationInfo = nil; os_lock_lock(&amp;NSKeyValueObservationInfoCreationSpinLock); // ‰ΩøÁî®Âº±ÂºïÁî®Ë°®NSKeyValueShareableObservationInfosÁºìÂ≠òËßÇÂØüËÄÖÂØπË±° if(!NSKeyValueShareableObservationInfos) &#123; // Ëá™ÂÆö‰πâNSPointerFunctions NSPointerFunctions *pointerFunctions = [[NSPointerFunctions alloc] initWithOptions:NSPointerFunctionsWeakMemory]; // ËÆæÁΩÆhashÂáΩÊï∞ [pointerFunctions setHashFunction:NSKeyValueShareableObservationInfoNSHTHash]; // ËÆæÁΩÆÂà§Á≠âÂáΩÊï∞ [pointerFunctions setIsEqualFunction:NSKeyValueShareableObservationInfoNSHTIsEqual]; // ÂàõÂª∫NSHashTable NSKeyValueShareableObservationInfos = [[NSHashTable alloc] initWithPointerFunctions:pointerFunctions capacity:0]; &#125; if(!NSKeyValueShareableObservationInfoKeyIsa) &#123; NSKeyValueShareableObservationInfoKeyIsa = [NSKeyValueShareableObservationInfoKey class]; &#125; // ÈÄöËøáËøô‰∏™ÂÖ¨ÂÖ±keyÂà∞ÁºìÂ≠òË°®NSKeyValueShareableObservationInfos‰∏≠Êü•Êâæ static NSKeyValueShareableObservationInfoKey * shareableObservationInfoKey; if(!shareableObservationInfoKey) &#123; // Á¨¨‰∏ÄÊ¨°‰ΩøÁî®, ‰∏∫Á©∫Êó∂ÂàõÂª∫ shareableObservationInfoKey = [[NSKeyValueShareableObservationInfoKey alloc] init]; &#125; // ËÆæÁΩÆkeyÁöÑ‰ø°ÊÅØ shareableObservationInfoKey.addingNotRemoving = YES; shareableObservationInfoKey.baseObservationInfo = baseObservationInfo; shareableObservationInfoKey.additionObserver = observer; shareableObservationInfoKey.additionProperty = property; shareableObservationInfoKey.additionOptions = options; shareableObservationInfoKey.additionContext = context; shareableObservationInfoKey.additionOriginalObservable = originalObservable; // Ê†πÊçÆshareableObservationInfoKeyÁöÑÂ∑≤Êúâ‰ø°ÊÅØËøõË°åÊü•Êâæ NSKeyValueObservationInfo * existsObservationInfo = [NSKeyValueShareableObservationInfos member:shareableObservationInfoKey]; // Ê∏ÖÁ©∫shareableObservationInfoKeyÁöÑÂ∫üÂºÉ‰ø°ÊÅØ(‰∏ªË¶ÅÊòØÂáèÂ∞ëÂØπobserverÁöÑÂºïÁî®ËÆ°Êï∞) shareableObservationInfoKey.additionOriginalObservable = nil; shareableObservationInfoKey.additionObserver = nil; shareableObservationInfoKey.baseObservationInfo = nil; if(!existsObservationInfo) &#123; // ÁºìÂ≠ò‰∏≠‰∏çÂ≠òÂú® // (‰∏ÄËà¨ÊòØÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®Êó∂)NSHashTable‰∏∫Á©∫, ÂàõÂª∫ if(!NSKeyValueShareableObservances) &#123; NSKeyValueShareableObservances = [NSHashTable weakObjectsHashTable]; &#125; // ÈÄöËøáËøô‰∏™ÂÖ¨ÂÖ±keyÂà∞ÁºìÂ≠òË°®NSKeyValueShareableObservances‰∏≠Êü•Êâæ static NSKeyValueShareableObservanceKey *shareableObservanceKey; if(!shareableObservanceKey) &#123; // key‰∏çÂ≠òÂú®Êó∂ÂàõÂª∫ shareableObservanceKey = [[NSKeyValueShareableObservanceKey alloc] init]; &#125; // ËÆæÁΩÆkeyÁöÑ‰ø°ÊÅØ shareableObservanceKey.observer = observer; shareableObservanceKey.property = property; shareableObservanceKey.options = options; shareableObservanceKey.context = context; shareableObservanceKey.originalObservable = originalObservable; // Êü•ÊâæObservanceÁºìÂ≠ò NSKeyValueObservance *existsObservance = [NSKeyValueShareableObservances member:shareableObservanceKey]; // Ê∏ÖÁ©∫shareableObservanceKeyÁöÑÂ∫üÂºÉ‰ø°ÊÅØ shareableObservanceKey.originalObservable = nil; shareableObservanceKey.observer = nil; NSKeyValueObservance *observance = nil; if (!existsObservance) &#123; // Ê≤°ÊúâÊâæÂà∞, ÂàôÂàõÂª∫observance observance = [[NSKeyValueObservance alloc] _initWithObserver:observer property:property options:options context:context originalObservable:originalObservable]; if(observance.cachedIsShareable) &#123; // ÂèØ‰ª•ÁºìÂ≠ò, ÊîæÂÖ•NSKeyValueShareableObservances‰∏≠ [NSKeyValueShareableObservances addObject:observance]; &#125; &#125; else &#123; // ÊâæÂà∞‰∫Ü, observanceÂ∞±ÊåáÂêëexistsObservance observance = existsObservance; &#125; if (baseObservationInfo) &#123; // Â§çÂà∂baseObservationInfoÂπ∂ËøΩÂä†observance createdObservationInfo = [baseObservationInfo _copyByAddingObservance:observance]; &#125; else &#123; // ÂàõÂª∫Êñ∞ÁöÑObservationInfo createdObservationInfo = [[NSKeyValueObservationInfo alloc] _initWithObservances:&amp;observance count:1 hashValue:0]; &#125; if (createdObservationInfo.cachedIsShareable)&#123; // ÂÖÅËÆ∏ÁºìÂ≠ò, Ê∑ªÂä†Âà∞NSKeyValueShareableObservationInfos‰∏≠ [NSKeyValueShareableObservationInfos addObject:createdObservationInfo]; &#125; // Ê≤°ÊúâÂëΩ‰∏≠ÁºìÂ≠ò *cacheHit = NO; // ËÆæÁΩÆÊñ∞Ê∑ªÂä†ÁöÑObservance *addedObservance = observance; &#125; else &#123; // ÁºìÂ≠ò‰∏≠Â≠òÂú® // ËÆæÁΩÆÂëΩ‰∏≠ÁºìÂ≠ò *cacheHit = YES; // observanceÂøÖÂÆöÂ∞±ÊòØÂ∑≤Â≠òÂú®ÁöÑinfo.observanceÂàóË°®ÊúÄÂêé‰∏Ä‰∏™, Âõ†‰∏∫Âà§Êñ≠equalÂ∞±ÊòØÊåâÁÖßËøô‰∏™ÂéüÂàôÂéªÂà§Êñ≠ÁöÑ // Âà§Á≠âÂáΩÊï∞: NSKeyValueShareableObservationInfoNSHTIsEqual() *addedObservance = existsObservationInfo.observances.lastObject; // ËÆæÁΩÆcreatedObservationInfo createdObservationInfo = existsObservationInfo; &#125; // Ëß£ÈîÅ os_lock_unlock(&amp;NSKeyValueObservationInfoCreationSpinLock); return createdObservationInfo;&#125; ÂáΩÊï∞4:Â∞ÜobjectÁöÑobservationInfoËÆæÁΩÆ‰∏∫newObservationInfovoid _NSKeyValueReplaceObservationInfoForObject(id object, NSKeyValueContainerClass * containerClass, NSKeyValueObservationInfo *oldObservationInfo, NSKeyValueObservationInfo *newObservationInfo) &#123; os_lock_lock(&amp;NSKeyValueObservationInfoSpinLock); if (newObservationInfo) [newObservationInfo retain]; // ‰∏çÁêÜËß£?????? /* typedef struct &#123; CFMutableArrayRef pendingArray;//0 ObservationInfoWatcher *firstWatcher;//4 ImplicitObservanceAdditionInfo implicitObservanceAdditionInfo; ImplicitObservanceRemovalInfo implicitObservanceRemovalInfo; &#125; NSKeyValueObservingTSD; */ NSKeyValueObservingTSD *TSD = _CFGetTSD(NSKeyValueObservingTSDKey); if(TSD) &#123; ObservationInfoWatcher *next = TSD-&gt;firstWatcher; while(next) &#123; if (next-&gt;object == object) &#123; [next-&gt;observationInfo release]; next-&gt;observationInfo = [newObservationInfo retain]; break; &#125; next = next-&gt;next; &#125; &#125; if(containerClass) &#123; // Ë∞ÉÁî®objectÁöÑd_setObservationInfo:ÊñπÊ≥ï, Âπ∂‰º†ÂèÇÊï∞newObservationInfo containerClass.cacheNSetObservationInfoImplementation(object, @selector(d_setObservationInfo:), newObservationInfo); &#125; else &#123; // Áõ¥Êé•ËÆæÁΩÆÊñ∞ÂÄº [object d_setObservationInfo: newObservationInfo]; &#125; os_lock_unlock(&amp;NSKeyValueObservationInfoSpinLock);&#125; 2.ÁºìÂ≠òÁºìÂ≠òÊü•ÊâæÈÄªËæëÊòØ‰∏ÄËá¥ÁöÑ: Á°ÆÂÆöËøô‰∫õÂØπË±°ÁöÑhashÂíåisEqual:ÊñπÊ≥ïÔºåÈÄöËøáÂàõÂª∫‰∏éÁõÆÊ†áÂØπË±°Âà§Á≠âÂ±ûÊÄß‰∏ÄËá¥ÁöÑkeyÂéªÊü•Êâæ„ÄÇ 2.1.NSKeyValuePropertyÁöÑÁºìÂ≠òif(!NSKeyValueProperties) &#123; // ÂàõÂª∫ÈõÜÂêàNSKeyValueProperties CFSetCallBacks callbacks = &#123;0&#125;; callbacks.version = kCFTypeSetCallBacks.version; callbacks.retain = kCFTypeSetCallBacks.retain; callbacks.release = kCFTypeSetCallBacks.release; callbacks.copyDescription = kCFTypeSetCallBacks.copyDescription; // ËÆæÁΩÆCFSetÈõÜÂêà‰∏≠ÂÖÉÁ¥†Âà§Á≠âÁöÑ‰æùÊçÆ callbacks.equal = (CFSetEqualCallBack)NSKeyValuePropertyIsEqual; // ËÆæÁΩÆCFSetÈõÜÂêà‰∏≠ÂÖÉÁ¥†ÁöÑhashÂÄºËé∑ÂèñÂáΩÊï∞ callbacks.hash = (CFSetHashCallBack)NSKeyValuePropertyHash; NSKeyValueProperties = CFSetCreateMutable(NULL, 0, &amp;callbacks);&#125;// ÊääpropertyÊ∑ªÂä†Âà∞NSKeyValuePropertiesÈõÜÂêà‰∏≠CFSetAddValue(NSKeyValueProperties, property); CFSetÈõÜÂêà‰∏≠ÂÖÉÁ¥†Âà§Á≠âÁöÑ‰æùÊçÆ BOOL NSKeyValuePropertyIsEqual(NSKeyValueProperty *property1, NSKeyValueProperty *property2) &#123; return (property1.containerClass == property2.containerClass) &amp;&amp; (property1.keyPath == property2.keyPath || [property1.keyPath isEqual: property2.keyPath]);&#125; ËøîÂõûNSKeyValuePropertyÁöÑhashÂÄº NSUInteger NSKeyValuePropertyHash(NSKeyValueProperty *property) &#123; return property.keyPath.hash ^ (NSUInteger)(void *)property.containerClass;&#125; ÂÜçÊ¨°ËØÅÊòé‰∫Ü classÂíåkeyPathÂÜ≥ÂÆö‰∫ÜÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™NSKeyValueProperty„ÄÇ 2.2.NSKeyValueObservanceÁöÑÁºìÂ≠òÁºìÂ≠òÊü•Êâæ NSHashTable *NSKeyValueShareableObservances;if(!NSKeyValueShareableObservances) &#123; NSKeyValueShareableObservances = [NSHashTable weakObjectsHashTable];&#125;// observanceÊü•Êâækeystatic DNSKeyValueShareableObservanceKey *shareableObservanceKey;if(!shareableObservanceKey) &#123; shareableObservanceKey = [[DNSKeyValueShareableObservanceKey alloc] init];&#125;shareableObservanceKey.observer = observer;shareableObservanceKey.property = property;shareableObservanceKey.options = options;shareableObservanceKey.context = context;shareableObservanceKey.originalObservable = originalObservable;// Êü•ÊâæÁºìÂ≠òNSKeyValueObservance *existsObservance = [NSKeyValueShareableObservances member:shareableObservanceKey];shareableObservanceKey.originalObservable = nil;shareableObservanceKey.observer = nil; ÈáçÂÜôNSKeyValueObservanceÁöÑhashÂíåisEqual:ÊñπÊ≥ï - (NSUInteger)hash &#123; return _NSKVOPointersHash(5, _observer, _property, (void *)(NSUInteger)(_options), _context, _originalObservable);&#125;- (BOOL)isEqual:(id)object &#123; if (object == self) return YES; if (![object isKindOfClass: self.class]) return NO; NSKeyValueObservance *other = (NSKeyValueObservance *)object; return other.observer == self.observer &amp;&amp; other.options == self.options &amp;&amp; other.context == self.context &amp;&amp; other.originalObservable == self.originalObservable;&#125; 2.3.NSKeyValueObservationInfoÁöÑÁºìÂ≠òÁºìÂ≠òÊü•Êâæ NSHashTable *NSKeyValueShareableObservationInfos;// observationInfoÁºìÂ≠òif(!NSKeyValueShareableObservationInfos) &#123; NSPointerFunctions *pointerFunctions = [[NSPointerFunctions alloc] initWithOptions:NSPointerFunctionsWeakMemory]; [pointerFunctions setHashFunction:NSKeyValueShareableObservationInfoNSHTHash]; [pointerFunctions setIsEqualFunction:NSKeyValueShareableObservationInfoNSHTIsEqual]; NSKeyValueShareableObservationInfos = [[NSHashTable alloc] initWithPointerFunctions:pointerFunctions capacity:0];&#125; 2.4.NSKeyValueObservationInfoÁöÑÂ≠òÂÇ®(observationInfo)ÂΩìÂ∞ÅË£ÖÊàêNSKeyValueObservationInfoÊó∂ÔºåweakÁöÑNSHashTableÂπ∂‰∏çË¥üË¥£Â≠òÂÇ®ÔºåÈÇ£‰πàÔºåË∞ÅË¥üË¥£ÁúüÊ≠£ÁöÑÂ≠òÂÇ®Âë¢? Take or return a pointer that identifies information about all of the observers that are registered with the receiver, the options that were used at registration-time, etc. The default implementation of these methoNS store observation info in a global dictionary keyed by the receivers‚Äô pointers. For improved performance, you can override these methoNS to store the opaque data pointer in an instance variable. Overrides of these methoNS must not attempt to send Objective-C messages to the passed-in observation info, including -retain and -release. Ëøô‰∏™ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØ‰ª•ÂØπË±°ÁöÑÊåáÈíà‰Ωú‰∏∫keyÔºå‰ªé‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÂ≠óÂÖ∏‰∏≠Ëé∑Âèñ‰ø°ÊÅØ„ÄÇ Â¶Ç‰ΩïËé∑ÂèñÂØπË±°ÁöÑÊåáÈíàÔºüËøôÈáåÊúâ‰∏™ÂÆö‰πâÔºöOBSERVATION_INFO_KEYÁöÑÂÆö‰πâÊòØ: #define OBSERVATION_INFO_KEY(object) ((void *)(~(NSUInteger)(object))) CFMutableDictionaryRef NSKeyValueObservationInfoPerObject = NULL;- (void *)observationInfo &#123; return NSKeyValueObservationInfoPerObject ? (void *)CFDictionaryGetValue(NSKeyValueObservationInfoPerObject, OBSERVATION_INFO_KEY(self)) : NULL;&#125;- (void)setObservationInfo:(void *)info &#123; if(!NSKeyValueObservationInfoPerObject) &#123; NSKeyValueObservationInfoPerObject = CFDictionaryCreateMutable(NULL, 0, NULL, NULL); &#125; if (info) &#123; CFDictionarySetValue(NSKeyValueObservationInfoPerObject, OBSERVATION_INFO_KEY(self), info); &#125; else &#123; CFDictionaryRemoveValue(NSKeyValueObservationInfoPerObject, OBSERVATION_INFO_KEY(self)); &#125;&#125; Âç≥Ëøô‰∏™ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØ‰ª•ÂØπË±°ÁöÑÊåáÈíà‰Ωú‰∏∫keyÔºå‰ªé‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÂ≠óÂÖ∏‰∏≠Ëé∑Âèñ‰ø°ÊÅØ„ÄÇÁî±Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÁêÜËß£‰∏∫ÔºåKVOÁöÑ‰ø°ÊÅØÊòØÂ≠òÂÇ®Âú®‰∏Ä‰∏™ÂÖ®Â±ÄÂ≠óÂÖ∏‰∏≠ÔºåËÄå‰∏çÊòØÂ≠òÂÇ®Âú®ÂØπË±°Êú¨Ë∫´„ÄÇ‰∏çËøáÔºå‰∏∫‰∫ÜÊèêÈ´òÊïàÁéáÔºåÊàë‰ª¨ÂèØ‰ª•ÈáçÂÜôobservationInfoÂ±ûÊÄßÁöÑsetÂíågetÊñπÊ≥ïÔºå‰ª•Â∞ÜËøô‰∏™‰∏çÈÄèÊòéÁöÑÊï∞ÊçÆÊåáÈíàÂ≠òÂÇ®Âà∞‰∏Ä‰∏™ÂÆû‰æãÂèòÈáè‰∏≠„ÄÇ‰ΩÜÊòØÔºåÂú®ÈáçÂÜôÊó∂ÔºåÊàë‰ª¨‰∏çÂ∫îËØ•Â∞ùËØïÂéªÂêëËøô‰∫õÊï∞ÊçÆÂèëÈÄÅ‰∏Ä‰∏™Objective-CÊ∂àÊÅØÔºåÂåÖÊã¨retainÂíårelease„ÄÇ 3.Êñ∞Âª∫‰∏éÈáçÂÜôÂú®Ëøô‰∏ÄÊ≠•È™§‰∏≠ÔºåÂä®ÊÄÅÂàõÂª∫‰∫ÜÂéüÊù•classÁöÑÂ≠êÁ±ªÔºåÂΩìÁÑ∂Ôºå‰πüÈáçÂÜôÂíåÊ∑ªÂä†‰∫ÜËÆ∏Â§öÊñπÊ≥ï„ÄÇ 3.1Âä®ÊÄÅÂàõÂª∫Â≠êÁ±ªÁöÑÊ†∏ÂøÉÂÆûÁé∞Âä®ÊÄÅÂàõÂª∫Â≠êÁ±ª‰∏≠ÔºåÈáçÂÜô‰∫Üdealloc„ÄÅclass„ÄÅ_isKVOAÊñπÊ≥ï„ÄÇ NSKeyValueNotifyingInfo *_NSKVONotifyingCreateInfoWithOriginalClass(Class originalClass) &#123; static IMP NSObjectWillChange; static IMP NSObjectDidChange; // ÊûÑÈÄ†Êñ∞ÁöÑÂ≠êÁ±ªÂêç const char *originalClassName = class_getName(originalClass); size_t size = strlen(originalClassName) + 16; char *newClassName = (char *)malloc(size); // #define NOTIFY_CLASSNAME_PREFIX "NSKVONotifying_" strlcpy(newClassName, NOTIFY_CLASSNAME_PREFIX, size); strlcat(newClassName, originalClassName, size); // ÂàõÂª∫Â≠êÁ±ª Class newSubClass = objc_allocateClassPair(originalClass, newClassName, sizeof(NSKeyValueNotifyingInfo)); objc_registerClassPair(newSubClass); free(newClassName); unsigned char *ivars = object_getIndexedIvars(newSubClass); // ÂàõÂª∫NSKeyValueNotifyingInfoÂØπË±°, Â∞ÅË£ÖÂ≠êÁ±ª\ÂéüÂßãÁ±ªÁ≠â‰ø°ÊÅØ NSKeyValueNotifyingInfo *notifyingInfo = (NSKeyValueNotifyingInfo *)ivars; notifyingInfo-&gt;originalClass = originalClass; notifyingInfo-&gt;newSubClass = newSubClass; notifyingInfo-&gt;notifyingKeys = CFSetCreateMutable(NULL, 0, &amp;kCFCopyStringSetCallBacks); notifyingInfo-&gt;selKeyMap = CFDictionaryCreateMutable(NULL, 0, NULL, &amp;kCFTypeDictionaryValueCallBacks); pthread_mutexattr_t mutexattr; pthread_mutexattr_init(&amp;mutexattr); pthread_mutexattr_settype(&amp;mutexattr, PTHREAD_MUTEX_RECURSIVE); pthread_mutex_init(&amp;notifyingInfo-&gt;mutex, &amp;mutexattr); pthread_mutexattr_destroy(&amp;mutexattr); // Ëé∑ÂèñNSObjectÁ±ªÁöÑ willChangeValueForKey Âíå didChangeValueForKeyÂÆûÁé∞ static dispatch_once_t NSObjectIMPLookupOnce; dispatch_once(&amp;NSObjectIMPLookupOnce, ^&#123; NSObjectWillChange = class_getMethodImplementation([NSObject class], @selector(d_willChangeValueForKey:)); NSObjectDidChange = class_getMethodImplementation([NSObject class], @selector(d_didChangeValueForKey:)); &#125;); // Âà§Êñ≠originalClassÁ±ªÊòØÂê¶ÈáçÂÜô‰∫Ü willChangeValueForKey Êàñ didChangeValueForKey // Â∞±ÊòØÊãøNSObjectÁöÑÂÆûÁé∞‰∏éoriginalClassÁöÑÂÆûÁé∞ÂÅöÂØπÊØî(ÂáΩÊï∞ÊåáÈíàIMPÊØîËæÉ) notifyingInfo-&gt;overrideWillOrDidChange = class_getMethodImplementation(notifyingInfo-&gt;originalClass, @selector(d_willChangeValueForKey:)) != NSObjectWillChange || class_getMethodImplementation(notifyingInfo-&gt;originalClass, @selector(d_didChangeValueForKey:)) != NSObjectDidChange; // ÂØπnotifyingInfoÁöÑoriginalClassÊ∑ªÂä† _isKVOAÊñπÊ≥ï NSKVONotifyingSetMethodImplementation(notifyingInfo, ISKVOA_SELECTOR, (IMP)NSKVOIsAutonotifying, NULL); // ÂØπnotifyingInfoÁöÑoriginalClassÊ∑ªÂä† deallocÊñπÊ≥ï NSKVONotifyingSetMethodImplementation(notifyingInfo, @selector(dealloc), (IMP)NSKVODeallocate, NULL); // ÂØπnotifyingInfoÁöÑoriginalClassÊ∑ªÂä† classÊñπÊ≥ï NSKVONotifyingSetMethodImplementation(notifyingInfo, @selector(class), (IMP)NSKVOClass, NULL); return notifyingInfo;&#125; Ê∑ªÂä†_isKVOAÊñπÊ≥ïBOOL NSKVOIsAutonotifying() &#123; return YES;&#125; ÈáçÂÜôclassÊñπÊ≥ïClass NSKVOClass(id object, SEL selector) &#123; // Êñ∞ÁöÑclass: NSKVONotifying_XXXX Class currentClass = object_getClass(object); // ÂéüÂÖàÁöÑclass: XXXX Class originalClass = _NSKVONotifyingOriginalClassForIsa(currentClass); if (currentClass == originalClass) &#123; // Áõ∏Âêå, ËøîÂõûobjectÁöÑcurrentClass Method m = class_getInstanceMethod(currentClass, selector); return ((Class (*)(id,Method))method_invoke)(object, m); &#125; else &#123; // ‰∏çÂêå, ËøîÂõûoriginalClass return [originalClass class]; &#125;&#125; ÈáçÂÜôdeallocÊñπÊ≥ïËé∑ÂèñobjectÂØπÂ∫îÁöÑobservationInfo(ÂØπË±°)Âπ∂ÊääÂÆÉÊîæÂà∞ÁªìÊûÑ‰Ωì‰∏≠ÔºåÂú®Ë∞ÉÁî®ÂÆåobjectÂéüÂÖàÁöÑdeallocÊñπÊ≥ï‰πãÂêéÂà§Êñ≠observationInfoÊòØÂê¶ËøòÂ≠òÂú®ÔºåËã•Â≠òÂú®ËØ¥ÊòéobserverÊ≤°ÊúâÂú®dealloc‰πãÂâçË¢´ÁßªÈô§ÊéâÔºåËøõËÄåÊäõÂá∫ÂºÇÂ∏∏„ÄÇ void NSKVODeallocate(id object, SEL selector) &#123; // Ëé∑ÂèñobjectÂØπÂ∫îÁöÑobservationInfo NSKeyValueObservationInfo *observationInfo = _NSKeyValueRetainedObservationInfoForObject(object, nil); ObservationInfoWatcher watcher = &#123;object, observationInfo, NULL&#125;; _NSKeyValueAddObservationInfoWatcher(&amp;watcher); // Ëé∑ÂèñnotifyInfo NSKeyValueNotifyingInfo *notifyInfo = (NSKeyValueNotifyingInfo *)object_getIndexedIvars(object_getClass(object)); // Ë∞ÉÁî®objectÂéüÊù•ÁöÑdeallocÂÆûÁé∞ Method originDellocMethod = class_getInstanceMethod(notifyInfo-&gt;originalClass, selector); ((id (*)(id,Method))method_invoke)(object, originDellocMethod); @try &#123; if(watcher.observationInfo) &#123; // observationInfo‰∏çÂ≠òÂú®ÊâçÂØπ, Â¶ÇÊûúËøòÂ≠òÂú®, ËØ¥ÊòéÊ≤°ÊúâÊ≠£Á°ÆÂú∞ÁßªÈô§observer BOOL keyExistsAndHasValidFormat = false; BOOL cleansUpBeforeThrowing = false; cleansUpBeforeThrowing = (BOOL)CFPreferencesGetAppBooleanValue(CFSTR("NSKVODeallocateCleansUpBeforeThrowing"), kCFPreferencesCurrentApplication, (Boolean *)&amp;keyExistsAndHasValidFormat); // keyÂ≠òÂú®‰∏îkeyÂØπÂ∫îÁöÑvalue‰∏∫YES cleansUpBeforeThrowing = cleansUpBeforeThrowing &amp;&amp; keyExistsAndHasValidFormat; // dyld_get_program_sdk_versionËøîÂõûÁ≥ªÁªüÁâàÊú¨ if (dyld_get_program_sdk_version() &gt; 0x7FFFF || cleansUpBeforeThrowing) &#123; if (cleansUpBeforeThrowing) &#123; _NSKeyValueRemoveObservationInfoForObject(object, watcher.observationInfo); &#125; [NSException raise:NSInternalInconsistencyException format:@"An instance %p of class %@ was deallocated while key value observers were still registered with it. Current observation info: %@", object, notifyInfo-&gt;originalClass, watcher.observationInfo]; &#125; else &#123; NSKVODeallocateBreak(object); &#125; &#125; &#125; @catch (NSException *exception) &#123; [exception raise]; &#125; @finally &#123; // ÁßªÈô§watcher _NSKeyValueRemoveObservationInfoWatcher(&amp;watcher); [watcher.observationInfo release]; &#125;&#125; 4.ÂõûË∞ÉÈÄöÁü•‰∏äÊñáÂàÜÊûêÔºåNSKeyValueNotifyObserver()Â∞±ÊòØÂõûË∞ÉÁöÑÂáΩÊï∞ÔºåÈÄöËøáÂÆÉË∞ÉÁî®observeValueForKeyPath:ofObject:change:context:ÊñπÊ≥ï„ÄÇËøôÈáåËøòÂâ©‰∏ãÊúÄÂêé‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂõûË∞ÉÊòØÊÄé‰πàÂ§ÑÁêÜÁöÑ? Âú®NSKVONotifyingEnableForInfoAndKey()ÂáΩÊï∞‰∏≠ÈáçÂÜôsetterÊñπÊ≥ïÔºå‰πãÂêéÂú®NSSetPrimitiveValueAndNotify()ÂáΩÊï∞‰∏≠ÂÖàË∞ÉÁî®willChangeValueForKeyÔºåÂÜçË∞ÉÁî®ÂéüÂÖàÁöÑsetterÊñπÊ≥ïÔºåÂÜçË∞ÉÁî®didChangeValueForKey„ÄÇ static inline void NSSetPrimitiveValueAndNotify(id object,SEL selector, void (^setValueWithImplementation)(IMP imp)) &#123; NSKeyValueNotifyingInfo *info = object_getIndexedIvars(object_getClass(object)); pthread_mutex_lock(&amp;info-&gt;mutex); NSString *key = CFDictionaryGetValue(info-&gt;selKeyMap, selector); key = [key copyWithZone:nil]; pthread_mutex_unlock(&amp;info-&gt;mutex); if (info-&gt;overrideWillOrDidChange) &#123; [object willChangeValueForKey:key]; IMP imp = class_getMethodImplementation(info-&gt;originalClass, selector); setValueWithImplementation(imp); [object didChangeValueForKey:key]; &#125; else &#123; [object changeValueForKey:key key:nil key:nil usingBlock:^&#123; IMP imp = class_getMethodImplementation(info-&gt;originalClass, selector); setValueWithImplementation(imp); &#125;]; &#125; [key release];&#125; ÂΩìÁÑ∂ÔºåËøôÈáåÁöÑdidChangeValueForKey‰πüË¢´ÈáçÂÜôÂÆûÁé∞‰∫ÜÔºåÂÆÉ‰ºöË∞ÉÁî®ÁúüÊ≠£ÁöÑÂõûË∞ÉobserveValueForKeyPath:ofObject:change:context:ÊñπÊ≥ï„ÄÇ ‰∫î„ÄÅÁßªÈô§ËßÇÂØüËÄÖÊâæÂà∞NSKeyValueObservanceÁßªÈô§Âç≥ÂèØ„ÄÇ NSKeyValueObservationInfo *_NSKeyValueObservationInfoCreateByRemoving(NSKeyValueObservationInfo *baseObservationInfo, id observer, NSKeyValueProperty *property, void *context, BOOL shouldCompareContext, id originalObservable, BOOL *cacheHit, NSKeyValueObservance **removalObservance) &#123; NSKeyValueObservationInfo *createdObservationInfo = nil; // ÂΩìÂâçÂ∑≤ÁªèÂ≠òÂú®ÁöÑobservanceÁöÑÊï∞Èáè NSUInteger observanceCount = CFArrayGetCount((CFArrayRef)baseObservationInfo.observances); NSKeyValueObservance *observancesBuff[observanceCount]; CFArrayGetValues((CFArrayRef)baseObservationInfo.observances, CFRangeMake(0, observanceCount), (const void **)observancesBuff); NSUInteger removalObservanceIndex = NSNotFound; for (NSInteger i = observanceCount - 1; i &gt;= 0; --i) &#123; // ÈÄê‰∏™ÈÅçÂéÜobservancesBuffÊï∞ÁªÑ‰∏≠ÁöÑÂÖÉÁ¥† NSKeyValueObservance *observance = observancesBuff[i]; // propertyÂíåobserver‰∏ÄËá¥ if (observance.property == property &amp;&amp; observance.observer == observer) &#123; // ‰∏çÈúÄË¶ÅÊØîËæÉcontextÊàñËÄÖcontext‰∏ÄËá¥ if (!shouldCompareContext || observance.context == context) &#123; // originalObservable‰∏ÄËá¥ if (!originalObservable || observance.originalObservable == originalObservable) &#123; // ÈúÄË¶ÅÁßªÈô§ÁöÑobservance *removalObservance = observance; // Á°ÆÂÆö‰∫ÜÂ∞ÜË¶ÅÁßªÈô§ÁöÑobservanceÁöÑÁ¥¢Âºï removalObservanceIndex = i; break; &#125; &#125; &#125; &#125; // Â∑≤ÁªèÊâæÂà∞ÈúÄË¶ÅÁßªÈô§ÁöÑobservance if (*removalObservance) &#123; // ÂéüÂÖàobservanceÁöÑÊï∞ÈáèÂ§ß‰∫é1‰∏™ if (observanceCount &gt; 1) &#123; os_lock_lock(&amp;NSKeyValueObservationInfoCreationSpinLock); // NSKeyValueShareableObservationInfosÁºìÂ≠ò‰∏çÂ≠òÂú®, ÂàõÂª∫ if (!NSKeyValueShareableObservationInfos) &#123; NSPointerFunctions *functions = [[NSPointerFunctions alloc] initWithOptions:NSPointerFunctionsWeakMemory]; [functions setHashFunction:NSKeyValueShareableObservationInfoNSHTHash]; [functions setIsEqualFunction:NSKeyValueShareableObservationInfoNSHTIsEqual]; NSKeyValueShareableObservationInfos = [[NSHashTable alloc] initWithPointerFunctions:functions capacity:0]; [functions release]; &#125; if (!NSKeyValueShareableObservationInfoKeyIsa) &#123; // Â∞±ÊòØNSKeyValueShareableObservationInfoKey.class NSKeyValueShareableObservationInfoKeyIsa = NSKeyValueShareableObservationInfoKey.self; &#125; static NSKeyValueShareableObservationInfoKey * shareableObservationInfoKey = nil; // ÊûÑÂª∫Êü•ÊâæÁºìÂ≠òÁöÑKey if (!shareableObservationInfoKey) &#123; shareableObservationInfoKey = [[NSKeyValueShareableObservationInfoKey alloc] init]; &#125; shareableObservationInfoKey.addingNotRemoving = NO; shareableObservationInfoKey.baseObservationInfo = baseObservationInfo; shareableObservationInfoKey.removalObservance = *removalObservance; shareableObservationInfoKey.removalObservanceIndex = removalObservanceIndex; shareableObservationInfoKey.cachedHash = NSKeyValueShareableObservationInfoNSHTHash(shareableObservationInfoKey, NULL); // Â∞ùËØïÂú®ÁºìÂ≠ò‰∏≠Êü•ÊâæNSKeyValueObservationInfo NSKeyValueObservationInfo *existsObservationInfo = [NSKeyValueShareableObservationInfos member:shareableObservationInfoKey]; // ÈáçÁΩÆkeyÁöÑÊï∞ÊçÆ shareableObservationInfoKey.removalObservance = nil; shareableObservationInfoKey.baseObservationInfo = nil; NSUInteger cachedHash = shareableObservationInfoKey.cachedHash; shareableObservationInfoKey.cachedHash = 0; if (!existsObservationInfo) &#123; // Âú®ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞, ÁßªÈô§removalObservanceIndexÂØπÂ∫îÁöÑÂÖÉÁ¥† memmove(observancesBuff + removalObservanceIndex, observancesBuff + removalObservanceIndex + 1, (observanceCount - (removalObservanceIndex + 1)) * sizeof(NSKeyValueObservance *)); // ÈáçÊñ∞ÂàõÂª∫ObservationInfo, Êï∞Èáè‰∏∫observanceCount - 1 createdObservationInfo = [[NSKeyValueObservationInfo alloc] _initWithObservances:observancesBuff count:observanceCount - 1 hashValue:cachedHash]; if (createdObservationInfo.cachedIsShareable) &#123; // ÁºìÂ≠òObservationInfo [NSKeyValueShareableObservationInfos addObject:createdObservationInfo]; &#125; // Ê≤°ÊúâÂëΩ‰∏≠ÁºìÂ≠ò *cacheHit = NO; &#125; else &#123; // ÂëΩ‰∏≠ÁºìÂ≠ò *cacheHit = YES; // Áõ¥Êé•ËµãÂÄºexistsObservationInfo createdObservationInfo = [existsObservationInfo retain]; &#125; os_lock_unlock(&amp;NSKeyValueObservationInfoCreationSpinLock); return createdObservationInfo; &#125; else &#123; // ÂéüÂÖàÂè™Êúâ‰∏Ä‰∏™observance, ÂëΩ‰∏≠ÁºìÂ≠ò *cacheHit = YES; &#125; &#125; // Ê≤°ÊúâÊâæÂà∞ÈúÄË¶ÅÁßªÈô§ÁöÑobservance, ËøîÂõûnil return nil;&#125; ÂÖ≠„ÄÅÂ∞èÁªìËøôÈáåÂ≠¶Âà∞‰∏Ä‰∏™ÊäÄÂ∑ßÔºöÂ¶Ç‰ΩïÁ°ÆËÆ§NSUserDefaults‰∏≠Êüê‰∏™keyÊòØÂê¶Â≠òÂú®? ÊØîÂ¶Ç BOOL result = [NSUserDefaults.standardUserDefaults boolForKey:@"key"]; ÂΩìresult‰∏∫NOÊó∂ÔºåÊÄé‰πàÂà§Êñ≠ÊòØÂ≠òÂÇ®ÈîÆ@&quot;key&quot;ÂØπÂ∫îÁöÑvalueÊòØNOÔºåËøòÊòØËØ¥ÂéãÊ†πÂ∞±Ê≤°ÊúâÂ≠òËøáËøô‰∏™keyÂë¢?ÂèØ‰ª•‰ΩøÁî®CFPreferencesGetAppBooleanValue()ÂáΩÊï∞„ÄÇKVO‰∏≠ÊúâËøô‰πà‰∏ÄÊÆµ‰ª£Á†Å: BOOL keyExistsAndHasValidFormat = false; // keyÊòØÂê¶Â≠òÂú®BOOL cleansUpBeforeThrowing = false; // Â≠òÂÇ®ÁöÑÂÄº‰∏∫YESÊàñËÄÖNOcleansUpBeforeThrowing = (BOOL)CFPreferencesGetAppBooleanValue(CFSTR("key"), kCFPreferencesCurrentApplication, (Boolean *)&amp;keyExistsAndHasValidFormat);// ËÉΩÂà§Êñ≠Âá∫keyÂ≠òÂú®cleansUpBeforeThrowing = cleansUpBeforeThrowing &amp;&amp; keyExistsAndHasValidFormat; ‰∏É„ÄÅÊâãÂä®ÂÆûÁé∞KVOÊúâÂæàÂ§öÂêåÂ≠¶Â∞ùËØïËá™Â∑±ÂÆûÁé∞‰∫ÜKVOÔºåÊúâÊåâÁÖßÂéüÁîüÊé•Âè£ÁöÑÔºå‰πüÊúâËá™ÊàëÂèëÊå•Áõ¥Êé•‰º†ÈÄíblockÁöÑ„ÄÇÁî±‰∫é‰πãÂâçÊàëÂ∑≤ÁªèËØªËøá‰∏Ä‰∫õÂºÄÊ∫êÁöÑ‰ª£Á†ÅÔºåËßÅ„Ää„ÄåKVOController„ÄçÁöÑÂ∞ÅË£Ö„ÄãÔºå‰ΩúËÄÖÂ∞±ÊòØ‰ΩøÁî®‰∫ÜblockÂæàÂ•ΩÂú∞Â∞ÅË£Ö‰∫ÜKVOÁöÑÂõûË∞É„ÄÇÊâÄ‰ª•ÔºåËøôÈáåËøòÊòØËØïÁùÄÊåâÁÖßÂéüÁîüÊé•Âè£ÂÆûÁé∞‰∏Ä‰∏ã„ÄÇ Áî±‰∫éÂØπÊ∫êÁ†ÅÁêÜËß£Âú∞‰∏çÊòØÂçÅÂàÜÈÄèÂΩªÔºåÂÜçÂä†‰∏äËÉΩÂäõÊúâÈôêÔºåÂú®Â∞ùËØïÂÆûÁé∞ËøáÁ®ã‰∏≠ÈÅáÂà∞‰∏çÂ∞ëÈóÆÈ¢òÔºåÂπ∏Â•ΩÈÉΩËß£ÂÜ≥‰∫Ü„ÄÇÊØîÂ¶ÇÔºö Â¶Ç‰ΩïÊõ¥Â•ΩÂú∞ÈáçÂÜôhashÊñπÊ≥ïÔºü ‰∏Ä‰∏™ÂåÖÂê´n‰∏™ÂÆåÂÖ®Áõ∏ÂêåÂÖÉÁ¥†ÁöÑÊï∞ÁªÑÔºåÂ¶ÇÊûúÂÅöÂà∞Âè™ÁßªÈô§‰∏Ä‰∏™ÂÖÉÁ¥†Ôºü ÂΩìÁÑ∂Ôºå‰ª£Á†ÅËÇØÂÆöÊúâ‰∏çÂ∞ëÈóÆÈ¢òÁöÑÔºåËÄå‰∏î‰ªÖ‰ªÖÂÆûÁé∞‰∏ÄÁÇπÊ†∏ÂøÉÂäüËÉΩÔºåÂßë‰∏îÂΩìÂÅöÁé©ÂÖ∑ÁúãÁúãÂêß„ÄÇ 1.Êé•Âè£@interface NSObject(YAKVO)@property void *ya_observationInfo;- (void)ya_willChangeValueForKey:(NSString *)key;- (void)ya_didChangeValueForKey:(NSString *)key;- (void)ya_addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(void *)context;- (void)ya_removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath context:(void *)context;- (void)ya_observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context;@end 2.ÂÆûÁé∞#define ClassPrefixCStr "YAKVONotifying_" // Êñ∞Á±ªÁöÑÂâçÁºÄ#define ClassPrefix @ ClassPrefixCStr#define OBSERVATION_INFO_KEY(object) ((void *)(~(NSUInteger)(object)))static NSMutableDictionary *YAKeyValueChangeDictionary = nil;/// ‰∏Ä‰∫õÁßÅÊúâÊñπÊ≥ïÂíåÂ±ûÊÄß@interface NSObject(YAKVOPrivate)@end@implementation NSObject(YAKVOPrivate)- (BOOL)ya_isKVOClass &#123; return NO;&#125;- (void)ya_changeValueForKey:(NSString *)key usingBlock:(void (^)(void))block &#123; [self ya_willChangeValueForKey:key]; if (block) block(); [self ya_didChangeValueForKey:key];&#125;@end/// ÂåÖË£ÖkeyPathÂíåoriginalClass@interface YAKeyValueProperty : NSObject@property (nonatomic, assign) Class isaForAutonotifying;@property (nonatomic, copy) NSString *keyPath;@property (nonatomic, assign) Class originalClass;- (instancetype)initWithOriginalClass:(Class)originalClass keyPath:(NSString *)keyPath;@end@implementation YAKeyValueProperty- (instancetype)initWithOriginalClass:(Class)originalClass keyPath:(NSString *)keyPath &#123; if (self = [super init]) &#123; _originalClass = originalClass; _keyPath = keyPath; &#125; return self;&#125;- (Class)isaForAutonotifying &#123; // ÊûÑÈÄ†Êñ∞ÁöÑÂ≠êÁ±ªÂêç const char *originalClassName = class_getName(_originalClass); size_t size = strlen(originalClassName) + 16; char *newClassName = (char *)malloc(size); strlcpy(newClassName, ClassPrefixCStr, size); strlcat(newClassName, originalClassName, size); // ÂàõÂª∫Â≠êÁ±ª Class newSubClass = objc_allocateClassPair(_originalClass, newClassName, 0); objc_registerClassPair(newSubClass); free(newClassName); // SetterÊñπÊ≥ïÊõøÊç¢ NSString *uppercase= [[_keyPath substringToIndex:1] uppercaseString]; NSString *last = [_keyPath substringFromIndex:1]; NSString *setter = [NSString stringWithFormat:@"set%@%@:", uppercase, last]; SEL sel = NSSelectorFromString(setter); Method method = class_getInstanceMethod(newSubClass, sel); if (method) &#123; const char *typeEncoding = method_getTypeEncoding(method); class_replaceMethod(newSubClass, sel, (IMP)YASetValueAndNotifyForKey, typeEncoding); &#125; else &#123; [[NSException exceptionWithName:@"Áº∫Â∞ëÂèÇÊï∞" reason:@"Ê≤°ÊúâÂÆûÁé∞SetterÊñπÊ≥ï" userInfo:nil] raise]; &#125; // classÊñπÊ≥ïÊõøÊç¢„ÄÅya_isKVOClassÊñπÊ≥ïÊõøÊç¢ YAKVONotifyingSetMethodImplementation(newSubClass, @selector(ya_isKVOClass), (IMP)YAKVOIsAutonotifying); YAKVONotifyingSetMethodImplementation(newSubClass, @selector(class), (IMP)YAKVOClass); return newSubClass;&#125;// ÂØπÂ∫îoriginalClassÁöÑya_isKVOClassÊñπÊ≥ïBOOL YAKVOIsAutonotifying(id object, SEL sel) &#123; return YES;&#125;// ÂØπÂ∫îoriginalClassÁöÑclassÊñπÊ≥ïClass YAKVOClass(id object, SEL sel) &#123; // Êñ∞ÁöÑclass: NSKVONotifying_XXXX Class currentClass = object_getClass(object); if ([object ya_isKVOClass]) &#123; NSString *clsStr = [NSStringFromClass(currentClass) stringByReplacingOccurrencesOfString:ClassPrefix withString:@""]; return NSClassFromString(clsStr); &#125; return currentClass;&#125;// ÂØπÂ∫îoriginalClassÁöÑsetterÊñπÊ≥ïvoid YASetValueAndNotifyForKey(id obj, SEL sel, id value, IMP imp) &#123; NSString *key = [[NSStringFromSelector(sel) substringFromIndex:3] lowercaseString]; key = [key substringToIndex:key.length - 1]; [obj ya_changeValueForKey:key usingBlock:^&#123; Class cls = [obj class]; // Ë∞ÉÁî®Áà∂Á±ªÁöÑsetterÊñπÊ≥ï IMP superImp = class_getMethodImplementation(cls, sel); ((void (*)(id ,SEL , id))superImp)(obj, sel, value); &#125;];&#125;// ÂØπÊüê‰∏™classÊ∑ªÂä†ÂÆû‰æãÊñπÊ≥ïvoid YAKVONotifyingSetMethodImplementation(Class cls, SEL sel, IMP imp) &#123; Method originMethod = class_getInstanceMethod(cls, sel); const char *encoding = NULL; if (originMethod) &#123; encoding = method_getTypeEncoding(originMethod); class_addMethod(cls, sel, imp, encoding); &#125;&#125;@end/// ÂåÖË£Öproperty„ÄÅobserver„ÄÅcontext„ÄÅoptions@interface YAKeyValueObservance : NSObject@property (nonatomic, weak) YAKeyValueProperty *property;@property (nonatomic, weak) id observer;@property (nonatomic, assign) void *context;@property (nonatomic, assign) int options;- (instancetype)initWithObserver:(id)observer property:(YAKeyValueProperty *)property options:(int)options context:(void *)context;@end@implementation YAKeyValueObservance- (instancetype)initWithObserver:(id)observer property:(YAKeyValueProperty *)property options:(int)options context:(void *)context &#123; if (self = [super init]) &#123; _observer = observer; _property = property; _options = options; _context = context; &#125; return self;&#125;- (NSUInteger)hash &#123; NSUInteger observerContextHash = [[NSString stringWithFormat:@"%p-%p", _observer, _context] hash]; return observerContextHash ^ _property.hash ^ _options;&#125;- (BOOL)isEqual:(id)object &#123; if (object == self) return YES; if (![object isKindOfClass:object_getClass(self)]) return NO; YAKeyValueObservance *other = (YAKeyValueObservance *)object; return other.observer == self.observer &amp;&amp; other.options == self.options &amp;&amp; other.context == self.context;&#125;@end/// ÂåÖË£ÖYAKeyValueObservanceÊï∞ÁªÑ@interface YAKeyValueObservationInfo : NSObject@property (nonatomic, strong) NSArray &lt;YAKeyValueObservance *&gt; *observances;- (instancetype)initWithObservances:(NSArray &lt;YAKeyValueObservance *&gt; *)observances count:(NSUInteger)count;@end@implementation YAKeyValueObservationInfo- (instancetype)initWithObservances:(NSArray&lt;YAKeyValueObservance *&gt; *)observances count:(NSUInteger)count &#123; if (self = [super init]) &#123; _observances = [[NSArray alloc] initWithArray:observances]; &#125; return self;&#125;@end/// ÈÖçÁΩÆYAKeyValueObservationInfoKeyÔºåÂéªÊü•ËØ¢ÂåπÈÖçÁöÑYAKeyValueObservationInfo@interface YAKeyValueObservationInfoKey : NSObject@property (nonatomic, strong) YAKeyValueObservationInfo *baseObservationInfo;@property (nonatomic, strong) NSObject *additionObserver;@property (nonatomic, strong) YAKeyValueProperty *additionProperty;@property (nonatomic, assign) NSUInteger additionOptions;@property (nonatomic, assign) void* additionContext;@end@implementation YAKeyValueObservationInfoKey@end#pragma mark - Private methodsBOOL YAKeyValuePropertyIsEqual(YAKeyValueProperty *property1, YAKeyValueProperty *property2) &#123; return (property1.originalClass == property2.originalClass) &amp;&amp; (property1.keyPath == property2.keyPath || [property1.keyPath isEqual: property2.keyPath]);&#125;NSUInteger YAKeyValuePropertyHash(YAKeyValueProperty *property) &#123; return property.keyPath.hash ^ (NSUInteger)(__bridge void *)property.originalClass;&#125;// Ëé∑ÂèñYAKeyValuePropertystatic inline YAKeyValueProperty *getKeyValueProperty(Class cls, NSString *keyPath) &#123; // ÁºìÂ≠òÈõÜÂêà static CFMutableSetRef YAKeyValueProperties; if(!YAKeyValueProperties) &#123; // ÂàõÂª∫YAKeyValueProperties CFSetCallBacks callbacks = &#123;0&#125;; callbacks.version = kCFTypeSetCallBacks.version; callbacks.retain = kCFTypeSetCallBacks.retain; callbacks.release = kCFTypeSetCallBacks.release; callbacks.copyDescription = kCFTypeSetCallBacks.copyDescription; callbacks.equal = (CFSetEqualCallBack)YAKeyValuePropertyIsEqual; callbacks.hash = (CFSetHashCallBack)YAKeyValuePropertyHash; YAKeyValueProperties = CFSetCreateMutable(NULL, 0, &amp;callbacks); &#125; static YAKeyValueProperty *finder; if (!finder) finder = [YAKeyValueProperty new]; finder.originalClass = cls; finder.keyPath = keyPath; YAKeyValueProperty *property = CFSetGetValue(YAKeyValueProperties, (__bridge const void *)(finder)); if (!property) &#123; // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞, ÂàõÂª∫ property = [[YAKeyValueProperty alloc] initWithOriginalClass:cls keyPath:keyPath]; // Ê∑ªÂä†Âà∞ÁºìÂ≠ò‰∏≠ CFSetAddValue(YAKeyValueProperties, (__bridge const void *)(property)); &#125; return property;&#125;// Ëé∑ÂèñYAKeyValueObservancestatic inline YAKeyValueObservance *getKeyValueObservance(YAKeyValueProperty *property, id observer, void *context, int options) &#123; static NSHashTable *YAKeyValueShareableObservances; if (!YAKeyValueShareableObservances) &#123; YAKeyValueShareableObservances = [NSHashTable weakObjectsHashTable]; &#125; static YAKeyValueObservance *finder; if (!finder) finder = [YAKeyValueObservance new]; finder.property = property; finder.context = context; finder.observer = observer; finder.options = options; YAKeyValueObservance *observance = [YAKeyValueShareableObservances member:finder]; if (!observance) &#123; // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞, ÂàõÂª∫ observance = [[YAKeyValueObservance alloc] initWithObserver:observer property:property options:options context:context]; // Ê∑ªÂä†Âà∞ÁºìÂ≠ò‰∏≠ [YAKeyValueShareableObservances addObject:observance]; &#125; return observance;&#125;NSUInteger YAKeyValueObservationInfoNSHTHash(const void *item, NSUInteger (*size)(const void *item)) &#123; if (object_getClass((__bridge id)item) == YAKeyValueObservationInfoKey.class) &#123; YAKeyValueObservationInfoKey *key = (__bridge YAKeyValueObservationInfoKey *)item; return key.baseObservationInfo.observances.firstObject.hash; &#125; else &#123; YAKeyValueObservationInfo *info = (__bridge YAKeyValueObservationInfo *)item; return info.observances.firstObject.hash; &#125;&#125;BOOL YAKeyValueObservationInfoNSHTIsEqual(const void *item1, const void *item2, NSUInteger (* size)(const void * item)) &#123; // ËøôÈáå‰ªÖ‰ªÖÂÜô‰∫ÜYAKeyValueObservationInfoKey‰∏éYAKeyValueObservationInfoÁöÑÊØîËæÉ if (object_getClass((__bridge id)item1) == YAKeyValueObservationInfoKey.class || object_getClass((__bridge id)item2) == YAKeyValueObservationInfoKey.class) &#123; YAKeyValueObservationInfo *info = nil; YAKeyValueObservationInfoKey *key = nil; // Á°ÆÂÆöÂì™‰∏Ä‰∏™ÊòØinfo, Âì™‰∏Ä‰∏™ÊòØkey if (object_getClass((__bridge id)item1) == YAKeyValueObservationInfoKey.class) &#123; info = (__bridge YAKeyValueObservationInfo *)item2; key = (__bridge YAKeyValueObservationInfoKey *)item1; &#125; else &#123; info = (__bridge YAKeyValueObservationInfo *)item1; key = (__bridge YAKeyValueObservationInfoKey *)item2; &#125; NSArray &lt;YAKeyValueObservance *&gt; *observancesInKey = key.baseObservationInfo.observances; NSArray &lt;YAKeyValueObservance *&gt; *observancesInInfo = info.observances; // key‰∏≠observanceÁöÑÊï∞Èáè NSUInteger countInkey = observancesInKey.count; // info‰∏≠observanceÁöÑÊï∞Èáè NSUInteger countInInfo = observancesInInfo.count; if (countInkey != countInInfo) return NO; for (NSUInteger i = 0; i &lt; countInkey; i++) &#123; // ‰øùËØÅÊØè‰∏™observanceÂÆåÂÖ®ÂåπÈÖç if (observancesInKey[i] != observancesInInfo[i]) &#123; return NO; &#125; &#125; return YES; &#125; return NO;&#125;#pragma mark - Public methods@implementation NSObject(YAKVO)CFMutableDictionaryRef YAKeyValueObservationInfoPerObject = NULL;- (void *)ya_observationInfo &#123; return YAKeyValueObservationInfoPerObject ? (void *)CFDictionaryGetValue(YAKeyValueObservationInfoPerObject, OBSERVATION_INFO_KEY(self)) : NULL;&#125;- (void)setYa_observationInfo:(void *)info &#123; if (!YAKeyValueObservationInfoPerObject) &#123; CFDictionaryValueCallBacks callbacks = &#123;0&#125;; callbacks.version = kCFTypeDictionaryKeyCallBacks.version; callbacks.retain = kCFTypeDictionaryKeyCallBacks.retain; callbacks.release = kCFTypeDictionaryKeyCallBacks.release; callbacks.copyDescription = kCFTypeDictionaryKeyCallBacks.copyDescription; YAKeyValueObservationInfoPerObject = CFDictionaryCreateMutable(NULL, 0, NULL, &amp;callbacks); &#125; if (info) &#123; CFDictionarySetValue(YAKeyValueObservationInfoPerObject, OBSERVATION_INFO_KEY(self), info); &#125; else &#123; CFDictionaryRemoveValue(YAKeyValueObservationInfoPerObject, OBSERVATION_INFO_KEY(self)); &#125;&#125;- (void)ya_willChangeValueForKey:(NSString *)key &#123; if (!YAKeyValueChangeDictionary) &#123; YAKeyValueChangeDictionary = [NSMutableDictionary dictionary]; &#125; id oldValue = nil; oldValue = [self valueForKeyPath:key]; if (!oldValue) oldValue = [NSNull null]; [YAKeyValueChangeDictionary setObject:oldValue forKey:[NSString stringWithFormat:@"%p-old", self]];&#125;- (void)ya_didChangeValueForKey:(NSString *)key &#123; if (self.ya_isKVOClass) &#123; YAKeyValueProperty *property = getKeyValueProperty(self.class, key); YAKeyValueObservationInfo *observation = self.ya_observationInfo; [observation.observances enumerateObjectsUsingBlock:^(YAKeyValueObservance *obj, NSUInteger idx, BOOL * _Nonnull stop) &#123; if ([obj.property isEqual:property]) &#123; NSMutableDictionary *change = [NSMutableDictionary dictionary]; if (obj.options &amp; NSKeyValueObservingOptionOld) &#123; id old = [YAKeyValueChangeDictionary objectForKey:[NSString stringWithFormat:@"%p-old", self]]; [change setObject:old forKey:@"old"]; &#125; else &#123; [YAKeyValueChangeDictionary removeObjectForKey:[NSString stringWithFormat:@"%p-old", self]]; &#125; if (obj.options &amp; NSKeyValueObservingOptionNew) &#123; id newValue = nil; newValue = [self valueForKeyPath:key]; if (!newValue) newValue = [NSNull null]; [YAKeyValueChangeDictionary setObject:newValue forKey:[NSString stringWithFormat:@"%p-new", self]]; [change setObject:newValue forKey:@"new"]; &#125; [obj.observer ya_observeValueForKeyPath:key ofObject:self change:change context:nil]; &#125; &#125;]; &#125;&#125;- (void)ya_addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(void *)context &#123; YAKeyValueProperty *property = getKeyValueProperty(self.class, keyPath); YAKeyValueObservance *observance = getKeyValueObservance(property, observer, context, options); static NSHashTable *YAKeyValueShareableObservationInfos; if (!YAKeyValueShareableObservationInfos) &#123; NSPointerFunctions *pointerFunctions = [[NSPointerFunctions alloc] initWithOptions:NSPointerFunctionsWeakMemory]; [pointerFunctions setHashFunction:YAKeyValueObservationInfoNSHTHash]; [pointerFunctions setIsEqualFunction:YAKeyValueObservationInfoNSHTIsEqual]; YAKeyValueShareableObservationInfos = [[NSHashTable alloc] initWithPointerFunctions:pointerFunctions capacity:0]; &#125; static YAKeyValueObservationInfoKey *finder; if (!finder) &#123; finder = [YAKeyValueObservationInfoKey new]; &#125; YAKeyValueObservationInfo *info = (__bridge id)[self ya_observationInfo]; finder.baseObservationInfo = info; finder.additionObserver = observer; finder.additionContext = context; finder.additionOptions = options; finder.additionProperty = property; YAKeyValueObservationInfo *observation = [YAKeyValueShareableObservationInfos member:finder]; // ÈáçÁΩÆfinderÊï∞ÊçÆ finder.baseObservationInfo = nil; finder.additionObserver = nil; finder.additionContext = NULL; finder.additionOptions = 0; finder.additionProperty = nil; if (!observation) &#123; // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞, ÂàõÂª∫ observation = [[YAKeyValueObservationInfo alloc] initWithObservances:@[observance] count:1]; // Ê∑ªÂä†Âà∞ÁºìÂ≠ò‰∏≠ [YAKeyValueShareableObservationInfos addObject:observation]; &#125; else &#123; NSMutableArray *buffer = [NSMutableArray arrayWithArray:observation.observances]; [buffer addObject:observance]; observation.observances = [NSArray arrayWithArray:buffer]; &#125; self.ya_observationInfo = (__bridge void *)(observation); if (!self.ya_isKVOClass) &#123; Class isaForAutonotifying = [property isaForAutonotifying]; // Êõ¥ÊîπisaÊåáÈíà object_setClass(self, isaForAutonotifying); &#125; if (options &amp; NSKeyValueObservingOptionInitial) &#123; id newValue = nil; if (options &amp; NSKeyValueObservingOptionNew) &#123; newValue = [self valueForKeyPath:keyPath]; &#125; if (!newValue) newValue = [NSNull null]; // ‰ΩøÁî®NSNullÂØπË±° NSDictionary *change = @&#123;@"new": newValue&#125;; [observer ya_observeValueForKeyPath:keyPath ofObject:self change:change context:context]; &#125;&#125;- (void)ya_removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath context:(void *)context &#123; if (self.ya_isKVOClass) &#123; YAKeyValueProperty *property = getKeyValueProperty(self.class, keyPath); YAKeyValueObservationInfo *observation = self.ya_observationInfo; NSMutableArray *diff = [NSMutableArray arrayWithArray:observation.observances]; __block NSInteger removeIdx = -1; [diff enumerateObjectsUsingBlock:^(YAKeyValueObservance *obj, NSUInteger idx, BOOL * _Nonnull stop) &#123; if ([obj.property isEqual:property] &amp;&amp; obj.observer == observer &amp;&amp; obj.context == context) &#123; removeIdx = idx; *stop = YES; &#125; &#125;]; if (removeIdx != -1) &#123; // ÊâæÂà∞ÈúÄË¶ÅÁßªÈô§ÁöÑÂÖÉÁ¥† [diff removeObjectAtIndex:removeIdx]; observation.observances = [NSArray arrayWithArray:diff]; &#125; &#125;&#125;- (void)ya_observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context&#123;&#125;@end ÂäüËÉΩcheck1.Ê∑ªÂä†ËßÇÂØüËÄÖ‰∏éËÆæÁΩÆÂõûË∞ÉÔºö [self.obj ya_addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld context:"NULL"]; - (void)ya_observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context &#123; NSLog(@"%@", change);&#125;self.obj.name = @"Aaron";self.obj.name = @"Jack"; ÊâìÂç∞Ôºö 2019-05-30 09:41:23.595046+0800 Aaron[24893:604622] &#123; new = Aaron; old = "&lt;null&gt;";&#125;2019-05-30 09:41:23.595215+0800 Aaron[24893:604622] &#123; new = Jack; old = Aaron;&#125; 2.‰ΩøÁî®NSKeyValueObservingOptionInitial [self.obj ya_addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionInitial context:"NULL"];self.obj.name = @"Aaron"; ÊâìÂç∞2019-05-30 09:45:01.717131+0800 Aaron[25010:609398] &#123; new = "&lt;null&gt;";&#125; 3.Â§öÊ¨°Ê∑ªÂä†ËßÇÂØüËÄÖ [self.obj ya_addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:"NULL"];[self.obj ya_addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:"NULL"];[self.obj ya_addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:"NULL"];self.obj.name = @"Aaron"; ÊâìÂç∞ 2019-05-30 09:47:20.625826+0800 Aaron[25107:613531] { new = Aaron; } 2019-05-30 09:47:20.625992+0800 Aaron[25107:613531] { new = Aaron; } 2019-05-30 09:47:20.626128+0800 Aaron[25107:613531] { new = Aaron; } ÂÖ∑‰ΩìÁöÑ‰ª£Á†ÅÊîæÂà∞‰∫Ügithub‰∏äÔºöhttps://github.com/ChenYalun/Project/tree/master/KVO KVOÁöÑÊ∫êÁ†ÅÊù•Ëá™Ôºöhttps://github.com/renjinkui2719/DIS_KVC_KVO „ÄÇÊÑüË∞¢‰ΩúËÄÖ„ÄÇ ÂèÇËÄÉÊñáÁ´†http://southpeak.github.io/2015/04/23/cocoa-foundation-nskeyvalueobserving/https://tech.glowing.com/cn/implement-kvo/https://knightsj.github.io/2017/05/15/‰ΩøÁî®BlockÂÆûÁé∞KVO/https://blog.sunnyxx.com/2014/03/09/objc_kvo_secret/http://chuquan.me/2018/12/12/kvo-principle/]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØ¶Ëß£KVCÊ∫êÁ†Å]]></title>
    <url>%2F2019%2F05%2F05%2F%E8%AF%A6%E8%A7%A3KVC%E6%BA%90%E7%A0%81%2F</url>
    <content type="text"><![CDATA[KVCÊ∫êÁ†ÅÈòÖËØª„ÄÇ ‰∏Ä„ÄÅÊé•Âè£@interface NSObject(NSKeyValueCoding)// ÊòØÂê¶ÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáè(ÂÆû‰æãÂèòÈáèËÆøÈóÆÂºÄÂÖ≥, ÈªòËÆ§YES)@property (class, readonly) BOOL accessInstanceVariablesDirectly;// ÈÄöËøákeyËÆøÈóÆ- (nullable id)valueForKey:(NSString *)key;- (void)setValue:(nullable id)value forKey:(NSString *)key;// Â∞ùËØïÈ™åËØÅÂ∞ÜË¶ÅËÆæÂÆöÁöÑvalue(ioValueÊåáÈíàÊåáÂêëÁöÑÂØπË±°)ÊòØÂê¶ÂêàÁêÜÊúâÊïà- (BOOL)validateValue:(inout id _Nullable * _Nonnull)ioValue forKey:(NSString *)inKey error:(out NSError **)outError;// Ëé∑ÂèñÁõ∏ÂØπÂ∫îÁöÑÁ≤æÁ°ÆÂÆπÂô®Á±ªÂûã- (NSMutableArray *)mutableArrayValueForKey:(NSString *)key;- (NSMutableOrderedSet *)mutableOrderedSetValueForKey:(NSString *)key;- (NSMutableSet *)mutableSetValueForKey:(NSString *)key;// ÈÄöËøákeyPathËÆøÈóÆ- (nullable id)valueForKeyPath:(NSString *)keyPath;- (void)setValue:(nullable id)value forKeyPath:(NSString *)keyPath;- (BOOL)validateValue:(inout id _Nullable * _Nonnull)ioValue forKeyPath:(NSString *)inKeyPath error:(out NSError **)outError;- (NSMutableArray *)mutableArrayValueForKeyPath:(NSString *)keyPath;- (NSMutableOrderedSet *)mutableOrderedSetValueForKeyPath:(NSString *)keyPath;- (NSMutableSet *)mutableSetValueForKeyPath:(NSString *)keyPath;// Êü•ÊâækeyÂ§±Ë¥•ÈªòËÆ§ÊäõÂá∫ÂºÇÂ∏∏, ÂèØÈáçÂÜôËá™Ë°åÂÆûÁé∞- (nullable id)valueForUndefinedKey:(NSString *)key;// ËÆæÁΩÆvalueÂ§±Ë¥•ÈªòËÆ§ÊäõÂá∫ÂºÇÂ∏∏, ÂèØÈáçÂÜôËá™Ë°åÂÆûÁé∞- (void)setValue:(nullable id)value forUndefinedKey:(NSString *)key;// ËÆæÁΩÆvalue‰∏∫nilÊó∂ÊäõÂá∫ÂºÇÂ∏∏, ÂèØÈáçÂÜôËá™Ë°åÂÆûÁé∞- (void)setNilValueForKey:(NSString *)key;// ‰º†ÂÖ•keyÊï∞ÁªÑ, ËøîÂõû‰∏Ä‰∏™ÊàêÂëòÂèòÈáèÂêçÂíåÂèòÈáèÂÄºÁöÑÈîÆÂÄºÂØπÁªÑÊàêÁöÑÂ≠óÂÖ∏(ÂèØÁî®‰∫éÊ®°ÂûãËΩ¨Â≠óÂÖ∏)- (NSDictionary&lt;NSString *, id&gt; *)dictionaryWithValuesForKeys:(NSArray&lt;NSString *&gt; *)keys;// Â≠óÂÖ∏ËΩ¨Ê®°Âûã- (void)setValuesForKeysWithDictionary:(NSDictionary&lt;NSString *, id&gt; *)keyedValues;@end/// ÂÆπÂô®Êâ©Â±ï@interface NSArray&lt;ObjectType&gt;(NSKeyValueCoding)- (id)valueForKey:(NSString *)key;- (void)setValue:(nullable id)value forKey:(NSString *)key;@end@interface NSDictionary&lt;KeyType, ObjectType&gt;(NSKeyValueCoding)- (nullable ObjectType)valueForKey:(NSString *)key;@end@interface NSMutableDictionary&lt;KeyType, ObjectType&gt;(NSKeyValueCoding)- (void)setValue:(nullable ObjectType)value forKey:(NSString *)key;@end@interface NSSet&lt;ObjectType&gt;(NSKeyValueCoding)- (id)valueForKey:(NSString *)key;- (void)setValue:(nullable id)value forKey:(NSString *)key;@end@interface NSOrderedSet&lt;ObjectType&gt;(NSKeyValueCoding)- (id)valueForKey:(NSString *)key;- (void)setValue:(nullable id)value forKey:(NSString *)key;@end ÈõÜÂêà‰ª£ÁêÜÂØπË±°ËøôÈáåÁÆÄÂçïÊÄªÁªìÈõÜÂêà‰ª£ÁêÜÂØπË±°ÁöÑ‰ΩøÁî®„ÄÇ ÂΩìÊàë‰ª¨Âú®ÂØπË±°‰∏äË∞ÉÁî® -valueForKey: ÁöÑÊó∂ÂÄôÔºåÂÆÉÂèØ‰ª•ËøîÂõû NSArrayÔºåNSSet ÊàñÊòØ NSOrderedSet ÁöÑÈõÜÂêà‰ª£ÁêÜÂØπË±°„ÄÇËøô‰∏™Á±ªÊ≤°ÊúâÂÆûÁé∞ÈÄöÂ∏∏ÁöÑ -&lt;Key&gt; ÊñπÊ≥ïÔºå‰ΩÜÊòØÂÆÉÂÆûÁé∞‰∫Ü‰ª£ÁêÜÂØπË±°ÊâÄÈúÄË¶Å‰ΩøÁî®ÁöÑÂæàÂ§öÊñπÊ≥ï„ÄÇ NSArray@interface Primes : NSObject@property (nonatomic, copy, readonly) NSArray *primes;@end@implementation Primes@dynamic primes; // ‰∏çË¶ÅÁîüÊàêgetÊñπÊ≥ïstatic int32_t const primes[] = &#123; 2, 101, 233, 383, 3, 103, 239, 389, 5, 107, 241, 397, 7, 109, 251, 401, 11, 113, 257, 409, 13, 127, 263, 419, 17, 131, 269, 421, 19, 137, 271, 431, 23, 139, 277, 433, 29, 149, 281, 439, 31, 151, 283, 443, 37, 157, 293, 449, 41, 163, 307, 457, 43, 167, 311, 461, 47, 173, 313, 463, 53, 179, 317, 467, 59, 181, 331, 479, 61, 191, 337, 487, 67, 193, 347, 491, 71, 197, 349, 499, 73, 199, 353, 503, 79, 211, 359, 509, 83, 223, 367, 521, 89, 227, 373, 523, 97, 229, 379, 541, 547, 701, 877, 1049, 557, 709, 881, 1051, 563, 719, 883, 1061, 569, 727, 887, 1063, 571, 733, 907, 1069, 577, 739, 911, 1087, 587, 743, 919, 1091, 593, 751, 929, 1093, 599, 757, 937, 1097, 601, 761, 941, 1103, 607, 769, 947, 1109, 613, 773, 953, 1117, 617, 787, 967, 1123, 619, 797, 971, 1129, 631, 809, 977, 1151, 641, 811, 983, 1153, 643, 821, 991, 1163, 647, 823, 997, 1171, 653, 827, 1009, 1181, 659, 829, 1013, 1187, 661, 839, 1019, 1193, 673, 853, 1021, 1201, 677, 857, 1031, 1213, 683, 859, 1033, 1217, 691, 863, 1039, 1223, 1229,&#125;;- (NSUInteger)countOfPrimes &#123; return (sizeof(primes) / sizeof(*primes));&#125;- (id)objectInPrimesAtIndex:(NSUInteger)idx &#123; NSParameterAssert(idx &lt; sizeof(primes) / sizeof(*primes)); return @(primes[idx]);&#125;@end ÂØπ‰∫éNSArrayÔºå ÂÆûÁé∞-countOf&lt;Key&gt;ÊñπÊ≥ïÔºå-objectIn&lt;Key&gt;AtIndex:ÊàñËÄÖ-&lt;key&gt;AtIndexes:‰∏≠ÁöÑ‰∏Ä‰∏™Âç≥ÂèØÔºåÂΩìÁÑ∂Â¶ÇÊûúÂÜçÂÆûÁé∞-get&lt;Key&gt;:range:Â∞Ü‰ºöÂ¢ûÂº∫ÊÄßËÉΩ„ÄÇ ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåkeyÊòØ‚Äùprimes‚ÄùÔºåÂÆûÈôÖ‰∏äÂπ∂Ê≤°ÊúâËøô‰∏™primesÊï∞ÁªÑÔºåËÄåÊòØÁî®‰∫Ü‰∏Ä‰∏™CÊï∞ÁªÑ‰ª£ÁêÜ‰∫Ü„ÄÇ@property (nonatomic, copy, readonly) NSArray *primes;Âíå@dynamic primes; Ëøô‰∏§Âè•ËØùÂèØ‰ª•ÁúÅÁï•Ôºà‰∏ãÊñáÁöÑ‰æãÂ≠êÂ∞±ÁúÅÁï•‰∫ÜÔºâÔºåËøôÈáåÂä†‰∏äÁöÑÂéüÂõ†ÊòØÔºå‰æø‰∫éÂ§ñÁïåÁü•ÊôìÂÖ∑‰ΩìÁöÑkeyÂÄº„ÄÇ ‰ΩøÁî®Ôºö Primes *primes = [Primes new];// obj is kind of class 'NSKeyValueArray'id obj = [primes valueForKey:@"primes"]; ÂèØËßÅÔºåËé∑ÂæóÁöÑÂØπË±°Âπ∂‰∏çÊòØ‰∏Ä‰∏™NSArrayÔºåËÄåÊòØNSKeyValueArray„ÄÇ NSSet@interface PrimesSet : NSObject@end@implementation PrimesSetstatic NSSet *_numSet;- (instancetype)init &#123; if (self = [super init]) &#123; _numSet = [NSSet setWithObjects:@0, @1, @2, @3, nil]; &#125; return self;&#125;- (NSUInteger)countOfPrimes &#123; return _numSet.count;&#125;- (NSEnumerator *)enumeratorOfPrimes &#123; return _numSet.objectEnumerator;&#125;- (id)memberOfPrimes:(id)obj &#123; return [_numSet member:obj];&#125;@end ÂØπ‰∫éNSSetÔºåË¶ÅÂÆûÁé∞-countOf&lt;Key&gt;„ÄÅ-enumeratorOf&lt;Key&gt;Âíå-memberOf&lt;Key&gt;:Ëøô‰∏â‰∏™ÊñπÊ≥ï„ÄÇ ‰ΩøÁî®Ôºö PrimesSet *primesSet = [PrimesSet new];// obj is kind of class 'NSKeyValueSet'id obj = [primesSet valueForKey:@"primes"]; Ëé∑ÂèñÂà∞ÁöÑÂØπË±°ÊòØNSKeyValueSet„ÄÇ NSOrderedSet@interface PrimesOrderedSet : NSObject@end@implementation PrimesOrderedSetstatic NSOrderedSet *_numOrderedSet;- (instancetype)init &#123; if (self = [super init]) &#123; _numOrderedSet = [NSOrderedSet orderedSetWithObjects:@0, @1, @2, @3, nil]; &#125; return self;&#125;- (NSUInteger)countOfPrimes &#123; return _numOrderedSet.count;&#125;- (NSUInteger)indexInPrimesOfObject:(id)obj &#123; return [_numOrderedSet indexOfObject:obj];&#125;- (id)objectInPrimesAtIndex:(NSUInteger)idx &#123; return [_numOrderedSet objectAtIndex:idx];&#125;// Áî®‰∫éÊèêÈ´òÊÄßËÉΩ- (void)getPrimes:(id __unsafe_unretained *)buffer range:(NSRange)inRange &#123; // ËøîÂõûÊèê‰æõÁöÑÁºìÂÜ≤Âå∫ÂÜÖÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÊï∞ÊçÆÈõÜÂêà [_numOrderedSet getObjects:buffer range:inRange];&#125;@end ÂøÖÈ°ªÂÆûÁé∞ÁöÑÊñπÊ≥ïÊòØ-countOf&lt;Key&gt;Âíå-indexIn&lt;Key&gt;OfObject:„ÄÇ‰∫åÈÄâ‰∏ÄÂÆûÁé∞ÁöÑÊñπÊ≥ïÊòØ-objectIn&lt;Key&gt;AtIndex:Âíå-&lt;key&gt;AtIndexes:„ÄÇÂ¶ÇÊûúÂÜçÂÆûÁé∞-get&lt;Key&gt;:range:Â∞Ü‰ºöÂ¢ûÂº∫ÊÄßËÉΩ„ÄÇ ‰ΩøÁî®Ôºö PrimesOrderedSet *primesOrderedSet = [PrimesOrderedSet new];// obj is kind of class 'NSKeyValueOrderedSet'id obj = [primesOrderedSet valueForKey:@"primes"]; Ëé∑ÂèñÂà∞ÁöÑÂØπË±°ÊòØNSKeyValueOrderedSet„ÄÇ ÈõÜÂêàÊìç‰ΩúÊï∞ÁªÑÊúÄÂ§ßÂÄºÔºö NSArray *array = @[@1, @8, @5];[array valueForKeyPath:@"@max.self"]; Ê®°ÂûãÊï∞ÁªÑÊúÄÂ§ßÂÄºÔºö NSArray *array = @[person1, person2, person3];[array valueForKeyPath:@"@max.age"]; ÂÖ∂‰ªñÊìç‰ΩúÁ¨¶Ôºö @max @min: Ëé∑ÂæóÊï∞ÁªÑ‰∏≠ÊúÄÂ§ß(ÊàñËÄÖÊúÄÂ∞è)ÁöÑ‰∏Ä‰∏™ÂÖÉÁ¥†@avg: Â∞ÜÈõÜÂêà‰∏≠ÂØπË±°ËΩ¨Êç¢ÊàêdoubleÁ±ªÂûãÔºåËøîÂõûÊï∞ÁªÑ‰∏≠ÊåáÂÆöÁöÑÂπ≥ÂùáÂÄºÁöÑnumberÂØπË±°@sum: Â∞ÜÈõÜÂêà‰∏≠ÊØè‰∏™ÂØπË±°ÈÉΩËΩ¨Êç¢ÊàêdoubleÁ±ªÂûãÔºåÁÑ∂ÂêéËÆ°ÁÆóÊÄªÂíåÔºåÊúÄÂêéËøîÂõû‰∏Ä‰∏™ÂÄº‰∏∫Ëøô‰∏™ÊÄªÂíåÁöÑNSNumberÂØπË±°@countÔºöËøîÂõûÈõÜÂêà‰∏≠ÂØπË±°ÊÄªÊï∞ÁöÑNSNumberÂØπË±°ËøîÂõû‰∏Ä‰∏™Áî±Êìç‰ΩúÁ¨¶Âè≥ËæπÁöÑkey pathÊåáÂÆöÁöÑÂØπË±°Â±ûÊÄßÁªÑÊàêÁöÑÊï∞ÁªÑÔºådistincUnionOfObjects‰ºöÂØπÊï∞ÁªÑÂéªÈáç„ÄÇÁ§∫‰æãÔºö[personList valueForKeyPath:@"@unionOfObjects.name"];[personList valueForKeyPath:@"@distinctUnionOfObjects.name"];Êìç‰ΩúÂØπË±°Ôºö@unionOfObjects/@distincUnionOfObjects Êìç‰ΩúÊï∞ÁªÑÔºö@distinctUnionOfArrays/@unionOfArraysÊìç‰ΩúÈõÜÂêàÔºö@distinctUnionOfSets Âíå@distinctUnionOfArrays ÂàÜÁ±ªÁöÑKVC‰∏ÄËà¨ÁöÑÂú∫ÊôØÊòØËøôÊ†∑Ôºö // ‰∏ªÁ±ª@interface Portion : NSObject@end@implementation Portion@end// ÂàÜÁ±ª@interface Portion (PrimitiveAccessors)- (NSNumber *)primitiveVolume;- (void)setPrimitiveVolume:(NSNumber *)value;@end@implementation Portion (PrimitiveAccessors)static NSNumber *gVolume;- (NSNumber *)primitiveVolume &#123; return gVolume;&#125;- (void)setPrimitiveVolume:(NSNumber *)value &#123; gVolume = value;&#125;@end ÂØπ‰∫é‰∏ªÁ±ª‰∏≠Ê≤°ÊúâÁöÑkeyÔºåÂàÜÁ±ªÂÆûÁé∞ÁâπÂÆöÁöÑÊñπÊ≥ïÂêéÔºåKVC‰πüÂ∞Ü‰ºöÁîüÊïà„ÄÇÂ¶ÇÊûúÊòØÂèñÂÄºÔºåÂàÜÁ±ªÂøÖÈ°ªÂÆûÁé∞ËøôÊ†∑ÁöÑÊñπÊ≥ïÔºögetPrimitive&lt;key&gt;ÊàñËÄÖprimitive&lt;key&gt;„ÄÇ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåkeyÊòØvolume„ÄÇÂ¶ÇÊûúÊòØËÆæÂÄºÔºåÂàÜÁ±ªÂøÖÈ°ªÂÆûÁé∞setPrimitive&lt;key&gt;:ÊñπÊ≥ï„ÄÇ ‰ΩøÁî®Ôºö Portion *p = [Portion new];[p setValue:@234 forKey:@"volume"];id m = [p valueForKey:@"volume"]; ÂΩìÁÑ∂ÔºåÊú¨Ë¥®‰∏äÊù•ËÆ≤ÔºåÂπ∂KVC‰∏ç‰ªãÊÑèËøô‰∫õÊñπÊ≥ïÂú®‰∏ªÁ±ªËøòÊòØÂàÜÁ±ªÂÆûÁé∞ÁöÑÔºåÂè™ÊúâÂÆûÁé∞Â∞±Êàê„ÄÇ‰∏äÈù¢ÁöÑÂè™ÊòØ‰∏Ä‰∏™‰æãÂ≠êÔºåÂÆûÈôÖ‰∏äÔºåÂÆåÂÖ®‰æùÈù†‰∏ªÁ±ª‰πüÊòØÊó†Â¶®ÁöÑ„ÄÇ @interface Portion : NSObject- (NSNumber *)primitiveVolume;- (void)setPrimitiveVolume:(NSNumber *)value;@end@implementation Portionstatic NSNumber *gVolume;- (NSNumber *)primitiveVolume &#123; return gVolume;&#125;- (void)setPrimitiveVolume:(NSNumber *)value &#123; gVolume = value;&#125;@end ‰∫å„ÄÅÂèñÂÄºvalueForKey:ËãπÊûúÂú®Êé•Âè£ËøôÈáåÂ∑≤ÁªèÁªôÂá∫‰∫ÜÂÖ∂Âü∫Êú¨ÂéüÁêÜÔºö The default implementation of this method does the following: Searches the class of the receiver for an accessor method whose name matches the pattern -get&lt;Key&gt;, -&lt;key&gt;, or -is&lt;Key&gt;, in that order. If such a method is found it is invoked. If the type of the method‚Äôs result is an object pointer type the result is simply returned. If the type of the result is one of the scalar types supported by NSNumber conversion is done and an NSNumber is returned. Otherwise, conversion is done and an NSValue is returned (new in Mac OS 10.5: results of arbitrary type are converted to NSValues, not just NSPoint, NRange, NSRect, and NSSize). (introduced in Mac OS 10.7). Otherwise (no simple accessor method is found), searches the class of the receiver for methods whose names match the patterns -countOf&lt;Key&gt; and -indexIn&lt;Key&gt;OfObject: and -objectIn&lt;Key&gt;AtIndex:(corresponding to the primitive methods defined by the NSOrderedSet class) and also -&lt;key&gt;AtIndexes: (corresponding to -[NSOrderedSet objectsAtIndexes:]). If a count method and an indexOf method and at least one of the other two possible methods are found, a collection proxy object that responds to all NSOrderedSet methods is returned. Each NSOrderedSet message sent to the collection proxy object will result in some combination of-countOf&lt;Key&gt;, -indexIn&lt;Key&gt;OfObject:, -objectIn&lt;Key&gt;AtIndex:, and -&lt;key&gt;AtIndexes: messages being sent to the original receiver of -valueForKey:. If the class of the receiver also implements an optional method whose name matches the pattern -get:range: that method will be used when appropriate for best performance. Otherwise (no simple accessor method or set of ordered set access methods is found), searches the class of the receiver for methods whose names match the patterns -countOf&lt;Key&gt; and -objectIn&lt;Key&gt;AtIndex:(corresponding to the primitive methods defined by the NSArray class) and (introduced in Mac OS 10.4) also-&lt;key&gt;AtIndexes:(corresponding to -[NSArray objectsAtIndexes:]). If a count method and at least one of the other two possible methods are found, a collection proxy object that responds to all NSArray methods is returned. Each NSArray message sent to the collection proxy object will result in some combination of -countOf&lt;Key&gt;, -objectIn&lt;Key&gt;AtIndex:, and -&lt;key&gt;AtIndexes: messages being sent to the original receiver of -valueForKey:. If the class of the receiver also implements an optional method whose name matches the pattern -get&lt;Key&gt;:range: that method will be used when appropriate for best performance. (introduced in Mac OS 10.4). Otherwise (no simple accessor method or set of ordered set or array access methods is found), searches the class of the receiver for a threesome of methods whose names match the patterns -countOf&lt;Key&gt;, -enumeratorOf&lt;Key&gt;, and -memberOf&lt;Key&gt;: (corresponding to the primitive methods defined by the NSSet class). If all three such methods are found a collection proxy object that responds to all NSSet methods is returned. Each NSSet message sent to the collection proxy object will result in some combination of -countOf&lt;Key&gt;, -enumeratorOf&lt;Key&gt;, and -memberOf&lt;Key&gt;:messages being sent to the original receiver of -valueForKey:. Otherwise (no simple accessor method or set of collection access methods is found), if the receiver‚Äôs class‚Äô +accessInstanceVariablesDirectly property returns YES, searches the class of the receiver for an instance variable whose name matches the pattern _&lt;key&gt;, _is&lt;Key&gt;, &lt;key&gt;, or is&lt;Key&gt;, in that order. If such an instance variable is found, the value of the instance variable in the receiver is returned, with the same sort of conversion to NSNumber or NSValue as in step 1. Otherwise (no simple accessor method, set of collection access methods, or instance variable is found), invokes -valueForUndefinedKey: and returns the result. The default implementation of -valueForUndefinedKey: raises an NSUndefinedKeyException, but you can override it in your application. Compatibility notes: For backward binary compatibility, an accessor method whose name matches the pattern -_get&lt;Key&gt;, or -_&lt;key&gt; is searched for between steps 1 and 3. If such a method is found it is invoked, with the same sort of conversion to NSNumber or NSValue as in step 1. KVC accessor methods whose names start with underscores were deprecated as of Mac OS 10.3 though. The behavior described in step 5 is a change from Mac OS 10.2, in which the instance variable search order was &lt;key&gt;, _&lt;key&gt;. For backward binary compatibility, -handleQueryWithUnboundKey: will be invoked instead of -valueForUndefinedKey: in step 6, if the implementation of -handleQueryWithUnboundKey: in the receiver‚Äôs class is not NSObject‚Äôs. Áî®Ëπ©ËÑöÁöÑËã±ËØ≠ÁøªËØëÂ¶Ç‰∏ãÔºö ÊåâÁÖß-get&lt;Key&gt;, -&lt;key&gt;, -is&lt;Key&gt;ÁöÑÈ°∫Â∫èÊêúÁ¥¢ËØ•Á±ªÁöÑÂ≠òÂèñÂô®ÊñπÊ≥ïÔºåËã•ÊâæÂà∞ÔºåÂàôÁõ¥Êé•Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúÊñπÊ≥ïË∞ÉÁî®ÁöÑÁªìÊûúÊòØidÁ±ªÂûãÔºåÁõ¥Êé•ÊääÁªìÊûúËøîÂõû„ÄÇÂ¶ÇÊûúÊñπÊ≥ïË∞ÉÁî®ÁöÑÁªìÊûúÊòØËÉΩÂ§üË¢´NSNumberËΩ¨Êç¢ÁöÑÊ†áÈáèÁ±ªÂûãÔºåÂàôÁªìÊûú‰ºöË¢´ËΩ¨‰∏∫NSNumberËøîÂõû„ÄÇÂê¶ÂàôÂØπ‰∫é‰∏ÄËà¨ÁöÑÊ†áÈáèÁ±ªÂûãÔºåËøô‰∫õÁ±ªÂûãÂ∞Ü‰ºöË¢´ËΩ¨Âåñ‰∏∫NSValueÔºàÂú®Mac OS 10.5Âèä‰ª•ÂêéÔºå‰∏ç‰ªÖ‰ªÖÊîØÊåÅNSPoint, NRange, NSRectÔºå‰ª•ÂèäNSSizeËøô‰∫õÁ±ªÂûãÔºâ„ÄÇ Â¶ÇÊûúÁÆÄÂçïÁöÑÂ≠òÂèñÂô®ÊñπÊ≥ïÊ≤°ÊúâÊâæÂà∞ÔºåÈÇ£‰πàÊêúÁ¥¢ËØ•Á±ªÁöÑ-countOf&lt;Key&gt;, -indexIn&lt;Key&gt;OfObject:ÊñπÊ≥ïÔºåËøòÊúâ-objectIn&lt;Key&gt;AtIndex:ÔºàÂØπÂ∫îË¢´NSOrderedSetÁ±ªÊâÄÂÆö‰πâÁöÑÊñπÊ≥ïÔºâÔºå-&lt;key&gt;AtIndexes:ÔºàÂØπÂ∫î-[NSOrderedSet objectsAtIndexes:]ÔºâÊñπÊ≥ï„ÄÇÂ¶ÇÊûú-countOf&lt;Key&gt;, -indexIn&lt;Key&gt;OfObject:Ëøô‰∏§‰∏™ÊñπÊ≥ïË¢´ÊâæÂà∞ÔºåÂè¶Â§ñ‰∏§‰∏™ÊñπÊ≥ï‰∏≠ÁöÑËá≥Â∞ë‰∏Ä‰∏™Ë¢´ÊâæÂà∞ÔºåÈÇ£‰πàËøô‰∏™ËÉΩÂìçÂ∫îNSOrderedSetÊâÄÊúâÊñπÊ≥ïÁöÑÈõÜÂêà‰ª£ÁêÜÂØπË±°‰ºöË¢´ËøîÂõû„ÄÇÂèëÈÄÅÁªôÂéüÊù•Ê∂àÊÅØÊé•Êî∂ËÄÖÁöÑ-valueForKey:Ê∂àÊÅØÔºåÂ∞Ü‰ºöË¢´Ëøô‰∏™ÈõÜÂêà‰ª£ÁêÜÂØπË±°ÁöÑ-countOf&lt;Key&gt;, -indexIn&lt;Key&gt;OfObject:, -objectIn&lt;Key&gt;AtIndex:, -&lt;key&gt;AtIndexes:Ëøô‰∫õÊñπÊ≥ïÂÖ±ÂêåÂ§ÑÁêÜ„ÄÇÂ¶ÇÊûúËøô‰∏™‰ª£ÁêÜÂØπË±°‰πüÂÆûÁé∞‰∫ÜÂèØÈÄâÁöÑ-get&lt;Key&gt;:range:ÊñπÊ≥ïÔºåËøôÂ∞ÜÊúâÂä©‰∫éÂ¢ûÂº∫ÊÄßËÉΩ„ÄÇ Â¶ÇÊûúÂ≠òÂèñÂô®ÊñπÊ≥ïÂíåordered setÁöÑ‰ª£ÁêÜÊñπÊ≥ïÊ≤°ÊúâË¢´ÊâæÂà∞ÔºåÈÇ£‰πàÊêúÁ¥¢ËØ•Á±ªÁöÑ-countOf&lt;Key&gt;ÊñπÊ≥ïÔºåËøòÊúâ-objectIn&lt;Key&gt;AtIndex:ÔºàÂØπÂ∫îË¢´NSArrayÁ±ªÊâÄÂÆö‰πâÁöÑÊñπÊ≥ïÔºâÔºå-&lt;key&gt;AtIndexes:ÔºàÂØπÂ∫î-[NSArray objectsAtIndexes:]ÔºâÊñπÊ≥ï„ÄÇÂ¶ÇÊûú-countOf&lt;Key&gt;Ëøô‰∏™ÊñπÊ≥ïË¢´ÊâæÂà∞ÔºåÂè¶Â§ñ‰∏§‰∏™ÊñπÊ≥ï‰∏≠ÁöÑËá≥Â∞ë‰∏Ä‰∏™Ë¢´ÊâæÂà∞ÔºåÈÇ£‰πàËøô‰∏™ËÉΩÂìçÂ∫îNSArrayÊâÄÊúâÊñπÊ≥ïÁöÑÈõÜÂêà‰ª£ÁêÜÂØπË±°‰ºöË¢´ËøîÂõû„ÄÇÂèëÈÄÅÁªôÂéüÊù•Ê∂àÊÅØÊé•Êî∂ËÄÖÁöÑ-valueForKey:Ê∂àÊÅØÔºåÂ∞Ü‰ºöË¢´Ëøô‰∏™ÈõÜÂêà‰ª£ÁêÜÂØπË±°ÁöÑ-countOf&lt;Key&gt;, -objectIn&lt;Key&gt;AtIndex:, -&lt;key&gt;AtIndexes:Ëøô‰∫õÊñπÊ≥ïÂÖ±ÂêåÂ§ÑÁêÜ„ÄÇÂ¶ÇÊûúËøô‰∏™‰ª£ÁêÜÂØπË±°‰πüÂÆûÁé∞‰∫ÜÂèØÈÄâÁöÑ-get&lt;Key&gt;:range:ÊñπÊ≥ïÔºåËøôÂ∞ÜÊúâÂä©‰∫éÂ¢ûÂº∫ÊÄßËÉΩ„ÄÇ Â¶ÇÊûúÂ≠òÂèñÂô®ÊñπÊ≥ï„ÄÅordered setÂíåarrayÁöÑ‰ª£ÁêÜÊñπÊ≥ïÈÉΩÊ≤°ÊúâË¢´ÊâæÂà∞ÔºåÈÇ£‰πàÂ∞ùËØïÊêúÁ¥¢-countOf&lt;Key&gt;, -enumeratorOf&lt;Key&gt;, -memberOf&lt;Key&gt;:Ëøô‰∫õ(Ë¢´NSSetÁ±ªÊâÄÂÆö‰πâÁöÑ)ÊñπÊ≥ï„ÄÇÂ¶ÇÊûúËøô‰∏â‰∏™ÊñπÊ≥ïÈÉΩËÉΩË¢´ÊâæÂà∞ÔºåÈÇ£‰πàËøô‰∏™ËÉΩÂìçÂ∫îNSSetÊâÄÊúâÊñπÊ≥ïÁöÑÈõÜÂêà‰ª£ÁêÜÂØπË±°‰ºöË¢´ËøîÂõû„ÄÇÂèëÈÄÅÁªôÂéüÊù•Ê∂àÊÅØÊé•Êî∂ËÄÖÁöÑ-valueForKey:Ê∂àÊÅØÔºåÂ∞Ü‰ºöË¢´Ëøô‰∏™ÈõÜÂêà‰ª£ÁêÜÂØπË±°ÁöÑcountOf&lt;Key&gt;, -enumeratorOf&lt;Key&gt;, -memberOf&lt;Key&gt;:Ëøô‰∫õÊñπÊ≥ïÂÖ±ÂêåÂ§ÑÁêÜ„ÄÇ Â¶ÇÊûúÂ≠òÂèñÂô®ÊñπÊ≥ï„ÄÅordered set„ÄÅarray‰ª•ÂèäsetÁöÑ‰ª£ÁêÜÊñπÊ≥ïÈÉΩÊ≤°ÊúâË¢´ÊâæÂà∞ÔºåÂÄòËã•Ê≠§Êó∂Ê∂àÊÅØÊé•Êî∂ËÄÖÁöÑ+accessInstanceVariablesDirectlyÂ±ûÊÄßËøîÂõûÁöÑÊòØYESÔºåÈÇ£‰πàÊåâÁÖß_&lt;key&gt;, _is&lt;Key&gt;, &lt;key&gt;, is&lt;Key&gt;ÁöÑÈ°∫Â∫èÊêúÁ¥¢ËØ•Á±ªÁöÑÂÆû‰æãÂèòÈáè„ÄÇÂ¶ÇÊûúÊâæÂà∞Ëøô‰∏™ÂÆû‰æãÂèòÈáèÔºåÈÇ£‰πàÊåâÁÖßÊ≠•È™§1‰∏≠ÁöÑÁ±ªÂûãËΩ¨Êç¢ËßÑÂàôËøîÂõûËøô‰∏™ÂÆû‰æãÂèòÈáèÁöÑÂÄº„ÄÇ Âê¶Âàô(Âï•‰πüÊ≤°ÊâæÂà∞)ÔºåË∞ÉÁî®-valueForUndefinedKey:ÊñπÊ≥ïÂπ∂ËøîÂõûÁªìÊûú„ÄÇËøô‰∏™ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØÊäõÂá∫NSUndefinedKeyExceptionÂºÇÂ∏∏Ôºå‰∏çËøá‰Ω†ÂèØ‰ª•ÈáçÂÜôËØ•ÊñπÊ≥ïËá™Ë°åÂÆûÁé∞„ÄÇ ÂÖºÂÆπÊÄßÔºö ‰∏∫‰∫ÜÂêëÂêéÂÖºÂÆπÔºå‰ºöÂú®Ê≠•È™§1‰∏≠Êü•ÊâæÂêçÁß∞‰∏∫-_get&lt;Key&gt;, -_&lt;key&gt;ÁöÑÂ≠òÂèñÂô®ÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊâæÂà∞‰∫ÜÔºå‰ºöËøõË°åË∞ÉÁî®Âπ∂ÊåâÁÖßÊ≠•È™§1‰∏≠ÁöÑÁ±ªÂûãËΩ¨Êç¢ËßÑÂàôËøîÂõûË∞ÉÁî®ÁöÑÁªìÊûú„ÄÇ ‰ªéMac OS 10.2ÂºÄÂßãÔºåÊ≠•È™§5‰∏≠ÁöÑÂÆû‰æãÂèòÈáèÊêúÁ¥¢È°∫Â∫è‰ªéÂéüÂÖàÁöÑ&lt;key&gt;, _&lt;key&gt;Êîπ‰∏∫Áé∞Âú®ÁöÑ_&lt;key&gt;, _is&lt;Key&gt;, &lt;key&gt;, is&lt;Key&gt;„ÄÇ Â¶ÇÊûú-handleQueryWithUnboundKey:ÁöÑÂÆûÁé∞‰∏çÊòØNSObjectÁöÑÈªòËÆ§ÂÆûÁé∞ÔºàÊç¢Âè•ËØùËØ¥ÔºåËá™Â∑±ÊâãÂä®ÂÆûÁé∞‰∫Ü-handleQueryWithUnboundKey:ÊñπÊ≥ïÔºâÔºåÈÇ£Âú®Ê≠•È™§6‰∏≠Ôºå-handleQueryWithUnboundKey:ÊñπÊ≥ïÂ∞Ü‰ºö‰ª£Êõø-valueForUndefinedKey:ÊñπÊ≥ïË¢´Ë∞ÉÁî®„ÄÇ ËØ¥ÂæóÊ∏ÖÊô∞Êòé‰∫Ü„ÄÇÊµÅÁ®ãÂõæÂ¶Ç‰∏ãÔºö ÊñπÊ≥ï‰∏Ä- (id)valueForKey:(NSString *)key &#123; if(key) &#123; OSSpinLockLock(&amp;NSKeyValueCachedAccessorSpinLock); // ÂàõÂª∫ÁºìÂ≠ògetterÁöÑCFSetÈõÜÂêàNSKeyValueCachedGetters if(!NSKeyValueCachedGetters) &#123; // CFSetÂØπË±°ÈúÄË¶ÅÁöÑÁªìÊûÑ‰ΩìÂèÇÊï∞, ÂëäËØâËøô‰∏™ÈõÜÂêàÊÄé‰πàÁÆ°ÁêÜÂÆπÂô®‰∏≠ÁöÑÂØπË±° // retain\releaseÊòØÂÜÖÂ≠òÁÆ°ÁêÜ equal\hashÊòØÂØπË±°Â§ÑÁêÜ copyDescriptionÊòØÂ§çÂà∂Â§ÑÁêÜ CFSetCallBacks callbacks = &#123;0&#125;; callbacks.version = kCFTypeSetCallBacks.version; // ‰πüÂèØ‰ª•Á¶ÅÁî®ÊéâretainÂíårelease, ËøôÊ†∑ÂΩìÂØπË±°ÈîÄÊØÅÊó∂ÈúÄË¶ÅÂèäÊó∂Â∞ÜÂÖ∂‰ªéÈõÜÂêà‰∏≠ÁßªÈô§Âê¶Âàô‰ºöÂ¥©Ê∫É // callbacks.retain = NULL; // callbacks.release = NULL; callbacks.retain = kCFTypeSetCallBacks.retain; callbacks.release = kCFTypeSetCallBacks.release; callbacks.copyDescription = kCFTypeSetCallBacks.copyDescription; callbacks.equal = (CFSetEqualCallBack)NSKeyValueAccessorIsEqual; callbacks.hash = (CFSetHashCallBack)NSKeyValueAccessorHash; NSKeyValueCachedGetters = CFSetCreateMutable(NULL,0,&amp;callbacks); &#125; // Ê†πÊçÆclass„ÄÅkeyÂíåhashÂàõÂª∫ÂîØ‰∏ÄÁöÑNSKeyValueGetterÂØπË±°, ‰Ωú‰∏∫‰ªéÁºìÂ≠òÈõÜÂêà‰∏≠Êü•ÊâæÁöÑ"ÂºïÂ≠ê" // Âè™Ë¶ÅhashValue‰∏ÄËá¥, ‰∏çÁÆ°ÂÖ∂‰ªñÂ±ûÊÄßÊòØÂê¶‰∏ÄËá¥, Â∞±ÂèØ‰ª•Âà§ÂÆöËøô‰∏§‰∏™ÂØπË±°ÊòØ‰∏ÄËá¥ÁöÑ // Ëøô‰πüÊòØ‰∏∫Âï•È¶ñÂÖàÊ†πÊçÆclassÂíåkey, ÂàõÂª∫‰∏Ä‰∏™"ÁÆÄÂçï"ÁöÑfinderÂà∞ÁºìÂ≠òÈõÜÂêà‰∏≠Êü•ÊâæÁöÑÂéüÂõ† NSKeyValueGetter *finder = [NSKeyValueGetter new]; finder.containerClassID = object_getClass(self); finder.key = key; finder.hashValue = CFHash(key) ^ (NSUInteger)(object_getClass(self)); // ÁºìÂ≠òÈõÜÂêà‰∏≠ÊòØÂê¶Âê´ÊúâÁâπÂÆöÁöÑNSKeyValueGetter NSKeyValueGetter *getter = CFSetGetValue(NSKeyValueCachedGetters, finder); if (!getter) &#123; // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞, ÂàõÂª∫getter getter = [object_getClass(self) _createValueGetterWithContainerClassID:object_getClass(self) key:key]; // ËøôÈáåÁöÑgetterÁõ∏ÊØî‰∏äÈù¢ÁöÑfinderÊõ¥Âä†ÂÖ∑‰ΩìËØ¶ÁªÜ, ËôΩÁÑ∂Ê†πÊçÆÂìàÂ∏åÊù•ËØ¥, ‰∫åËÄÖÊòØ"Áõ∏ÂêåÁöÑÂØπË±°" // ÂàõÂª∫Â•ΩgetterÂêé, ÊääÂÆÉÊîæÂà∞ÁºìÂ≠òÈõÜÂêà‰∏≠ CFSetAddValue(NSKeyValueCachedGetters, getter); &#125; OSSpinLockUnlock(&amp;NSKeyValueCachedAccessorSpinLock); // ÊâæÂà∞getter, ‰∫§Áªô_NSGetUsingKeyValueGetterÂáΩÊï∞Â§ÑÁêÜ return _NSGetUsingKeyValueGetter(self, getter); &#125; else &#123; // key‰∏∫Á©∫, ÊäõÂá∫ÂºÇÂ∏∏ [NSException raise:NSInvalidArgumentException format:@"%@: attempt to retrieve a value for a nil key",_NSMethodExceptionProem(self,_cmd)]; &#125; return nil;&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏ªË¶ÅÂÅö‰∫ÜÂõõ‰ª∂‰∫ã: ÂèñÂÄºÊó∂Ôºå‰ΩøÁî®OSSpinLockLock‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ® Ê†πÊçÆclassÂíåkeyÔºåÁîüÊàê‰∏Ä‰∏™NSKeyValueGetterÂØπË±°ÔºåÁî®‰∫éÂ∞ÅË£Ö‰ø°ÊÅØ ÂèñÂÄºÊó∂Ôºå‰ºöÊ†πÊçÆclassÂíåkeyÈÖçÁΩÆ‰∏Ä‰∏™ÁÆÄÂçïÁöÑGetterÔºåÈ¶ñÂÖàÂà∞CFSetÁºìÂ≠òÈõÜÂêà‰∏≠ËøõË°åÊü•ÊâæÔºå‰ª•ÊèêÈ´òÊü•ÊâæÈÄüÂ∫¶ ÂΩìkey‰∏çÂ≠òÂú®Êó∂ÔºåÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏: ÂèÇÊï∞ÊúâËØØ ÊñπÊ≥ï‰∫åÂΩìÁºìÂ≠òÈõÜÂêà‰∏≠‰∏çÂ≠òÂú®Êó∂Ôºå‰æøËøõÂÖ•‰∫ÜÊõ¥‰∏∫ÂÖ∑‰ΩìÁöÑ‚ÄùÊü•Êâæ‚ÄùÊµÅÁ®ã‰∏≠„ÄÇ // ËØ¶ÁªÜÁöÑÊü•ÊâæÊµÅÁ®ã(Ê≠§Â§ÑÂÅáÂÆökey‰∏∫"name")+ (NSKeyValueGetter *)_createValueGetterWithContainerClassID:(id)containerClassID key:(NSString *)key &#123; NSKeyValueGetter * getter = nil; // Ëé∑ÂèñÂ≠óËäÇÈïøÂ∫¶ NSUInteger keyLen = [key lengthOfBytesUsingEncoding:NSUTF8StringEncoding]; // Ëøô‰∏™Êï∞ÁªÑÁî®‰∫éÂ≠òÊîæÈ¶ñÂ≠óÁ¨¶Â§ßÂÜôÁöÑkey, ‰æãÂ¶Ç: "Name" char keyCStrUpFirst[keyLen + 1]; // Â∞ÜkeyËΩ¨‰∏∫CÂ≠óÁ¨¶‰∏≤, Â≠òÂÇ®Âú®keyCStrUpFirstÊï∞ÁªÑ‰∏≠ [key getCString:keyCStrUpFirst maxLength:keyLen + 1 encoding:NSUTF8StringEncoding]; if (key.length) &#123; // Â∞ÜÂ∞èÂÜôÂ≠óÊØçËΩ¨‰∏∫Â§ßÂÜôÂ≠óÊØç keyCStrUpFirst[0] = toupper(keyCStrUpFirst[0]); &#125; // Ëøô‰∏™Êï∞ÁªÑÁî®‰∫éÂ≠òÊîæ‰∏ékey‰∏ÄËá¥ÁöÑÂ≠óÁ¨¶, ‰æãÂ¶Ç: "name" char keyCStr[keyLen + 16]; // ÂÜçÂ∞ÜkeyËΩ¨‰∏∫CÂ≠óÁ¨¶‰∏≤, Â≠òÂÇ®Âú®keyCStrÊï∞ÁªÑ‰∏≠ [key getCString:keyCStr maxLength:keyLen + 1 encoding:NSUTF8StringEncoding]; Method getMethod = NULL; // Êü•ËØ¢ÊñπÊ≥ïÊåáÈíà, ‰ΩøÁî®'ÈÄªËæëÊàñ'Âõ∫ÂÆö‰∫ÜÈªòËÆ§È°∫Â∫è:getName==&gt;name==&gt;isName==&gt;_getName==&gt;_name // Ê≠§Â§ÑËØÅÊòé‰∫ÜÊé•Âè£ÊñáÊ°£‰∏≠ÁöÑÁ¨¨‰∏ÄÊ≠• // 1. Whose name matches the pattern -get&lt;Key&gt;, -&lt;key&gt;, or -is&lt;Key&gt;, in that order. // 2. For backward binary compatibility, an accessor method whose name matches the pattern -_get&lt;Key&gt;, or -_&lt;key&gt; is searched for between steps 1 and 3. if((getMethod = NSKeyValueMethodForPattern(self,"get%s",keyCStrUpFirst)) || (getMethod = NSKeyValueMethodForPattern(self,"%s",keyCStr)) || (getMethod = NSKeyValueMethodForPattern(self,"is%s",keyCStrUpFirst)) || (getMethod = NSKeyValueMethodForPattern(self,"_get%s",keyCStrUpFirst)) || (getMethod = NSKeyValueMethodForPattern(self,"_%s",keyCStr))) &#123; // ÊàêÂäüÊâæÂà∞, ÂàõÂª∫NSKeyValueMethodGetterÂØπË±°, ‰øùÂ≠òÊâæÂà∞ÁöÑmethod getter = [[NSKeyValueMethodGetter alloc] initWithContainerClassID:containerClassID key:key method:getMethod]; &#125; else &#123; /* Ê≤°ÊúâÊâæÂà∞, ËøõÂÖ•‰∏ã‰∏™ÊµÅÁ®ã, ÂÅáÂÆökey‰∏∫"name", Âàô: ountOf_Method ÂØπÂ∫î countOfName ObjectIn_AtIndexMethod ÂØπÂ∫î objectInNameAtIndex: _AtIndexesMethod ÂØπÂ∫î nameAtIndexes: IndexIn_OfObjectMethod ÂØπÂ∫î indexInNameOfObject: enumeratorOf_Method ÂØπÂ∫î enumeratorOfName memberOf_Method ÂØπÂ∫î memberOfName: */ Method ountOf_Method = NSKeyValueMethodForPattern(self, "countOf%", keyCStrUpFirst); Method ObjectIn_AtIndexMethod = NSKeyValueMethodForPattern(self, "objectIn%sAtIndex:", keyCStrUpFirst); Method _AtIndexesMethod = NSKeyValueMethodForPattern(self, "%sAtIndexes:", keyCStr); Method IndexIn_OfObjectMethod = NSKeyValueMethodForPattern(self, "indexIn%sOfObject:", keyCStrUpFirst); Method enumeratorOf_Method = NSKeyValueMethodForPattern(self, "enumeratorOf%s", keyCStrUpFirst); Method memberOf_Method = NSKeyValueMethodForPattern(self, "memberOf%s:", keyCStrUpFirst); if(ountOf_Method &amp;&amp; IndexIn_OfObjectMethod &amp;&amp; (ObjectIn_AtIndexMethod || _AtIndexesMethod)) &#123; // Á¨¨‰∫åÊ≠•, ÈíàÂØπNSOrderedSet, ountOf_Method„ÄÅIndexIn_OfObjectMethodÔºå‰ª•ÂèäObjectIn_AtIndexMethodÊàñËÄÖ_AtIndexesMethod‰∏≠ÁöÑ‰∏Ä‰∏™Â≠òÂú®(ÂÆûÁé∞‰ª£ÁêÜÈõÜÂêàÂØπË±°) NSKeyValueNonmutatingOrderedSetMethodSet *methodSet = [[NSKeyValueNonmutatingOrderedSetMethodSet alloc] init]; methodSet.count = ountOf_Method; methodSet.objectAtIndex = ObjectIn_AtIndexMethod; methodSet.indexOfObject = IndexIn_OfObjectMethod; methodSet.objectsAtIndexes = _AtIndexesMethod; // eg: getName:range:ÊñπÊ≥ï(Áî®‰∫éÂ¢ûÂº∫ÊÄßËÉΩ) methodSet.getObjectsRange = NSKeyValueMethodForPattern(self, "get%s:range:", keyCStrUpFirst); // NSKeyValueNonmutatingOrderedSetMethodSetÂ∞±ÊòØ‰∏Ä‰∏™Êã•ÊúâÂá†‰∏™Â±ûÊÄßÁöÑÁÆÄÂçïÁöÑÂØπË±°, Áî®‰∫é‰øùÂ≠òcount„ÄÅobjectAtIndexÁ≠âÊñπÊ≥ïÊåáÈíà‰ø°ÊÅØ // ÊàêÂäüÊâæÂà∞, ÂàõÂª∫NSKeyValueCollectionGetterÂØπË±°, ‰øùÂ≠ò‰øùÂ≠òÂ•ΩÁöÑmethodSetÂØπË±° getter = [[NSKeyValueCollectionGetter alloc] initWithContainerClassID:containerClassID key:key methods:methodSet proxyClass:NSKeyValueOrderedSet.self]; [methodSet release]; &#125; else if(ountOf_Method &amp;&amp; (ObjectIn_AtIndexMethod || _AtIndexesMethod))&#123; // Á¨¨‰∏âÊ≠•, ÈíàÂØπNSArray, ountOf_Method„ÄÅ‰ª•ÂèäObjectIn_AtIndexMethodÊàñËÄÖ_AtIndexesMethod‰∏≠ÁöÑ‰∏Ä‰∏™Â≠òÂú® NSKeyValueNonmutatingArrayMethodSet *methodSet = [[NSKeyValueNonmutatingArrayMethodSet alloc] init]; methodSet.count = ountOf_Method; methodSet.objectAtIndex = ObjectIn_AtIndexMethod; methodSet.objectsAtIndexes = _AtIndexesMethod; methodSet.getObjectsRange = NSKeyValueMethodForPattern(self, "get%s:range:", keyCStrUpFirst); // ÂêåÊ†∑ÁöÑ, ÊàêÂäüÊâæÂà∞, ÂàõÂª∫NSKeyValueCollectionGetterÂØπË±°,‰øùÂ≠òmethodSet getter = [[NSKeyValueCollectionGetter alloc] initWithContainerClassID:containerClassID key:key methods:methodSet proxyClass:NSKeyValueArray.self]; [methodSet release]; &#125; else if(ountOf_Method &amp;&amp; enumeratorOf_Method &amp;&amp; memberOf_Method)&#123; // Á¨¨ÂõõÊ≠•, ÈíàÂØπNSSet, ountOf_Method„ÄÅenumeratorOf_Method‰ª•ÂèämemberOf_Method NSKeyValueNonmutatingSetMethodSet *methodSet = [[NSKeyValueNonmutatingSetMethodSet alloc] init]; methodSet.count = ountOf_Method; methodSet.enumerator = enumeratorOf_Method; methodSet.member = memberOf_Method; getter = [[NSKeyValueCollectionGetter alloc] initWithContainerClassID:containerClassID key:key methods:methodSet proxyClass:NSKeyValueSet.self]; [methodSet release]; &#125; else if([self accessInstanceVariablesDirectly]) &#123; // Á¨¨‰∫îÊ≠•, Â¶ÇÊûúÂÖÅËÆ∏Áõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáè, ‰πüÂç≥accessInstanceVariablesDirectly‰∏∫YES, ÂàôÁõ¥Êé•ÂèñÂá∫ÂÆû‰æãÂèòÈáè // ÈªòËÆ§È°∫Â∫è‰∏∫_name==&gt;_isName==&gt;name==&gt;isName Ivar ivar = NULL; if((ivar = NSKeyValueIvarForPattern(self, "_%s", keyCStr)) || (ivar = NSKeyValueIvarForPattern(self, "_is%s", keyCStrUpFirst)) || (ivar = NSKeyValueIvarForPattern(self, "%s", keyCStr)) || (ivar = NSKeyValueIvarForPattern(self, "is%s", keyCStrUpFirst)) ) &#123; // Ê≠§Êó∂ivarÊúâÂÄº, ÂàõÂª∫NSKeyValueIvarGetter getter = [[NSKeyValueIvarGetter alloc] initWithContainerClassID:containerClassID key:key containerIsa:self ivar:ivar]; &#125; &#125; &#125; if(!getter) &#123; // ÊúÄÂêé, getterÂàõÂª∫Â§±Ë¥•, ËØ¥ÊòéÊñπÊ≥ï„ÄÅÂÆû‰æãÂèòÈáèÊü•ËØ¢Â§±Ë¥•, ËøõÂÖ•‰∏ã‰∏™ÊµÅÁ®ã getter = [self _createValuePrimitiveGetterWithContainerClassID:containerClassID key:key]; &#125; return getter;&#125; Ëøô‰∏™ÊñπÊ≥ïËØ¶ÁªÜÂú∞ËÆæÂÆö‰∫ÜÊü•ÊâæÁöÑÈ°∫Â∫èÔºåÂÄºÂæóÂÖ≥Ê≥®ÁöÑÊòØÔºåNSKeyValueMethodForPattern()Ëøô‰∏™ÂáΩÊï∞Ë∞ÉÁî®ÁöÑÊ¨°Êï∞Áõ∏ÂΩìÁöÑÂ§ö„ÄÇ ÊñπÊ≥ï‰∏â//ÊúÄÂêé‰∏ÄÊ¨°Êü•Êâæ+ (NSKeyValueGetter *)_createValuePrimitiveGetterWithContainerClassID:(id)containerClassID key:(NSString *)key &#123; NSKeyValueGetter *getter = nil; NSUInteger keyCstrLen = [key lengthOfBytesUsingEncoding:NSUTF8StringEncoding]; char keyCstrUpFirst[keyCstrLen + 1]; [key getCString:keyCstrUpFirst maxLength:keyCstrLen + 1 encoding:NSUTF8StringEncoding]; if(key.length) &#123; keyCstrUpFirst[0] = toupper(keyCstrUpFirst[0]); &#125; char keyCstr[keyCstrLen + 1]; [key getCString:keyCstr maxLength:keyCstrLen + 1 encoding:NSUTF8StringEncoding]; Method getMethod = NULL; // ÂêåÊ†∑ÁöÑÂ•óË∑Ø, Êü•ÊâæÈ°∫Â∫è: getPrimitiveName==&gt;primitiveName if((getMethod = NSKeyValueMethodForPattern(self, "getPrimitive%s", keyCstrUpFirst)) || (getMethod = NSKeyValueMethodForPattern(self, "primitive%s", keyCstrUpFirst)) ) &#123; getter = [[NSKeyValueMethodGetter alloc] initWithContainerClassID:containerClassID key:key method:getMethod]; &#125; else if([self accessInstanceVariablesDirectly]) &#123; Ivar ivar = NULL; // Áõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáè // Âú®ÊñπÊ≥ï‰∫å‰∏≠ÊâæËøá‰∏ÄÈÅç‰∫Ü, ‰∏∫Âï•ËøòË¶ÅÂÜçÊâæ‰∏ÄÈÅç? // ËØ¥ÊòéË¶Å‰πàÊòØÊ†πÊú¨Ê≤°ÊúâÊâæÂà∞, Ë¶Å‰πàÊòØËôΩÁÑ∂ÊâæÂà∞‰∫Ü, ‰ΩÜÊòØÂú®ÂàõÂª∫NSKeyValueIvarGetterÊàñËÄÖNSKeyValueMethodGetterÁöÑÊó∂ÂÄôÂ§±Ë¥•‰∫Ü, ÊúÄÁªàÁöÑgetterËøòÊòØnil if ((ivar = NSKeyValueIvarForPattern(self, "_%s", keyCstr)) || (ivar = NSKeyValueIvarForPattern(self, "_is%s", keyCstrUpFirst)) || (ivar = NSKeyValueIvarForPattern(self, "%s", keyCstr)) || (ivar = NSKeyValueIvarForPattern(self, "is%s", keyCstrUpFirst)) ) &#123; getter = [[NSKeyValueIvarGetter alloc] initWithContainerClassID:containerClassID key:key containerIsa:self ivar:ivar]; &#125; &#125; if(!getter) &#123; getter = [self _createOtherValueGetterWithContainerClassID:containerClassID key:key]; &#125; return getter;&#125; ÊñπÊ≥ïÂõõ// ËΩ¨ÂèëÂ§ÑÁêÜÁªôNSKeyValueUndefinedGetterÂØπË±°+ (id)_createOtherValueGetterWithContainerClassID:(id)containerClassID key:(NSString *)key &#123; return [[NSKeyValueUndefinedGetter alloc] initWithContainerClassID:containerClassID key:key containerIsa:self];&#125; ÊñπÊ≥ï‰∫î// NSKeyValueUndefinedGetterË¥üË¥£Ë∞ÉÁî®ÂÖ∂Áà∂Á±ª(NSKeyValueGetter)ÁöÑÊûÑÈÄ†ÊñπÊ≥ï@implementation NSKeyValueUndefinedGetter- (id)initWithContainerClassID:(id)containerClassID key:(NSString *)key containerIsa:(Class)containerIsa &#123; void *arguments[3] = &#123;0&#125;; arguments[0] = key; // Ë∞ÉÁî®valueForUndefinedKeyÊñπÊ≥ï, ËØ•ÊñπÊ≥ïÈªòËÆ§ÂÆûÁé∞ÊäõÂá∫ÂºÇÂ∏∏ return [super initWithContainerClassID:containerClassID key:key implementation:methogetImplementation(class_getInstanceMethod(containerIsa,@selector(valueForUndefinedKey:))) selector:@selector(valueForUndefinedKey:) extraArguments:arguments count:1];&#125;@end ÊñπÊ≥ïÊåáÈíàÊÄé‰πàÊü•Êâæ// NSKeyValueMethodForPatternMethod NSKeyValueMethodForPattern(Class class, const char *pattern,const char *param) &#123; size_t paramLen = strlen(param); size_t patternLen = strlen(pattern); char selName[patternLen + paramLen * 2 + 1]; snprintf(selName, (patternLen + paramLen * 2 + 1), pattern,param,param); // ‰æùËµñRuntimeÁöÑclass_getInstanceMethod return class_getInstanceMethod(class, sel_registerName(selName));&#125; ÂÆû‰æãÂèòÈáèÊÄé‰πàÊü•Êâæ// NSKeyValueIvarForPatternIvar NSKeyValueIvarForPattern(Class class, const char *pattern,const char *param) &#123; size_t paramLen = strlen(param); size_t patternLen = strlen(pattern); char ivarName[paramLen + patternLen + 1]; snprintf(ivarName, paramLen + patternLen + 1, pattern,param); // ‰æùËµñRuntimeÁöÑclass_getInstanceVariable return class_getInstanceVariable(class, ivarName);&#125; NSKeyValueMethodGetterÂ¶Ç‰ΩïÂàõÂª∫1. NSKeyValueMethodGetterÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ÁîüÊàêIMP@implementation NSKeyValueMethodGetter- (id)initWithContainerClassID:(id)containerClassID key:(NSString *)key method:(Method)method &#123; NSUInteger methodArgumentsCount = methogetNumberOfArguments(method); NSUInteger extraAtgumentCount = 1; // ÈªòËÆ§‰∏§‰∏™ÂèÇÊï∞((void (*)(id, SEL))objc_msgSend) if(methodArgumentsCount == 2) &#123; char *returnType = methocopyReturnType(method); IMP imp = NULL; switch (returnType[0]) &#123; case '#': case '@': &#123; // ËøîÂõûÁ±ªÂûãÊòØÂØπË±°Êó∂, Áõ¥Êé•Ëé∑ÂèñmethodÁöÑÂáΩÊï∞ÊåáÈíà // ËøòÊòØ‰ª•key‰∏∫"name"‰∏æ‰æã, ÂàôÊñπÊ≥ï‰∏∫- (NSString *)name; ËøôÈáåÁõ¥Êé•Ëé∑ÂèñÂÖ∂IMP imp = methogetImplementation(method); extraAtgumentCount = 0; &#125; break; case 'B': &#123; /* // Ëé∑ÂèñÂ∞ÜBOOLÁ±ªÂûãËΩ¨‰∏∫NSNumberÂØπË±°Á±ªÂûãÁöÑÂáΩÊï∞ÊåáÈíà NSNumber * _NSGetBoolValueWithMethod(id object, SEL selctor, Method method) &#123; return [[[NSNumber alloc] initWithBool: ((BOOL (*)(id,SEL))methogetImplementation(method))(object, methogetName(method))] autorelease]; &#125; // ÊØîÂ¶Çkey‰∏∫"isMan", ÂàôÊñπÊ≥ï‰∏∫ - (BOOL)iaMan; // Ëé∑ÂèñÁöÑIMP‰æøÊòØÂ∞ÜÊôÆÈÄöBOOLÁ±ªÂûãÂÄºËΩ¨Âåñ‰∏∫NSNumberÁ±ªÂûãÂØπË±°ÁöÑÂáΩÊï∞ÊåáÈíà, ÂÖ∂‰ªñÁ±ª‰ºº */ imp = (IMP)_NSGetBoolValueWithMethod; &#125; break; case 'C': &#123;imp = (IMP)_NSGetUnsignedCharValueWithMethod;&#125; break; case 'I': &#123;imp = (IMP)_NSGetUnsignedIntValueWithMethod;&#125; break; case 'Q': &#123;imp = (IMP)_NSGetUnsignedLongLongValueWithMethod;&#125; break; case 'L': &#123;imp = (IMP)_NSGetUnsignedLongValueWithMethod;&#125; break; case 'S': &#123;imp = (IMP)_NSGetUnsignedShortValueWithMethod;&#125; break; case 'c': &#123;imp = (IMP)_NSGetCharValueWithMethod;&#125; break; case 'd': &#123;imp = (IMP)_NSGetDoubleValueWithMethod;&#125; break; case 'f': &#123;imp = (IMP)_NSGetFloatValueWithMethod;&#125; break; case 'i': &#123;imp = (IMP)_NSGetIntValueWithMethod;&#125; break; case 'l': &#123;imp = (IMP)_NSGetLongValueWithMethod;&#125; break; case 'q': &#123;imp = (IMP)_NSGetLongLongValueWithMethod;&#125; break; case 's': &#123;imp = (IMP)_NSGetShortValueWithMethod;&#125; break; case '&#123;': &#123; if (strcmp(returnType, @encode(CGPoint)) == 0)&#123; imp = (IMP)_NSGetPointValueWithMethod; &#125; else if (strcmp(returnType, @encode(NSRange)) == 0)&#123; imp = (IMP)_NSGetRangeValueWithMethod; &#125; else if (strcmp(returnType, @encode(CGRect)) == 0)&#123; imp = (IMP)_NSGetRectValueWithMethod; &#125; else if (strcmp(returnType, @encode(CGSize)) == 0)&#123; imp = (IMP)_NSGetSizeValueWithMethod; &#125; else &#123; imp = (IMP)_NSGetValueWithMethod; &#125; &#125; break; &#125; free(returnType); if(imp) &#123; void *arguments[3] = &#123;0&#125;; if(extraAtgumentCount &gt; 0) &#123; arguments[0] = method; &#125; // Â∞Üclass key selector imp method ÂèÇÊï∞ ÂèÇÊï∞Êï∞ÈáèÁ≠â‰ø°ÊÅØ‰∫§ÁªôÁà∂Á±ªÂ§ÑÁêÜ return [super initWithContainerClassID:containerClassID key:key implementation:imp selector:methogetName(method) extraArguments:arguments count:extraAtgumentCount]; &#125; else &#123; [self release]; return nil; &#125; &#125; else &#123; [self release]; return nil; &#125;&#125;@end Áî±‰∫éKVCËøîÂõûÁöÑÁ±ªÂûã‰∏∫ÂØπË±°(NSObject)ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂØπÊñπÊ≥ïËøîÂõûÂÄºÁ±ªÂûãÂàÜÂà´ËøõË°åÂà§Êñ≠‰ªéËÄå‰∏∫GetterËµãÂÄº‰∏çÂêåÁöÑÂáΩÊï∞ÊåáÈíà„ÄÇ‰πüÂç≥‰ªéBOOL„ÄÅdouble„ÄÅint„ÄÅCGSizeÁ≠âÊôÆÈÄöÁ±ªÂûãËΩ¨Âåñ‰∏∫NSNumber„ÄÅNSValue„ÄÅidÁ≠âÂØπË±°Á±ªÂûãÁöÑÂáΩÊï∞(ÊåáÈíà)„ÄÇ 2. Âú®Áà∂Á±ªNSKeyValueAccessor‰∏≠, ÂØπclass key selector imp method ÂèÇÊï∞ ÂèÇÊï∞Êï∞ÈáèÁ≠â‰ø°ÊÅØËøõË°å‰øùÂ≠ò@implementation NSKeyValueAccessor- (id)initWithContainerClassID:(id)containerClassID key:(NSString *)key implementation:(IMP)implementation selector:(SEL)selector extraArguments:(void *[3])extraArguments count:(NSUInteger)count &#123; if (self = [super init]) &#123; _containerClassID = containerClassID; _key = key.copy; _implementation = implementation; _selector = selector; NSUInteger hash = 0; if (key) &#123; hash = CFHash(key); &#125; hash ^= (NSUInteger)containerClassID; _hashValue = hash; _extraArgumentCount = count; _extraArgument1 = extraArguments[0]; if (_extraArgument1 == key) &#123; _extraArgument1 = _key; &#125; _extraArgument2 = extraArguments[1]; if (_extraArgument2 == key) &#123; _extraArgument2 = _key; &#125; _extraArgument3 = extraArguments[2]; &#125; return self;&#125;@end NSKeyValueIvarGetterÂ¶Ç‰ΩïÂàõÂª∫- (id)initWithContainerClassID:(id)containerClassID key:(NSString *)key containerIsa:(Class)containerIsa ivar:(Ivar)ivar &#123; const char *ivarEncoding = ivar_getTypeEncoding(ivar); IMP imp = NULL; switch (ivarEncoding[0]) &#123; case '#': case '@': &#123; objc_ivar_memory_management_t mngment = objc_ivar_memoryUnknown;//_class_getIvarMemoryManagement(containerIsa, ivar); if(mngment &lt; objc_ivar_memoryWeak) &#123; /* id _NSGetObjectGetAssignValueInIvar(id object, SEL selector, Ivar ivar) &#123; return *(id *)object_getIvarAddress(object, ivar); &#125; */ imp = (IMP)_NSGetObjectGetAssignValueInIvar; &#125; else if (mngment == objc_ivar_memoryWeak) &#123; /* id _NSGetObjectGetWeakValueInIvar(id object, SEL selector, Ivar ivar) &#123; return objc_loadWeak((id *)object_getIvarAddress(object, ivar)); &#125; */ imp = (IMP)_NSGetObjectGetWeakValueInIvar; &#125; else if(mngment == objc_ivar_memoryUnretained) &#123; imp = (IMP)_NSGetObjectGetAssignValueInIvar; &#125; else &#123; imp = (IMP)_NSGetObjectGetIvarValueInIvar; &#125; &#125; break; case 'C': &#123; /* NSNumber * _NSGetUnsignedCharValueInIvar(id object, SEL selector, Ivar ivar) &#123; unsigned char value = *(unsigned char *)object_getIvarAddress(object, ivar); return [[[NSNumber alloc] initWithUnsignedChar:value] autorelease]; &#125; */ imp = (IMP)_NSGetUnsignedCharValueInIvar; &#125; break; case 'B': &#123;imp = (IMP)_NSGetBoolValueInIvar;&#125;break; case 'I': &#123;imp = (IMP)_NSGetUnsignedIntValueInIvar;&#125;break; case 'L': &#123;imp = (IMP)_NSGetUnsignedLongValueInIvar;&#125;break; case 'Q': &#123;imp = (IMP)_NSGetUnsignedLongLongValueInIvar;&#125;break; case 'S': &#123;imp = (IMP)_NSGetUnsignedShortValueInIvar;&#125; break; case '&#123;': &#123; char* idx = index(ivarEncoding, '='); if (idx == NULL) &#123; imp = (IMP)_NSGetValueInIvar; &#125; else if (strncmp(ivarEncoding, @encode(CGPoint), idx - ivarEncoding) == 0)&#123; imp = (IMP)_NSGetPointValueInIvar; &#125; else if (strncmp(ivarEncoding, @encode(NSRange), idx - ivarEncoding) == 0)&#123; imp = (IMP)_NSGetRangeValueInIvar; &#125; else if (strncmp(ivarEncoding, @encode(CGRect), idx - ivarEncoding) == 0)&#123; imp = (IMP)_NSGetRectValueInIvar; &#125; else if (strncmp(ivarEncoding, @encode(CGSize), idx - ivarEncoding) == 0)&#123; imp = (IMP)_NSGetSizeValueInIvar; &#125; else &#123; imp = (IMP)_NSGetValueInIvar; &#125; &#125; break; case 'c': &#123;imp = (IMP)_NSGetCharValueInIvar;&#125;break; case 'd': &#123;imp = (IMP)_NSGetDoubleValueInIvar;&#125;break; case 'f': &#123;imp = (IMP)_NSGetFloatValueInIvar;&#125;break; case 'i': &#123;imp = (IMP)_NSGetIntValueInIvar;&#125;break; case 'l': &#123;imp = (IMP)_NSGetLongValueInIvar;&#125;break; case 'q': &#123;imp = (IMP)_NSGetLongLongValueInIvar;&#125;break; case 's': &#123;imp = (IMP)_NSGetShortValueInIvar;&#125;break; &#125; if(imp) &#123; void *arguments[3] = &#123;0&#125;; arguments[0] = ivar; return [super initWithContainerClassID:containerClassID key:key implementation:imp selector:NULL extraArguments:arguments count:1]; &#125; else &#123; [self release]; return nil; &#125;&#125; ÂêåÊ†∑Âú∞ÔºåÂà§Êñ≠ÂÆû‰æãÂèòÈáèÁöÑÁ±ªÂûãÁºñÁ†ÅÔºåËøõËÄåËµãÂÄº‰∏çÂêåÁöÑIMP„ÄÇ ÊÄé‰πàÊ†πÊçÆGetterÂèñÂÄº1. Á∫øÁ®ãÊ†°È™åvoid NSKeyValueObservingAssertRegistrationLockNotHeld() &#123; if(_NSKeyValueObserverRegistrationEnableLockingAssertions &amp;&amp; _NSKeyValueObserverRegistrationLockOwner == pthreaself()) &#123; assert(pthreaself() != _NSKeyValueObserverRegistrationLockOwner); &#125;&#125; 2. Áõ¥Êé•Ë∞ÉÁî®Getter‰∏≠Â≠òÂÇ®ÁöÑÊñπÊ≥ïÂÆûÁé∞(getter.implementation)id _NSGetUsingKeyValueGetter(id object, NSKeyValueGetter *getter) &#123; // Á∫øÁ®ãÂà§Êñ≠ NSKeyValueObservingAssertRegistrationLockNotHeld(); // Ê†πÊçÆÂÖ∂‰ªñÂèÇÊï∞Êï∞ÈáèextraArgumentCountÂàÜÂà´ËøõË°åÂáΩÊï∞Ë∞ÉÁî® switch (getter.extraArgumentCount) &#123; case 0: &#123; return ( (id (*)(id,SEL))getter.implementation )(object,getter.selector); &#125; break; case 1: &#123; return ( (id (*)(id,SEL,void*))getter.implementation )(object,getter.selector, getter.extraArgument1); &#125; break; case 2: &#123; return ( (id (*)(id,SEL,void*,void*))getter.implementation )(object,getter.selector, getter.extraArgument1, getter.extraArgument2); &#125; break; case 3: &#123; return ( (id (*)(id,SEL,void*,void*,void*))getter.implementation )(object,getter.selector, getter.extraArgument1, getter.extraArgument2, getter.extraArgument3); &#125; break; default: break; &#125; return nil;&#125; valueForKeyPath:ÂÅáÂÆöËøôÈáåÁöÑkeyPath‰∏∫@&quot;key1.key2.key3.key4&quot;„ÄÇ - (id)valueForKeyPath:(NSString *)keyPath &#123; if(keyPath) &#123; // Â≠óÁ¨¶‰∏≤ÁºñÁ†ÅÂà§Êñ≠ CFStringEncoding encoding = __CFDefaultEightBitStringEncoding; if(encoding == kCFStringEncodingInvalidId) &#123; // ÁºñÁ†ÅÊó†Êïà kCFStringEncodingInvalidIdÂ∞±ÊòØ (0xffffffffU) encoding = __CFStringComputeEightBitStringEncoding(); &#125; // ÂàõÂª∫CÂ≠óÁ¨¶‰∏≤: "key1.key2.key3.key4" const char *cStr = CFStringGetCStringPtr((CFStringRef)keyPath, encoding); if(cStr) &#123; // memchrÂáΩÊï∞:‰ªéÂ§¥ÂºÄÂßãÊêúÂØªs ÊâÄÊåáÁöÑÂÜÖÂ≠òÂÜÖÂÆπÂâçn ‰∏™Â≠óËäÇÔºåÁõ¥Âà∞ÂèëÁé∞Á¨¨‰∏Ä‰∏™ÂÄº‰∏∫c ÁöÑÂ≠óËäÇÔºåÂàôËøîÂõûÊåáÂêëËØ•Â≠óËäÇÁöÑÊåáÈíà // ÊâÄ‰ª•ÊúÄÂêéËé∑ÂèñÂà∞ÂåÖÂê´'ÁÇπÁ¨¶Âè∑'ÁöÑÂêéÈÉ®ÂàÜ Âç≥firstDotPointers‰∏∫ ".key2.key3.key4" const char *firstDotPointer = memchr(cStr, '.', keyPath.length); if(firstDotPointer) &#123; // ËøôÈáåÁöÑsubKeyÊòØ "key1" NSString *subKey = [[keyPath substringWithRange:NSMakeRange(0, firstDotPointer - cStr)] retain]; // ËøôÈáåÁöÑsubKeyPathLeftÊòØ "key2.key3.key4" NSString *subKeyPathLeft = [[keyPath substringWithRange:NSMakeRange(firstDotPointer - cStr + 1, keyPath.length - (firstDotPointer - cStr + 1))] retain]; // ÂÖàËé∑ÂèñÂà∞subKeyÁöÑÁªìÊûú, ÁÑ∂ÂêéÁî®ÂÆÉÁöÑÁªìÊûúÂÜçÊ±ÇsubKeyPathLeft, ËøõÂÖ•ÈÄíÂΩí‰∏≠ id value = [[self valueForKey:subKey] valueForKeyPath:subKeyPathLeft]; [subKey release]; [subKeyPathLeft release]; return value; &#125; else &#123; // firstDotPointer‰∏çÂ≠òÂú®, ËØ¥ÊòékeyPath‰∏≠Ê≤°Êúâ'ÁÇπÁ¨¶Âè∑', ÂàôÁõ¥Êé•Ë∞ÉÁî®valueForKey return [self valueForKey:keyPath]; &#125; &#125; &#125; // Ëµ∞Âà∞ËøôÈáå, ‰∏äÈù¢‰ª£Á†ÅÊ≤°Êúâreturn, ËØ¥ÊòékeyPath‰∏∫nilÊàñËÄÖcStr‰∏∫nil NSRange range = [keyPath rangeOfString:@"." options:NSLiteralSearch range:NSMakeRange(0, keyPath.length)]; if(range.length) &#123; // range.length‰∏ç‰∏∫0, ‰πüÂç≥keyPath‰∏≠Êúâ'ÁÇπÁ¨¶Âè∑' // subKey‰∏∫"key1" NSString *subKey = [[keyPath substringWithRange:NSMakeRange(0, range.location)] retain]; // subKeyPathLeft‰∏∫"key2.key3.key4" NSString *subKeyPathLeft = [[keyPath substringWithRange:NSMakeRange(range.location + 1, keyPath.length - (range.location + 1))] retain]; // ÂêåÊ†∑ÁöÑ, ÂÖàËé∑ÂèñÂà∞subKeyÁöÑÁªìÊûú, ÁÑ∂ÂêéÁî®ÂÆÉÁöÑÁªìÊûúÂÜçÊ±ÇsubKeyPathLeft, ËøõÂÖ•ÈÄíÂΩí‰∏≠ id value = [[self valueForKey:subKey] valueForKeyPath:subKeyPathLeft]; [subKey release]; [subKeyPathLeft release]; return value; &#125; else &#123; // keyPath‰∏∫nilÊàñËÄÖkeyPath‰∏≠Ê≤°Êúâ'ÁÇπÁ¨¶Âè∑', Áõ¥Êé•Ë∞ÉÁî®valueForKey return [self valueForKey:keyPath]; &#125;&#125; ËøôÈáåÂ∞±Êúâ‰∏Ä‰∏™ÈóÆÈ¢ò‰∫ÜÔºåÁõ∏‰ººÁöÑÊääkeyPathÊãÜÂàÜÈÄªËæëÁöÑÈÄªËæë‰∏∫Âï•Ë¶ÅÂÜô‰∏§‰∏™Ôºå‰∏Ä‰∏™ËΩ¨‰∏∫CÂ≠óÁ¨¶‰∏≤ÊãÜÂàÜÔºå‰∏Ä‰∏™Áõ¥Êé•ÊãÜÂàÜ? Êè£Êµã‰∏§ËÄÖÁöÑÂå∫Âà´‰∏ªË¶ÅÊòØÂØπÂ≠óÁ¨¶‰∏≤ÁºñÁ†ÅÁöÑÂà§Êñ≠„ÄÇ ‰∏â„ÄÅËÆæÂÄºËÆæÂÄºÁöÑÊµÅÁ®ãÂ∞±ÊØîËæÉÁÆÄÂçï‰∫Ü„ÄÇ The default implementation of this method does the following: Searches the class of the receiver for an accessor method whose name matches the pattern -set&lt;Key&gt;:. If such a method is found the type of its parameter is checked. If the parameter type is not an object pointer type but the value is nil -setNilValueForKey: is invoked. The default implementation of -setNilValueForKey: raises an NSInvalidArgumentException, but you can override it in your application. Otherwise, if the type of the method‚Äôs parameter is an object pointer type the method is simply invoked with the value as the argument. If the type of the method‚Äôs parameter is some other type the inverse of the NSNumber/NSValue conversion done by -valueForKey: is performed before the method is invoked. Otherwise (no accessor method is found), if the receiver‚Äôs class‚Äô +accessInstanceVariablesDirectly property returns YES, searches the class of the receiver for an instance variable whose name matches the pattern _&lt;key&gt;, _is&lt;Key&gt;, &lt;key&gt;, or is&lt;Key&gt;, in that order. If such an instance variable is found and its type is an object pointer type the value is retained and the result is set in the instance variable, after the instance variable‚Äôs old value is first released. If the instance variable‚Äôs type is some other type its value is set after the same sort of conversion from NSNumber or NSValue as in step 1. Otherwise (no accessor method or instance variable is found), invokes -setValue:forUndefinedKey:. The default implementation of -setValue:forUndefinedKey: raises an NSUndefinedKeyException, but you can override it in your application. Compatibility notes: For backward binary compatibility with -takeValue:forKey:‚Äòs behavior, a method whose name matches the pattern -_set&lt;Key&gt;: is also recognized in step 1. KVC accessor methods whose names start with underscores were deprecated as of Mac OS 10.3 though. For backward binary compatibility, -unableToSetNilForKey: will be invoked instead of -setNilValueForKey: in step 1, if the implementation of -unableToSetNilForKey: in the receiver‚Äôs class is not NSObject‚Äôs. The behavior described in step 2 is different from -takeValue:forKey:‚Äòs, in which the instance variable search order is &lt;key&gt;, _&lt;key&gt;. For backward binary compatibility with -takeValue:forKey:‚Äòs behavior, -handleTakeValue:forUnboundKey: will be invoked instead of -setValue:forUndefinedKey: in step 3, if the implementation of -handleTakeValue:forUnboundKey: in the receiver‚Äôs class is not NSObject‚Äôs. ÁøªËØëÂ¶Ç‰∏ãÔºöËøô‰∏™ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØËøôÊ†∑ÁöÑÔºö ÊêúÁ¥¢ËØ•Á±ªÂêçÁß∞‰∏∫-set&lt;Key&gt;:ÁöÑÂ≠òÂèñÂô®ÊñπÊ≥ïÔºåÂ¶ÇÊûúÊâæÂà∞ÔºåÊ£ÄÊü•ÂÖ∂ÂèÇÊï∞Á±ªÂûã„ÄÇÂ¶ÇÊûúÂèÇÊï∞‰∏∫nilÔºå-setNilValueForKey:ÊñπÊ≥ïÂ∞Ü‰ºöË¢´Ë∞ÉÁî®„ÄÇËøô‰∏™ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØÊäõÂá∫NSInvalidArgumentExceptionÂºÇÂ∏∏Ôºå‰∏çËøá‰Ω†ÂèØ‰ª•ÈáçÂÜôËØ•ÊñπÊ≥ïËá™Ë°åÂÆûÁé∞„ÄÇÂ¶ÇÊûúÂèÇÊï∞Á±ªÂûã‰∏∫ÂØπË±°Á±ªÂûãÔºåËØ•Â≠òÂèñÂô®ÊñπÊ≥ï‰ºöË¢´Áõ¥Êé•Ë∞ÉÁî®ÔºåËøô‰∏™ÂèÇÊï∞‰πü‰ºöË¢´Áõ¥Êé•‰ΩøÁî®„ÄÇÂ¶ÇÊûúÂèÇÊï∞ËÉΩË¢´ËΩ¨Âåñ‰∏∫NSNumber/NSValueÁ±ªÂûãÔºåÂèÇÊï∞‰ºöÂú®Â≠òÂèñÂô®ÊñπÊ≥ïË¢´Ë∞ÉÁî®‰πãÂâçËøõË°åËΩ¨Êç¢„ÄÇ Â¶ÇÊûúÂ≠òÂèñÂô®ÊñπÊ≥ïÊ≤°ÊúâË¢´ÊâæÂà∞ÔºåÂÄòËã•Ê≠§Êó∂Ê∂àÊÅØÊé•Êî∂ËÄÖÁöÑ+accessInstanceVariablesDirectlyÂ±ûÊÄßËøîÂõûÁöÑÊòØYESÔºåÈÇ£‰πàÊåâÁÖß_&lt;key&gt;, _is&lt;Key&gt;, &lt;key&gt;, is&lt;Key&gt;ÁöÑÈ°∫Â∫èÊêúÁ¥¢ËØ•Á±ªÁöÑÂÆû‰æãÂèòÈáè„ÄÇÂ¶ÇÊûúÊâæÂà∞Ëøô‰∏™ÂÆû‰æãÂèòÈáèÔºåÂΩìÂÖ∂‰∏∫ÂØπË±°Á±ªÂûãÊó∂ÔºåËØ•ÂÆû‰æãÂèòÈáè‰ºöÂú®ÊóßÂÄºÈáäÊîæ‰πãÂêéË¢´ËÆæÁΩÆÊñ∞ÂÄº„ÄÇÂΩìÂÖ∂‰∏∫ÂÖ∂‰ªñÁ±ªÂûãÊó∂ÔºåÈÇ£‰πàÊåâÁÖßÊ≠•È™§1‰∏≠ÁöÑÁ±ªÂûãËΩ¨Êç¢ËßÑÂàôËÆæÁΩÆËøô‰∏™ÂÆû‰æãÂèòÈáèÁöÑÂÄº„ÄÇ Â¶ÇÊûúÂ≠òÂèñÂô®ÊñπÊ≥ïÂíåÂÆû‰æãÂèòÈáèÈÉΩÊ≤°ÊúâË¢´ÊâæÂà∞Ôºå-setValue:forUndefinedKey:ÊñπÊ≥ïÂ∞Ü‰ºöË¢´Ë∞ÉÁî®„ÄÇËøô‰∏™ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØÊäõÂá∫NSUndefinedKeyExceptionÂºÇÂ∏∏Ôºå‰∏çËøá‰Ω†ÂèØ‰ª•ÈáçÂÜôËØ•ÊñπÊ≥ïËá™Ë°åÂÆûÁé∞„ÄÇ ÂÖºÂÆπÊÄßÔºö ‰∏∫‰∫ÜÂêëÂêéÂÖºÂÆπ-takeValue:forKey:ÔºåÂêçÁß∞‰∏∫-_set&lt;Key&gt;:ÁöÑÊñπÊ≥ï‰πü‰ºöÂú®Ê≠•È™§1‰∏≠Ë¢´Êü•Êâæ„ÄÇ Â¶ÇÊûú-unableToSetNilForKey:ÁöÑÂÆûÁé∞‰∏çÊòØNSObjectÁöÑÈªòËÆ§ÂÆûÁé∞ÔºàÊç¢Âè•ËØùËØ¥ÔºåËá™Â∑±ÊâãÂä®ÂÆûÁé∞‰∫Ü-unableToSetNilForKey:ÊñπÊ≥ïÔºâÔºåÈÇ£Âú®Ê≠•È™§1‰∏≠Ôºå-unableToSetNilForKey:ÊñπÊ≥ïÂ∞Ü‰ºö‰ª£Êõø-setNilValueForKey:ÊñπÊ≥ïË¢´Ë∞ÉÁî®„ÄÇ ÂØπ‰∫é-takeValue:forKey:ÔºåÂÖ∂ÂÆû‰æãÂèòÈáèÁöÑÊü•ÊâæÈ°∫Â∫è‰∏çÂêå‰∫éÊ≠•È™§2ÊâÄÊèèËø∞ÁöÑÔºåË∞ÉÁî®ÂÆÉÊó∂ÔºåÂÆû‰æãÂèòÈáèÊü•ÊâæÈ°∫Â∫èÊòØ&lt;key&gt;, _&lt;key&gt;„ÄÇ ‰∏∫‰∫ÜÂêëÂêéÂÖºÂÆπ-takeValue:forKey:ÔºåÂ¶ÇÊûú-handleTakeValue:forUnboundKey:ÁöÑÂÆûÁé∞‰∏çÊòØNSObjectÁöÑÈªòËÆ§ÂÆûÁé∞ÔºàÊç¢Âè•ËØùËØ¥ÔºåËá™Â∑±ÊâãÂä®ÂÆûÁé∞‰∫Ü-handleTakeValue:forUnboundKey:ÊñπÊ≥ïÔºâÔºåÈÇ£Âú®Ê≠•È™§3‰∏≠Ôºå-handleTakeValue:forUnboundKey:ÊñπÊ≥ïÂ∞Ü‰ºö‰ª£Êõø-setValue:forUndefinedKey:ÊñπÊ≥ïË¢´Ë∞ÉÁî®„ÄÇ ÊµÅÁ®ãÂõæÂ¶Ç‰∏ãÔºö setValue:ÊñπÊ≥ï‰∏ÄËøôÈáå‰ΩøÁî®NSKeyValueCachedSettersÁºìÂ≠òsetter„ÄÇ // ÂÅáÂÆökey‰∏∫@"name"- (void)setValue:(id)value forKey:(NSString *)key &#123; if (key) &#123; // Âä†ÈîÅ OSSpinLockLock(&amp;NSKeyValueCachedAccessorSpinLock); if (!NSKeyValueCachedSetters) &#123; CFSetCallBacks callbacks = &#123;0&#125;; callbacks.version = kCFTypeSetCallBacks.version; callbacks.retain = kCFTypeSetCallBacks.retain; callbacks.release = kCFTypeSetCallBacks.release; callbacks.copyDescription = kCFTypeSetCallBacks.copyDescription; callbacks.equal = (CFSetEqualCallBack)NSKeyValueAccessorIsEqual; callbacks.hash = (CFSetHashCallBack)NSKeyValueAccessorHash; NSKeyValueCachedSetters = CFSetCreateMutable(NULL,0,&amp;callbacks); &#125; NSKeyValueSetter *finder = [NSKeyValueSetter new]; finder.containerClassID = object_getClass(self); finder.key = key; finder.hashValue = CFHash((CFTypeRef)key) ^ (NSUInteger)(object_getClass(self)); // ÁºìÂ≠ò‰∏≠ÂèñSetter NSKeyValueSetter *setter = CFSetGetValue(NSKeyValueCachedSetters, (void *)finder); if (!setter) &#123; setter = [object_getClass(self) _createValueSetterWithContainerClassID:object_getClass(self) key:key]; CFSetAddValue(NSKeyValueCachedSetters, (void*)setter); &#125; // Ëß£ÈîÅ OSSpinLockUnlock(&amp;NSKeyValueCachedAccessorSpinLock); // ËÆæÂÄº _NSSetUsingKeyValueSetter(self,setter, value); &#125; else &#123; [NSException raise:NSInvalidArgumentException format:@"%@: attempt to set a value for a nil key",_NSMethodExceptionProem(self,_cmd)]; &#125;&#125; ÊñπÊ≥ï‰∫å+ (NSKeyValueSetter *)_createValueSetterWithContainerClassID:(id)containerClassID key:(NSString *)key &#123; NSKeyValueSetter *setter = nil; NSUInteger key_cstr_len = [key lengthOfBytesUsingEncoding:NSUTF8StringEncoding]; // È¶ñÂ≠óÁ¨¶Â§ßÂÜôÁöÑkey char key_cstr_upfirst[key_cstr_len + 1]; [key getCString:key_cstr_upfirst maxLength:key_cstr_len + 1 encoding:NSUTF8StringEncoding]; if (key.length) &#123; key_cstr_upfirst[0] = toupper(key_cstr_upfirst[0]); &#125; // ÂéüÊù•ÁöÑkey char key_cstr[key_cstr_len + 1]; [key getCString:key_cstr maxLength:key_cstr_len + 1 encoding:NSUTF8StringEncoding]; Method method = NULL; // Êü•ÊâæÊñπÊ≥ïÈ°∫Â∫è, ÂÅáÂÆökey‰∏∫@"name" // setName: ==&gt; _setName: ==&gt; setIsName: if ((method = NSKeyValueMethodForPattern(self, "set%s:", key_cstr_upfirst)) || (method = NSKeyValueMethodForPattern(self, "_set%s:", key_cstr_upfirst)) || (method = NSKeyValueMethodForPattern(self, "setIs%s:", key_cstr_upfirst)) ) &#123; setter = [[NSKeyValueMethodSetter alloc] initWithContainerClassID:containerClassID key:key method:method]; &#125; else if ([self accessInstanceVariablesDirectly]) &#123; Ivar ivar = NULL; // ÂÖÅËÆ∏Áõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáè, Êü•ÊâæÈ°∫Â∫è‰∏∫: _name ==&gt; _isName ==&gt; name ==&gt; isName if ((ivar = NSKeyValueIvarForPattern(self, "_%s", key_cstr)) || (ivar = NSKeyValueIvarForPattern(self, "_is%s", key_cstr_upfirst)) || (ivar = NSKeyValueIvarForPattern(self, "%s", key_cstr)) || (ivar = NSKeyValueIvarForPattern(self, "is%s", key_cstr_upfirst)) ) &#123; setter = [[NSKeyValueIvarSetter alloc] initWithContainerClassID:containerClassID key:key containerIsa:self ivar:ivar]; &#125; &#125; if (!setter) &#123; setter = [self _createValuePrimitiveSetterWithContainerClassID:containerClassID key:key]; &#125; return setter;&#125; ÊñπÊ≥ï‰∏â+ (NSKeyValueSetter *)_createValuePrimitiveSetterWithContainerClassID:(id)containerClassID key:(NSString *)key &#123; NSKeyValueSetter *setter = nil; NSUInteger keyCstrLen = [key lengthOfBytesUsingEncoding:NSUTF8StringEncoding]; char keyCstrUpFirst[keyCstrLen + 1]; [key getCString:keyCstrUpFirst maxLength:keyCstrLen + 1 encoding:NSUTF8StringEncoding]; if(key.length) &#123; keyCstrUpFirst[0] = toupper(keyCstrUpFirst[0]); &#125; char keyCstr[keyCstrLen + 1]; [key getCString:keyCstr maxLength:keyCstrLen + 1 encoding:NSUTF8StringEncoding]; // ÂÅáÂÆökey‰∏∫@"name", Êü•ËØ¢ setPrimitiveName:ÊñπÊ≥ï Method method = NSKeyValueMethodForPattern(self,"setPrimitive%s:",keyCstrUpFirst); if(method) &#123; setter = [[NSKeyValueMethodSetter alloc] initWithContainerClassID:containerClassID key:key method:method]; &#125; else &#123; if([self accessInstanceVariablesDirectly]) &#123; Ivar ivar = NULL; if ((ivar = NSKeyValueIvarForPattern(self, "_%s", keyCstr)) || (ivar = NSKeyValueIvarForPattern(self, "_is%s", keyCstrUpFirst)) || (ivar = NSKeyValueIvarForPattern(self, "%s", keyCstr)) || (ivar = NSKeyValueIvarForPattern(self, "is%s", keyCstrUpFirst)) ) &#123; setter = [[NSKeyValueIvarSetter alloc] initWithContainerClassID:containerClassID key:key containerIsa:self ivar:ivar]; &#125; &#125; &#125; if(!setter) &#123; setter = [self _createOtherValueSetterWithContainerClassID:containerClassID key:key]; &#125; return setter;&#125; ÊñπÊ≥ïÂõõ+ (NSKeyValueSetter *)_createOtherValueSetterWithContainerClassID:(id)containerClassID key:(NSString *)key &#123; return [[NSKeyValueUndefinedSetter alloc] initWithContainerClassID:containerClassID key:key containerIsa:self];&#125; ÊÄé‰πàÊ†πÊçÆSetterËÆæÂÄºvoid _NSSetUsingKeyValueSetter(id object, NSKeyValueSetter *setter, id value) &#123; switch (setter.extraArgumentCount) &#123; case 0: &#123; ( (id (*)(id,SEL,id))setter.implementation )(object,setter.selector,value); &#125; break; case 1: &#123; ( (id (*)(id,SEL,id,void*))setter.implementation )(object,setter.selector, value, setter.extraArgument1); &#125; break; case 2: &#123; ( (id (*)(id,SEL,id,void*,void*))setter.implementation )(object,setter.selector, value, setter.extraArgument1, setter.extraArgument2); &#125; break; case 3: &#123; ( (id (*)(id,SEL,id,void*,void*,void*))setter.implementation )(object,setter.selector, value, setter.extraArgument1, setter.extraArgument2, setter.extraArgument3); &#125; break; default: break; &#125;&#125; Áõ¥Êé•Ë∞ÉÁî®Setter‰∏≠Â≠òÂÇ®ÁöÑÊñπÊ≥ïÂÆûÁé∞(getter.implementation)„ÄÇ setValue:forKeyPath:- (void)setValue:(id)value forKeyPath:(NSString *)keyPath &#123; if(keyPath) &#123; CFStringEncoding encoding = __CFDefaultEightBitStringEncoding; if(encoding == kCFStringEncodingInvalidId) &#123; encoding = __CFStringComputeEightBitStringEncoding(); &#125; const char *keyPathCStr = CFStringGetCStringPtr((CFStringRef)keyPath, encoding); if(keyPathCStr) &#123; const char *firstDotPointer = memchr(keyPathCStr, '.', keyPath.length); if(firstDotPointer) &#123; NSString *subKey = [[keyPath substringWithRange:NSMakeRange(0, firstDotPointer - keyPathCStr)] retain]; NSString *subKeyPathAfterDot = [[keyPath substringWithRange:NSMakeRange(firstDotPointer - keyPathCStr + 1, keyPath.length - (firstDotPointer - keyPathCStr + 1))] retain]; [[self valueForKey:subKey] setValue:value forKeyPath:subKeyPathAfterDot]; [subKey release]; [subKeyPathAfterDot release]; &#125; else &#123; [self setValue:value forKey:keyPath]; &#125; &#125; &#125; NSRange dotRange = [keyPath rangeOfString:@"." options:NSLiteralSearch range:NSMakeRange(0, keyPath.length)]; if(dotRange.length) &#123; NSString *subKey = [[keyPath substringWithRange:NSMakeRange(0, dotRange.location)] retain]; NSString *subKeyPathAfterDot = [[keyPath substringWithRange:NSMakeRange(dotRange.location + 1, keyPath.length - (dotRange.location + 1))] retain]; [[self valueForKey:subKey] setValue:value forKeyPath:subKeyPathAfterDot]; [subKey release]; [subKeyPathAfterDot release]; &#125; else &#123; [self setValue:value forKey:keyPath]; &#125;&#125; Âü∫Êú¨ÊòØ‰∏éÂèñÂÄºÁ±ª‰ººÁöÑÈÄªËæë„ÄÇ Âõõ„ÄÅÈõÜÂêàÂØπË±°ÁöÑKVCNSArrayÁöÑKVCÊé•Âè£@interface NSArray (NSKeyValueCoding)// ËøîÂõûArrayÂÜÖÊØè‰∏™ÂØπË±°ÁöÑ‚Äúkey‚ÄùÂØπÂ∫îÂÄºÁªÑÊàêÁöÑÊï∞ÁªÑ- (id)valueForKey:(NSString *)key;// Â¶ÇÊûúkeyPath‰∏≠ÂåÖÂê´ÈõÜÂêàËøêÁÆóÁ¨¶, ÂàôËøîÂõûËøêÁÆóÁªìÊûú, Âê¶ÂàôËøîÂõûArrayÂÜÖÊØè‰∏™ÂØπË±°ÁöÑ‚ÄúkeyPath‚ÄùÂØπÂ∫îÂÄºÁªÑÊàêÁöÑÊï∞ÁªÑ- (id)valueForKeyPath:(NSString *)keyPath;// ËÆæÁΩÆArrayÈáåÊØè‰∏™ÂØπË±°ÁöÑkeyÂØπÂ∫îÂÄº‰∏∫value- (void)setValue:(id)value forKey:(NSString *)key;@end ÂÆûÁé∞- (id)valueForKey:(NSString *)key &#123; NSString *operationKey = nil; // ÈõÜÂêàËøêÁÆóÁ¨¶:Â¶Ç@count, @firstObject, @lastObjectÁ≠â if (key.length &amp;&amp; [key characterAtIndex:0] == '@' &amp;&amp; (operationKey = [key substringWithRange:NSMakeRange(1, key.length - 1)])) &#123; // ÂéªÊéâ'@'‰æøÊòØoperationKey id value = [super valueForKey:operationKey]; return value; &#125; else &#123; // ÂàõÂª∫‰∏éËá™Ë∫´Áõ∏Á≠âÊï∞ÈáèÁöÑarray id *objectsBuff = NSAllocateObjectArray(self.count); // Áé∞Âú®, ÊåáÈíàp‰∏éÊåáÈíàobjectsBuffÊåáÂêë‰∏ÄËá¥ id *p = objectsBuff; // ÈÅçÂéÜËá™Ë∫´ for (id object in self) &#123; // ÂèñÂá∫ÂÆπÂô®‰∏≠ÁöÑÂÖÉÁ¥†ÂØπÂ∫îÁöÑvalue id eachValue = [object valueForKey:key]; // Â¶ÇÊûúeachValue‰∏çÂ≠òÂú®, ÂàôpÁöÑnextÊåáÈíàÊåáÂêëÁöÑÂØπË±°ËÆæÁΩÆÊàê NSNullÂÆû‰æãÂØπË±° // Â¶ÇÊûúeachValueÊúâÂÄº, ÂàôpÁöÑnextÊåáÈíàÊåáÂêëÁöÑÂØπË±°ËÆæÁΩÆ‰∏∫eachValue *(p++) = (eachValue ? : [NSNull null]); &#125; // Ê†πÊçÆobjectsBuffÂàõÂª∫‰∏Ä‰∏™Êï∞ÁªÑ, Ëøô‰∏™objectsBuffÂ∞±ÊòØ'eachValue'ÁöÑÈõÜÂêà // ‰πüÂç≥ÂÅáÂÆökey‰∏∫@"name", ÈÅçÂéÜÂÆπÂô®‰∏≠ÊâÄÊúâÂÖÉÁ¥†, ÂèñÂá∫ÊØè‰∏™ÂÖÉÁ¥†key‰∏∫@"name"ÂØπÂ∫îÁöÑÂÄº, Ëøô‰∫õÂÄºÁöÑÈõÜÂêàÂ∞±ÊòØÊï∞ÁªÑarrayValue NSArray *arrayValue = [[[NSArray alloc] initWithObjects:objectsBuff count:self.count] autorelease]; // ÈáäÊîæobjectsBuff NSFreeObjectArray(objectsBuff); return arrayValue; &#125;&#125;- (id)valueForKeyPath:(NSString *)keyPath &#123; // ÈõÜÂêàËøêÁÆóÁ¨¶: Â¶Ç@count, @firstObject, @"@unionOfObjects.friend.name"Á≠â // ËøôÈáå‰ª• @"@unionOfObjects.friend"‰∏∫‰æã if(keyPath.length &amp;&amp; [keyPath characterAtIndex:0] == '@') &#123; // ËØ¥ÊòékeyPath‰∏≠Êúâ'@Á¨¶Âè∑', ‰∏î'@Á¨¶Âè∑'Âú®Á¨¨0‰∏™‰ΩçÁΩÆÂ§Ñ NSRange dotRange = [keyPath rangeOfString:@"." options:NSLiteralSearch range:NSMakeRange(0, keyPath.length)]; if(dotRange.length) &#123; // dotRange.length‰∏ç‰∏∫0, ËØ¥ÊòékeyPath‰∏≠Êúâ'@Á¨¶Âè∑', ËÄå‰∏îËøòÊúâ'ÁÇπÁ¨¶Âè∑' // ÂèñÂá∫ÂåÖÂê´ËøêÁÆóÁ¨¶ÁöÑÈÇ£ÈÉ®ÂàÜ,Â¶Ç @"unionOfObjects" NSString *operator = [keyPath substringWithRange:NSMakeRange(0, dotRange.location)]; // ÂèñÂá∫Èô§ËøêÁÆóÁ¨¶‰πãÂ§ñÁöÑÈÇ£ÈÉ®ÂàÜ,Â¶Ç @"friend" NSString *keyPathForOperator = [keyPath substringWithRange:NSMakeRange(dotRange.location + 1, keyPath.length - (dotRange.location + 1))]; if(keyPathForOperator) &#123; // ËØ¥ÊòéÂê´ËøêÁÆóÁ¨¶ÁöÑÈÇ£ÈÉ®ÂàÜÂ¶Ç @"unionOfObjects" ÂíåÈô§ËøêÁÆóÁ¨¶‰πãÂ§ñÁöÑÈÇ£ÈÉ®ÂàÜÂ¶Ç @"friend" ÈÉΩÂ≠òÂú® NSUInteger operatorCStrLength = [operator lengthOfBytesUsingEncoding:NSUTF8StringEncoding]; char operatorCStr[operatorCStrLength + 1]; // ËΩ¨‰∏∫CÂ≠óÁ¨¶‰∏≤operatorCStr, ‰πüÂç≥ @"unionOfObjects" ËΩ¨‰∏∫ "unionOfObjects" [operator getCString:operatorCStr maxLength:operatorCStrLength + 1 encoding:NSUTF8StringEncoding]; // Êü•ÊâæÊñπÊ≥ï, Âç≥: "unionOfObjectsForKeyPath:" Method operatorMethod = NSKeyValueMethodForPattern(self.class, "%sForKeyPath:", operatorCStr); if(!operatorMethod) &#123; // ‰∏äÈù¢ÁöÑÊñπÊ≥ïÊ≤°ÊâæÂà∞, Â∞±Êü•ÊâæÂ∏¶‰∏ãÂàíÁ∫øÁöÑÈÇ£‰∏™: "_unionOfObjectsForKeyPath:" operatorMethod = NSKeyValueMethodForPattern(self.class, "_%sForKeyPath:", operatorCStr); &#125; if (operatorMethod) &#123; // Êü•ÊâæÊàêÂäü, Ë∞ÉÁî®ËøêÁÆóÁ¨¶ÂØπÂ∫îÁöÑÊñπÊ≥ï id value = ((id (*)(id,Method,NSString *))methoinvoke)(self,operatorMethod,keyPathForOperator); return value; &#125; else &#123; // Ê≤°ÊúâÊâæÂà∞, ËØ¥ÊòéÊòØ‰∏çÊîØÊåÅÁöÑËøêÁÆóÁ¨¶ [NSException raise:NSInvalidArgumentException format:@"[&lt;%@ %p&gt; valueForKeyPath:]: this class does not implement the %@ operation.", self.class,self,operator]; return nil; &#125; &#125; else &#123; // ËØ¥ÊòéÂè™ÊúâÂåÖÂê´ËøêÁÆóÁ¨¶ÁöÑÈÇ£ÈÉ®ÂàÜÂ¶Ç @"friend", Ëµ∞NSObjectÁöÑvalueForKeyÈÄªËæë id value = [super valueForKey:operator]; return value; &#125; &#125; else &#123; // keyPath‰∏≠Êúâ'@Á¨¶Âè∑', ‰ΩÜÊòØÊ≤°Êúâ'ÁÇπÁ¨¶Âè∑', ÂèñÂá∫Èô§'@Á¨¶Âè∑'‰πãÂ§ñÁöÑkey NSString *key = [[keyPath substringWithRange:NSMakeRange(1, keyPath.length - 1)] retain]; // Ëµ∞NSObjectÁöÑvalueForKeyÈÄªËæë id value = [super valueForKey:key]; return value; &#125; &#125; else &#123; // Ê≤°Êúâ'@Á¨¶Âè∑',ÂèØËÉΩÊúâ'ÁÇπÁ¨¶Âè∑', Ëµ∞NSObjectÁöÑvalueForKeyPathÈÄªËæë return [super valueForKeyPath: keyPath]; &#125;&#125;- (void)setValue:(id)value forKey:(NSString *)key &#123; for (id object in self) &#123; // ÂØπÂÆπÂô®ÂÜÖÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩËÆæÂÄº [object setValue:value forKey:key]; &#125;&#125; Ê±ÇÂíå// @sum.keyPath, ‰æãÂ¶Ç @"@sum.price", ‰º†ÈÄíÂà∞Ëøô‰∏™ÊñπÊ≥ï‰∏≠, ÂèÇÊï∞keyPath‰∏∫@"price"- (NSNumber *)_sumForKeyPath:(NSString *)keyPath &#123; NSDecimal resultDecimal = &#123;0&#125;; NSDecimalNumber *zero = [NSDecimalNumber zero]; if (zero) resultDecimal = [zero decimalValue]; // ËøôÈáå‰ΩøÁî®NSDecimalNumber ‰øùËØÅÁ≤æÁ°ÆÂ∫¶ NSDecimal eachDecimal = &#123;0&#125;; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; // Ëé∑ÂèñÊØè‰∏™ÂØπË±°ÁöÑkeyPath(Â¶Ç@"price")ÂØπÂ∫îÂÄº id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; eachDecimal = [eachValue decimalValue]; // Á¥ØÂä† NSDecimalAdd(&amp;resultDecimal, &amp;resultDecimal, &amp;eachDecimal, NSRoundBankers); &#125; &#125; return [NSDecimalNumber decimalNumberWithDecimal:resultDecimal];&#125; Ê±ÇÂπ≥ÂùáÂÄº// ÂØπ Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÂÄº Ê±ÇÂπ≥ÂùáÂÄº// @avg.keyPath- (NSNumber *)_avgForKeyPath:(NSString *)keyPath &#123; if (self.count) &#123; //ÊÄªÂíå / ÂØπË±°Êï∞ return [(NSDecimalNumber*)[self _sumForKeyPath:keyPath] decimalNumberByDividingBy:(NSDecimalNumber*)[NSDecimalNumber numberWithUnsignedInteger:self.count]]; &#125; return 0;&#125; Ê±ÇÊï∞Èáè// Ëé∑ÂèñÂØπË±°Êï∞ÁõÆ// @count- (NSNumber *)_countForKeyPath:(NSString *)keyPath &#123; return [NSNumber numberWithInteger:self.count];&#125; Ê±ÇÊúÄÂ§ßÂÄº// ÂØπ Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÂÄº Ê±ÇÊúÄÂ§ßÂÄº// @max.keyPath- (id)_maxForKeyPath:(NSString *)keyPath &#123; id maxValue = nil; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; if (!maxValue) &#123; maxValue = eachValue; &#125; else if ([maxValue compare:eachValue] == NSOrderedAscending)&#123; maxValue = eachValue; &#125; &#125; &#125; return maxValue;&#125; Ê±ÇÊúÄÂ∞èÂÄº// ÂØπ Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÂÄº Ê±ÇÊúÄÂ∞èÂÄº// @min.keyPath- (id)_minForKeyPath:(NSString *)keyPath &#123; id minValue = nil; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; if (!minValue) &#123; minValue = eachValue; &#125; else if ([minValue compare:eachValue] == NSOrderedDescending)&#123; minValue = eachValue; &#125; &#125; &#125; return minValue;&#125; Ëé∑ÂèñÊï∞ÁªÑ// ËøîÂõû Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÂÄº ÁªÑÊàêÊï∞ÁªÑ// @unionOfObjects.keyPath- (NSArray *)_unionOfObjectsForKeyPath:(NSString *)keyPath &#123; NSMutableArray *unionArray = [NSMutableArray arrayWithCapacity:self.count]; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; [unionArray addObject:eachValue]; &#125; &#125; return unionArray;&#125; Ëé∑ÂèñÂéªÈáçÊï∞ÁªÑ// ËøîÂõû Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÂÄº ÁªÑÊàêÂéªÈáçÊï∞ÁªÑ// @distinctUnionOfObjects.keyPath- (NSArray *)_distinctUnionOfObjectsForKeyPath:(NSString *)keyPath &#123; NSArray *unionArray = [self _unionOfObjectsForKeyPath:keyPath]; return [NSSet setWithArray:unionArray].allObjects;&#125; Ëé∑ÂèñÊàêÂëòÊï∞ÁªÑ// ËøîÂõû Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÊï∞ÁªÑÁöÑÊØè‰∏™ÊàêÂëò ÁªÑÊàêÊï∞ÁªÑ ËøôÈáåÊØè‰∏™keyPathÂØπÂ∫îÂÄºÊòØ‰πüÊòØÊï∞ÁªÑÔºåËé∑ÂèñÁöÑÊòØÊØè‰∏™Êï∞ÁªÑÂ±ïÂºÄÂêéÁªÑÊàêÁöÑÊÄªÊï∞ÁªÑ// @unionOfArrays.keyPath- (NSArray *)_unionOfArraysForKeyPath:(NSString *)keyPath &#123; NSMutableArray *unionArray = [NSMutableArray arrayWithCapacity:self.count]; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; [unionArray addObjectsFromArray:eachValue]; &#125; &#125; return unionArray;&#125; Ëé∑ÂèñÂéªÈáçÁöÑÊàêÂëòÊï∞ÁªÑ// ËøîÂõû Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÊï∞ÁªÑÁöÑÊØè‰∏™ÊàêÂëò ÁªÑÊàêÁöÑÂéªÈáçÂ§çÊï∞ÁªÑ.// @distinctUnionOfArrays.keyPath- (NSArray *)_distinctUnionOfArraysForKeyPath:(NSString *)keyPath &#123; NSArray *unionArray = [self _unionOfArraysForKeyPath:keyPath]; return [NSSet setWithArray:unionArray].allObjects;&#125; Ëé∑ÂèñÈõÜÂêàÊï∞ÁªÑ// ËøîÂõû Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÈõÜÂêàÁöÑÊØè‰∏™ÊàêÂëò ÁªÑÊàêÁöÑÊï∞ÁªÑ. ËøôÈáåÊØè‰∏™keyPathÂØπÂ∫îÂÄºÊòØÊòØÈõÜÂêàÔºåËé∑ÂèñÁöÑÊòØÊØè‰∏™ÈõÜÂêàÂ±ïÂºÄÂêéÁªÑÊàêÁöÑÊÄªÊï∞ÁªÑ// @unionOfSets.keyPath- (NSArray *)_unionOfSetsForKeyPath:(NSString *)keyPath &#123; NSMutableArray *unionArray = [NSMutableArray arrayWithCapacity:self.count]; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; [unionArray addObjectsFromArray:[eachValue allObjects]]; &#125; &#125; return unionArray;&#125; Ëé∑ÂèñÂéªÈáçÁöÑÈõÜÂêàÊï∞ÁªÑ// ËøîÂõû Array‰∏≠ÊØè‰∏™ÂØπË±°ÁöÑkeyPathÂØπÂ∫îÈõÜÂêàÁöÑÊØè‰∏™ÊàêÂëò ÁªÑÊàêÁöÑÂéªÈáçÂ§çÊï∞ÁªÑ.// @distinctUnionOfSets.keyPath- (NSArray *)_distinctUnionOfSetsForKeyPath:(NSString *)keyPath &#123; NSMutableSet *unionSet = [NSMutableSet setWithCapacity:self.count]; for (NSUInteger i=0; i&lt;self.count; ++i) &#123; id eachValue = [self _valueForKeyPath:keyPath ofObjectAtIndex:i]; if (eachValue) &#123; [unionSet unionSet:eachValue]; &#125; &#125; return unionSet.allObjects;&#125; NSSetÁöÑKVC‰∏éNSArrayÁöÑÈÄªËæëÂü∫Êú¨‰øùÊåÅ‰∏ÄËá¥„ÄÇ NSOrderedSetÁöÑKVC‰∏éNSArrayÁöÑÈÄªËæëÂü∫Êú¨‰øùÊåÅ‰∏ÄËá¥„ÄÇ NSDictionaryÁöÑKVC‰∏éNSArrayÁõ∏ÊØîÔºå‰∏ªË¶ÅÂå∫Âà´Âú®‰∫éÔºö - (id)valueForKey:(NSString *)key &#123; NSString *operationKey = nil; // key‰∏≠ÂåÖÂê´'@Â≠óÁ¨¶', ‰∏î'@Â≠óÁ¨¶'Âú®Á¨¨0‰Ωç, Â¶Ç @"@count" if(key.length &amp;&amp; [key characterAtIndex:0] == '@' &amp;&amp; (operationKey = [key substringWithRange:NSMakeRange(1, key.length - 1)])) &#123; // Ê≠§Êó∂, operationKey‰∏∫ @"count" return [super valueForKey:operationKey]; &#125; else &#123; // Ê≤°Êúâ'@Â≠óÁ¨¶', Ëµ∞Â≠óÂÖ∏ÁöÑobjectForKeyÈÄªËæë return [self objectForKey:key]; &#125;&#125; valueForKey:ÂèñÂÄºÈÄªËæëÂ§ö‰∫ÜÂØπ@Â≠óÁ¨¶ÁöÑÂ§ÑÁêÜ„ÄÇ valueForKeyPath:‰∏éNSArrayÁöÑÈÄªËæë‰∏ÄËá¥„ÄÇ ‰∫î„ÄÅÂÖ∂‰ªñÂàÜÁ±ªÁöÑKVCNSMutableDictionaryÁöÑKVC@implementation NSMutableDictionary (NSKeyValueCoding)- (void)setValue:(id)value forKey:(NSString *)key &#123; if(value) &#123; [self setObject:value forKey:key]; &#125; else &#123; [self removeObjectForKey:key]; &#125;&#125;@end Áõ∏ÊØî‰∏ªÁ±ªÂ¢ûÂä†ÁöÑÁâπÊÄßÊòØÔºöÂú®NSMutableDictionary‰∏≠ÔºåÂ¶ÇÊûúËÆæÁΩÆÁöÑvalue‰∏∫Á©∫ÔºåÂàôËá™Âä®Â∞ÜkeyÂØπÂ∫îÁöÑvalueÁßªÈô§„ÄÇ NSUserDefaultsÁöÑKVC@implementation NSUserDefaults (NSKeyValueCoding)- (id)valueForKey:(NSString *)key &#123; NSString *subKey = nil; if(key.length &amp;&amp; [key characterAtIndex:0] == '@' &amp;&amp; (subKey = [key substringWithRange:NSMakeRange(1, key.length - 1)])) &#123; return [super valueForKey:subKey]; &#125; else &#123; return [self objectForKey:key]; &#125;&#125;- (void)setValue:(id)value forKey:(NSString *)key &#123; if(value) &#123; [self setObject:value forKey:key]; &#125; else &#123; [self removeObjectForKey:key]; &#125;&#125;@end Êï¥Âêà‰∫ÜNSDictionary‰∏éNSMutableDictionaryÁöÑÁâπËâ≤„ÄÇ Â¢ûÂä†‰∫ÜÂØπ@Â≠óÁ¨¶ÁöÑÂ§ÑÁêÜ„ÄÇ Â¶ÇÊûúËÆæÁΩÆÁöÑvalue‰∏∫Á©∫ÔºåÂàôËá™Âä®Â∞ÜkeyÂØπÂ∫îÁöÑvalueÁßªÈô§„ÄÇ NSNullÁöÑKVC@implementation NSNull (NSKeyValueCoding)- (id)valueForKey:(NSString *)key &#123; return self;&#125;@end ÂØπ‰∫éNSNullÊù•ËØ¥ÔºåÊó†ËÆ∫ÊÄé‰πàËÆæÂÄºÔºåÂèñÂá∫Êù•ÁöÑÂÄºÊÄªÊòØNSNullÂØπË±°„ÄÇ ÂÖ≠„ÄÅÊÄªÁªìÁ∫µËßÇÂÖ®ÊµÅÁ®ãÔºå‰ΩøÁî®KVC‰∏éÁõ¥Êé•‰ΩøÁî®Â≠òÂèñÂô®Áõ∏ÊØîÔºåÈÄüÂ∫¶ÊñπÈù¢Á®çÊúâÈÄäËâ≤ÔºåÊè£Êµã‰∏ªË¶ÅÂéüÂõ†Â¶Ç‰∏ãÔºö Â≠óÁ¨¶‰∏≤Â§ÑÁêÜ„ÄÇÂ∞§ÂÖ∂ÊòØÂê´ÊúâÈîÆË∑ØÂæÑÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®Âà∞ÈÄíÂΩí„ÄÇÔºàÂΩìÁÑ∂ÔºåÂê´Êúâ@Â≠óÁ¨¶ÁöÑÈõÜÂêàËøêÁÆóÁ¨¶‰πüÁÆó„ÄÇÔºâ ÊñπÊ≥ïÊü•Êâæ„ÄÇÊµÅÁ®ãÈ¢áÂ§öÔºåÂ∞ΩÁÆ°Êúâ‰ΩøÁî®CFSet‰Ωú‰∏∫ÁºìÂ≠ò„ÄÇ Ë£ÖÁÆ±ÊãÜÁÆ±„ÄÇKVCË¶ÅÊ±ÇËÆæÂÄºÂèÇÊï∞ÂíåÂèñÂÄºÂèÇÊï∞Âùá‰∏∫ÂØπË±°ÔºåËøôÂ∞±ÈúÄË¶Å‰∏ÄËà¨ÂÄºÁ±ªÂûãÂíåÂØπË±°Á±ªÂûãÁöÑÁõ∏‰∫íËΩ¨Êç¢„ÄÇ Ëøô‰πüÊòØ‰∏∫Âï•Áé∞Âú®Â≠óÂÖ∏ËΩ¨Ê®°ÂûãÈÉΩ‰∏ç‰ΩøÁî®KVC‰∫ÜÔºåÂèÇËßÅËØªYYModel„ÄÇ Âº∫ÁÉàÂª∫ËÆÆÈòÖËØªÔºö https://myzerone.com/posts/2016/10/20/KVC(Key-Value-Coding)/https://objccn.io/issue-7-3/ Ê∫êÁ†ÅÊù•Ëá™Ôºöhttps://github.com/renjinkui2719/DIS_KVC_KVO „ÄÇÊÑüË∞¢‰ΩúËÄÖ„ÄÇ ÂèÇËÄÉËµÑÊñôhttps://nshipster.cn/kvc-collection-operators/https://www.jianshu.com/p/a50ea091e1f4http://hufeng825.github.io/2013/09/23/ios33/https://www.jianshu.com/p/938855e842e4https://suhou.github.io/2017/09/29/KVCÂéüÁêÜÂ∞èËÆ∞/http://blog.cocoabit.com/ios-settter-benchmark/]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØª„ÄåFDFullscreenPopGesture„Äç]]></title>
    <url>%2F2019%2F04%2F25%2F%E8%AF%BB%E3%80%8CFDFullscreenPopGesture%E3%80%8D%2F</url>
    <content type="text"><![CDATA[2019.5.29 ‰øÆÊîπMethod SwizzlingÈÉ®ÂàÜÂÜÖÂÆπ ‰ºòÈõÖÂú∞ÂºÄÂêØÂÖ®Â±è‰æßÊªëÊâãÂäø„ÄÇ ‰∏Ä„ÄÅ‰ΩøÁî®‰ΩúËÄÖÁªôUINavigationControllerÂíåUIViewControllerÈÉΩÊ∑ªÂä†‰∫ÜÂàÜÁ±ªÔºåÂπ∂ËøõË°å‰∫ÜÈªòËÆ§ÁöÑÂèÇÊï∞ËÆæÁΩÆÔºåÂõ†Ê≠§‰∏çÂÅö‰ªª‰ΩïÈÖçÁΩÆÂ∞±ËÉΩÊã•ÊúâËøô‰∏™ÂäüËÉΩ„ÄÇ ‰∫å„ÄÅÂéüÁêÜ‰ΩúËÄÖÈÄöËøáÊñπÊ≥ï‰∫§Êç¢ÔºåhookÂà∞Á≥ªÁªüÂéüÁîüpushÊñπÊ≥ï‰∏≠ÁöÑÊâãÂäø‰∏≠ÁöÑtargetÂíåÂä®ÁîªË∞ÉÁî®selectorÔºåÂàõÂª∫Ëá™Â∑±ÁöÑUIPanGestureRecognizerÔºåÂπ∂ËÆæÁΩÆÂÆÉÁöÑtargetÂíåselector„ÄÇ ‰∏â„ÄÅÊé•Âè£ @interface UINavigationController (FDFullscreenPopGesture)// Ëé∑ÂèñÈáçÊñ∞ÂÆûÁé∞ÁöÑ‰æßÊªëËøîÂõûÊâãÂäøÂØπË±°@property (nonatomic, strong, readonly) UIPanGestureRecognizer *fd_fullscreenPopGestureRecognizer;// ÊòØÂê¶ÂÖÅËÆ∏ËßÜÂõæÊéßÂà∂Âô®ÂçïÁã¨ÁÆ°ÁêÜÂÆÉÂØπÂ∫îÁöÑNavigationBarÊòæÁ§∫‰∏éÈöêËóè.ÈªòËÆ§ÊòØYES// Ëøô‰∏™ÈúÄË¶ÅÈÖçÂêàËßÜÂõæÊéßÂà∂Âô®ÁöÑfd_prefersNavigationBarHiddenÂ±ûÊÄßÊù•‰ΩøÁî®// ‰πüÂ∞±ÊòØËØ¥Â¶ÇÊûúÊääËøô‰∏™Â±ûÊÄßËÆæÁΩÆ‰∏∫NO, ËßÜÂõæÊéßÂà∂Âô®ÂØπÂ∫îÁöÑÂØºËà™Ê†èÁöÑÈöêËóè‰∏éÂê¶‰∏çÁî±ËßÜÂõæÊéßÂà∂Âô®ÂÜ≥ÂÆö@property (nonatomic, assign) BOOL fd_viewControllerBasedNavigationBarAppearanceEnabled;@end @interface UIViewController (FDFullscreenPopGesture)// ÊòØÂê¶Á¶ÅÁî®ÂÖ®Â±è‰æßÊªëÊâãÂäø(ÈªòËÆ§NO)@property (nonatomic, assign) BOOL fd_interactivePopDisabled;// Ë°®ÊòéÂΩìÂâçÊéßÂà∂Âô®ÁöÑÂØºËà™Ê†èÊòØÊòæÁ§∫ËøòÊòØÈöêËóè, ÈªòËÆ§NO (ÊòæÁ§∫ÂØºËà™Ê†è)@property (nonatomic, assign) BOOL fd_prefersNavigationBarHidden;// ËÆæÁΩÆËÉΩÂ§üÂìçÂ∫î‰æßÊªëÁöÑÊúÄÂ§ßËæπÁïå(Ë∑ùÁ¶ª)@property (nonatomic, assign) CGFloat fd_interactivePopMaxAllowedInitialDistanceToLeftEdge;@end Âõõ„ÄÅÊ∫êÁ†ÅÈòÖËØª_FDFullscreenPopGestureRecognizerDelegate_FDFullscreenPopGestureRecognizerDelegateÂØπË±°„ÄÇÈÅµÂæ™UIGestureRecognizerDelegateÂçèËÆÆÔºå‰∏ªË¶ÅÁî®‰∫éÂÜ≥ÂÆöÊéßÂà∂Âô®ÊòØÂê¶ËÉΩÂìçÂ∫îÊâãÂäø„ÄÇ @interface _FDFullscreenPopGestureRecognizerDelegate : NSObject &lt;UIGestureRecognizerDelegate&gt;@property (nonatomic, weak) UINavigationController *navigationController;@end@implementation _FDFullscreenPopGestureRecognizerDelegate- (BOOL)gestureRecognizerShouldBegin:(UIPanGestureRecognizer *)gestureRecognizer &#123; // Ê†àÁöÑÊúÄÈ°∂Â±Ç, ‰∏çÈúÄË¶ÅÂìçÂ∫îÊâãÂäø if (self.navigationController.viewControllers.count &lt;= 1) &#123; return NO; &#125; // ÊâìÂºÄ‰∫ÜÁ¶ÅÁî®ÊâãÂäøÁöÑÂºÄÂÖ≥ UIViewController *topViewController = self.navigationController.viewControllers.lastObject; if (topViewController.fd_interactivePopDisabled) &#123; return NO; &#125; // Ë∂ÖËøáËá™Â∑±ËÆæÁΩÆÁöÑleft edge CGPoint beginningLocation = [gestureRecognizer locationInView:gestureRecognizer.view]; CGFloat maxAllowedInitialDistance = topViewController.fd_interactivePopMaxAllowedInitialDistanceToLeftEdge; if (maxAllowedInitialDistance &gt; 0 &amp;&amp; beginningLocation.x &gt; maxAllowedInitialDistance) &#123; return NO; &#125; // Ê≠£Âú®ÊâßË°åTransitionÂä®Áîª if ([[self.navigationController valueForKey:@"_isTransitioning"] boolValue]) &#123; return NO; &#125; // ÊâãÊú∫Ê®™Â±èÁä∂ÊÄÅ‰∏ã, ÈÄÇÈÖç‰æßÊªëÊñπÂêë // It tells you how far the touch moved since it was last reset. It resets when the touch goes down or if you reset it yourself. CGPoint translation = [gestureRecognizer translationInView:gestureRecognizer.view]; BOOL isLeftToRight = [UIApplication sharedApplication].userInterfaceLayoutDirection == UIUserInterfaceLayoutDirectionLeftToRight; CGFloat multiplier = isLeftToRight ? 1 : - 1; // Âè™ËÉΩÊòØ‰ªéÂ∑¶ÂêëÂè≥Êªë if ((translation.x * multiplier) &lt;= 0) &#123; return NO; &#125; return YES;&#125;@end UIViewController (FDFullscreenPopGesturePrivate)UIViewControllerÁöÑÂàÜÁ±ª„ÄÇÁªôÂÖ∂Ê∑ªÂä†ÂÖ≥ËÅîÂ±ûÊÄßfd_willAppearInjectBlock„ÄÇhook viewWillAppearÊñπÊ≥ïÂπ∂Âú®ÂÖ∂‰∏≠Ë∞ÉÁî®fd_willAppearInjectBlockÂõûË∞ÉÔºåhook viewWillDisappearÊñπÊ≥ïÔºåÂπ∂Âú®ÂÖ∂‰∏≠Ê†πÊçÆÊéßÂà∂Âô®ÁöÑfd_prefersNavigationBarHiddenÂ±ûÊÄßÊù•ËÆæÁΩÆÁä∂ÊÄÅÊ†èÁöÑÊòæÁ§∫‰∏éÂê¶„ÄÇ typedef void (^_FDViewControllerWillAppearInjectBlock)(UIViewController *viewController, BOOL animated);@interface UIViewController (FDFullscreenPopGesturePrivate)@property (nonatomic, copy) _FDViewControllerWillAppearInjectBlock fd_willAppearInjectBlock;@end@implementation UIViewController (FDFullscreenPopGesturePrivate)+ (void)load &#123; static dispatch_once_t onceToken; // ÊñπÊ≥ï‰∫§Êç¢, viewWillAppearÂíåfd_viewWillAppear‰∫íÊç¢, viewWillDisappearÂíåfd_viewWillDisappear‰∫íÊç¢ dispatch_once(&amp;onceToken, ^&#123; Method viewWillAppear_originalMethod = class_getInstanceMethod(self, @selector(viewWillAppear:)); Method viewWillAppear_swizzledMethod = class_getInstanceMethod(self, @selector(fd_viewWillAppear:)); method_exchangeImplementations(viewWillAppear_originalMethod, viewWillAppear_swizzledMethod); Method viewWillDisappear_originalMethod = class_getInstanceMethod(self, @selector(viewWillDisappear:)); Method viewWillDisappear_swizzledMethod = class_getInstanceMethod(self, @selector(fd_viewWillDisappear:)); method_exchangeImplementations(viewWillDisappear_originalMethod, viewWillDisappear_swizzledMethod); &#125;);&#125;- (void)fd_viewWillAppear:(BOOL)animated &#123; // ‰∏ªÁ±ªÁöÑÂÆûÁé∞ Forward to primary implementation. [self fd_viewWillAppear:animated]; if (self.fd_willAppearInjectBlock) &#123; self.fd_willAppearInjectBlock(self, animated); &#125;&#125;- (void)fd_viewWillDisappear:(BOOL)animated &#123; // Forward to primary implementation. [self fd_viewWillDisappear:animated]; // Âª∂Ëøü‰∏∫0Áõ∏ÂΩì‰∫éÁõ¥Êé•Ë∞ÉÁî®ÂºÇÊ≠• // dispatch_async(dispatch_get_main_queue(), ^&#123;&#125;); dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; UIViewController *viewController = self.navigationController.viewControllers.lastObject; // viewControllerÂ≠òÂú®ËÄå‰∏îÂÆÉÁöÑfd_prefersNavigationBarHidden‰∏∫NO, ÊääNavigationBarÊòæÁ§∫Âá∫Êù• if (viewController &amp;&amp; !viewController.fd_prefersNavigationBarHidden) &#123; [self.navigationController setNavigationBarHidden:NO animated:NO]; &#125; &#125;);&#125;- (_FDViewControllerWillAppearInjectBlock)fd_willAppearInjectBlock &#123; return objc_getAssociatedObject(self, _cmd);&#125;- (void)setFd_willAppearInjectBlock:(_FDViewControllerWillAppearInjectBlock)block &#123; objc_setAssociatedObject(self, @selector(fd_willAppearInjectBlock), block, OBJC_ASSOCIATION_COPY_NONATOMIC);&#125;@end UINavigationController (FDFullscreenPopGesture)UINavigationControllerÁöÑÂàÜÁ±ª„ÄÇhookpushViewController:animated:ÊñπÊ≥ïÔºåÁªôÂìçÂ∫îpushÊâãÂäøÁöÑviewÊ∑ªÂä†Ëá™ÂÆö‰πâÁöÑfd_fullscreenPopGestureRecognizerÊâãÂäø„ÄÇÂΩìÁÑ∂Ôºåfd_fullscreenPopGestureRecognizerÁöÑtargetÂíåselector‰∏épushÂéüÁîüÊâãÂäøÁöÑtargetÂèäselector‰øùÊåÅ‰∏ÄËá¥„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåfd_fullscreenPopGestureRecognizerÊâãÂäøÁöÑ‰ª£ÁêÜÊòØ‰∏äÈù¢ÁöÑ_FDFullscreenPopGestureRecognizerDelegateÂØπË±°ÔºåÁõÆÁöÑÊòØÂÜ≥ÂÆöÊòØÂê¶ÂìçÂ∫îÊâãÂäø„ÄÇ @implementation UINavigationController (FDFullscreenPopGesture)+ (void)load &#123; // Inject "-pushViewController:animated:" // ‰∫§Êç¢pushViewController‰∏éfd_pushViewController static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; Class class = [self class]; SEL originalSelector = @selector(pushViewController:animated:); SEL swizzledSelector = @selector(fd_pushViewController:animated:); Method originalMethod = class_getInstanceMethod(class, originalSelector); Method swizzledMethod = class_getInstanceMethod(class, swizzledSelector); BOOL success = class_addMethod(class, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod)); if (success) &#123; class_replaceMethod(class, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125; &#125;);&#125;- (void)fd_pushViewController:(UIViewController *)viewController animated:(BOOL)animated &#123; // ‰øùËØÅviewÂè™Ê∑ªÂä†‰∏ÄÊ¨°fd_fullscreenPopGestureRecognizerÊâãÂäø if (![self.interactivePopGestureRecognizer.view.gestureRecognizers containsObject:self.fd_fullscreenPopGestureRecognizer]) &#123; // Add our own gesture recognizer to where the onboard screen edge pan gesture recognizer is attached to. [self.interactivePopGestureRecognizer.view addGestureRecognizer:self.fd_fullscreenPopGestureRecognizer]; // Ëé∑ÂèñÁßÅÊúâÂèòÈáètargetÂíåselector NSArray *internalTargets = [self.interactivePopGestureRecognizer valueForKey:@"targets"]; id internalTarget = [internalTargets.firstObject valueForKey:@"target"]; SEL internalAction = NSSelectorFromString(@"handleNavigationTransition:"); // ËÆæÁΩÆÊªëÂä®ÊâãÂäøÁöÑ‰ª£ÁêÜ self.fd_fullscreenPopGestureRecognizer.delegate = self.fd_popGestureRecognizerDelegate; [self.fd_fullscreenPopGestureRecognizer addTarget:internalTarget action:internalAction]; // Á¶ÅÁî®ÂéüÁîüÁöÑÊâãÂäø self.interactivePopGestureRecognizer.enabled = NO; &#125; // Â§ÑÁêÜnavigation bar ÁöÑÊòæÁ§∫‰∏éÈöêËóè [self fd_setupViewControllerBasedNavigationBarAppearanceIfNeeded:viewController]; // Ë∞ÉÁî®ÂéüÊù•ÁöÑÊñπÊ≥ïÂÆûÁé∞(Âä†‰∏Ä‰∏™Âà§Êñ≠, ÈÅøÂÖçÈáçÂ§çpush) if (![self.viewControllers containsObject:viewController]) &#123; [self fd_pushViewController:viewController animated:animated]; &#125;&#125;- (void)fd_setupViewControllerBasedNavigationBarAppearanceIfNeeded:(UIViewController *)appearingViewController &#123; // Â¶ÇÊûúfd_viewControllerBasedNavigationBarAppearanceEnabledËÆæÁΩÆ‰∏∫NO, Áõ¥Êé•ËøîÂõû if (!self.fd_viewControllerBasedNavigationBarAppearanceEnabled) &#123; return; &#125; // ÈÖçÂêàfd_prefersNavigationBarHiddenÊù•‰ΩøÁî® __weak typeof(self) weakSelf = self; _FDViewControllerWillAppearInjectBlock block = ^(UIViewController *viewController, BOOL animated) &#123; __strong typeof(weakSelf) strongSelf = weakSelf; if (strongSelf) &#123; [strongSelf setNavigationBarHidden:viewController.fd_prefersNavigationBarHidden animated:animated]; &#125; &#125;; // ËÆæÁΩÆappearingViewController„ÄÅdisappearingViewControllerÁöÑfd_willAppearInjectBlock appearingViewController.fd_willAppearInjectBlock = block; UIViewController *disappearingViewController = self.viewControllers.lastObject; if (disappearingViewController &amp;&amp; !disappearingViewController.fd_willAppearInjectBlock) &#123; disappearingViewController.fd_willAppearInjectBlock = block; &#125;&#125;- (_FDFullscreenPopGestureRecognizerDelegate *)fd_popGestureRecognizerDelegate &#123; _FDFullscreenPopGestureRecognizerDelegate *delegate = objc_getAssociatedObject(self, _cmd); // Âè™ÂàùÂßãÂåñdelegate‰∏ÄÊ¨° if (!delegate) &#123; delegate = [[_FDFullscreenPopGestureRecognizerDelegate alloc] init]; delegate.navigationController = self; objc_setAssociatedObject(self, _cmd, delegate, OBJC_ASSOCIATION_RETAIN_NONATOMIC); &#125; return delegate;&#125;- (UIPanGestureRecognizer *)fd_fullscreenPopGestureRecognizer &#123; UIPanGestureRecognizer *panGestureRecognizer = objc_getAssociatedObject(self, _cmd); // Âè™ÂàùÂßãÂåñpanGestureRecognizer‰∏ÄÊ¨° if (!panGestureRecognizer) &#123; panGestureRecognizer = [[UIPanGestureRecognizer alloc] init]; panGestureRecognizer.maximumNumberOfTouches = 1; objc_setAssociatedObject(self, _cmd, panGestureRecognizer, OBJC_ASSOCIATION_RETAIN_NONATOMIC); &#125; return panGestureRecognizer;&#125;- (BOOL)fd_viewControllerBasedNavigationBarAppearanceEnabled &#123; NSNumber *number = objc_getAssociatedObject(self, _cmd); if (number) &#123; // BOOLÂÄºË¢´Â∞ÅË£ÖÊàêÂØπË±°‰∫Ü return number.boolValue; &#125; // Ëµ∞Âà∞Ëøô‰∏ÄÊ≠•ËØ¥ÊòéËøòÊ≤°ÊúâËÆæÁΩÆËøáÂÖ≥ËÅîÂ±ûÊÄß, ÊâãÂä®ËÆæÁΩÆ self.fd_viewControllerBasedNavigationBarAppearanceEnabled = YES; return YES;&#125;- (void)setFd_viewControllerBasedNavigationBarAppearanceEnabled:(BOOL)enabled &#123; SEL key = @selector(fd_viewControllerBasedNavigationBarAppearanceEnabled); objc_setAssociatedObject(self, key, @(enabled), OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;@end UIViewController (FDFullscreenPopGesture)UIViewControllerÁöÑÂàÜÁ±ª„ÄÇÁªôÂÖ∂Ê∑ªÂä†ÂÖ≥ËÅîÂ±ûÊÄßfd_interactivePopDisabled„ÄÅfd_interactivePopMaxAllowedInitialDistanceToLeftEdgeÂíåfd_prefersNavigationBarHidden„ÄÇ @implementation UIViewController (FDFullscreenPopGesture)- (BOOL)fd_interactivePopDisabled &#123; // ÂÖ≥‰∫é_cmd: ËøôË°å‰ª£Á†ÅÁ≠â‰ª∑‰∫é return [objc_getAssociatedObject(self, @selector(fd_interactivePopDisabled)) boolValue]; return [objc_getAssociatedObject(self, _cmd) boolValue];&#125;- (void)setFd_interactivePopDisabled:(BOOL)disabled &#123; objc_setAssociatedObject(self, @selector(fd_interactivePopDisabled), @(disabled), OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;- (BOOL)fd_prefersNavigationBarHidden &#123; return [objc_getAssociatedObject(self, _cmd) boolValue];&#125;- (void)setFd_prefersNavigationBarHidden:(BOOL)hidden &#123; // Â≠òÂÇ®ÁöÑÊó∂ÂÄôÈúÄË¶ÅÊääÂü∫Êú¨Êï∞ÊçÆÁ±ªÂûãÂåÖË£ÖÊàêÂØπË±° @(hidden) objc_setAssociatedObject(self, @selector(fd_prefersNavigationBarHidden), @(hidden), OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;- (CGFloat)fd_interactivePopMaxAllowedInitialDistanceToLeftEdge &#123;#if CGFLOAT_IS_DOUBLE // CGFLOAT_IS_DOUBLEÂÆè: 64‰Ωç‰∏ãÊòØ1 Âê¶Âàô0, ÁâπÂà´‰∏•Ë∞® return [objc_getAssociatedObject(self, _cmd) doubleValue];#else return [objc_getAssociatedObject(self, _cmd) floatValue];#endif&#125;- (void)setFd_interactivePopMaxAllowedInitialDistanceToLeftEdge:(CGFloat)distance &#123; SEL key = @selector(fd_interactivePopMaxAllowedInitialDistanceToLeftEdge); // ‰ΩøÁî®@(MAX(0, distance), ÈÄÇÈÖçdistanceË¢´Â§ñÁïåËÆæÁΩÆ‰∏∫Ë¥üÂÄºÁöÑÊÉÖÂÜµ objc_setAssociatedObject(self, key, @(MAX(0, distance)), OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;@end ‰∫î„ÄÅÂÜçË∞àMethod SwizzlingÂÆû‰æãÊñπÊ≥ï‰∫§Êç¢@interface ViewController ()@end@implementation ViewController- (void)viewWillAppear:(BOOL)animated &#123; [super viewWillAppear:animated]; NSLog(@"ÂéüÂßãÁöÑÊñπÊ≥ïÂÆûÁé∞");&#125;@end@implementation ViewController (MethodSwizzling1)+ (void)load &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; Class cls = [self class]; SEL originalSel = @selector(viewWillAppear:); SEL swizzledSel = @selector(ya1_viewWillAppear:); Method originalMethod = class_getInstanceMethod(cls, originalSel); Method swizzledMethod = class_getInstanceMethod(cls, swizzledSel); if (class_addMethod(cls, originalSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))) &#123; class_replaceMethod(cls, swizzledSel, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125; &#125;);&#125;- (void)ya1_viewWillAppear:(BOOL)animated &#123; [self ya1_viewWillAppear:animated]; NSLog(@"Á¨¨‰∏ÄÊ¨°Âú®ÂàÜÁ±ªÈáåÈù¢‰∫íÊç¢");&#125;@end Á±ªÊñπÊ≥ï‰∫§Êç¢// ‰∫§Êç¢Á±ªÊñπÊ≥ï+ (void)load &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; SEL originalSel = @selector(a); SEL swizzledSel = @selector(b); Class class = object_getClass(self); Method originalMethod = class_getInstanceMethod(class, originalSel); Method swizzledMethod = class_getInstanceMethod(class, swizzledSel); if (class_addMethod(class, originalSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))) &#123; class_replaceMethod(class, swizzledSel, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125; &#125;);&#125;+ (void)b &#123; NSLog(@"b");&#125; ÈóÆÈ¢ò1ÔºöÂÆû‰æãÊñπÊ≥ï‰∫§Êç¢‰∏éÁ±ªÊñπÊ≥ï‰∫§Êç¢Êúâ‰ªÄ‰πàÂå∫Âà´ÔºüÊ≤°ÊúâÂ§ßÁöÑÂèòÂåñÔºåÂîØ‰∏ÄÁöÑÂå∫Âà´Âú®‰∫éËé∑ÂèñÊñπÊ≥ïÊâÄÂ±ûÁöÑÂØπË±°‰∏äÔºå‰∏Ä‰∏™Ëé∑ÂèñÁöÑÊòØÁ±ªÂØπË±°‰∏Ä‰∏™Ëé∑ÂèñÁöÑÊòØÂÖÉÁ±ªÂØπË±°„ÄÇÂç≥‰∏Ä‰∏™ÊòØ[self class]ÊàñËÄÖËØ¥[self self]Ôºå‰∏Ä‰∏™ÊòØobject_getClass(self)„ÄÇ‰∏∫‰ªÄ‰πà‰ºöÊúâËøôÁßçÂå∫Âà´ÔºüÂéüÂõ†Âú®‰∫éÔºåÂÆû‰æãÊñπÊ≥ïÂ≠òÂÇ®Âú®Á±ªÂØπË±°‰∏≠ÔºåÁ±ªÊñπÊ≥ïÂ≠òÂÇ®Âú®ÂÖÉÁ±ªÂØπË±°‰∏≠„ÄÇ ÂÜç‰∏Ä‰∏™ÔºåÁúãÁúãclassÁöÑÂÆûÁé∞Ôºö + (Class)class &#123; return self;&#125;- (Class)class &#123; return object_getClass(self);&#125; ÁΩë‰∏äËÆ∏Â§öÊñáÁ´†Ëøô‰πàËØ¥ÁöÑÔºö object_getClass‰∏éself.classÁöÑÂå∫Âà´self.class:ÂΩìselfÊòØÂÆû‰æãÂØπË±°ÁöÑÊó∂ÂÄôÔºåËøîÂõûÁöÑÊòØÁ±ªÂØπË±°ÔºåÂê¶ÂàôÂàôËøîÂõûËá™Ë∫´„ÄÇobject_getClass:Ëé∑ÂæóÁöÑÊòØisaÁöÑÊåáÂêë Ëøô‰∏™‚ÄúËøîÂõûËá™Ë∫´‚ÄùÂæàÂê´Á≥ä„ÄÇ object_getClass()Ëé∑ÂèñisaÊåáÂêëÊØãÂ∫∏ÁΩÆÁñë„ÄÇÂÆû‰æãÂØπË±°ÁöÑisaÊåáÂêëÁ±ªÂØπË±°ÔºåÁ±ªÂØπË±°ÁöÑisaÊåáÂêëÂÖÉÁ±ªÂØπË±°ÔºåÂÖÉÁ±ªÂØπË±°ÁöÑisaÊåáÂêëÊ†πÂÖÉÁ±ªÔºåÊ†πÂÖÉÁ±ªÁöÑisaÊåáÂêëÂÆÉËá™Â∑±ÔºåËÄ≥ÁÜüËÉΩËØ¶„ÄÇ ÂÖ≥ÈîÆÊòØclassÔºåselfÊåáÂêë‰∫ÜÊ∂àÊÅØÁöÑÊé•Êî∂ËÄÖÔºà‚Äúthe object that‚Äôs received this message‚ÄùÔºâÔºåÂæàËá™ÁÑ∂Âú∞ÔºåÂÆû‰æãÊñπÊ≥ïÁöÑÊ∂àÊÅØÊé•Êî∂ËÄÖÊòØÂÆû‰æãÂØπË±°ÔºåÁ±ªÊñπÊ≥ïÁöÑÊ∂àÊÅØÊé•Êî∂ËÄÖÊòØÁ±ªÂØπË±°„ÄÇÊ†πÊçÆ‰ª£Á†ÅÂÆûÁé∞Êù•ÁúãÔºåÂÆû‰æãÊñπÊ≥ïË∞ÉÁî®classÊòØËé∑ÂèñÂÆû‰æãÂØπË±°ÁöÑisaÊåáÂêëÔºåÂç≥Á±ªÂØπË±°„ÄÇËÄåÁ±ªÂØπË±°Ë∞ÉÁî®classËøîÂõûÁöÑÊ∂àÊÅØÊé•Êî∂ËÄÖËá™Â∑±ÔºåËøô‰∏™‚ÄúËá™Ë∫´‚ÄùÊåáÁöÑÂ∞±ÊòØÁ±ªÂØπË±°„ÄÇ‰∫éÊòØÔºå‰∏çÁÆ°ÊòØÂÆû‰æãÂØπË±°ËøòÊòØÁ±ªÂØπË±°Ë∞ÉÁî®classÊñπÊ≥ïÔºåËøîÂõûÁöÑÊÄªÊòØÁ±ªÂØπË±°„ÄÇ ÂêåÊ†∑Âú∞ÔºåÂú®ÂÆû‰æãÊñπÊ≥ïÁöÑ‰∫§Êç¢‰∏≠ÔºåËøôÂá†ÁßçËé∑ÂèñÁ±ªÂØπË±°ÁöÑÊñπÂºèÊòØÁ≠â‰ª∑ÁöÑÔºö Class class = [self self];Class class = [self class];Class class = self; Ë∞ÉÁî®selfÁöÑselfÊñπÊ≥ï‰πüÊ≤°Âï•Â•áÊÄ™ÁöÑÔºåÊ∫êÁ†ÅÊòØËøôÊ†∑ÁöÑÔºö - (id)self &#123; return self;&#125;+ (Class)class &#123; return self;&#125; ÈóÆÈ¢ò2ÔºöËÉΩÂê¶ÂÅöÂà∞ÂÆû‰æãÊñπÊ≥ï‰∏éÁ±ªÊñπÊ≥ï‰∫§Êç¢ÔºüÂÆû‰æãÊñπÊ≥ï‰∏éÂÆû‰æãÊñπÊ≥ï‰∫íÊç¢„ÄÅÁ±ªÊñπÊ≥ï‰∏éÁ±ªÊñπÊ≥ï‰∫íÊç¢ÈÉΩÂæàÂÆπÊòìÂÅöÂà∞„ÄÇÈÇ£‰∏Ä‰∏™ÂÆû‰æãÊñπÊ≥ï‰∏é‰∏Ä‰∏™Á±ªÊñπÊ≥ï‰∫íÊç¢ÔºåÊàñËÄÖ‰∏Ä‰∏™Á±ªÊñπÊ≥ï‰∏é‰∏Ä‰∏™ÂÆû‰æãÊñπÊ≥ï‰∫íÊç¢ÂèØ‰ª•ÂÅöÂà∞ÂêóÔºüÁ≠îÊ°àÊòØËÇØÂÆöÁöÑ„ÄÇÊ†πÊçÆ‰∏äÊñáËÆ®ËÆ∫ÔºåÂÖ≥ÈîÆÂú®‰∫éËé∑ÂèñÊñπÊ≥ïÊâÄÂ±ûÁöÑÂØπË±°‰∏äÔºåÂç≥Â∑ßÂ¶ôÊéßÂà∂Â•ΩËé∑ÂèñÁöÑÁ±ªÂØπË±°ÂíåÂÖÉÁ±ªÂØπË±°Âç≥ÂèØ„ÄÇ Ôºà1ÔºâÂÆû‰æãÊñπÊ≥ï‰∏éÁ±ªÊñπÊ≥ï‰∫íÊç¢ÔºàÊñ∞ÁöÑÂÆû‰æãÊñπÊ≥ï‰∫§Êç¢ÂéüÂÖàÁöÑÁ±ªÊñπÊ≥ïÔºâSEL originalSel = @selector(classMethod);SEL swizzledSel = @selector(newInstanceMethod);Class originClass = object_getClass(self);Class swizzleClass = self; Ôºà2ÔºâÁ±ªÊñπÊ≥ï‰∏éÂÆû‰æãÊñπÊ≥ï‰∫íÊç¢ÔºàÊñ∞ÁöÑÁ±ªÊñπÊ≥ï‰∫§Êç¢ÂéüÂÖàÁöÑÂÆû‰æãÊñπÊ≥ïÔºâSEL originalSel = @selector(instanceMethod);SEL swizzledSel = @selector(newClassMethod);Class originClass = self;Class swizzleClass = object_getClass(self); ‰∫åËÄÖÁöÑÂÖ±ÂêåÂÆûÁé∞ÊòØËøôÊ†∑ÁöÑÔºö Method originalMethod = class_getInstanceMethod(originClass, originalSel);Method swizzledMethod = class_getInstanceMethod(swizzleClass, swizzledSel);if (class_addMethod(originClass, originalSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))) &#123; class_replaceMethod(originClass, swizzledSel, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod));&#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod);&#125; ÈóÆÈ¢ò3ÔºöÊñπÊ≥ï‰∫åÊ¨°‰∫§Êç¢ÊòØÂê¶‰ºöÂΩ±ÂìçÁ¨¨‰∏ÄÊ¨°‰∫§Êç¢ÔºàÈÄ†ÊàêÁ¨¨‰∏ÄÊ¨°‰∫§Êç¢Â§±ÊïàÔºâÔºüÊØîÂ¶ÇÔºö @implementation ViewController (MethodSwizzling2)+ (void)load &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; SEL originalSel = @selector(viewWillAppear:); SEL swizzledSel = @selector(ya2_viewWillAppear:); Method originalMethod = class_getInstanceMethod(self, originalSel); Method swizzledMethod = class_getInstanceMethod(self, swizzledSel); if (class_addMethod(self, originalSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))) &#123; class_replaceMethod(self, swizzledSel, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125; &#125;);&#125;- (void)ya2_viewWillAppear:(BOOL)animated &#123; [self ya2_viewWillAppear:animated]; NSLog(@"Á¨¨‰∫åÊ¨°Âú®ÂàÜÁ±ªÈáåÈù¢‰∫íÊç¢");&#125;@end ÂæàÊòéÊòæ‰∏ç‰ºö„ÄÇ ÂéüÂõ†: Compile Sources‰∏≠ËÆæÂÆö‰∫ÜÂàÜÁ±ªÁöÑÁºñËØëÈ°∫Â∫è‰∏∫ViewController+MethodSwizzling.m --&gt; ViewController+MethodSwizzling2.mÔºåloadÊñπÊ≥ïÁöÑË∞ÉÁî®È°∫Â∫è‰πüÊòØËøôÊ†∑„ÄÇÊúÄÊñ∞ÂÖàË∞ÉÁî®‰∏ªÁ±ªÁöÑviewWillAppear:ÊñπÊ≥ï‰∏çÂøÖÂ§öËØ¥ÔºåÊé•ÁùÄË∞ÉÁî®ÂàÜÁ±ªViewController+MethodSwizzling‰∏≠ÁöÑÊñπÊ≥ï‰∫íÊç¢ÈÄªËæëÔºå‰ΩøÂæóÁ¨¨‰∏ÄÊ¨°ÊñπÊ≥ï‰∫íÊç¢ÊàêÂäü„ÄÇÁ¥ßÊé•ÁùÄË∞ÉÁî®ÂàÜÁ±ªViewController+MethodSwizzling2‰∏≠ÁöÑÊñπÊ≥ï‰∫íÊç¢ÈÄªËæëÔºåËøô‰∏™‰∏ç‰ºöÂΩ±ÂìçÁ¨¨‰∏ÄÊ¨°ÊñπÊ≥ï‰∫íÊç¢ÁöÑÈÄªËæëÔºåÁõ∏ÂΩì‰∫éÂú®Á¨¨‰∏ÄÊ¨°ÁöÑÊñπÊ≥ï‰∫íÊç¢‰πãÂêéÂÜç‰∫íÊç¢‰∏ÄÊ¨°„ÄÇ Á¨¨‰∏ÄÊ¨°: ya_viewWillAppearÁöÑÂÆûÁé∞‰∏éviewWillAppearÁöÑÂÆûÁé∞‰∫íÊç¢Á¨¨‰∫åÊ¨°: ya2_viewWillAppearÁöÑÂÆûÁé∞‰∏éya_viewWillAppearÁöÑÂÆûÁé∞‰∫íÊç¢ÔºåÂõ†‰∏∫viewWillAppearÁöÑÂÆûÁé∞Ë¢´ya_viewWillAppear‰ª£Êõø‰∫Ü„ÄÇÊâÄ‰ª•‰∏ªÁ±ªÂíåÂêÑ‰∏™ÂàÜÁ±ªÁöÑÊñπÊ≥ïÈÉΩË¢´Ê∏ÖÊô∞Âú∞Ë∞ÉÁî®‰∫Ü„ÄÇ ÈóÆÈ¢ò4Ôºö‰∏∫‰ªÄ‰πàÈúÄË¶Åclass_replaceMethod()ÂáΩÊï∞?ÂéüÂÖàÁöÑÊñπÊ≥ïÂ≠òÂú®(ÊúâÂÆûÁé∞)ÔºåËá™‰∏çÂøÖËØ¥Ôºå‰ΩøÁî®method_exchangeImplementations()Áõ¥Êé•‰∫§Êç¢ÂáΩÊï∞ÊåáÈíàÂç≥ÂèØ„ÄÇÈÇ£‰πàÊúâ‰∏™ÈóÆÈ¢òÔºåÂÅáÂÆöÂéüÂÖàÁöÑÊñπÊ≥ï‰∏çÂ≠òÂú®ÔºåÈÇ£Áõ¥Êé•‰ΩøÁî®class_addMethod()ÂáΩÊï∞ÊääswizzledMethodÊñπÊ≥ïÁöÑÂÆûÁé∞‚Äú‰∫§Áªô‰∫Ü‚ÄùÂéüÂÖàÁöÑoriginalMethodÊñπÊ≥ïÔºåÊ≠§Êó∂ÂéüÂÖàÁöÑoriginalMethodÊñπÊ≥ïÂíåÊñ∞ÁöÑswizzledMethodÊñπÊ≥ïÈÉΩÊåáÂêë‰∫ÜÂêå‰∏Ä‰∏™ÂÆûÁé∞: swizzledMethodÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇËøõË°åÂà∞Ëøô‰∏ÄÊ≠•Ë∂≥Â§ü‰∫ÜÔºåclass_addMethod()ÂáΩÊï∞Êó¢Âà§Êñ≠‰∫ÜÂéüÂÖàÁöÑÊñπÊ≥ïÊòØÂê¶ÂÆûÁé∞ÔºåÂÄòËã•Êú™ÂÆûÁé∞ÂèàËá™Âä®ÊääÊñ∞ÊñπÊ≥ïÁöÑÂÆûÁé∞‚Äú‰∫§Áªô‰∫Ü‚ÄùÂÆÉÔºåÂÆåÂÖ®Ëß£ÂÜ≥‰∫ÜÈóÆÈ¢òÔºåËøòÈúÄË¶Åclass_replaceMethod()ÂáΩÊï∞ÂÅöÂï•? ÂéüÂõ†Âú®‰∫éÔºå‚ÄúÂéüÂÖàÁöÑÊñπÊ≥ïÊ≤°ÊúâÂÆûÁé∞‚ÄùÊúâ‰∏§ÁßçÊÉÖÂÜµÔºåÁ¨¨‰∏ÄÁßç:ËØ•ÊñπÊ≥ïÊòØ‰ªÖ‰ªÖÂ±û‰∫éËøô‰∏™Á±ªÁöÑÔºåÁà∂Á±ªÊ≤°Êúâ„ÄÇÁ¨¨‰∫åÁßç:ËØ•ÊñπÊ≥ïÊòØÁªßÊâøËá™Ëøô‰∏™Á±ªÁöÑÁà∂Á±ªÁöÑÔºåÁà∂Á±ª‰∏≠ÊúâÂÆûÁé∞ÔºåËÄåÂÆÉËá™Â∑±Âç¥Ê≤°ÊúâÂÆûÁé∞„ÄÇÂØπ‰∫éÁ¨¨‰∫åÁßçÊÉÖÂÜµÔºåÂÄòËã•‰ªÖ‰ªÖ‰ΩøÁî®class_addMethod()ÂáΩÊï∞ËÄåÊ≤°Êúâ‰ΩøÁî®class_replaceMethod()ÂáΩÊï∞Ôºå‰ºöÈÄ†Êàê‚Äú‰∏¢Â§±ÊéâÂéüÂÖàÁöÑÁà∂Á±ªÁöÑÂÆûÁé∞‚Äù„ÄÇ Á§∫‰æã‰ª£Á†Å: @interface MainObject : NSObject@end@implementation MainObject- (void)a &#123; NSLog(@"super-main");&#125;@end// AObjectÁªßÊâøËá™MainObject@interface AObject : MainObject@end@implementation AObject@end@interface AObject (Object)@end@implementation AObject (Object)+ (void)load &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; SEL originalSel = @selector(a); SEL swizzledSel = @selector(b); Method originalMethod = class_getInstanceMethod(self, originalSel); Method swizzledMethod = class_getInstanceMethod(self, swizzledSel); if (class_addMethod(self, originalSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))) &#123; // ‰ªÄ‰πà‰πü‰∏çÂÅö &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125; &#125;);&#125;- (void)b &#123; NSLog(@"b-method");&#125;@end// Ë∞ÉÁî®AObject *obj = [AObject new];[obj performSelector:@selector(a)];[obj performSelector:@selector(b)]; ÂæàÊòéÊòæÔºåÊâìÂç∞‰∫Ü‰∏§Ê¨°‚Äùb-method‚Äù„ÄÇ 2019-05-29 20:01:19.934449+0800 Aaron[35973:604269] b-method2019-05-29 20:01:19.934591+0800 Aaron[35973:604269] b-method ËÄåÂ¶ÇÊûúÊ∑ªÂä†‰∏äclass_replaceMethod()ÂáΩÊï∞ÔºåÂÖàÁªôoriginalSelÊ∑ªÂä†‰∏äswizzledMethodÁöÑÂÆûÁé∞ÔºåÂÜçÊääÁà∂Á±ªÁöÑÂÆûÁé∞originalMethodÊõøÊç¢Âà∞swizzledSel‰∏≠ÔºåËøôÊ†∑Áà∂Á±ªÁöÑÂÆûÁé∞Â∞±‰ºöÂæóÂà∞Ë∞ÉÁî®: ......if (class_addMethod(self, originalSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))) &#123; class_replaceMethod(self, swizzledSel, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod));&#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod);&#125;...... ÊâìÂç∞Ôºö 2019-05-29 20:06:39.298454+0800 Aaron[36191:611275] b-method2019-05-29 20:06:39.298605+0800 Aaron[36191:611275] super-main Âõ†Ê≠§ÔºåÂΩì‚Äù‰∏ªÁ±ªÊú¨Ë∫´Ê≤°ÊúâÂÆûÁé∞ÈúÄË¶ÅÊõøÊç¢ÁöÑÊñπÊ≥ïÔºåËÄåÊòØÁªßÊâø‰∫ÜÁà∂Á±ªÁöÑÂÆûÁé∞‚ÄùÊó∂ÔºåÊØîÂ¶Ç‰∏ÄÂºÄÂßãÁöÑ‰æãÂ≠êviewWillAppearÊñπÊ≥ïÔºåÂ∞±ÂèØ‰ª•Ë∞ÉÁî®Âà∞Áà∂Á±ªÁöÑÂÆûÁé∞ÔºåÈÅøÂÖçÂá∫Áé∞ÈóÆÈ¢ò„ÄÇÂØπ‰∫éÂÆåÂÖ®Êó†‰∏≠ÁîüÊúâÁöÑÊØîÂ¶ÇaaaÊñπÊ≥ïÔºåÁî®‰∏çÁî®class_replaceMethod()ÈÉΩÊó†Â¶®„ÄÇ ÂÖ≠„ÄÅËá™ÂÆö‰πâ‰æßÊªëÊâãÂäøÈô§‰∫ÜÂÖ®Â±è‰æßÊªë‰πãÂ§ñÔºåÊúâ‰∫õÊÉÖÂÜµ‰∏ãÈúÄË¶ÅËá™ÂÆö‰πâ‰æßÊªëÊâãÂäøÔºåËøôÊó∂ÂèØ‰ª•‰ΩøÁî®UIScreenEdgePanGestureRecognizerÂÆûÁé∞„ÄÇ - (void)viewDidLoad &#123; [super viewDidLoad]; UIView *orangeView = [[UIView alloc] initWithFrame:self.view.bounds]; orangeView.backgroundColor = UIColor.orangeColor; [self.view addSubview:orangeView]; UIScreenEdgePanGestureRecognizer *pan = [[UIScreenEdgePanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePop:)]; pan.edges = UIRectEdgeLeft; [orangeView addGestureRecognizer:pan]; self.orangeView = orangeView;&#125;- (void)handlePop:(UIScreenEdgePanGestureRecognizer *)pan &#123; void (^setOriginX)(UIView *, CGFloat) = ^(UIView *view, CGFloat x) &#123; [UIView animateWithDuration:0.15 animations:^&#123; CGRect frame = view.frame; frame.origin.x = x; view.frame = frame; &#125;]; &#125;; UIView *targetView = pan.view; CGFloat offsetX = [pan translationInView:targetView].x; if (pan.state == UIGestureRecognizerStateChanged) &#123; targetView.center = CGPointMake(targetView.center.x + offsetX, targetView.center.y); [pan setTranslation:CGPointZero inView:targetView.superview]; &#125; else if (pan.state == UIGestureRecognizerStateEnded || pan.state == UIGestureRecognizerStateCancelled) &#123; if (targetView.frame.origin.x / targetView.frame.size.width &gt; 0.3) &#123; setOriginX(targetView, targetView.bounds.size.width); &#125; else &#123; setOriginX(targetView, 0); &#125; &#125;&#125; ÂèÇËÄÉËµÑÊñôhttp://blog.sunnyxx.com/2015/06/07/fullscreen-pop-gesture/https://www.jianshu.com/p/d39f7d22db6chttps://juejin.im/entry/5bea8d6de51d454fbd6b472f]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂºÄÊ∫êÈ°πÁõÆÔºöPageMenu]]></title>
    <url>%2F2019%2F03%2F21%2F%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%EF%BC%9APageMenu%2F</url>
    <content type="text"><![CDATA[‰∏Ä‰∏™‰ΩøÁî®SwiftÂÜôÁöÑPageMenu„ÄÇ ‰∏Ä‰∏™‰ΩøÁî®SwiftÂÜôÁöÑPageMenu„ÄÇÊ≤°ÊúâÈÇ£‰πàÂ§öÊé•Âè£ÔºåËá™Â∑±ÂèØ‰ª•Ê†πÊçÆÂÆûÈôÖÈúÄË¶ÅÊâ©Â±ï„ÄÇÂÜôËøô‰∏™ÁöÑÁõÆÁöÑ‰∏ÄÊòØ‰∏∫‰∫ÜÁªÉÊâãÔºåÊØïÁ´üÂ∑•‰Ωú‰∏≠‰ΩøÁî®SwiftÊûÅÂ∞ëÔºåÂÜç‰∏Ä‰∏™ÔºåPageMenu‰ΩøÁî®Âú∫ÊôØÊå∫Â§öÁöÑÔºåÊàëÈÅáÂà∞ËøáÂ•ΩÂá†Ê¨°ÔºåËøôÊ¨°ÂÅö‰∏Ä‰∏™ÊÄªÁªì„ÄÇ ‰∏Ä„ÄÅÊÄùË∑ØMenuStyle: Áî®‰∫éÊ†áÈ¢òÁöÑÊ†∑ÂºèÈÖçÁΩÆPageTitleView: ÁßÅÊúâÁöÑÂçï‰∏™Ê†áÈ¢òÊéß‰ª∂PageTitle: Ê†áÈ¢òÂå∫ËßÜÂõæPageContent: ÂÜÖÂÆπÂå∫ËßÜÂõæPageMenu: ÁªßÊâøËá™UIViewControllerÁöÑËßÜÂõæÊéßÂà∂Âô®ÔºåÁî®‰∫éËøûÊé•PageTitleÂíåPageContentUIColor+RGB: ‰∏Ä‰∫õÂØπUIColorÁöÑÊãìÂ±ïÔºå‰∏ªË¶ÅÊòØÊîØÊåÅRGBÁöÑÊñπÂºèËÆæÁΩÆÈ¢úËâ≤ ‰∫å„ÄÅ‰ª£Á†ÅMenuStyleclass MenuStyle: UIView &#123; // Ê†áÈ¢ò‰πãÈó¥ÁöÑÈó¥Ë∑ù var margin: CGFloat = 10 // ÈªòËÆ§È¢úËâ≤ var defaultColor = UIColor(r: 0, g: 0, b: 0) // ÈªòËÆ§Â≠ó‰Ωì var defaultFont = UIFont.systemFont(ofSize: 17) // ÈÄâ‰∏≠ÊÄÅÈ¢úËâ≤ var selectedColor = UIColor(r: 239, g: 154, b: 64) // ÈÄâ‰∏≠ÊÄÅÂ≠ó‰Ωì var selectedFont = UIFont.systemFont(ofSize: 18) // ÊåáÁ§∫Êù°È´òÂ∫¶, ‰∏∫0Ë°®Á§∫ÈöêËóè var lineHeight: CGFloat = 2 // ÊåáÁ§∫Êù°ÂÆΩÂ∫¶, ‰∏∫0Ë°®Á§∫Ëá™ÈÄÇÂ∫î var lineWidth: CGFloat = 0 // ÊåáÁ§∫Êù°È¢úËâ≤, ÈªòËÆ§‰∏éselectedColor‰øùÊåÅ‰∏ÄËá¥ var lineColor: UIColor? // ÊòØÂê¶ÂºÄÂêØÊåáÁ§∫Êù°È¢úËâ≤Ê∏êÂèò var lineColorGradual = true // ÊåáÁ§∫Êù°ÂúÜËßí var lineCornerRadius: CGFloat = 2 // Ê†áÈ¢òÂå∫ÁöÑframe var pageTitleFrame = CGRect(x: 0, y: 20, width: UIScreen.main.bounds.width, height: 25) // Ê†áÈ¢òÂå∫‰∏éÂÜÖÂÆπÂå∫ÁöÑÈó¥Ë∑ù var titleContentMargin: CGFloat = 5&#125; PageTitleimport UIKit// ‰ª£ÁêÜprotocol PageTitleDelegate : class &#123; func pageTitleDidSelected(pageTitle: PageTitle, pageTitleView: PageTitleView)&#125;// Ê†áÈ¢òËßÜÂõæÁªÑ‰ª∂class PageTitleView: UIView &#123; // Á¥¢Âºï var index: Int = 0 // Ê†áÈ¢ò var title: String? // Ê∏êÂèòÈ¢úËâ≤ var color: UIColor? &#123; didSet &#123; label.textColor = color &#125; &#125; // Ê†∑Âºè fileprivate var style: MenuStyle // ÈÄâ‰∏≠Áä∂ÊÄÅ fileprivate var isSelected: Bool = false &#123; didSet &#123; reloadState() &#125;// Âà∑Êñ∞Êï∞ÊçÆ &#125; // Ëá™Ë∫´ÂÆΩÂ∫¶ fileprivate var width: CGFloat &#123; return title?.size(withAttributes: [NSAttributedString.Key.font: font]).width ?? 0 &#125; // Â≠ó‰ΩìÂ§ßÂ∞è fileprivate var font: UIFont &#123; return isSelected ? style.selectedFont : style.defaultFont &#125; // Â≠ó‰ΩìÈ¢úËâ≤ fileprivate var fontColor: UIColor &#123; return isSelected ? style.selectedColor : style.defaultColor &#125; // ÁÇπÂáªÂõûË∞É fileprivate var tapCallBack: ((_ view: PageTitleView) -&gt; Void)? private lazy var label: UILabel = &#123; let label = UILabel() let gesture = UITapGestureRecognizer(target: self, action: #selector(action(_:))) label.addGestureRecognizer(gesture) label.isUserInteractionEnabled = true return label &#125;() init(title: String?, isSelected: Bool, style: MenuStyle) &#123; self.title = title self.isSelected = isSelected self.style = style super.init(frame: CGRect.zero) reloadState() self.addSubview(label) &#125; required init?(coder aDecoder: NSCoder) &#123; fatalError("init(coder:) has not been implemented") &#125; // Âä®ÊÄÅÈìæÊé• @objc fileprivate func action(_ tap: UITapGestureRecognizer) &#123; if tapCallBack != nil &#123; tapCallBack!(self) &#125; &#125; // Âà∑Êñ∞Êï∞ÊçÆ private func reloadState() &#123; label.text = title label.textColor = fontColor label.font = font label.sizeToFit() &#125;&#125;// Ê†áÈ¢òËßÜÂõæclass PageTitle: UIView &#123; // ‰ª£ÁêÜ weak var delegate: PageTitleDelegate? private var titleList: [String] private lazy var scrollView: UIScrollView = &#123; var scrollView = UIScrollView(frame: bounds) scrollView.showsHorizontalScrollIndicator = false addSubview(scrollView) return scrollView &#125;() // ÊåáÁ§∫Âô® private lazy var lineView: UIView = &#123; var lineView = UIView() lineView.backgroundColor = menuStyle.lineColor ?? menuStyle.selectedColor lineView.layer.cornerRadius = menuStyle.lineCornerRadius lineView.layer.masksToBounds = true scrollView.addSubview(lineView) return lineView &#125;() // Ê†∑Âºè private var menuStyle: MenuStyle // ÂΩìÂâçÈÄâ‰∏≠Ê†áÈ¢ò private var currentSelectedView: PageTitleView? // Ê†áÈ¢òÂàóË°® private var titleViewList = [PageTitleView]() init(frame: CGRect, menuStyle: MenuStyle, titleList: [String]) &#123; self.menuStyle = menuStyle self.titleList = titleList super.init(frame: frame) setupSubViews() &#125; private func setupSubViews() &#123; var totalWidth: CGFloat = 0 // ËÆæÁΩÆÂ≠êÊéß‰ª∂ for (idx, title) in titleList.enumerated() &#123; let view = PageTitleView(title: title as String, isSelected: false, style: menuStyle) view.index = idx titleViewList.append(view) let x = CGFloat(idx + 1) * menuStyle.margin + totalWidth view.frame = CGRect(x: x, y: 0, width: view.width, height: frame.height - menuStyle.lineHeight) totalWidth += view.width scrollView.addSubview(view) view.tapCallBack = &#123; [weak self] view in guard let self = self else &#123; return &#125; self.changeToSelectedIndex(idx: view.index) &#125; &#125; scrollView.contentSize = CGSize(width: totalWidth + CGFloat(titleList.count + 1) * menuStyle.margin, height: 0) // ÈªòËÆ§ÈÄâ‰∏≠ÁöÑÁ¥¢Âºï 0 changeToSelectedIndex() &#125; required init?(coder aDecoder: NSCoder) &#123; fatalError("init(coder:) has not been implemented") &#125;&#125;// MARK: ÂàáÊç¢ËøáÁ®ã‰∏≠ÈúÄË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞extension PageTitle &#123; private func changeToSelectedIndex(idx: Int = 0, progress: CGFloat = 1) &#123; // Á¥¢ÂºïÂÄºË∂äÁïå if idx &gt; titleViewList.count - 1 || idx &lt; 0 || titleViewList.count &lt;= 0 &#123; return &#125; var fromView, toView: PageTitleView if currentSelectedView == nil &#123; fromView = titleViewList.first! toView = fromView &#125; else &#123; fromView = currentSelectedView! toView = titleViewList[idx] // Âêå‰∏Ä‰∏™Ê†áÈ¢ò if fromView == toView &#123; return &#125; &#125; if menuStyle.lineHeight != 0 &#123; refreshBottomLineFrame(fromView.frame, toView.frame, progress) &#125; if menuStyle.lineColorGradual &#123; refreshTitleViewColor(fromView, toView, progress) &#125; if progress == 1 &#123; refreshTitleViewState(fromView, toView) &#125; &#125; // ËÆæÁΩÆÊåáÁ§∫Êù°frame private func refreshBottomLineFrame(_ from: CGRect, _ to: CGRect, _ progress: CGFloat) &#123; var from = from var to = to let lineHeight = menuStyle.lineHeight let lineWidth = menuStyle.lineWidth let y = frame.height - lineHeight let isFixedLineWidth = lineWidth != 0 let fromWidth = isFixedLineWidth ? lineWidth : from.width let toWidth = isFixedLineWidth ? lineWidth : to.width let fromMinX = isFixedLineWidth ? from.midX - lineWidth * 0.5 : from.minX let fromMaxX = isFixedLineWidth ? fromMinX + lineWidth : from.maxX let toMinX = isFixedLineWidth ? to.midX - lineWidth * 0.5 : to.minX let toMaxX = isFixedLineWidth ? toMinX + lineWidth : to.maxX from = CGRect(x: fromMinX, y: y, width: fromWidth, height: lineHeight) to = CGRect(x: toMinX, y: y, width: toWidth, height: lineHeight) let isToLeft = toMinX &lt; fromMinX // ÂêëÂ∑¶ if progress &lt; 0.5 &#123; if isToLeft &#123; // ÂêëÂ∑¶ÁßªÂä® let offsetWidth = (fromMinX - toMinX) * 2 * progress lineView.frame = CGRect(x: fromMinX - offsetWidth, y: y, width: fromMaxX - fromMinX + offsetWidth, height: lineHeight) &#125; else &#123; let offsetWidth = (toMaxX - fromMaxX) * 2 * progress lineView.frame = CGRect(x: fromMinX, y: y, width:from.width + offsetWidth, height: lineHeight) &#125; &#125; else &#123; if isToLeft &#123; // ÂêëÂ∑¶ÁßªÂä® let offsetWidth = (fromMaxX - to.maxX) * (1 - (progress - 0.5) * 2) lineView.frame = CGRect(x: toMinX, y: y, width:to.width + offsetWidth, height: lineHeight) &#125; else &#123; let offsetWidth = (toMinX - fromMinX) * (1 - (progress - 0.5) * 2) lineView.frame = CGRect(x: toMinX - offsetWidth, y: y, width:toMaxX - toMinX + offsetWidth, height: lineHeight) &#125; &#125; &#125; // Âà∑Êñ∞Ê†áÈ¢òÁä∂ÊÄÅ private func refreshTitleViewState(_ fromView: PageTitleView, _ toView: PageTitleView) &#123; // Êõ¥Êñ∞currentSelectedView currentSelectedView?.isSelected = false toView.isSelected = true currentSelectedView = toView // ËÆæÁΩÆÊ†áÈ¢òÂ±Ö‰∏≠ let width = scrollView.bounds.width let contentWidth = scrollView.contentSize.width var offsetX = toView.center.x - width * 0.5 offsetX = max(offsetX, 0) offsetX = min(contentWidth - width, offsetX) if contentWidth &lt;= width &#123; // ‰øùÊåÅÂ±Ö‰∏≠ let viewWidth = CGFloat(titleViewList.last?.frame.maxX ?? 0) - CGFloat(titleViewList.first?.frame.minX ?? 0) offsetX = -(width - viewWidth) * 0.5 + menuStyle.margin &#125; scrollView.setContentOffset(CGPoint(x: offsetX, y: 0), animated: true) if delegate != nil &#123; delegate?.pageTitleDidSelected(pageTitle: self, pageTitleView: toView) &#125; &#125; // Ê†áÈ¢òÈ¢úËâ≤Ê∏êÂèò private func refreshTitleViewColor(_ fromView: PageTitleView, _ toView: PageTitleView, _ progress: CGFloat) &#123; let toRGB = UIColor.rgbValue(menuStyle.selectedColor) let fromRGB = UIColor.rgbValue(menuStyle.defaultColor) let deltaRGB = (toRGB.0 - fromRGB.0, toRGB.1 - fromRGB.1, toRGB.2 - fromRGB.2) fromView.color = UIColor(r: toRGB.0 - deltaRGB.0 * progress, g: toRGB.1 - deltaRGB.1 * progress, b: toRGB.2 - deltaRGB.2 * progress) toView.color = UIColor(r: fromRGB.0 + deltaRGB.0 * progress, g: fromRGB.1 + deltaRGB.1 * progress, b: fromRGB.2 + deltaRGB.2 * progress) &#125;&#125;// MARK: PageContentDelegateextension PageTitle : PageContentDelegate &#123; func pageContentDidChange(pageContent: PageContent, targetIndex: Int, progress: CGFloat) &#123; changeToSelectedIndex(idx: targetIndex, progress: progress) &#125;&#125; PageContentimport UIKit// ‰ª£ÁêÜprotocol PageContentDelegate : class &#123; func pageContentDidChange(pageContent: PageContent, targetIndex: Int, progress: CGFloat)&#125;class PageContent: UIView &#123; weak var delegate: PageContentDelegate? private var controllerList: [UIViewController] private let identifier = "PageMenu_CollectionView_Identifier" private var currentIndex = 0 private var shouldCallDelegate = false private lazy var collectionView: UICollectionView = &#123; let layout = UICollectionViewFlowLayout() layout.itemSize = bounds.size layout.scrollDirection = .horizontal layout.minimumLineSpacing = 0 layout.minimumInteritemSpacing = 0 var collectionView = UICollectionView(frame: bounds, collectionViewLayout: layout) collectionView.dataSource = self as UICollectionViewDataSource collectionView.delegate = self as UICollectionViewDelegate collectionView.showsHorizontalScrollIndicator = false collectionView.scrollsToTop = false collectionView.isPagingEnabled = true collectionView.bounces = false collectionView.backgroundColor = UIColor.white // Ê≥®ÂÜåcell collectionView.register(UICollectionViewCell.self, forCellWithReuseIdentifier: identifier) addSubview(collectionView) return collectionView &#125;() init(frame: CGRect, controllerList: [UIViewController]) &#123; self.controllerList = controllerList super.init(frame: frame) self.collectionView.reloadData() &#125; required init?(coder aDecoder: NSCoder) &#123; fatalError("init(coder:) has not been implemented") &#125;&#125;// MARK: UICollectionViewDataSourceextension PageContent : UICollectionViewDataSource, UICollectionViewDelegate &#123; func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int &#123; return controllerList.count &#125; func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell &#123; let cell = collectionView.dequeueReusableCell(withReuseIdentifier: identifier, for: indexPath) let view = controllerList[indexPath.row].view! view.frame = cell.bounds cell.contentView.addSubview(view) return cell &#125;&#125;// MARK: UIScrollViewDelegateextension PageContent : UIScrollViewDelegate &#123; func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) &#123; let index = Int(scrollView.contentOffset.x / scrollView.bounds.width) currentIndex = index &#125; func scrollViewWillBeginDragging(_ scrollView: UIScrollView) &#123; shouldCallDelegate = true &#125; func scrollViewDidScroll(_ scrollView: UIScrollView) &#123; if !shouldCallDelegate &#123; return &#125; let width = scrollView.bounds.width let offsetX = scrollView.contentOffset.x - CGFloat(currentIndex) * width let offsetIndex = offsetX &gt; 0 ? 1 : -1 let progress = abs(offsetX) / width if delegate != nil &#123; delegate?.pageContentDidChange(pageContent: self, targetIndex: currentIndex + offsetIndex, progress: progress) &#125; &#125;&#125;// MARK: PageTitleDelegateextension PageContent : PageTitleDelegate &#123; internal func pageTitleDidSelected(pageTitle: PageTitle, pageTitleView: PageTitleView) &#123; shouldCallDelegate = false collectionView.scrollToItem(at: IndexPath(item: pageTitleView.index, section: 0), at: .left, animated: false) currentIndex = pageTitleView.index &#125;&#125; PageMenuimport UIKitclass PageMenu : UIViewController &#123; var pageTitle: PageTitle var pageContent: PageContent var menuStyle: MenuStyle private var controllerList: [UIViewController] init(_ menuStyle: MenuStyle, _ controllerList: [UIViewController]) &#123; var titleList = [String]() for controller in controllerList &#123; titleList.append(controller.title ?? "null") &#125; self.pageTitle = PageTitle(frame: menuStyle.pageTitleFrame, menuStyle: menuStyle, titleList: titleList) self.pageContent = PageContent(frame: CGRect(x: pageTitle.frame.minX, y: pageTitle.frame.maxY + menuStyle.titleContentMargin, width: pageTitle.frame.width, height: UIScreen.main.bounds.height - pageTitle.frame.height), controllerList: controllerList) self.menuStyle = menuStyle self.controllerList = controllerList super.init(nibName: nil, bundle: nil) configureComponent() &#125; required init?(coder aDecoder: NSCoder) &#123; fatalError("init(coder:) has not been implemented") &#125; private func configureComponent() &#123; view.addSubview(pageTitle) view.addSubview(pageContent) for controller in controllerList &#123; addChild(controller) &#125; pageTitle.delegate = pageContent pageContent.delegate = pageTitle &#125;&#125; UIColor+RGBimport Foundationimport UIKitextension UIColor &#123; convenience init(r : CGFloat, g : CGFloat, b : CGFloat) &#123; self.init(red: r / 255.0, green: g / 255.0, blue: b / 255.0, alpha: 1.0) &#125; class func rgbValue(_ color : UIColor) -&gt; (CGFloat, CGFloat, CGFloat) &#123; guard let components = color.cgColor.components else &#123; fatalError("È¢úËâ≤ÊåâÁÖßRGBËÆæÁΩÆ") &#125; return (components[0] * 255, components[1] * 255, components[2] * 255) &#125;&#125; ‰∏â„ÄÅ‰ΩøÁî®ÁÆÄÂçïÈÖçÁΩÆ‰∏Ä‰∏ãMenuStyleÔºåÂàõÂª∫Ëá™Â∑±ÁöÑËßÜÂõæÊéßÂà∂Âô®ÔºåÂ∞±ËÉΩÁõ¥Êé•‰ΩøÁî®‰∫Ü„ÄÇ override func viewDidLoad() &#123; super.viewDidLoad() var controllerList = [UIViewController]() let style: MenuStyle = MenuStyle() // ÂàõÂª∫styleÂπ∂ÈÖçÁΩÆÊ†∑Âºè style.margin = 30 style.defaultColor = UIColor(r: 135, g: 135, b: 135) style.selectedColor = UIColor(r: 0, g: 0, b: 0) // ÂàõÂª∫ÊéßÂà∂Âô® let red = UIViewController() red.view.backgroundColor = UIColor.red red.title = "ÂÖ≥Ê≥®" let blue = UIViewController() blue.view.backgroundColor = UIColor.blue blue.title = "ÁÉ≠Èó®" controllerList = [red, blue] // ÂàõÂª∫PageMenu let pageMenu = PageMenu(style, controllerList) pageMenu.pageTitle.backgroundColor = UIColor(r: 45, g: 184, b: 105) addChild(pageMenu) view.addSubview(pageMenu.view)&#125; Âõõ„ÄÅÊïàÊûúÂæÆÂçöÊ†∑ÂºèÔºö it‰πãÂÆ∂Ê†∑ÂºèÔºö ‰∫î„ÄÅÊÄªÁªìÂ§ÑÁêÜËµ∑Êù•ÊØîËæÉÈ∫ªÁÉ¶‰∏ÄÁÇπÁöÑÂ∞±ÊòØÔºåÊ†áÈ¢òÂå∫ÊåáÁ§∫Êù°ÁöÑframeÊ∏êÂèòÔºåË¶ÅËÄÉËôëÂ∑¶ÊªëÂíåÂè≥ÊªëÁöÑÊÉÖÂÜµÔºåËøòË¶ÅËÄÉËôëËøõÂ∫¶progressÁöÑÈóÆÈ¢ò„ÄÇ‰∏çËøáËøòÂ•ΩÔºå‰ªîÁªÜÊÉ≥ÊÉ≥ÈÉΩËÉΩËß£ÂÜ≥ÁöÑ„ÄÇ ÂÜç‰∏Ä‰∏™ÔºåPageTitleÂíåPageContent‰πãÈó¥‰∫íÁõ∏ÈÄö‰ø°ÁöÑÊñπÊ°àÔºåÊàëÈÄâÊã©ÁöÑÊòØ‰ª£ÁêÜ„ÄÇPageTitleÊòØPageContentÁöÑ‰ª£ÁêÜÔºåÂêåÊó∂ÔºåPageContentÂèàÊòØPageTitleÁöÑ‰ª£ÁêÜ„ÄÇÁî±PageMenuË¥üË¥£ËøûÊé•„ÄÇ]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÂºÄÊ∫êÈ°πÁõÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂÆûÁé∞ÈÄöÁü•‰∏≠ÂøÉ]]></title>
    <url>%2F2019%2F01%2F28%2F%E5%AE%9E%E7%8E%B0%E9%80%9A%E7%9F%A5%E4%B8%AD%E5%BF%83%2F</url>
    <content type="text"><![CDATA[Ëá™Â∑±ÂéªÂÆûÁé∞NotificationCenter„ÄÇ ÊúâÂá†‰∏™Âº±ÂºïÁî®ÂÆπÂô®Âú®Êó•Â∏∏Â∑•‰Ωú‰∏≠Ê≤°ÊúâÁî®ËøáÔºå‰ΩÜÊòØÂèàÁâπÂà´ÊÉ≥‰∫≤ÊâãÂÆûË∑µ‰∏ÄÁï™„ÄÇÂÅ∂Â∞îÁúãÂà∞‰∏ÄÁØáÊñáÁ´†ÔºåËØ¥ÊòØËá™Â∑±ÂÆûÁé∞‰∫ÜÁ≥ªÁªü‰∏≠ÈÄöÁü•‰∏≠ÂøÉÁöÑÂäüËÉΩÔºåÂá∫‰∫éÂ•ΩÂ•áÔºå‰∫éÊòØËá™Â∑±‰πüÂ∞ùËØï‰∏ÄÁï™„ÄÇ ‰∏ªË¶ÅÂéüÁêÜÂ∞±ÊòØÂàõÂª∫‰∏Ä‰∏™Â≠óÂÖ∏observerMapÔºånotificationName‰Ωú‰∏∫keyÔºåNSMapTable‰Ωú‰∏∫value„ÄÇÂú®Ëøô‰∏™NSMapTable‰∏≠ÔºåËßÇÂØüËÄÖobserver‰Ωú‰∏∫keyÔºåÁî®‰∫éÂ≠òÊîæËßÇÂØüËÄÖÁöÑNSHashSet‰Ωú‰∏∫value„ÄÇÊå∫ÁªïÁöÑ„ÄÇ Êé•Âè£Êñá‰ª∂Êé•Âè£‰∏éÁ≥ªÁªü‰øùÊåÅ‰∏ÄËá¥„ÄÇ #import &lt;Foundation/Foundation.h&gt;NS_ASSUME_NONNULL_BEGINtypedef NSString *YANotificationName NS_EXTENSIBLE_STRING_ENUM;@interface YANotificationCenter : NSObject@property (class, readonly, strong) YANotificationCenter *defaultCenter;- (void)addObserver:(id)observer selector:(SEL)aSelector name:(nullable YANotificationName)aName object:(nullable id)anObject;- (void)postNotificationName:(NSNotificationName)aName object:(nullable id)anObject;- (void)postNotificationName:(NSNotificationName)aName object:(nullable id)anObject userInfo:(nullable NSDictionary *)aUserInfo;- (void)removeObserver:(id)observer;- (void)removeObserver:(id)observer name:(nullable YANotificationName)aName object:(nullable id)anObject;@endNS_ASSUME_NONNULL_END Checklist ‰∏çÂ¢ûÂä†observerÂíåobjectÁöÑÂºïÁî®ËÆ°Êï∞ ÊîØÊåÅÊê∫Â∏¶ÂèÇÊï∞‰ø°ÊÅØuserInfo ÂèØ‰ª•‰∏çÊåáÂÆöobject Ê∑ªÂä†ËßÇÂØüËÄÖÊó∂ÊåáÂÆöobjectÔºåpostÈÄöÁü•Êó∂Âè™ÊúâÁõ∏ÂêåÁöÑobjectÊâç‰ºöÊúâÊïà observer‰∏∫nilÔºåÂèëÈÄÅÈÄöÁü•Êó∂Ê≤°Êúâ‰ΩúÁî® ÊåáÂÆöÁ∫øÁ®ãÂèëÈÄÅÈÄöÁü•ÔºåÂàôÂú®ÊåáÂÆöÁ∫øÁ®ãË∞ÉÁî® Ê≤°ÊúâÂèäÊó∂ÁßªÈô§ÈÄöÁü•ÔºåobserverÈîÄÊØÅ‰πãÂêéÁªßÁª≠ÂèëÈÄÅÈÄöÁü•‰∏ç‰ºö‰∫ßÁîüÂºÇÂ∏∏(‰ªéiOS 9ÂºÄÂßãÔºåÂç≥‰Ωø‰∏çÁßªÈô§ËßÇÂØüËÄÖÂØπË±°ÔºåÁ®ãÂ∫è‰πü‰∏ç‰ºöÂá∫Áé∞ÂºÇÂ∏∏„ÄÇ) ÊîØÊåÅÂ§ö‰∏™observerÁõëÂê¨Âêå‰∏Ä‰∏™ÈÄöÁü• Â¶ÇÊûúnotificationName‰∏∫nilÔºåobjectÊúâÂÄºÔºåÂàôÊé•Êî∂ÊâÄÊúâÊåáÂÆö‰∏∫objectÁöÑÈÄöÁü• Â¶ÇÊûúnotificationName‰∏∫nilÔºå‰∏îobject‰πü‰∏∫nilÔºåÂàôÊé•Êî∂Á≥ªÁªüÂÜÖÊâÄÊúâÈÄöÁü•(‰πüÂç≥YANotificationCenterÂèëÂá∫ÁöÑÊâÄÊúâÈÄöÁü•) ÁßªÈô§ÊâÄÊúâÈÄöÁü•ÂêéÔºåÁõ∏ÂÖ≥ÊñπÊ≥ï‰∏çÂÜçË∞ÉÁî® ÁßªÈô§ÊåáÂÆöÈÄöÁü•ÂêéÔºåÁõ∏ÂÖ≥ÊñπÊ≥ï‰∏çÂÜçË∞ÉÁî® ÂêåÊ≠•‰º†ÈÄíÈÄöÁü•ÁªôËßÇÂØüËÄÖ Â§öÊ¨°Ê∑ªÂä†observerÔºåÂèëÈÄÅÈÄöÁü•Êó∂Â§öÊ¨°Ë∞ÉÁî® ÊîØÊåÅÂºÇÊ≠•ÂèëÂ∏ÉÈÄöÁü•ÔºàNotificationQueueÔºâ Â¶ÇÊûúÊÉ≥Ôºõ‚ÄúÂ§öÊ¨°Ê∑ªÂä†observerÔºåÂèëÈÄÅÈÄöÁü•Êó∂Â§öÊ¨°Ë∞ÉÁî®‚ÄùËøô‰∏™Ê≤°ÊúâÂÆûÁé∞„ÄÇÁõÆÂâçÊòØÂ§öÊ¨°Ê∑ªÂä†observerÔºåÂèëÈÄÅÈÄöÁü•Êó∂Âè™‰ºöË∞ÉÁî®‰∏ÄÊ¨°„ÄÇÂÖ∂ÂÆûË¶ÅÂÆûÁé∞‰πüÊúâÂäûÊ≥ïÔºåÂè™ÊòØ‰∏™‰∫∫ÊÑüËßâËøôÊ†∑ÊòØ‰∏çÊòØÊõ¥Â•Ω‰∏ÄÁÇπÔºü ÂäüËÉΩÊµãËØï1. ‰∏çÂØπobserverÂíåobjectÂº∫ÂºïÁî®2. ÂèØ‰ª•Êê∫Â∏¶ÂèÇÊï∞userInfo3. Ê∑ªÂä†ËßÇÂØüËÄÖÊó∂object‰∏∫nilÔºåpostÈÄöÁü•Êó∂objectÊúâÂÄºÔºå‰æùÁÑ∂ÊúâÊïà(Ë°®Á§∫‰∏çÈôê‰∫éÊåáÂÆöÁöÑobject)[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print3:) name:@"Noti_1" object:nil];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_1" object:self userInfo:@&#123;@"key": @"value"&#125;];4. Ê∑ªÂä†ËßÇÂØüËÄÖÊó∂ÊåáÂÆöobjectÔºåpostÈÄöÁü•Êó∂Áõ∏ÂêåÁöÑobjectÔºåÊúâÊïàÔºå‰∏çÂêåÁöÑobjectÔºåÊó†Êïà// ÊúâÊïà[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print3:) name:@"Noti_2" object:self];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_2" object:self userInfo:@&#123;@"key": @"value"&#125;];// Êó†Êïà[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print3:) name:@"Noti_3" object:self];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_3" object:a userInfo:@&#123;@"key": @"value"&#125;];5. ÂèØ‰ª•Ê∑ªÂä†nÊ¨°observerÔºåÂèëÈÄÅÈÄöÁü•Êó∂ÂØπÂ∫îË∞ÉÁî®nÊ¨°(‰∏çÊîØÊåÅ)[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print3:) name:@"Noti_4" object:nil];[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print3:) name:@"Noti_4" object:nil];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_4" object:nil userInfo:@&#123;@"key": @"value"&#125;];6. Êú™Ê∑ªÂä†observerÔºåÂèëÈÄÅÈÄöÁü•Êó∂Ê≤°Êúâ‰ΩúÁî®[YANotificationCenter.defaultCenter postNotificationName:@"Noti_5" object:nil userInfo:@&#123;@"key": @"value"&#125;];7. ÊåáÂÆöÁ∫øÁ®ãÂèëÈÄÅÈÄöÁü•ÔºåÂàôÂú®ÊåáÂÆöÁ∫øÁ®ãË∞ÉÁî®// printÊñπÊ≥ïÊòØÂú®ÂèëÈÄÅÈÄöÁü•ÁöÑÁ∫øÁ®ã‰∏≠Ë∞ÉÁî®ÁöÑ[YANotificationCenter.defaultCenter addObserver:self selector:@selector(print) name:@"Noti_6" object:nil];dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;NSLog(@"ÂΩìÂâçÁ∫øÁ®ã:%@",[NSThread currentThread]);[YANotificationCenter.defaultCenter postNotificationName:@"Noti_6" object:nil userInfo:@&#123;@"key": @"value"&#125;];&#125;);8. Ê≤°ÊúâÂú®observerÁöÑdeallocÊñπÊ≥ï‰∏≠ÁßªÈô§ÈÄöÁü•ÔºåobserverÈîÄÊØÅ‰πãÂêéÁªßÁª≠ÂèëÈÄÅÈÄöÁü•ÔºåÊó†ÂΩ±Âìç(‰ªéiOS 9ÂºÄÂßãÔºåÂç≥‰Ωø‰∏çÁßªÈô§ËßÇÂØüËÄÖÂØπË±°ÔºåÁ®ãÂ∫è‰πü‰∏ç‰ºöÂá∫Áé∞ÂºÇÂ∏∏„ÄÇ)[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print) name:@"Noti_7" object:nil];// aÂØπË±°ÈîÄÊØÅ‰πãÂêéÁªßÁª≠ÂèëÈÄÅÈÄöÁü•[YANotificationCenter.defaultCenter postNotificationName:@"Noti_7" object:nil userInfo:@&#123;@"key": @"value"&#125;];9. Â§ö‰∏™observerÁõëÂê¨Âêå‰∏Ä‰∏™ÈÄöÁü•ÔºåÊâÄÊúâobserverÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ïÂùáÂæóÂà∞Ë∞ÉÁî®[YANotificationCenter.defaultCenter addObserver:a selector:@selector(print) name:@"Noti_8" object:nil];[YANotificationCenter.defaultCenter addObserver:b selector:@selector(print) name:@"Noti_8" object:nil];[YANotificationCenter.defaultCenter addObserver:c selector:@selector(print) name:@"Noti_8" object:nil];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_8" object:nil userInfo:@&#123;@"key": @"value"&#125;];10. Â¶ÇÊûúnotificationName‰∏∫nilÔºåobjectÊúâÂÄºÔºåÂàôÊé•Êî∂ÊâÄÊúâÊåáÂÆö‰∏∫objectÁöÑÈÄöÁü•// Êé•Êî∂selfÂèëÈÄÅÁöÑÊâÄÊúâÈÄöÁü•[YANotificationCenter.defaultCenter addObserver:self selector:@selector(print1) name:nil object:self];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_9" object:self userInfo:@&#123;@"key": @"value"&#125;];11. Â¶ÇÊûúnotificationName‰∏∫nilÔºå‰∏îobject‰πü‰∏∫nilÔºåÂàôÊé•Êî∂Á≥ªÁªüÂÜÖÊâÄÊúâÈÄöÁü•(‰πüÂç≥YANotificationCenterÂèëÂá∫ÁöÑÊâÄÊúâÈÄöÁü•)// Êé•Êî∂Á≥ªÁªüÂÜÖÊâÄÊúâÈÄöÁü•Ôºå‰πüÂç≥‰ªªÊÑè‰∏Ä‰∏™ÈÄöÁü•ÈÉΩ‰ºöËß¶Âèë[YANotificationCenter.defaultCenter addObserver:self selector:@selector(print1) name:nil object:nil];12. ÁßªÈô§ÊâÄÊúâÈÄöÁü•ÂêéÔºåÁõ∏ÂÖ≥ÊñπÊ≥ï‰∏çÂÜçË∞ÉÁî®[YANotificationCenter.defaultCenter addObserver:self selector:@selector(print1) name:@"Noti_10" object:nil];// ÁßªÈô§ÊâÄÊúâÈÄöÁü•ÂêéÔºåÂÜçÊ¨°ÂèëÈÄÅÈÄöÁü•Ê≤°ÊúâÊïàÊûú[YANotificationCenter.defaultCenter removeObserver:self];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_10" object:nil userInfo:@&#123;@"key": @"value"&#125;];13. ÁßªÈô§ÊåáÂÆöÈÄöÁü•ÂêéÔºåÁõ∏ÂÖ≥ÊñπÊ≥ï‰∏çÂÜçË∞ÉÁî®[YANotificationCenter.defaultCenter addObserver:self selector:@selector(print1) name:@"Noti_11" object:nil];// ÁßªÈô§ÊåáÂÆöÈÄöÁü•ÂêéÔºåÂÜçÊ¨°ÂèëÈÄÅÈÄöÁü•Ê≤°ÊúâÊïàÊûú[YANotificationCenter.defaultCenter removeObserver:self name:@"Noti_11" object:nil];[YANotificationCenter.defaultCenter postNotificationName:@"Noti_11" object:nil userInfo:@&#123;@"key": @"value"&#125;]; ÂÆûÁé∞Êñá‰ª∂#import "YANotificationCenter.h"typedef NS_ENUM(NSUInteger, YANotificationSenderType) &#123; YANotificationSenderTypeObject = 0, // ÊåáÂÆöÂØπË±° YANotificationSenderTypeObserver = 1, // ËßÇÂØüËÄÖ&#125;;@interface YANotificationCenter()// Recorder observer.@property (nonatomic, strong) NSMutableDictionary *observerMap;// Recorder all the selector.@property (nonatomic, strong) NSMutableDictionary *selectorMap;@end@implementation YANotificationCenter- (instancetype)init &#123; if (self = [super init]) &#123; _observerMap = [NSMutableDictionary dictionary]; _selectorMap = [NSMutableDictionary dictionary]; &#125; return self;&#125;+ (YANotificationCenter *)defaultCenter &#123; static YANotificationCenter *center = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; center = [[self alloc] init]; &#125;); return center;&#125;- (void)addObserver:(id)observer selector:(SEL)aSelector name:(YANotificationName)aName object:(id)anObject &#123; if (!observer) return; if (!aName) aName = (id)kCFNull; NSMapTable *map = [self.observerMap objectForKey:aName]; if (!map) map = [NSMapTable weakToStrongObjectsMapTable]; if (anObject) &#123; NSHashTable *set = [map objectForKey:observer]; if (!set || ![set isKindOfClass:[NSHashTable class]]) set = [NSHashTable weakObjectsHashTable]; [set addObject:anObject]; [map setObject:set forKey:observer]; &#125; else &#123; [map setObject:(id)kCFNull forKey:observer]; &#125; [self.observerMap setObject:map forKey:aName]; NSString *key = generateKey(observer, anObject, aName); [self.selectorMap setObject:NSStringFromSelector(aSelector) forKey:key];&#125;- (void)postNotificationName:(NSNotificationName)aName object:(id)anObject &#123; [self postNotificationName:aName object:anObject userInfo:nil];&#125;- (void)postNotificationName:(YANotificationName)aName object:(id)anObject userInfo:(NSDictionary *)aUserInfo &#123; // When the notification name is nil. &#123; NSMapTable *map = [self.observerMap objectForKey:(id)kCFNull]; id key = nil; NSEnumerator *enumerator = map.keyEnumerator; while (key = [enumerator nextObject]) &#123; NSHashTable *set = [map objectForKey:key]; NSArray *selectorList = nil; if (set == (id)kCFNull) &#123; selectorList = self.selectorMap.allValues; &#125; else if ([set containsObject:anObject]) &#123; selectorList = selectorListForSender(self, anObject, YANotificationSenderTypeObject); &#125; if (!selectorList) break; [selectorList enumerateObjectsUsingBlock:^(NSString *selector, NSUInteger idx, BOOL * _Nonnull stop) &#123; SEL sel = NSSelectorFromString(selector); ((void (*)(id, SEL, id))[key methodForSelector:sel])(self, sel, aUserInfo); &#125;]; &#125; &#125; // Normal process. NSMapTable *map = [self.observerMap objectForKey:aName]; id key = nil; NSEnumerator *enumerator = map.keyEnumerator; if (anObject) &#123; while (key = [enumerator nextObject]) &#123; NSHashTable *set = [map objectForKey:key]; if (set == (id)kCFNull || [set containsObject:anObject]) &#123; NSString *selector = [self.selectorMap objectForKey:generateKey(key, anObject, aName)]; if (!selector) return; SEL sel = NSSelectorFromString(selector); ((void (*)(id, SEL, id))[key methodForSelector:sel])(self, sel, aUserInfo); &#125; &#125; &#125; else &#123; while (key = [enumerator nextObject]) &#123; NSString *selector = [self.selectorMap objectForKey:generateKey(key, anObject, aName)]; if (!selector) return; SEL sel = NSSelectorFromString(selector); ((void (*)(id, SEL, id))[key methodForSelector:sel])(self, sel, aUserInfo); &#125; &#125;&#125;- (void)removeObserver:(id)observer &#123; [self.observerMap.allValues enumerateObjectsUsingBlock:^(NSMapTable *map, NSUInteger idx, BOOL * _Nonnull stop) &#123; [map removeObjectForKey:observer]; &#125;]; [self.selectorMap removeObjectsForKeys:selectorListForSender(self, observer, YANotificationSenderTypeObserver)];&#125;- (void)removeObserver:(id)observer name:(YANotificationName)aName object:(id)anObject &#123; NSMapTable *map = [self.observerMap objectForKey:aName]; // Remove selector. [self.selectorMap removeObjectForKey:generateKey(observer, anObject, aName)]; if (anObject) &#123; NSHashTable *set = [map objectForKey:observer]; [set removeObject:anObject]; if (set.count == 0) [map removeObjectForKey:observer]; &#125; else &#123; [map removeObjectForKey:observer]; &#125; if (map.count == 0) [self.observerMap removeObjectForKey:aName];&#125;static inline NSString *generateKey(id observer, id anObject, YANotificationName name) &#123; NSString *key = nil; if (anObject) &#123; key = [NSString stringWithFormat:@"%p_%@_%p" ,anObject, name, observer]; &#125; else &#123; key = [NSString stringWithFormat:@"%@_%p", name, observer]; &#125; return key;&#125;static inline NSArray *selectorListForSender(YANotificationCenter *self, id object, YANotificationSenderType type) &#123; NSString *p = [NSString stringWithFormat:@"%p", object]; NSPredicate *predicate = nil; if (type == YANotificationSenderTypeObject) &#123; predicate = [NSPredicate predicateWithFormat:@"SELF BEGINSWITH %@", p]; &#125; else &#123; predicate = [NSPredicate predicateWithFormat:@"SELF ENDSWITH %@", p]; &#125; NSArray *keys = [self.selectorMap.allKeys filteredArrayUsingPredicate:predicate]; NSArray *result = [self.selectorMap objectsForKeys:keys notFoundMarker:(id)kCFNull]; return result.count == 0 ? nil : result;&#125;@end ÂèÇËÄÉËµÑÊñôÔºöhttp://southpeak.github.io/2015/03/20/cocoa-foundation-nsnotificationcenter/]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Weak Associated Object]]></title>
    <url>%2F2019%2F01%2F20%2FWeak%20Associated%20Object%2F</url>
    <content type="text"><![CDATA[ÁªôÂàÜÁ±ªÊ∑ªÂä†weakÂ±ûÊÄßÁöÑÂá†ÁßçÊñπÊ≥ï„ÄÇ ‰ºóÊâÄÂë®Áü•ÔºåÈÄöËøáRuntimeÁöÑÂÖ≥ËÅîÂ±ûÊÄßÊù•ÁªôÂàÜÁ±ªÊ∑ªÂä†‚ÄúÂ±ûÊÄß‚ÄùÔºåËøôÈáåÁöÑÂ±ûÊÄßÁº∫Â∞ë‰∫Ü‰∏•Ê†ºÊÑè‰πâ‰∏äÁöÑÊàêÂëòÂèòÈáèÔºåËÄå‰∏îÊòØËá™Â∑±ÊâãÂä®ÂÆûÁé∞‰∫ÜgetterÊñπÊ≥ïÂíåsetterÊñπÊ≥ï„ÄÇÂá†ÁßçÂÖ≥ËÅîÁ≠ñÁï•‰∏≠Âπ∂Ê≤°Êúâ‰∏éweakÊïàÊûúÁõ∏Â™≤ÁæéÁöÑÈÄâÈ°πÔºåOBJC_ASSOCIATION_ASSIGNÁ≠ñÁï•‰∏éweakÊïàÊûúÁöÑ‰∏ªË¶ÅÂå∫Âà´Âú®‰∫éweakËá™Âä®ËÉΩÂ∞ÜÊåáÂêëÂ∑≤ÈîÄÊØÅÂØπË±°ÁöÑÊåáÈíàÊåá‰∏∫nil„ÄÇ Âç±Èô©ÁöÑASSIGNÂçïÁ∫Ø‰ΩøÁî®ASSIGNÂÆπÊòìËØ±ÂèëÊç¢ÂÜÖÂ≠òËÆøÈóÆÔºåÂéüÂõ†Êó†ÈúÄÂ§öË®Ä„ÄÇ @interface NSObject(Default)@property (nonatomic) id strongObj;@end@implementation NSObject(Default)- (void)setStrongObj:(id)strongObj &#123; objc_setAssociatedObject(self, @selector(strongObj), strongObj, OBJC_ASSOCIATION_ASSIGN);&#125;- (id)strongObj &#123; return objc_getAssociatedObject(self, @selector(strongObj));&#125;@end// Á§∫‰æãÂ¶Ç‰∏ã&#123; NSObject *obj = [NSObject new]; NSObject *main = [NSObject new]; main.strongObj = obj; obj = nil; NSLog(@"%@", main.strongObj); // Crash&#125; ÊûÅÁÆÄÊñπÊ°àËøôÊòØ‰∏ÄÁßçÊûÅÂ•ΩÁöÑÁªôÂàÜÁ±ªÊ∑ªÂä†weakÂ±ûÊÄßÁöÑÂÆûÁé∞ÊñπÂºè„ÄÇÁúãÂà∞ËøôÁßçÂÆûÁé∞ÊñπÂºèÂêéÊûÅ‰∏∫ÂÖ¥Â•ãÔºåÂÆûÂú®Â§™ÁÆÄÊ¥Å„ÄÅÂ∑ßÂ¶ô‰∫Ü„ÄÇ__weakÊú¨Ë∫´Â∞±‰ºöÊääÊåáÈíàÊåáÂêënilÔºåÈÇ£Áõ¥Êé•Âà©Áî®Â∞±ÊòØ‰∫Ü„ÄÇ‰ΩøÁî®OBJC_ASSOCIATION_COPYÂÖ≥ËÅîÁ≠ñÁï•Â∞Üblock copyÂà∞Â†Ü‰∏äÔºåÂà©Áî®blockÊääÊåÅÊúâÁöÑweakÂØπË±°ËøîÂõûÔºåÂ¶ÇÊûúÂØπË±°‰∏çÂ≠òÂú®‰∫ÜÔºåËøîÂõûÁöÑ‰æøÊòØÁ©∫ÂÄº„ÄÇ @interface NSObject(Weak)@property (nonatomic) id object;@end@implementation NSObject(Weak)- (void)setObject:(id)object &#123; id __weak weakObject = object; id (^block)(void) = ^&#123; return weakObject; &#125;; objc_setAssociatedObject(self, @selector(object), block, OBJC_ASSOCIATION_COPY);&#125;- (id)object &#123; id (^block)(void) = objc_getAssociatedObject(self, @selector(object)); return (block ? block() : nil);&#125;@end ÂåÖË£ÖÁ±ªËøôÁßçÊñπÂºèÊòØÈÄöËøáÂåÖË£Ö‰∏Ä‰∏™ÂØπË±°ÂÆûÁé∞ÁöÑ„ÄÇË¶ÅÊ±ÇËÆæÁΩÆÁöÑÂÖ≥ËÅîÂØπË±°ÊòØYAWeakObjectÁ±ªÂûã„ÄÇÂΩìËøô‰∏™ÂØπË±°ÈîÄÊØÅÁöÑÊó∂ÂÄôË∞ÉÁî®deallocBlockÔºåËÄåÂú®Ëøô‰∏™block‰∏≠ÊääÂÖ≥ËÅîÁöÑÂØπË±°ÈáçÊñ∞ËÆæÁΩÆ‰∏∫nil(‰∏çÂèØ‰ΩøÁî®objc_removeAssociatedObjectsÁõ¥Êé•ÁßªÈô§ÂÖ≥ËÅîÂØπË±°)ÔºåËøôÊ†∑ËÆøÈóÆËøô‰∏™ÂÖ≥ËÅîÂØπË±°ÁöÑÊó∂ÂÄôÂæóÂà∞ÁöÑÂ∞±ÊòØnilÂÄº‰∫Ü„ÄÇ ËøôÁßçÊñπÂºè‰ºöÊ±°ÊüìweakÂ±ûÊÄßÔºåË¶ÅÊ±ÇË¢´ËÆæÁΩÆ‰∏∫weakÂ±ûÊÄßÁöÑÂØπË±°ÂøÖÈ°ªÊòØÊüêÁßçÁ±ªÂûãÔºå‰∏çÊòØÂ§™Â•Ω„ÄÇÂΩìÁÑ∂Ê†πÊçÆËøôÁßçÊÄùË∑ØÔºåËøòÂèØ‰ª•Ëøõ‰∏ÄÊ≠•Â∞ÅË£ÖÔºåÊúÄÁªàÁöÑËêΩËÑöÁÇπÊó†ÈùûÊòØÊèê‰æõÊñ∞ÁöÑÊñπÊ≥ïÊé•Âè£Êõø‰ª£ÂéüÁîüÁöÑËøêË°åÊó∂ÊñπÊ≥ï(ËßÅÂèÇËÄÉÊñáÁ´†)„ÄÇ@interface NSObject(WeakClass)@property (nonatomic) YAWeakObject *weakObject;@end@implementation NSObject(WeakClass)- (YAWeakObject *)weakObject &#123; return objc_getAssociatedObject(self, @selector(weakObject));&#125;- (void)setWeakObject:(YAWeakObject *)weakObject &#123; objc_setAssociatedObject(self, @selector(weakObject), weakObject, OBJC_ASSOCIATION_ASSIGN); typeof(self) slf = self; void (^block)(void) = ^&#123; typeof(slf) self = slf; objc_setAssociatedObject(self, @selector(weakObject), nil, OBJC_ASSOCIATION_ASSIGN); &#125;; [weakObject setDeallocBlock:block];&#125;@end ‰ΩøÁî®ÂÆπÂô®ÂÆûÈôÖ‰∏ä‰ΩøÁî®ÊîØÊåÅÂº±ÂºïÁî®ÁöÑÂÆπÂô®Â¶ÇNSHashTable„ÄÅNSMapTable„ÄÅNSPointerArrayÈÉΩÊòØÂèØ‰ª•ÂÆûÁé∞ÁöÑ„ÄÇÂéüÁêÜÂæàÁÆÄÂçïÔºå‰ΩøÁî®ÂÆπÂô®ÊåÅÊúâÂÖ≥ËÅîÁöÑÂØπË±°ÔºåÂΩìËØ•ÂØπË±°‰∏çÂ≠òÂú®Êó∂ÔºåÂÆπÂô®Ëá™Ë∫´‰æøÊúâËá™Âä®ÁßªÈô§Â∑≤ÈîÄÊØÅÂØπË±°ÁöÑÁâπÊÄßÔºåËøôÊ†∑Â∞±ÂÆûÁé∞‰∫ÜweakÂ±ûÊÄß„ÄÇ NSMapTable ÂèØ‰ª•ÊåÅÊúâÈîÆÂíåÂÄºÁöÑÂº±ÂºïÁî®ÔºåÂΩìÈîÆÊàñËÄÖÂÄºÂΩì‰∏≠ÁöÑ‰∏Ä‰∏™Ë¢´ÈáäÊîæÊó∂ÔºåÊï¥‰∏™Ëøô‰∏ÄÈ°πÂ∞±‰ºöË¢´ÁßªÈô§Êéâ„ÄÇNSHashTable ÂèØ‰ª•ÊåÅÊúâÊàêÂëòÁöÑÂº±ÂºïÁî®„ÄÇNSPointerArray ÂèØ‰ª•ÊåÅÊúâÊàêÂëòÁöÑÂº±ÂºïÁî®ÔºåÂΩìÊàêÂëò‰∏çÂ≠òÂú®Êó∂Ëá™Âä®ÊääÊâÄÂú®indexÁΩÆ‰∏∫NULL„ÄÇ ËøôÁßçÂÅöÊ≥ïÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ÂÆπÂô®ÔºåÁõ∏ÂØπÊØîËæÉÈ∫ªÁÉ¶„ÄÇ @interface NSObject(WeakContainer)@property (nonatomic) id weakObj;@end@implementation NSObject(WeakContainer)static NSPointerArray *gPointerArray = nil;- (id)weakObj &#123; if (!gPointerArray) return nil; // Removes NULL values from the receiver.(sometimes doesn't work as documented) [gPointerArray compact]; for (id obj in gPointerArray) &#123; if (obj != NULL) &#123; return objc_getAssociatedObject(self, @selector(weakObj)); &#125; &#125; gPointerArray = nil; return nil;&#125;- (void)setWeakObj:(id)weakObj &#123; if (weakObj) &#123; if (!gPointerArray) gPointerArray = [NSPointerArray weakObjectsPointerArray]; [gPointerArray addPointer:(__bridge void *)weakObj]; objc_setAssociatedObject(self, @selector(weakObj), weakObj, OBJC_ASSOCIATION_ASSIGN); &#125;&#125;@end Â§öËØ¥‰∏ÄÂè•Êúâ‰∏Ä‰∏™‰∏úË•øÂú®‰ΩúËÄÖÁöÑÊñáÁ´†ÈáåÁúãÂà∞ÔºåÊØîËæÉÊúâÊÑèÊÄù„ÄÇ Weak Singleton+ (instancetype)sharedWeakInstance &#123; static __weak id weakObj = nil; id strongObj = weakObj; @synchronized (self) &#123; if (!strongObj) &#123; strongObj = [[self class] new]; weakObj = strongObj; &#125; &#125; return strongObj;&#125; Â∫îÁî®Âú∫ÊôØ:‰∏çÈúÄË¶Å‰øùÂ≠òÂÖ¨ÂÖ±ÁöÑ‰ø°ÊÅØ„ÄÅÁî®Êà∑Áä∂ÊÄÅÁ≠âÔºåÁ¨¶Âêà‚ÄùÁî®ÂÆåÂ∞±Ëµ∞‚Äù„ÄÇÂ¶ÇÊûúÁ±ª‰ººLoginManagerÁÆ°ÁêÜÁôªÂΩïÁä∂ÊÄÅÔºåÁªßÊâøËá™ AFHttpSessionManagerÁöÑNetworkManagerÂçï‰æãÔºåAppÂçï‰æãClientManagerÁ≠âÂàô‰∏çÈÄÇÁî®ËøôÁßçÊñπÂºè„ÄÇ ÂèÇËÄÉËµÑÊñôÔºö https://www.jianshu.com/p/ed65d71554d8https://blog.csdn.net/yan_1564335/article/details/53996538http://mrpeak.cn/blog/ios-weak/]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄåKVOController„ÄçÁöÑÂ∞ÅË£Ö]]></title>
    <url>%2F2019%2F01%2F12%2F%E3%80%8CKVOController%E3%80%8D%E7%9A%84%E5%B0%81%E8%A3%85%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π†KVOÁöÑÂ∞ÅË£Ö„ÄÇ KVOControllerÊ∫êÁ†ÅÂè™Êúâ700Ë°åÂ∑¶Âè≥ÔºåËØª‰∏ÄÈÅç‰∏ãÊù•ËøòÊòØÊØîËæÉÈÄöÁïÖÁöÑ„ÄÇËøôÈáåÂÅö‰∏Ä‰∏™ËÆ∞ÂΩï„ÄÇ ‰∏Ä„ÄÅ‰ΩøÁî®‰ΩøÁî®Ëµ∑Êù•ÊûÅÂÖ∂ÁÆÄ‰æø„ÄÇ // ËÆæÁΩÆÊâÄËßÇÂØüÁöÑÂØπË±°ÂèäÂÖ∂keyPath[self.KVOController observe:self.myButton keyPath:@"backgroundColor" options:NSKeyValueObservingOptionNew block:^(id _Nullable observer, id _Nonnull object, NSDictionary&lt;NSKeyValueChangeKey,id&gt; * _Nonnull change) &#123; NSLog(@"%@", change[NSKeyValueChangeNewKey]);&#125;]; ËøôÈáåÁöÑself.KVOControllerÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ÈªòËÆ§ÔºåÂõ†‰∏∫KVOControllerÊòØÊáíÂä†ËΩΩÁöÑ„ÄÇ ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊòØÂÉè‰∏äÈù¢ËøôÊ†∑‰ΩøÁî®ÁöÑÔºåËøòÊúâ‰∏ÄÁßçÊÉÖÂÜµÔºå‰∏çÈúÄË¶ÅÂº∫ÊåÅÊúâË¢´ËßÇÂØüËÄÖÁöÑÊó∂ÂÄôÔºö [self.KVOControllerNonRetaining observe:self.myButton keyPath:@"backgroundColor" options:NSKeyValueObservingOptionNew block:^(id _Nullable observer, id _Nonnull object, NSDictionary&lt;NSKeyValueChangeKey,id&gt; * _Nonnull change) &#123; NSLog(@"%@", change[NSKeyValueChangeNewKey]);&#125;]; Âè™ÈúÄ‰ΩøÁî®self.KVOControllerNonRetainingÂç≥ÂèØ‰∏çÂ¢ûÂä†Ë¢´ËßÇÂØüËÄÖself.myButtonÁöÑÂºïÁî®ËÆ°Êï∞„ÄÇ ‰∫å„ÄÅÂàÜÁ±ª@interface NSObject (FBKVOController)@property (nonatomic, strong) FBKVOController *KVOController;@property (nonatomic, strong) FBKVOController *KVOControllerNonRetaining;@end Ë¶ÅÂÆûÁé∞‰ª•‰∏ä‰ΩøÁî®ÁöÑÊñπÂºèÔºåÊòØÁªô NSObject ÂàÜÁ±ªÊ∑ªÂä†‰∏§‰∏™Â±ûÊÄß:KVOControllerÂíåKVOControllerNonRetaining„ÄÇËøô‰∏™ÊØîËæÉÁÆÄÂçïÔºå‰ΩøÁî®Runtime ÁöÑÂÖ≥ËÅîÂ±ûÊÄßÂç≥ÂèØ„ÄÇÂÄºÂæó‰∏ÄÊèêÁöÑÊòØ‰ΩúËÄÖÂú® getter ÊñπÊ≥ïÈáå‰ΩøÁî®‰∫ÜÊáíÂä†ËΩΩÔºåÂè™ÊúâÂΩì‰ΩøÁî®Âà∞KVOControllerÊàñËÄÖKVOControllerNonRetainingÁöÑÊó∂ÂÄôÔºåÊâç‰ºöÂàõÂª∫„ÄÇÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•ÈÄâÊã©Ëá™Ë°åÂàõÂª∫„ÄÇ - (FBKVOController *)KVOController &#123; id controller = objc_getAssociatedObject(self, NSObjectKVOControllerKey); // ÊáíÂä†ËΩΩKVOController, Áî®Âà∞Êó∂Êâç‰ºöÂàõÂª∫ if (nil == controller) &#123; controller = [FBKVOController controllerWithObserver:self]; self.KVOController = controller; &#125; return controller;&#125;- (FBKVOController *)KVOControllerNonRetaining &#123; id controller = objc_getAssociatedObject(self, NSObjectKVOControllerNonRetainingKey); if (nil == controller) &#123; controller = [[FBKVOController alloc] initWithObserver:self retainObserved:NO]; self.KVOControllerNonRetaining = controller; &#125; return controller;&#125; ‰ª•‰∏ä‰∏§‰∏™ getter ÊñπÊ≥ïÂàÜÂà´ÂØπÂ∫îÂº∫ÂºïÁî®Ë¢´ËßÇÂØüËÄÖÂíåÂº±ÂºïÁî®Ë¢´ËßÇÂØüËÄÖ„ÄÇ ‰∏â„ÄÅÊé•Âè£Áî±Ê≠§ÂèØ‰ª•ÁúãÂà∞ÔºåÊ†∏ÂøÉÂäüËÉΩÁöÑÂÆûÁé∞‰æùËµñ‰∫éFBKVOController„ÄÇ // Âº∫ÂºïÁî®+ (instancetype)controllerWithObserver:(nullable id)observer;- (instancetype)initWithObserver:(nullable id)observer;// ÊåáÂÆöÊûÑÈÄ†Âô®- (instancetype)initWithObserver:(nullable id)observer retainObserved:(BOOL)retainObserved NS_DESIGNATED_INITIALIZER;- (instancetype)init NS_UNAVAILABLE;+ (instancetype)new NS_UNAVAILABLE; ÊûÑÈÄ†ÊñπÊ≥ïÈáå‰∏ªË¶ÅÊö¥Èú≤‰∫Ü‰∏§ÁßçÂàùÂßãÂåñÊñπÂºèÔºåÂÖ∂‰∏≠ÈÄöËøáinitWithObserverËøô‰∏™ÊñπÊ≥ïÂèØ‰ª•ËÆæÁΩÆÂèÇÊï∞retainObserved‰ª•Ë°®ÊòéÊòØÂê¶ÈúÄË¶ÅÂº∫ÂºïÁî®Ë¢´ËßÇÂØüËÄÖ„ÄÇ @property (nullable, nonatomic, weak, readonly) id observer; Âè™Êúâ‰∏Ä‰∏™Âè™ËØªÂ±ûÊÄßÔºåÁªôÂá∫Ë¢´ËßÇÂØüËÄÖÂØπË±°„ÄÇ - (void)observe:(nullable id)object keyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options block:(FBKVONotificationBlock)block;- (void)observe:(nullable id)object keyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options action:(SEL)action;- (void)observe:(nullable id)object keyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(nullable void *)context; ‰ΩúËÄÖÁªôÂá∫‰∫ÜÂõûË∞ÉÁöÑ‰∏â‰∏™ÈÄâÈ°πÔºöblockÂõûË∞ÉÔºåÈÄâÊã©Â≠êÂõûË∞É‰ª•Âèä KVO ÈªòËÆ§ÊñπÊ≥ïÂõûË∞É„ÄÇÂèØ‰ª•Âú®Ê∑ªÂä†Ë¢´ËßÇÂØüËÄÖÁöÑÊó∂ÂÄôËá™Ë°åÈÄâÊã©„ÄÇ - (void)observe:(nullable id)object keyPaths:(NSArray&lt;NSString *&gt; *)keyPaths options:(NSKeyValueObservingOptions)options block:(FBKVONotificationBlock)block;- (void)observe:(nullable id)object keyPaths:(NSArray&lt;NSString *&gt; *)keyPaths options:(NSKeyValueObservingOptions)options action:(SEL)action;- (void)observe:(nullable id)object keyPaths:(NSArray&lt;NSString *&gt; *)keyPaths options:(NSKeyValueObservingOptions)options context:(nullable void *)context; ËÄÉËôëÂà∞‰∏ç‰∏ÄÂÆöÂè™ËßÇÂØü‰∏Ä‰∏™ÂØπË±°ÁöÑ‰∏Ä‰∏™ÊàêÂëòÂèòÈáèÔºåÂõ†Ê≠§‰ΩúËÄÖÊèê‰æõ‰∫ÜkeyPathsÈÄâÈ°πÔºåÂèØ‰ª•ÂêåÊó∂ËßÇÂØü‰∏Ä‰∏™ÂØπË±°ÁöÑÂ§ö‰∏™keyPathÔºö‰º†ÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÂç≥ÂèØ„ÄÇ - (void)unobserve:(nullable id)object keyPath:(NSString *)keyPath;- (void)unobserve:(nullable id)object;- (void)unobserveAll; ÁßªÈô§ÁõëÂê¨Êèê‰æõ‰∏âÁßçÊé•Âè£ÔºöÁßªÈô§Êüê‰∏™ÂØπË±°Êüê‰∏™keyPath ÁöÑÁõëÂê¨ÔºåÁßªÈô§ÂØπÊüê‰∏™ÂØπË±°ÁöÑÁõëÂê¨ÔºåÂèñÊ∂àËßÇÂØüËÄÖÂØπÊâÄÊúâÂØπË±°ÁöÑÊâÄÊúâÁõëÂê¨„ÄÇ Âõõ„ÄÅFBKVOControllerÂÆûÁé∞ÊûÑÈÄ†Âô®@implementation FBKVOController &#123; NSMapTable&lt;id, NSMutableSet&lt;_FBKVOInfo *&gt; *&gt; *_objectInfosMap; pthread_mutex_t _lock;&#125; FBKVOController‰∏ªË¶ÅÁª¥Êä§‰∫Ü‰∏Ä‰∏™NSMapTable„ÄÇkey ÊòØÊâÄËßÇÂØüÁöÑÂØπË±°Ôºåvalue ÊòØNSMutableSetÁ±ªÂûãÁöÑÈõÜÂêà(ÂÜÖÈÉ®ÂÖÉÁ¥†ÊòØ_FBKVOInfoÁ±ªÂûã)„ÄÇÁª¥Êä§‰∏Ä‰∏™NSMapTableÁöÑÂéüÂõ†ÊòØÔºö‰æø‰∫éËßÇÂØü‰∏Ä‰∏™ÂØπË±°ÁöÑÂ§ö‰∏™keyPathÔºåËøô‰∏™ÂØπË±°‰Ωú‰∏∫ keyÔºåËøôËÆ∏Â§ö‰∏™keyPathÂ∞ÅË£ÖÊàê‰∏Ä‰∏™‰∏™_FBKVOInfoÂ≠òÂÖ•NSMutableSet‰∏≠„ÄÇÂè¶Â§ñ‰∏Ä‰∏™ÊàêÂëòÂèòÈáè_lock‰∏ªË¶ÅÊòØ‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ - (instancetype)initWithObserver:(nullable id)observer retainObserved:(BOOL)retainObserved &#123; self = [super init]; if (nil != self) &#123; _observer = observer; // Ê†πÊçÆÊòØÂê¶retainObservedÔºåÈÄâÊã©NSMapTableÁöÑ"Âº∫-Âº∫"ÊàñËÄÖ"Âº±-Âº∫" NSPointerFunctionsOptions keyOptions = retainObserved ? NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPointerPersonality : NSPointerFunctionsWeakMemory|NSPointerFunctionsObjectPointerPersonality; _objectInfosMap = [[NSMapTable alloc] initWithKeyOptions:keyOptions valueOptions:NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPersonality capacity:0]; pthread_mutex_init(&amp;_lock, NULL); &#125; return self;&#125; FBKVOControllerÊâÄÊúâÊö¥Èú≤ÁöÑÊûÑÈÄ†ÊñπÊ≥ïÊé•Âè£ÈÉΩÊåáÂêë‰∫Ü‰∏äÈù¢ÁöÑÈÇ£‰∏™ÂÆûÁé∞„ÄÇËøô‰∏™ÊñπÊ≥ïÂè™ÂÅö‰∫Ü‰∏â‰ª∂‰∫ã: 1ÔºåÂàùÂßãÂåñÁ∫øÁ®ãÈîÅ_lockÔºå2ÔºåÊ†πÊçÆretainObservedÂèÇÊï∞ÂàõÂª∫‰∏çÂêåÁ±ªÂûãÁöÑNSMapTableÔºåÊòØÈÄâÊã©‚ÄùÂº∫-Âº∫‚ÄùËøòÊòØÈÄâÊã©‚ÄùÂº±-Âº∫‚Äù„ÄÇ3ÔºåÂ±ûÊÄßobserverËµãÂÄº„ÄÇ Áî±Ê≠§ÂèØËßÅÔºåFBKVOControllerÊú¨Ë∫´ÂØπË¢´ËßÇÂØüËÄÖobserverÊòØÂº±ÂºïÁî®ÁöÑ(Êúâ‰∏Ä‰∏™ weak Â±ûÊÄßÁöÑobserverÊàêÂëòÂèòÈáè)ÔºåÈÄöËøáÁª¥Êä§‰∏Ä‰∏™NSMapTableÊù•ÊúÄÁªàÁ°ÆÂÆöÂØπË¢´ËßÇÂØüËÄÖÁöÑÂº∫Âº±ÂºïÁî®ÂÖ≥Á≥ª„ÄÇ Êé•Âè£ÂÆûÁé∞- (void)observe:(nullable id)object keyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options block:(FBKVONotificationBlock)block &#123; if (nil == object || 0 == keyPath.length || NULL == block) &#123; return; &#125; // ÂàõÂª∫Êï∞ÊçÆÁªìÊûÑ_FBKVOInfo _FBKVOInfo *info = [[_FBKVOInfo alloc] initWithController:self keyPath:keyPath options:options block:block]; // Ê∑ªÂä†ÂØπobjectÁöÑËßÇÂØü, Âπ∂‰º†ÂÖ•info [self _observe:object info:info];&#125; ‰ª•Ê∑ªÂä†‰∏Ä‰∏™Ë¢´ËßÇÂØüËÄÖÂπ∂‰∏îÂõûË∞ÉÊòØ block ‰∏∫‰æã„ÄÇÂú®Ëøô‰∏™ÊñπÊ≥ïÈáåÈ¶ñÂÖàÊòØÂØπÂèÇÊï∞ÁöÑÂêàÁêÜÊÄßÂà§Êñ≠ÔºåË¶ÅÊ±Çobject„ÄÅkeyPath‰ª•ÂèäblockÂùáÊòØÂêàÁêÜÂÄº„ÄÇ Êé•ÁùÄÊääkeyPath„ÄÅoptions„ÄÅblockÂåÖË£ÖÊàê‰∏Ä‰∏™Êï∞ÊçÆÁªìÊûÑ_FBKVOInfo„ÄÇ ÊúÄÂêéË∞ÉÁî®Ëá™Â∑±ÁöÑ_observe:info:ÊñπÊ≥ïÔºå‰º†ÂÖ•objectÂíåinfo„ÄÇ _FBKVOInfoÊï∞ÊçÆÁªìÊûÑ@interface _FBKVOInfo : NSObject@end@implementation _FBKVOInfo &#123;@public __weak FBKVOController *_controller; NSString *_keyPath; NSKeyValueObservingOptions _options; SEL _action; void *_context; FBKVONotificationBlock _block; _FBKVOInfoState _state;&#125; _FBKVOInfoÊòØ‰∏Ä‰∏™Êï∞ÊçÆÁªìÊûÑÔºåÂåÖÂê´‰∫ÜÁõëÂê¨ÁöÑkeyPath„ÄÅblock„ÄÅÈÄâÊã©Â≠ê„ÄÅcontextÁ≠âÁ≠âÂÖÉÁ¥†„ÄÇ - (instancetype)initWithController:(FBKVOController *)controller keyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options block:(nullable FBKVONotificationBlock)block action:(nullable SEL)action context:(nullable void *)context &#123; self = [super init]; if (nil != self) &#123; _controller = controller; _block = [block copy]; _keyPath = [keyPath copy]; _options = options; _action = action; _context = context; &#125; return self;&#125; ÊûÑÈÄ†ÊñπÊ≥ïÁöÑÂÆûÁé∞Â∞±ÊòØËøôÊ†∑Ôºå‰∏çËøáÊúâ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπ:blockÂíåkeyPathË∞ÉÁî®‰∏Ä‰∏ã copy ÊñπÊ≥ï„ÄÇkeyPathË∞ÉÁî®‰∏Ä‰∏ã copyÁöÑÂéüÂõ†ÊòØÔºåËøôÈáåÁöÑ_keyPathÊòØ‰ΩøÁî®__strong‰øÆÈ•∞ÁöÑÔºåÂ¶ÇÊûúÂ§ñÈù¢‰º†ËøõÊù•ÁöÑÊòØ‰∏çÂèØÂèòÂ≠óÁ¨¶‰∏≤ÔºåËá™ÁÑ∂Ê≤°ÊúâÂï•ÈóÆÈ¢òÔºåÂèØÊòØ‰∏ÄÊó¶‰º†ËøõÊù•‰∏Ä‰∏™ÂèØÂèòÂ≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊûúÁõ¥Êé•ËµãÂÄº_keyPath = keyPath;ÔºåÂΩìËøô‰∏™ÂèØÂèòÂ≠óÁ¨¶‰∏≤ÊîπÂèòÂ∞±‰ºöÈÄ†Êàê_keyPath‰πüÊîπÂèòÔºåÊØîËæÉÂÆπÊòì‰∫ßÁîü‰∏çÂèØÊéß‰∫ã‰ª∂ÔºåÊâÄ‰ª•Ë∞ÉÁî® copyÊñπÊ≥ïÔºå‰πüÂç≥ÊòØÊ∑±Â§çÂà∂ÊµÖÂ§çÂà∂ÁöÑÈóÆÈ¢ò„ÄÇ Ê≤°ÊúâÊ∑±Â§çÂà∂ÁöÑÁ§∫‰æãÂ¶Ç‰∏ãÔºö NSMutableString *str = [NSMutableString stringWithString:@"key"]; // ÂÅáÂÆöÊòØ_keyPath = keyPath;ËÄå‰∏çÊòØ_keyPath = [keyPath copy]; _FBKVOInfo *info = [[_FBKVOInfo alloc] initWithController:self keyPath:str options:NSKeyValueObservingOptionNew block:^(id _Nullable observer, id _Nonnull object, NSDictionary&lt;NSKeyValueChangeKey,id&gt; * _Nonnull change) &#123; &#125; action:@selector(push) context:nil]; [str appendString:@"new"]; NSLog(@"%@", info-&gt;_keyPath); //info-&gt;_keyPath‰∏çÁ¨¶ÂêàÈ¢ÑÊúüÁöÑÊîπÂèò‰∫Ü ÂêåÊ†∑Ôºåblock ÁöÑcopyÊòØÊääblock‰ªéÊ†àÊã∑Ë¥ùÂà∞Â†Ü‰∏≠ÔºåÈò≤Ê≠¢Ë¢´ÈáäÊîæ„ÄÇÂõ†‰∏∫block‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ÂáΩÊï∞‰∏ç‰ºöË¢´ copyÔºå‰æùÁÑ∂Âú®Ê†à‰∏äÔºåÊñπÊ≥ïÊâßË°åÂÆåÁ´ãÂç≥ÈáäÊîæÁöÑ„ÄÇ Âú®ARC‰∏ãÔºöÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÁ≥ªÁªü‰ºöÊääBlockËá™Âä®copyÂà∞Â†Ü‰∏ä„ÄÇ Block‰Ωú‰∏∫ÂèòÈáèÔºöÊñπÊ≥ï‰∏≠Â£∞Êòé‰∏Ä‰∏™ block ÁöÑÊó∂ÂÄôÊòØÂú®Ê†à‰∏äÔºõÂºïÁî®‰∫ÜÂ§ñÈÉ®Â±ÄÈÉ®ÂèòÈáèÊàñÊàêÂëòÂèòÈáè, Âπ∂‰∏îÊúâËµãÂÄºÊìç‰ΩúÔºàÊúâÂêçÂ≠óÔºâÔºå‰ºöË¢´ copy Âà∞Â†Ü‰∏äÔºõËµãÂÄºÁªôÈôÑÊúâ__strong‰øÆÈ•∞Á¨¶ÁöÑidÁ±ªÂûãÁöÑÁ±ªÊàñËÄÖBlcokÁ±ªÂûãÊàêÂëòÂèòÈáèÊó∂ÔºõËµãÂÄºÁªô‰∏Ä‰∏™ weak ÂèòÈáè‰∏ç‰ºöË¢´ copyÔºõ Block‰Ωú‰∏∫Â±ûÊÄßÔºöÁî® copy ‰øÆÈ•∞‰ºöË¢´ copyÔºõ Block‰Ωú‰∏∫ÂáΩÊï∞ÂèÇÊï∞Ôºö‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ÂáΩÊï∞‰∏ç‰ºöË¢´ copyÔºå‰æùÁÑ∂Âú®Ê†à‰∏äÔºåÊñπÊ≥ïÊâßË°åÂÆåÂç≥ÈáäÊîæÔºõ‰Ωú‰∏∫ÂáΩÊï∞ÁöÑËøîÂõûÂÄº‰ºöË¢´ copy Âà∞Â†ÜÔºõ - (NSUInteger)hash &#123; return [_keyPath hash];&#125;- (BOOL)isEqual:(id)object &#123; if (nil == object) &#123; return NO; &#125; if (self == object) &#123; return YES; &#125; if (![object isKindOfClass:[self class]]) &#123; return NO; &#125; return [_keyPath isEqualToString:((_FBKVOInfo *)object)-&gt;_keyPath];&#125; _FBKVOInfoËøòÂÅö‰∫Ü‰∏ÄÁÇπÂÖ∂‰ªñÁöÑ‰∫ãÔºö1.ÈáçÂÜô‰∫Ü- (NSUInteger)hash;ÊñπÊ≥ïÔºå‰ΩøÁî®_keyPathÁöÑ hash ÂÄºÊù•‰Ωú‰∏∫_FBKVOInfoÁöÑ hash ÂÄº„ÄÇÂàÜÈÖçÁöÑËøô‰∏™hashÂÄº(Âç≥Áî®‰∫éÊü•ÊâæÈõÜÂêà‰∏≠ÊàêÂëòÁöÑ‰ΩçÁΩÆÊ†áËØÜ)ÔºåÂ∞±ÊòØÈÄöËøáhashÊñπÊ≥ïËÆ°ÁÆóÂæóÊù•ÁöÑÔºå‰∏îhashÊñπÊ≥ïËøîÂõûÁöÑhashÂÄºÊúÄÂ•ΩÂîØ‰∏Ä„ÄÇ2.ÈáçÂÜô‰∫Ü- (BOOL)isEqual:(id)object;ÊñπÊ≥ïÔºåÊª°Ë∂≥EqualÁöÑÊù°‰ª∂Êúâ‰∏§‰∏™: È¶ñÂÖàÊòØÁ±ªÂØπË±°‰∏ÄËá¥ÔºåÂÜçËÄÖÊòØ_keyPathÂåπÈÖç„ÄÇÊç¢Âè•ËØùËØ¥Ôºå_keyPathÂÜ≥ÂÆö‰∫Ü_FBKVOInfoÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™„ÄÇ‰∏∫‰∫Ü‰ºòÂåñÂà§Á≠âÁöÑÊïàÁéáÔºåÂü∫‰∫éhashÁöÑNSSetÂíåNSDictionaryÂú®Âà§Êñ≠ÊàêÂëòÊòØÂê¶Áõ∏Á≠âÊó∂Ôºå ‰ºöËøôÊ†∑ÂÅöStep1: ÊàêÂëòÁöÑhashÂÄºÊòØÂê¶ÂíåÁõÆÊ†áhashÂÄºÁõ∏Á≠âÔºåÂ¶ÇÊûúÁõ∏ÂêåËøõÂÖ•Step 2ÔºåÂ¶ÇÊûú‰∏çÁ≠âÔºåÁõ¥Êé•Âà§Êñ≠‰∏çÁõ∏Á≠âStep 2: hashÂÄºÁõ∏Âêå(Âç≥Step 1)ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÜçËøõË°åÂØπË±°Âà§Á≠âÔºå ‰Ωú‰∏∫Âà§Á≠âÁöÑÁªìÊûú„ÄÇ hashÂÄºÊòØÂØπË±°Âà§Á≠âÁöÑÂøÖË¶ÅÈùûÂÖÖÂàÜÊù°‰ª∂ NSPointerFunctionsObjectPointerPersonalityÂØπ‰∫é isEqual: Âíå hash ‰ΩøÁî®Áõ¥Êé•ÁöÑÊåáÈíàÊØîËæÉ„ÄÇ‰ΩøÁî®Áßª‰ΩçÊåáÈíà(shifted pointer)Êù•ÂÅöhashÊ£ÄÊµãÂèäÁ°ÆÂÆö‰∏§‰∏™ÂØπË±°ÊòØÂê¶Áõ∏Á≠âÔºõÂêåÊó∂‰ΩøÁî®descriptionÊñπÊ≥ïÊù•ÂÅöÊèèËø∞Â≠óÁ¨¶‰∏≤„ÄÇ Personalities determine hashing and equality. NSPointerFunctionsObjectPersonality provides the standard Foundation behavior of using hash and isEqual:. You can also use NSPointerFunctionsObjectPointerPersonality, which treats the contents as objects, but uses direct pointer value comparison; this is useful if you need a collection to work with object identity rather than value.NSPointerFunctionsObjectPointerPersonality ‰ΩøÁî® ==Âà§Êñ≠Áõ∏Á≠âNSPointerFunctionsObjectPersonality ‰ΩøÁî®hashÂíåisEqual:Âà§Êñ≠Áõ∏Á≠â _observe:info:ÊñπÊ≥ï- (void)_observe:(id)object info:(_FBKVOInfo *)info &#123; // lock pthread_mutex_lock(&amp;_lock); NSMutableSet *infos = [_objectInfosMap objectForKey:object]; // Ê£ÄÊü•infosÊòØÂê¶Â≠òÂú®‰∫é_objectInfosMap‰∏≠ _FBKVOInfo *existingInfo = [infos member:info]; if (nil != existingInfo) &#123; // Â∑≤ÁªèÂ≠òÂú®‰∫ÜÔºåreturn pthread_mutex_unlock(&amp;_lock); return; &#125; // ‰∏çÂ≠òÂú®ÔºåÂàõÂª∫infosÂπ∂‰øùÂ≠ò‰∫é_objectInfosMap‰∏≠ if (nil == infos) &#123; infos = [NSMutableSet set]; [_objectInfosMap setObject:infos forKey:object]; &#125; // ÊääinfoÊ∑ªÂä†Âà∞infos‰∏≠ [infos addObject:info]; pthread_mutex_unlock(&amp;_lock); // _FBKVOSharedControllerÊ∑ªÂä†ËßÇÂØü [[_FBKVOSharedController sharedController] observe:object info:info];&#125; È¶ñÂÖàÂä†ÈîÅ„ÄÇÊääË¢´ËßÇÂØüÁöÑÂØπË±°object‰Ωú‰∏∫key‰ªéËá™Â∑±ÁöÑ_objectInfosMapËé∑ÂèñÂÖ∂ÂØπÂ∫îÁöÑNSMutableSetÁ±ªÂûãÁöÑÈõÜÂêàÔºåÂ¶ÇÊûúËøô‰∏™ÈõÜÂêàÂåÖÂê´‰∫ÜÂ∑≤ÁªèÂ∞ÅË£ÖÂ•ΩÁöÑinfoÂØπË±°ÔºåËØ¥ÊòéÂ∑≤ÁªèÂØπËøô‰∏™infoÊ∑ªÂä†ËøáÁõëÂê¨‰∫ÜÔºåËß£ÈîÅÁõ¥Êé• return Â∞±ÊòØ‰∫Ü„ÄÇÂ¶ÇÊûúËøô‰∏™infosÈõÜÂêà‰∏çÂ≠òÂú®ÔºåÂàõÂª∫„ÄÇÊääinfoÂÖÉÁ¥†Ê∑ªÂä†Âà∞Ëøô‰∏™infosÈõÜÂêà‰∏≠„ÄÇËß£ÈîÅ„ÄÇË∞ÉÁî®[[_FBKVOSharedController sharedController] observe:object info:info];ÊñπÊ≥ï„ÄÇ ÂèØËßÅËøô‰∏™ÊñπÊ≥ï‰∏ªË¶ÅÊòØ‰ΩøÁî®_objectInfosMap‰øùÂ≠ò‰∫ÜÂ∞ÅË£ÖÂ•ΩÁöÑinfoÂØπË±°ÔºåÂÖ∑‰ΩìÁõëÂê¨Ë∞ÉÁî®ÈÄªËæë‰æùËµñ‰∫é_FBKVOSharedController„ÄÇ ‰∫î„ÄÅ_FBKVOSharedControllerÂÆûÁé∞ÂàùÂßãÂåñ@interface _FBKVOSharedController : NSObject+ (instancetype)sharedController;- (void)observe:(id)object info:(nullable _FBKVOInfo *)info;- (void)unobserve:(id)object info:(nullable _FBKVOInfo *)info;- (void)unobserve:(id)object infos:(nullable NSSet *)infos;@end@implementation _FBKVOSharedController &#123; NSHashTable&lt;_FBKVOInfo *&gt; *_infos; pthread_mutex_t _mutex;&#125; _FBKVOSharedControllerÊòØ‰∏Ä‰∏™Âçï‰æã„ÄÇ‰ΩúÁî®ÊòØËßÇÂØü _FBKVOInfo ‰∏≠ÁöÑ keyPathÔºåÂπ∂Áªô‰∫àÂõûË∞É(ÂõûË∞ÉÁöÑÁ±ªÂûãÂèØ‰ª•ÊòØ block„ÄÅselector„ÄÅÁ≥ªÁªüÂõûË∞ÉÊñπÊ≥ï)„ÄÇ Êö¥Èú≤Âá∫‰∏§‰∏™ÊñπÊ≥ï: Ê∑ªÂä†ÁõëÂê¨ÔºåÂèÇÊï∞‰∏∫_infos ÁßªÈô§ÁõëÂê¨ÔºåÂèÇÊï∞‰∏∫_FBKVOInfoÊàñËÄÖNSSetÁ±ªÂûãÁöÑinfos(ÂÆπÂô®ÂÜÖÁöÑÂÖÉÁ¥†‰ªçÁÑ∂ÊòØ_FBKVOInfo) ÂÜÖÈÉ®Áª¥Êä§‰∫Ü‰∏Ä‰∏™ÂìàÂ∏åË°®(NSHashTable)_infosÔºåÁî®‰∫é‰øùÂ≠òËøô‰∫õ_FBKVOInfo„ÄÇÈô§Ê≠§‰πãÂ§ñËøòÊúâ‰∏Ä‰∏™ÈîÅ:_mutexÔºåÁî®‰∫éÂÆûÁé∞Á∫øÁ®ãÂÆâÂÖ®„ÄÇ ÂìàÂ∏åË°®ÁöÑÂàõÂª∫: NSHashTable *infos = [NSHashTable alloc];_infos = [infos initWithOptions:NSPointerFunctionsWeakMemory|NSPointerFunctionsObjectPointerPersonality capacity:0];NSPointerFunctionsWeakMemory: ÊåÅÂº±ÊåáÈíàÂºïÁî®ÁùÄ_FBKVOInfoÂØπË±°„ÄÇNSPointerFunctionsObjectPointerPersonality ‰ΩøÁî®==Âà§ÂÆöÁõ∏Á≠â„ÄÇ ÂèØËßÅ_FBKVOSharedControllerÂè™ÊòØÂçïÁ∫ØÂú∞ÊéåÁÆ°_FBKVOInfoÈõÜÂêàÔºåÂÆÉÂè™ÈúÄË¶ÅËß£Êûê_FBKVOInfoÂπ∂ÁªôobserverÂõûË∞ÉÂç≥ÂèØÔºåÂÖ∂‰ªñÁöÑ‰∏ÄÂàáÈÉΩ‰∏çÂÖ≥ÂøÉ„ÄÇ Ê∑ªÂä†ÁõëÂê¨- (void)observe:(id)object info:(nullable _FBKVOInfo *)info &#123; if (nil == info) return; // _infosÊ∑ªÂä†ÂØπË±° pthread_mutex_lock(&amp;_mutex); [_infos addObject:info]; pthread_mutex_unlock(&amp;_mutex); // Ê∑ªÂä†ËßÇÂØüÔºå‰º†ÂÖ•ÁöÑcontextÊòØinfo [object addObserver:self forKeyPath:info-&gt;_keyPath options:info-&gt;_options context:(void *)info]; if (info-&gt;_state == _FBKVOInfoStateInitial) &#123; info-&gt;_state = _FBKVOInfoStateObserving; // ÂàùÂßãÁä∂ÊÄÅËΩ¨ÁõëÂê¨Áä∂ÊÄÅ &#125; else if (info-&gt;_state == _FBKVOInfoStateNotObserving) &#123; // Êú™ÁõëÂê¨Áä∂ÊÄÅ‰æøÁßªÈô§ // this could happen when `NSKeyValueObservingOptionInitial` is one of the NSKeyValueObservingOptions, // and the observer is unregistered within the callback block. // at this time the object has been registered as an observer (in Foundation KVO), // so we can safely unobserve it. // NSKeyValueObservingOptionInitialÔºöÊ∑ªÂä†ËßÇÂØüËÄÖÊó∂Â∞±Ëß¶ÂèëÂõûË∞ÉÔºåÂπ∂‰∏îÂú®ÂêéÈù¢ËµãÂÄºÊó∂‰πü‰ºöËß¶ÂèëÂõûË∞ÉÔºå‰ΩÜÊòØÈÉΩÂè™ËøîÂõûNSKeyValueChangeKindKey„ÄÇËßÇÂØüËÄÖÂú®callback block‰∏≠ÂèñÊ∂àËßÇÂØüÔºåÊâÄ‰ª•Âú®ËøôÈáåremoveObserver [object removeObserver:self forKeyPath:info-&gt;_keyPath context:(void *)info]; &#125;&#125; ÂÆπÂô®‰∏≠Ê∑ªÂä† info ÂÖÉÁ¥†ÔºåÊ∑ªÂä†ÁõëÂê¨„ÄÇ ÁßªÈô§ÁõëÂê¨- (void)unobserve:(id)object info:(nullable _FBKVOInfo *)info &#123; if (nil == info) return; // ÂìàÂ∏åË°®‰∏≠ÁßªÈô§info pthread_mutex_lock(&amp;_mutex); [_infos removeObject:info]; pthread_mutex_unlock(&amp;_mutex); // ÁßªÈô§ÁõëÂê¨ if (info-&gt;_state == _FBKVOInfoStateObserving) &#123; [object removeObserver:self forKeyPath:info-&gt;_keyPath context:(void *)info]; &#125; info-&gt;_state = _FBKVOInfoStateNotObserving;&#125; ÂÆπÂô®‰∏≠ÁßªÈô§ info ÂÖÉÁ¥†ÔºåÁßªÈô§ÁõëÂê¨„ÄÇ Á≥ªÁªüKVOË∞ÉÁî®- (void)observeValueForKeyPath:(nullable NSString *)keyPath ofObject:(nullable id)object change:(nullable NSDictionary&lt;NSKeyValueChangeKey, id&gt; *)change context:(nullable void *)context &#123; _FBKVOInfo *info; &#123; pthread_mutex_lock(&amp;_mutex); // ÁúãÁúãinfoÊòØÂê¶Â≠òÂú®‰∫é_infos‰∏≠ÔºåÂ¶ÇÊûúÂ≠òÂú®ÔºåËøîÂõûinfo info = [_infos member:(__bridge id)context]; pthread_mutex_unlock(&amp;_mutex); &#125; if (nil != info) &#123; // Â±ÄÈÉ®ÂèòÈáèÂº∫ÂºïÁî®controller FBKVOController *controller = info-&gt;_controller; if (nil != controller) &#123; // Â±ÄÈÉ®ÂèòÈáèÂº∫ÂºïÁî®observer id observer = controller.observer; if (nil != observer) &#123; if (info-&gt;_block) &#123; // ÂõûË∞É block NSDictionary&lt;NSKeyValueChangeKey, id&gt; *changeWithKeyPath = change; if (keyPath) &#123; NSMutableDictionary&lt;NSString *, id&gt; *mChange = [NSMutableDictionary dictionaryWithObject:keyPath forKey:FBKVONotificationKeyPathKey]; [mChange addEntriesFromDictionary:change]; changeWithKeyPath = [mChange copy]; &#125; info-&gt;_block(observer, object, changeWithKeyPath); &#125; else if (info-&gt;_action) &#123; // ÂõûË∞É selector [observer performSelector:info-&gt;_action withObject:change withObject:object]; &#125; else &#123; // Ë∞ÉÁî®KVO Á≥ªÁªüÊñπÊ≥ï [observer observeValueForKeyPath:keyPath ofObject:object change:change context:info-&gt;_context]; &#125; &#125; &#125; &#125;&#125; ÊúÄÁªàÂú®Á≥ªÁªüÊñπÊ≥ï‰∏≠Áªô‰∫à‰∏çÂêåÁ±ªÂûãÁöÑÂõûË∞É„ÄÇ typedef NS_ENUM(uint8_t, _FBKVOInfoState) &#123; _FBKVOInfoStateInitial = 0, _FBKVOInfoStateObserving, _FBKVOInfoStateNotObserving,&#125;; ‰ΩúËÄÖ‰ΩøÁî®‰∫Ü‰∏â‰∏™Êûö‰∏æÂÄºÊù•ËÆ∞ÂΩïÁõëÂê¨Áä∂ÊÄÅ„ÄÇ‰ºö‰∏ç‰ºöÊòØÂ§öÊ≠§‰∏Ä‰∏æÂë¢Ôºü‰∏ç‰ºö„ÄÇ‰ΩúÁî®‰∏ªË¶Å‰ΩìÁé∞Âú®Ê∑ªÂä†ÁõëÂê¨ÁöÑÊñπÊ≥ïÈáåÊúâ‰∏™ÁßªÈô§ÁõëÂê¨Êìç‰ΩúÔºö // Ê∑ªÂä†ËßÇÂØüÔºå‰º†ÂÖ•ÁöÑcontextÊòØinfo[object addObserver:self forKeyPath:info-&gt;_keyPath options:info-&gt;_options context:(void *)info]; if (info-&gt;_state == _FBKVOInfoStateInitial) &#123; info-&gt;_state = _FBKVOInfoStateObserving; // ÂàùÂßãÁä∂ÊÄÅËΩ¨ÁõëÂê¨Áä∂ÊÄÅ &#125; else if (info-&gt;_state == _FBKVOInfoStateNotObserving) &#123; // Êú™ÁõëÂê¨Áä∂ÊÄÅ‰æøÁßªÈô§ [object removeObserver:self forKeyPath:info-&gt;_keyPath context:(void *)info]; &#125; ‚ÄúÊú™ÁõëÂê¨Áä∂ÊÄÅ‰æøÁßªÈô§‚ÄúÊòØÊÄé‰πàÂá∫Áé∞ÁöÑÔºüÁ§∫‰æãÂ¶Ç‰∏ãÔºö [self.KVOController observe:self.myButton keyPath:@"backgroundColor" options:NSKeyValueObservingOptionInitial block:^(id _Nullable observer, id _Nonnull object, NSDictionary&lt;NSKeyValueChangeKey,id&gt; * _Nonnull change) &#123; [self.KVOController unobserve:self.myButton keyPath:@"backgroundColor"];&#125;]; ÂåÖÂê´‰∫ÜNSKeyValueObservingOptionInitialÈÄâÈ°π‰∏îÂú®ÂõûË∞É‰∏≠ÁßªÈô§‰∫ÜÁõëÂê¨Â∞±‰ºöÂá∫Áé∞ËøôÁßçÊÉÖÂÜµ„ÄÇÂõ†‰∏∫Â¶ÇÊûúÊúâNSKeyValueObservingOptionInitialÈÄâÈ°πÔºåÂú®Ê∑ªÂä†ÁõëÂê¨ÁöÑÊó∂ÂÄôÂ∞±‰ºöÊúâÂõûË∞É„ÄÇË∞ÉÁî®Ê†àÂ¶Ç‰∏ãÔºö ÊâßË°åÂà∞[object addObserver:self forKeyPath:info-&gt;_keyPath options:info-&gt;_options context:(void *)info];ËøôË°å‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÈ¶ñÂÖàÊ∑ªÂä†ÁõëÂê¨ÔºåÊé•ÁùÄË∞ÉÁî®ÂõûË∞ÉÔºåËÄåÂõûË∞É‰∏≠ÂèàÁßªÈô§‰∫ÜËßÇÂØüÔºåËøôÊó∂infoÁöÑÁä∂ÊÄÅË¢´ËÆæÁΩÆ‰∏∫_FBKVOInfoStateNotObserving„ÄÇÊé•ÁùÄËøõÂÖ•‰∫Ü‰∏ãÈù¢ÁöÑ if-else Âà§Êñ≠‰∏≠ÔºåÊâçÊúâ‰∫ÜÁßªÈô§ÁõëÂê¨ÁöÑÊìç‰Ωú„ÄÇÂèØËßÅÈÄªËæëÈùûÂ∏∏‰∏•Ë∞®„ÄÇ NSKeyValueObservingOptionÂèÇËÄÉÔºö NSKeyValueObservingOptionNewÔºöÊé•Êî∂ÊñπÊ≥ï‰∏≠‰ΩøÁî®changeÂèÇÊï∞‰º†ÂÖ•ÂèòÂåñÂêéÁöÑÊñ∞ÂÄºÔºåÈîÆ‰∏∫Ôºö&gt;NSKeyValueChangeNewKeyÔºõNSKeyValueObservingOptionOldÔºöÊé•Êî∂ÊñπÊ≥ï‰∏≠‰ΩøÁî®changeÂèÇÊï∞‰º†ÂÖ•ÂèòÂåñÂâçÁöÑÊóßÂÄºÔºåÈîÆ‰∏∫Ôºö&gt;NSKeyValueChangeOldKeyÔºõNSKeyValueObservingOptionInitialÔºöÊ≥®ÂÜå‰πãÂêéÁ´ãÂàªË∞ÉÁî®Êé•Êî∂ÊñπÊ≥ïÔºåÂ¶ÇÊûúÈÖçÁΩÆ‰∫Ü&gt;NSKeyValueObservingOptionNewÔºåchangeÂèÇÊï∞ÂÜÖÂÆπ‰ºöÂåÖÂê´Êñ∞ÂÄºÔºåÈîÆ‰∏∫Ôºö&gt;NSKeyValueChangeNewKeyÔºõNSKeyValueObservingOptionPriorÔºöÂ¶ÇÊûúÂä†ÂÖ•Ëøô‰∏™ÂèÇÊï∞ÔºåÊé•Êî∂ÊñπÊ≥ï‰ºöÂú®ÂèòÂåñÂâçÂêéÂàÜÂà´Ë∞ÉÁî®‰∏ÄÊ¨°ÔºåÂÖ±‰∏§&gt;Ê¨°ÔºåÂèòÂåñÂâçÁöÑÈÄöÁü•changeÂèÇÊï∞ÂåÖÂê´notificationIsPrior = 1„ÄÇÂÖ∂‰ªñÂÜÖÂÆπÊ†πÊçÆ&gt;NSKeyValueObservingOptionNewÂíåNSKeyValueObservingOptionOldÁöÑÈÖçÁΩÆÁ°ÆÂÆö„ÄÇ ÂÖ≠„ÄÅ‰∏Ä‰∏™ÂáΩÊï∞ÂÖ∂ÂÆû‰∏çÊòØ‰∏Ä‰∏™ÂáΩÊï∞Ôºå‰∏çËøáÊòØ‰∏∫‰∫ÜÂÆûÁé∞‰∏Ä‰∏™ÂäüËÉΩÔºåÊ†∏ÂøÉËøòÊòØ‰∏Ä‰∏™ÂáΩÊï∞„ÄÇ // 1.Êûö‰∏æÂ≠óÁ¨¶‰∏≤Âåñstatic NSString *describe_option(NSKeyValueObservingOptions option) &#123; switch (option) &#123; case NSKeyValueObservingOptionNew: return @"NSKeyValueObservingOptionNew"; break; case NSKeyValueObservingOptionOld: return @"NSKeyValueObservingOptionOld"; break; case NSKeyValueObservingOptionInitial: return @"NSKeyValueObservingOptionInitial"; break; case NSKeyValueObservingOptionPrior: return @"NSKeyValueObservingOptionPrior"; break; default: NSCAssert(NO, @"unexpected option %tu", option); break; &#125; return nil;&#125;// 2.ÊãºÊé•optionstatic void append_option_description(NSMutableString *s, NSUInteger option) &#123; if (0 == s.length) &#123; [s appendString:describe_option(option)]; &#125; else &#123; [s appendString:@"|"]; [s appendString:describe_option(option)]; &#125;&#125;// 3.NSKeyValueObservingOptionsÁ±ªÂûãÂÄºÈÅçÂéÜstatic NSUInteger enumerate_flags(NSUInteger *ptrFlags) &#123; NSCAssert(ptrFlags, @"expected ptrFlags"); if (!ptrFlags) return 0; NSUInteger flags = *ptrFlags; if (!flags) return 0; NSUInteger flag = 1 &lt;&lt; __builtin_ctzl(flags); flags &amp;= ~flag; *ptrFlags = flags; return flag;&#125;// 4.ÊääoptionsÊâÄÊúâÂÄºÈÉΩÊãºÂá∫Êù•static NSString *describe_options(NSKeyValueObservingOptions options) &#123; NSMutableString *s = [NSMutableString string]; NSUInteger option; while (0 != (option = enumerate_flags(&amp;options))) &#123; append_option_description(s, option); &#125; return s;&#125; ‰∏ç‰ΩøÁî® switch-case Êää‰ΩçÁßªÊûö‰∏æÁöÑÂÄºÈÅçÂéÜÂá∫Êù•‰∫Ü„ÄÇ // Similar to __builtin_ctz, except the argument type is unsigned long.// __builtin_ctz(x)ÔºöxÊú´Â∞æ0ÁöÑ‰∏™Êï∞// Â∑¶Áßª__builtin_ctz(x)‰ΩçÂæóÂà∞ÂéüÂÖàÁöÑÊûö‰∏æÂÄºNSUInteger flag = 1 &lt;&lt; __builtin_ctzl(flags);// flags ÂéªÈô§Â∑≤ÁªèÂèñÂà∞ÁöÑÂÄºflags &amp;= ~flag;// ÊääÊõ¥Êñ∞ÂêéÁöÑflagsËµã‰∫àÊåáÂêëptrFlagsÁöÑÊåáÈíà*ptrFlags = flags; ‰∏çÂ§±‰∏∫‰∏Ä‰∏™Â•ΩÂäûÊ≥ï„ÄÇ ‰∏É„ÄÅÊÄªÁªì ‰ΩøÁî® KVOController ËøõË°åÈîÆÂÄºËßÇÊµãÂèØ‰ª•ËØ¥ÂÆåÁæéÂú∞Ëß£ÂÜ≥‰∫ÜÂú®‰ΩøÁî®ÂéüÁîü KVO Êó∂ÈÅáÂà∞ÁöÑÂêÑÁßçÈóÆÈ¢ò„ÄÇ 1.‰∏çÈúÄË¶ÅÊâãÂä®ÁßªÈô§ËßÇÂØüËÄÖÔºõ2.ÂÆûÁé∞ KVO ‰∏é‰∫ã‰ª∂ÂèëÁîüÂ§ÑÁöÑ‰ª£Á†Å‰∏ä‰∏ãÊñáÁõ∏ÂêåÔºå‰∏çÈúÄË¶ÅË∑®ÊñπÊ≥ï‰º†ÂèÇÊï∞Ôºõ3.‰ΩøÁî® block Êù•Êõø‰ª£ÊñπÊ≥ïËÉΩÂ§üÂáèÂ∞ë‰ΩøÁî®ÁöÑÂ§çÊùÇÂ∫¶ÔºåÊèêÂçá‰ΩøÁî® KVO ÁöÑ‰ΩìÈ™åÔºõ4.ÊØè‰∏Ä‰∏™ keyPath ‰ºöÂØπÂ∫î‰∏Ä‰∏™Â±ûÊÄßÔºå‰∏çÈúÄË¶ÅÂú® block ‰∏≠‰ΩøÁî® if Âà§Êñ≠ keyPathÔºõ ‰ª•‰∏äÂºïËá™draveness„ÄÇËß£ÈáäÂ¶Ç‰∏ãÔºö1.NSMapTable ÂèØ‰ª•ÊåÅÊúâÈîÆÂíåÂÄºÁöÑÂº±ÂºïÁî®ÔºåÂΩìÈîÆÊàñËÄÖÂÄºÂΩì‰∏≠ÁöÑ‰∏Ä‰∏™Ë¢´ÈáäÊîæÊó∂ÔºåÊï¥‰∏™Ëøô‰∏ÄÈ°πÂ∞±‰ºöË¢´ÁßªÈô§Êéâ„ÄÇ // ËøôÈáå‰ΩøÁî®Ë¢´ËßÇÂØüËÄÖobserver‰Ωú‰∏∫Âº∫ÂºïÁî®ÊàñËÄÖÂº±ÂºïÁî®ÁöÑkeyÔºå‰ΩøÁî®_FBKVOInfo‰Ωú‰∏∫Âº∫ÂºïÁî®ÁöÑvalueNSPointerFunctionsOptions keyOptions = retainObserved ? NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPointerPersonality : NSPointerFunctionsWeakMemory|NSPointerFunctionsObjectPointerPersonality;_objectInfosMap = [[NSMapTable alloc] initWithKeyOptions:keyOptions valueOptions:NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPersonality capacity:0]; 2.Âõ†‰∏∫ÊòØÂú®@selector(observeValueForKeyPath:ofObject:change:context:)‰∏≠Â§ÑÁêÜÁöÑÂõûË∞É„ÄÇ3.‰ΩøÁî®FBKVONotificationBlock„ÄÇ4._FBKVOInfoÂ∞ÅË£Ö„ÄÇ Á∫µËßÇÂÖ®ÈÉ®‰ª£Á†ÅÔºå‰ΩúËÄÖÈ¶ñÂÖàÁªôÂàÜÁ±ªÊ∑ªÂä†‰∫Ü‰∏§‰∏™Â±ûÊÄßÔºåÁî®‰∫éÊé•Âè£Ë∞ÉÁî®„ÄÇËøô‰∫õÂ±ûÊÄßÈÉΩÊåáÂêë‰∫ÜFBKVOControllerÔºåFBKVOController‰∏ªË¶ÅÁª¥Êä§‰∫Ü‰∏Ä‰∏™NSMapTable„ÄÇkey ÊòØÊâÄËßÇÂØüÁöÑÂØπË±°Ôºåvalue ÊòØNSMutableSetÁ±ªÂûãÁöÑÈõÜÂêàÔºåÂÖ∂ÂÜÖÈÉ®ÂÖÉÁ¥†ÊòØ_FBKVOInfoÁ±ªÂûãÂØπË±°„ÄÇ‰∏Ä‰∏™_FBKVOInfoÂØπË±°ÂØπÂ∫î‰∏Ä‰∏™‰ø°ÊÅØÂ∞ÅË£Ö„ÄÇ‰πãÊâÄ‰ª•‰ΩøÁî®NSMapTableÈõÜÂêàÊòØ‰æø‰∫éÂØπÂêå‰∏Ä‰∏™ÂØπË±°ÁöÑÂ§ö‰∏™keyPathËøõË°åËßÇÂØüÔºåÂêåÊó∂Â§ÑÁêÜË¢´ËßÇÂØüËÄÖÁöÑÂº∫Âº±ÂºïÁî®„ÄÇÂè¶Â§ñ_FBKVOInfoÂØπË±°ÊòØÂØπFBKVOController„ÄÅkeyPath„ÄÅcontext„ÄÅÂõûË∞ÉblockÁ≠â‰ø°ÊÅØÁöÑÂ∞ÅË£Ö„ÄÇÊúÄÂêéÔºåÂêÑ‰∏™FBKVOControllerÊääÊâÄÊúâÂØπËßÇÂØüÁöÑÂ§ÑÁêÜ‰∫§ÁªôÂçï‰æã_FBKVOSharedControllerÔºåËøô‰∏™Âçï‰æãË∞ÉÁî®Á≥ªÁªüKVOÊñπÊ≥ïÂõûË∞É„ÄÅÂ§ÑÁêÜÂåÖÂê´ÊâÄÊúâ_FBKVOInfoÂØπË±°ÁöÑNSHashTableÈõÜÂêà„ÄÇ ÂèÇËÄÉËµÑÊñôhttps://github.com/draveness/analyze/blob/master/contents/KVOController/KVOController.mdhttps://blog.csdn.net/DonnyDN/article/details/77750751https://www.jianshu.com/p/915356e280fchttps://blog.kyleduo.com/2014/10/20/ios_learning-kvo/]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØª„ÄåYYCache„Äç]]></title>
    <url>%2F2019%2F01%2F02%2F%E8%AF%BB%E3%80%8CYYCache%E3%80%8D%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫éYYCacheÁöÑÁÆÄÂçïÊÄªÁªì„ÄÇ ÈòÖËØªYYCacheÊ∫êÁ†ÅÊúâ3ÈÅç‰∫ÜÔºåËá™ÊàëÊÑüËßâ‚ÄúÈúÄË¶ÅÁêÜËß£‚ÄùÁöÑÈÉ®ÂàÜÊéåÊè°ÁöÑÂ∑Æ‰∏çÂ§ö‰∫ÜÔºåÂÅö‰∏™ËÆ∞ÂΩï„ÄÇ ‰∏Ä„ÄÅ‰ΩøÁî®API Á±ª‰ººÂ≠óÂÖ∏ÔºåÊØîËæÉÂÆπÊòìÁêÜËß£„ÄÇ 1.ÂàùÂßãÂåñ@property (copy, readonly) NSString *name;@property (strong, readonly) YYMemoryCache *memoryCache;@property (strong, readonly) YYDiskCache *diskCache;- (nullable instancetype)initWithName:(NSString *)name;- (nullable instancetype)initWithPath:(NSString *)path NS_DESIGNATED_INITIALIZER;+ (nullable instancetype)cacheWithName:(NSString *)name;+ (nullable instancetype)cacheWithPath:(NSString *)path;- (instancetype)init UNAVAILABLE_ATTRIBUTE;+ (instancetype)new UNAVAILABLE_ATTRIBUTE; 2.ÊòØÂê¶Â≠òÂú®- (BOOL)containsObjectForKey:(NSString *)key;- (void)containsObjectForKey:(NSString *)key withBlock:(nullable void(^)(NSString *key, BOOL contains))block; 3.Êü•ËØ¢- (nullable id&lt;NSCoding&gt;)objectForKey:(NSString *)key;- (void)objectForKey:(NSString *)key withBlock:(nullable void(^)(NSString *key, id&lt;NSCoding&gt; object))block; 4.ËÆæÂÄº- (void)setObject:(nullable id&lt;NSCoding&gt;)object forKey:(NSString *)key;- (void)setObject:(nullable id&lt;NSCoding&gt;)object forKey:(NSString *)key withBlock:(nullable void(^)(void))block; 5.ÁßªÈô§- (void)removeObjectForKey:(NSString *)key;- (void)removeObjectForKey:(NSString *)key withBlock:(nullable void(^)(NSString *key))block;- (void)removeAllObjects;- (void)removeAllObjectsWithBlock:(void(^)(void))block;- (void)removeAllObjectsWithProgressBlock:(nullable void(^)(int removedCount, int totalCount))progress endBlock:(nullable void(^)(BOOL error))end; ‰∫å„ÄÅYYCache ÂÆûÁé∞@implementation YYCache- (instancetype) init &#123; NSLog(@"Use \"initWithName\" or \"initWithPath\" to create YYCache instance."); return [self initWithPath:@""];&#125;- (instancetype)initWithName:(NSString *)name &#123; if (name.length == 0) return nil; NSString *cacheFolder = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) firstObject]; NSString *path = [cacheFolder stringByAppendingPathComponent:name]; return [self initWithPath:path];&#125;- (instancetype)initWithPath:(NSString *)path &#123; if (path.length == 0) return nil; YYDiskCache *diskCache = [[YYDiskCache alloc] initWithPath:path]; if (!diskCache) return nil; NSString *name = [path lastPathComponent]; YYMemoryCache *memoryCache = [YYMemoryCache new]; memoryCache.name = name; self = [super init]; _name = name; _diskCache = diskCache; _memoryCache = memoryCache; return self;&#125;+ (instancetype)cacheWithName:(NSString *)name &#123; return [[self alloc] initWithName:name];&#125;+ (instancetype)cacheWithPath:(NSString *)path &#123; return [[self alloc] initWithPath:path];&#125;- (BOOL)containsObjectForKey:(NSString *)key &#123; return [_memoryCache containsObjectForKey:key] || [_diskCache containsObjectForKey:key];&#125;- (void)containsObjectForKey:(NSString *)key withBlock:(void (^)(NSString *key, BOOL contains))block &#123; if (!block) return; if ([_memoryCache containsObjectForKey:key]) &#123; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; block(key, YES); &#125;); &#125; else &#123; [_diskCache containsObjectForKey:key withBlock:block]; &#125;&#125;- (id&lt;NSCoding&gt;)objectForKey:(NSString *)key &#123; id&lt;NSCoding&gt; object = [_memoryCache objectForKey:key]; if (!object) &#123; object = [_diskCache objectForKey:key]; if (object) &#123; [_memoryCache setObject:object forKey:key]; &#125; &#125; return object;&#125;- (void)objectForKey:(NSString *)key withBlock:(void (^)(NSString *key, id&lt;NSCoding&gt; object))block &#123; if (!block) return; id&lt;NSCoding&gt; object = [_memoryCache objectForKey:key]; if (object) &#123; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; block(key, object); &#125;); &#125; else &#123; [_diskCache objectForKey:key withBlock:^(NSString *key, id&lt;NSCoding&gt; object) &#123; if (object &amp;&amp; ![_memoryCache objectForKey:key]) &#123; [_memoryCache setObject:object forKey:key]; &#125; block(key, object); &#125;]; &#125;&#125;- (void)setObject:(id&lt;NSCoding&gt;)object forKey:(NSString *)key &#123; [_memoryCache setObject:object forKey:key]; [_diskCache setObject:object forKey:key];&#125;- (void)setObject:(id&lt;NSCoding&gt;)object forKey:(NSString *)key withBlock:(void (^)(void))block &#123; [_memoryCache setObject:object forKey:key]; [_diskCache setObject:object forKey:key withBlock:block];&#125;- (void)removeObjectForKey:(NSString *)key &#123; [_memoryCache removeObjectForKey:key]; [_diskCache removeObjectForKey:key];&#125;- (void)removeObjectForKey:(NSString *)key withBlock:(void (^)(NSString *key))block &#123; [_memoryCache removeObjectForKey:key]; [_diskCache removeObjectForKey:key withBlock:block];&#125;- (void)removeAllObjects &#123; [_memoryCache removeAllObjects]; [_diskCache removeAllObjects];&#125;- (void)removeAllObjectsWithBlock:(void(^)(void))block &#123; [_memoryCache removeAllObjects]; [_diskCache removeAllObjectsWithBlock:block];&#125;- (void)removeAllObjectsWithProgressBlock:(void(^)(int removedCount, int totalCount))progress endBlock:(void(^)(BOOL error))end &#123; [_memoryCache removeAllObjects]; [_diskCache removeAllObjectsWithProgressBlock:progress endBlock:end]; &#125;- (NSString *)description &#123; if (_name) return [NSString stringWithFormat:@"&lt;%@: %p&gt; (%@)", self.class, self, _name]; else return [NSString stringWithFormat:@"&lt;%@: %p&gt;", self.class, self];&#125;@end Êï¥‰ΩìÊù•ÁúãËøòÊòØÊØîËæÉÂÆπÊòìÁêÜËß£ÁöÑÔºåYYCache Êï¥Âêà‰∫ÜÂÜÖÂ≠òÁºìÂ≠òÂíåÁ£ÅÁõòÁºìÂ≠òÔºå‰∏ªË¶ÅÂÅö‰∫ÜËøô‰∫õ‰∫ãÔºö ÂàùÂßãÂåñYYCacheÂÆû‰æãÔºåË¶ÅÊ±ÇÁºìÂ≠òË∑ØÂæÑË¶ÅÂêàÁêÜ„ÄÇ Êü•ËØ¢ÁºìÂ≠òÂØπË±°ÂÖà‰ªéÂÜÖÂ≠òÁºìÂ≠ò‰∏≠Êü•ÊâæÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂÜç‰ªéÁ£ÅÁõòÁºìÂ≠ò‰∏≠Êü•Êâæ„ÄÇÂΩìÁ£ÅÁõòÁºìÂ≠ò‰∏≠ÊúâËÄåÂÜÖÂ≠òÁºìÂ≠ò‰∏≠Ê≤°ÊúâÁöÑÊó∂ÂÄôÔºåÊääÂèñÂæóÁöÑÁºìÂ≠òÂØπË±°‰øùÂ≠òÂú®ÂÜÖÂ≠òÁºìÂ≠ò‰∏≠„ÄÇ ÁºìÂ≠òÂØπË±°ÁöÑÂ≠òÂèñÂíåÁßªÈô§ÔºåÂÜÖÂ≠òÁºìÂ≠òÂíåÁ£ÅÁõòÁºìÂ≠ò‰∏§ËÄÖ‰øùÊåÅÂêåÊ≠•„ÄÇ 1.YYMemoryCacheÂü∫Êú¨Â±ûÊÄß@property (nullable, copy) NSString *name;@property (readonly) NSUInteger totalCount;@property (readonly) NSUInteger totalCost;#pragma mark - Limit@property NSUInteger countLimit;@property NSUInteger costLimit;@property NSTimeInterval ageLimit;@property NSTimeInterval autoTrimInterval;@property BOOL shouldRemoveAllObjectsOnMemoryWarning;@property BOOL shouldRemoveAllObjectsWhenEnteringBackground;@property (nullable, copy) void(^didReceiveMemoryWarningBlock)(YYMemoryCache *cache);@property (nullable, copy) void(^didEnterBackgroundBlock)(YYMemoryCache *cache);@property BOOL releaseOnMainThread;@property BOOL releaseAsynchronously; Á±ª‰ºº‰∫éNSCacheÔºåÊèê‰æõÂåÖÊã¨ÁºìÂ≠òÊï∞Èáè„ÄÅÁºìÂ≠òËä±Ë¥π„ÄÅÁºìÂ≠òÊó∂Èó¥ÁöÑÁÆ°ÁêÜ„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÂΩìÊé•Êî∂Âà∞ÂÜÖÂ≠òË≠¶ÂëäÊó∂(shouldRemoveAllObjectsOnMemoryWarning)ÊàñËÄÖ App ËøõÂÖ•Âà∞ÂêéÂè∞Êó∂(shouldRemoveAllObjectsWhenEnteringBackground)ÂèØ‰ª•ÈÄâÊã©ÈáäÊîæÁºìÂ≠òÂØπË±°„ÄÇËÄåÂØπÁºìÂ≠òÂØπË±°ÈáäÊîæ‰πüÂèØ‰ª•ËøõË°åÊéßÂà∂ÔºåÊØîÂ¶ÇÂèØ‰ª•ÈÄâÊã©Âú®‰∏ªÁ∫øÁ®ãÈáäÊîæ(releaseOnMainThread)ÊàñËÄÖÂºÇÊ≠•ÈáäÊîæ(releaseAsynchronously)„ÄÇ Â≠òÂèñÊé•Âè£- (BOOL)containsObjectForKey:(id)key;- (nullable id)objectForKey:(id)key;- (void)setObject:(nullable id)object forKey:(id)key;- (void)setObject:(nullable id)object forKey:(id)key withCost:(NSUInteger)cost;- (void)removeObjectForKey:(id)key;- (void)removeAllObjects;- (void)trimToCount:(NSUInteger)count;- (void)trimToCost:(NSUInteger)cost;- (void)trimToAge:(NSTimeInterval)age; Èô§‰∫ÜÂü∫Êú¨ÁöÑÂ≠òÂèñÊñπÊ≥ï‰πãÂ§ñÔºåYYMemoryCache ËøòÊö¥Èú≤‰∫Ü‰∏â‰∏™ÁßªÈô§ÁºìÂ≠òÂØπË±°ÁöÑÊñπÊ≥ï„ÄÇ trimToCountÔºöÊ†πÊçÆÈôêÂà∂ÁöÑÊï∞Èáè(countLimit)ËøõË°åÁßªÈô§ÁºìÂ≠òÂØπË±°Êìç‰ΩúÔºåÁõ¥Âà∞Êª°Ë∂≥Êï∞ÈáèÈôêÂà∂Ë¶ÅÊ±Ç„ÄÇ trimToCostÔºöÊ†πÊçÆÈôêÂà∂ÁöÑËä±Ë¥π(costLimit)ËøõË°åÁßªÈô§ÁºìÂ≠òÂØπË±°Êìç‰ΩúÔºåÁõ¥Âà∞Êª°Ë∂≥Ëä±Ë¥πÈôêÂà∂Ë¶ÅÊ±Ç„ÄÇ trimToAgeÔºöÊ†πÊçÆÁºìÂ≠òÂØπË±°ÁöÑËøáÊúüÊó∂Èó¥(ageLimit)ËøõË°åÁßªÈô§ÁºìÂ≠òÂØπË±°Êìç‰ΩúÔºåÁõ¥Âà∞Êª°Ë∂≥Ë¶ÅÊ±Ç„ÄÇ ÂÖ∑‰ΩìÂÆûÁé∞Âú®ÂÖ∑‰ΩìÂÆûÁé∞‰∏≠Ôºå‰ΩúËÄÖËÄÉËôë‰∫Ü‰ª•‰∏ãË¶ÅÊ±Ç: ÁºìÂ≠òÂØπË±°ÁöÑÂ≠òÂèñ„ÄÇË¶Å‰øùËØÅÊïàÁéáÂ∞±Ë¶ÅÊ±ÇÂ≠òÂèñÊó∂Èó¥Â§çÊùÇÂ∫¶ÊúÄÂ•ΩÊòØO(1)„ÄÇ ÁºìÂ≠òÂØπË±°ÁöÑÁßªÈô§„ÄÇË¶Å‰øùËØÅËÉΩÊåâÁÖß cost„ÄÅage„ÄÅcount Á≠âÊù°‰ª∂ÂØπÊâÄÊúâ‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑÂØπË±°ËøõË°åÁßªÈô§„ÄÇ Á∫øÁ®ãÂÆâÂÖ®„ÄÇÈúÄË¶ÅÂä†ÈîÅ„ÄÇÁ¨¨‰∏ÄÊù°ÔºöË¶ÅÊ±ÇÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØ O(1)ÔºåÈÇ£Â∞±ÂèØ‰ª•ÈááÁî®ÂìàÂ∏åË°®„ÄÅÂ≠óÂÖ∏Á≠â„ÄÇ‰ΩúËÄÖ‰ΩøÁî®‰∫ÜÂ≠óÂÖ∏Ôºå‰∏îÊòØÊïàÁéáÊõ¥È´òÁöÑCFMutableDictionaryRef„ÄÇÁ¨¨‰∫åÊù°ÔºöËÆ∞ÂΩï cost„ÄÅage„ÄÅcountÁ≠âÂ±ûÊÄßÔºåËÇØÂÆöÈúÄË¶ÅÂØπÁºìÂ≠òÂØπË±°ËøõË°åÂåÖË£Ö„ÄÇÂÜçËÄÖÈúÄË¶ÅËÄÉËôëLRU(Least Recently Used)ÔºåÂ∞±ÈúÄË¶Å‰øùËØÅÈ°∫Â∫è„ÄÇËÄåË¶Å‰ΩøÂæóÂ≠óÂÖ∏‰∏≠ÁöÑÂØπË±°(value)ÊúâÈ°∫Â∫èÔºåÂøÖÈ°ªÊúâ‰∏Ä‰∏™ÊåáÂêëÂÖ∂‰ªñÂØπË±°ÁöÑÊåáÈíà(Â±ûÊÄßÔºâ„ÄÇÂèØ‰ª•‰ΩøÁî®ÂèåÂêëÈìæË°®ÂåÖË£ÖÁºìÂ≠òÂØπË±°„ÄÇÁ¨¨‰∏âÊù°ÔºöÂ≠òÂèñÁöÑÁ∫øÁ®ãÂÆâÂÖ®Ôºå‰ΩøÁî®GCDÁ∫øÁ®ãÈîÅ„ÄÇ ÁªìÁÇπ@interface _YYLinkedMapNode : NSObject &#123; @package __unsafe_unretained _YYLinkedMapNode *_prev; // retained by dic __unsafe_unretained _YYLinkedMapNode *_next; // retained by dic id _key; id _value; NSUInteger _cost; NSTimeInterval _time;&#125;@end ÈìæË°®ÁöÑÁªìÁÇπ‰∏≠‰øùÂ≠òÁùÄkey Âíå valueÔºåËøôÊòØÂØπÁºìÂ≠òÂØπË±°ÁöÑÂåÖË£Ö„ÄÇ_costÂíå_timeËÆ∞ÂΩïÁùÄÁºìÂ≠òÂØπË±°ÁöÑËä±Ë¥πÂíåËøáÊúüÊó∂Èó¥„ÄÇËÄå‰ΩøÁî®unsafe_unretained‰øÆÈ•∞ÁöÑ_prevÂíå_nextÂàôÂàÜÂà´ÊåáÂêëÂâç‰∏Ä‰∏™ÂØπË±°ÂíåÂêé‰∏Ä‰∏™ÂØπË±°„ÄÇÁî±‰∫éËøô‰∫õÁªìÁÇπÂ∑≤ÁªèË¢´Â≠óÂÖ∏ÊåÅÊúâ‰∫ÜÔºåÊâÄ‰ª•Áõ¥Êé•‰ΩøÁî®unsafe_unretained‰øÆÈ•∞Ôºå‰∏çÂøÖÂÜçÂ¢ûÂä†ÂÆÉÁöÑÂºïÁî®ËÆ°Êï∞ÔºåÊèêÈ´òÊïàÁéá„ÄÇ ÈìæË°® @interface _YYLinkedMap : NSObject &#123; @package CFMutableDictionaryRef _dic; // do not set object directly NSUInteger _totalCost; NSUInteger _totalCount; _YYLinkedMapNode *_head; // MRU, do not change it directly _YYLinkedMapNode *_tail; // LRU, do not change it directly BOOL _releaseOnMainThread; BOOL _releaseAsynchronously;&#125;- (void)insertNodeAtHead:(_YYLinkedMapNode *)node;- (void)bringNodeToHead:(_YYLinkedMapNode *)node;- (void)removeNode:(_YYLinkedMapNode *)node;- (_YYLinkedMapNode *)removeTailNode;- (void)removeAll;@end ‰∏Ä‰∏™ YYMemoryCache ÂØπË±°Êúâ‰∏Ä‰∏™ÈìæË°®„ÄÇËøô‰∏™ÈìæË°®‰ΩøÁî®_dic‰øùÂ≠òÁùÄÊâÄÊúâÂåÖË£ÖÂ•ΩÁöÑÁºìÂ≠òÂØπË±°(_YYLinkedMapNode)ÔºåËÆ∞ÂΩïÁùÄÊÄªÁöÑËä±Ë¥π(_totalCost)ÂíåÊÄªÁöÑÊï∞Èáè(_totalCount)„ÄÇÂΩìÁÑ∂ÔºåËøò‰ΩøÁî®_headÊåáÁùÄÈìæË°®ÁöÑÂ§¥ÊåáÈíàÔºå‰ΩøÁî®_tailÊåáÁùÄÈìæË°®ÁöÑÂ∞æÊåáÈíà„ÄÇ_releaseOnMainThreadÂíå_releaseAsynchronouslyÁî®‰∫éËÆæÁΩÆÂØπÁºìÂ≠òÂØπË±°ÈáäÊîæÊìç‰ΩúÁöÑÈÄâÈ°π:‰∏ªÁ∫øÁ®ãÈáäÊîæÊàñËÄÖÂºÇÊ≠•ÈáäÊîæ„ÄÇ _YYLinkedMapÊö¥Èú≤Âá∫ÁöÑ‰∫î‰∏™ÊñπÊ≥ïÂæàÊ∏ÖÊô∞Âú∞Ë°®ÊòéÂÆÉÁöÑ‰ΩúÁî®ÔºöÊØèÊ¨°ÂΩìÁºìÂ≠òÂèñÂà∞Êüê‰∏™ÂØπË±°Êó∂ÔºåÊääÂÆÉÁΩÆÂú®Â§¥ÁªìÁÇπÁöÑ‰ΩçÁΩÆ„ÄÇËøôÊ†∑ÈöèÁùÄÊó∂Èó¥ÁöÑÊé®ÁßªÔºåÂæàËΩªÊùæÂú∞‰ΩøÂæóÈÇ£‰∫õ‰∏çÁªèÂ∏∏‰ΩøÁî®ÁöÑÂØπË±°Â§ÑÂú®ÈìæË°®ÁöÑÂêéÁ´ØÔºåÁªèÂ∏∏‰ΩøÁî®ÁöÑÂØπË±°Â§ÑÂú®ÈìæË°®ÁöÑÂâçÁ´ØÔºåËøôÊ†∑Â∞±ÂÆûÁé∞‰∫Ü LRU„ÄÇ Êìç‰Ωú- (void)insertNodeAtHead:(_YYLinkedMapNode *)node &#123; CFDictionarySetValue(_dic, (__bridge const void *)(node-&gt;_key), (__bridge const void *)(node)); _totalCost += node-&gt;_cost; _totalCount++; if (_head) &#123; node-&gt;_next = _head; _head-&gt;_prev = node; _head = node; &#125; else &#123; _head = _tail = node; &#125;&#125;- (void)bringNodeToHead:(_YYLinkedMapNode *)node &#123; if (_head == node) return; if (_tail == node) &#123; _tail = node-&gt;_prev; _tail-&gt;_next = nil; &#125; else &#123; node-&gt;_next-&gt;_prev = node-&gt;_prev; node-&gt;_prev-&gt;_next = node-&gt;_next; &#125; node-&gt;_next = _head; node-&gt;_prev = nil; _head-&gt;_prev = node; _head = node;&#125;- (void)removeNode:(_YYLinkedMapNode *)node &#123; CFDictionaryRemoveValue(_dic, (__bridge const void *)(node-&gt;_key)); _totalCost -= node-&gt;_cost; _totalCount--; if (node-&gt;_next) node-&gt;_next-&gt;_prev = node-&gt;_prev; if (node-&gt;_prev) node-&gt;_prev-&gt;_next = node-&gt;_next; if (_head == node) _head = node-&gt;_next; if (_tail == node) _tail = node-&gt;_prev;&#125;- (_YYLinkedMapNode *)removeTailNode &#123; if (!_tail) return nil; _YYLinkedMapNode *tail = _tail; CFDictionaryRemoveValue(_dic, (__bridge const void *)(_tail-&gt;_key)); _totalCost -= _tail-&gt;_cost; _totalCount--; if (_head == _tail) &#123; _head = _tail = nil; &#125; else &#123; _tail = _tail-&gt;_prev; _tail-&gt;_next = nil; &#125; return tail;&#125; ÂØπÁªìÁÇπÁöÑÊèíÂÖ•„ÄÅÁßªÈô§„ÄÅË∞ÉÊï¥‰ΩçÁΩÆÔºåÊòØÊï∞ÊçÆÁªìÊûÑÁöÑÂü∫Á°ÄÊìç‰Ωú„ÄÇ‰ª§‰∫∫ÊÄÄÂøµÔºÅ _releaseOnMainThreadÂíå_releaseAsynchronouslyËøô‰∏§‰∏™ÈÄâÈ°πÁöÑÂÆûÁé∞‰πüÂæàÁÆÄÂçï„ÄÇ‰ΩúËÄÖËá™Â∑±Áª¥Êä§‰∫Ü‰∏Ä‰∏™ÈòüÂàó: static inline dispatch_queue_t YYMemoryCacheGetReleaseQueue() &#123; return dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0);&#125; ÁßªÈô§ÁöÑÊó∂ÂÄôÊúâÊâÄÂà§Êñ≠Ôºö CFMutableDictionaryRef holder = _dic; _dic = CFDictionaryCreateMutable(CFAllocatorGetDefault(), 0, &amp;kCFTypeDictionaryKeyCallBacks, &amp;kCFTypeDictionaryValueCallBacks); if (_releaseAsynchronously) &#123; dispatch_queue_t queue = _releaseOnMainThread ? dispatch_get_main_queue() : YYMemoryCacheGetReleaseQueue(); dispatch_async(queue, ^&#123; CFRelease(holder); // hold and release in specified queue &#125;); &#125; else if (_releaseOnMainThread &amp;&amp; !pthread_main_np()) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; CFRelease(holder); // hold and release in specified queue &#125;); &#125; else &#123; CFRelease(holder); &#125; Ë¶ÅÊ±ÇÂºÇÊ≠•Ë¶ÅÊ±Ç‰∏ªÁ∫øÁ®ãÔºöÈÇ£Â∞±Âú®‰∏ªÁ∫øÁ®ãÂºÇÊ≠•ÈáäÊîæholder„ÄÇÂÖ≥‰∫éËøôÈáå‰ΩøÁî®‰∏Ä‰∏™holderÁöÑÂéüÂõ†Ôºå‰∏ãÊñáÊúâËß£Èáä„ÄÇ Ê†∏ÂøÉÊìç‰Ωú@implementation YYMemoryCache &#123; pthread_mutex_t _lock; _YYLinkedMap *_lru; dispatch_queue_t _queue;&#125; ‰ªéËøôÈáåÂèØ‰ª•ÁúãÂá∫YYMemoryCache‰ΩøÁî®pthread_mutex_t‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ ÊúÄÂÖ≥ÈîÆÁöÑËøòÊòØÂØπÊó†ÊïàÁºìÂ≠òÂØπË±°ÁöÑÈáäÊîæÔºå‰ª• count ‰∏∫‰æãÔºåÂΩìÁºìÂ≠òÁöÑÂØπË±°Êï∞ÈáèË∂ÖËøá‰∫Ü count ÈôêÂà∂ÔºåÂ∞±ÈúÄË¶ÅÂØπÈìæË°®ÂêéÁ´Ø‰∏çÂ∏∏‰ΩøÁî®ÁöÑÁºìÂ≠òÂØπË±°ËøõË°åÁßªÈô§Êìç‰ΩúÔºåÁõ¥Âà∞Êª°Ë∂≥ count ÈôêÂà∂„ÄÇ - (void)_trimToCount:(NSUInteger)countLimit &#123; BOOL finish = NO; pthread_mutex_lock(&amp;_lock); if (countLimit == 0) &#123; [_lru removeAll]; finish = YES; &#125; else if (_lru-&gt;_totalCount &lt;= countLimit) &#123; finish = YES; &#125; pthread_mutex_unlock(&amp;_lock); if (finish) return; NSMutableArray *holder = [NSMutableArray new]; while (!finish) &#123; if (pthread_mutex_trylock(&amp;_lock) == 0) &#123; if (_lru-&gt;_totalCount &gt; countLimit) &#123; _YYLinkedMapNode *node = [_lru removeTailNode]; if (node) [holder addObject:node]; &#125; else &#123; finish = YES; &#125; pthread_mutex_unlock(&amp;_lock); &#125; else &#123; usleep(10 * 1000); //10 ms &#125; &#125; if (holder.count) &#123; dispatch_queue_t queue = _lru-&gt;_releaseOnMainThread ? dispatch_get_main_queue() : YYMemoryCacheGetReleaseQueue(); dispatch_async(queue, ^&#123; [holder count]; // release in queue &#125;); &#125;&#125; Ëøô‰∏™ÊñπÊ≥ïÂÅö‰∫Ü‰ªÄ‰πàÔºü ‰ΩøÁî®pthread_mutex_lock(&amp;_lock);pthread_mutex_unlock(&amp;_lock);ÂØπÊìç‰ΩúÂä†ÈîÅËß£ÈîÅÊù•‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ ÂØπÂèÇÊï∞ countLimit Âà§Êñ≠ÔºöÂ¶ÇÊûúcountLimit‰∏∫0Ôºå‰πüÂ∞±ÊòØËØ¥ÁºìÂ≠òÊï∞ÈáèÈôêÂà∂‰∏∫0ÔºåÈÇ£ÁßªÈô§ÊâÄÊúâÁºìÂ≠òÂØπË±°Â∞±ÊòØ‰∫Ü„ÄÇÂ¶ÇÊûúÂΩìÂâçÊâÄÁºìÂ≠òÁöÑÂØπË±°Êï∞ÈáèÂ∞è‰∫écountLimitÔºåÈÇ£ËØ¥ÊòéÊª°Ë∂≥Êï∞ÈáèÈôêÂà∂Ë¶ÅÊ±ÇÔºåÂ∞±‰∏çÈúÄË¶ÅÁßªÈô§Êìç‰Ωú‰∫Ü„ÄÇ ‰ΩúËÄÖÂàõÂª∫‰∏Ä‰∏™ÂèØÂèòÂ≠óÂÖ∏holderÔºåÂΩì‰∏çÊª°Ë∂≥countLimitÈôêÂà∂Ë¶ÅÊ±ÇÁöÑÊó∂ÂÄôÔºåÂØπÈìæË°®Â∞æÁªìÁÇπËøõË°åÁßªÈô§Êìç‰ΩúÔºåÂπ∂ÊääËøô‰∏™Â∞æÁªìÁÇπÊ∑ªÂä†Âà∞holder‰∏≠ÊåÅÊúâ„ÄÇÂΩìÁÑ∂ÔºåËøôÈáåÊúâÂä†ÈîÅÊìç‰Ωú„ÄÇËøô‰∏™ while Âæ™ÁéØÁªìÊùüÔºåÊâÄÊúâÂ§ö‰ΩôÁöÑÁºìÂ≠òÂØπË±°Â∞±Âú®holder‰∏≠‰∫Ü„ÄÇ4.ÂØπholder‰∏≠ÊâÄÊúâÂÖÉÁ¥†ËøõË°å release Êìç‰Ωú„ÄÇÂÖ∂‰ªñÁöÑÂ¶Ç: - (void)_trimToAge:(NSTimeInterval)ageLimit; - (void)_trimToCost:(NSUInteger)costLimit Êìç‰ΩúÂêåÁêÜ„ÄÇ ÂÜÖÂ≠òË≠¶ÂëäÂÜÖÂ≠òË≠¶ÂëäËØ≠ App ËøõÂÖ•ÂêéÂè∞Êó∂ÈáäÊîæÁºìÂ≠òÂØπË±°ÁöÑÊìç‰ΩúÔºå‰ΩúËÄÖÊé•Âèó‰∫ÜÁ≥ªÁªüÈÄöÁü•ÔºåÁõ¥Êé•Â§ÑÁêÜÂç≥ÂèØ„ÄÇ [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_appDidReceiveMemoryWarningNotification) name:UIApplicationDidReceiveMemoryWarningNotification object:nil];[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_appDidEnterBackgroundNotification) name:UIApplicationDidEnterBackgroundNotification object:nil]; Â≠òÂèñÂÆûÁé∞- (BOOL)containsObjectForKey:(id)key &#123; if (!key) return NO; pthread_mutex_lock(&amp;_lock); BOOL contains = CFDictionaryContainsKey(_lru-&gt;_dic, (__bridge const void *)(key)); pthread_mutex_unlock(&amp;_lock); return contains;&#125;- (id)objectForKey:(id)key &#123; if (!key) return nil; pthread_mutex_lock(&amp;_lock); _YYLinkedMapNode *node = CFDictionaryGetValue(_lru-&gt;_dic, (__bridge const void *)(key)); if (node) &#123; node-&gt;_time = CACurrentMediaTime(); [_lru bringNodeToHead:node]; &#125; pthread_mutex_unlock(&amp;_lock); return node ? node-&gt;_value : nil;&#125;- (void)setObject:(id)object forKey:(id)key &#123; [self setObject:object forKey:key withCost:0];&#125; ÂØπÁºìÂ≠òÂØπË±°ÁöÑËØªÂèñËá™ÁÑ∂ÊòØÊ†πÊçÆ key ËØªÂèñÂà∞Â≠óÂÖ∏‰∏≠ÂØπÂ∫îÁöÑ valueÔºåËøô‰∏™ value ÊòØ‰∏™ÁªìÁÇπ(_YYLinkedMapNode)ÔºåÂÜçÂèñÂá∫Ëøô‰∏™ÁªìÁÇπÁöÑvalue Â±ûÊÄßÔºå‰æøÊòØÊúÄÂéüÂßãÁöÑÁºìÂ≠òÂØπË±°‰∫Ü:node-&gt;_value„ÄÇ 2.ÂÖ≥ÈîÆÁÇπ1.Â≠óÂÖ∏ Â£∞Êòé: CFMutableDictionaryRef _dic;ÂàõÂª∫: _dic = CFDictionaryCreateMutable(CFAllocatorGetDefault(), 0, &amp;kCFTypeDictionaryKeyCallBacks, &amp;kCFTypeDictionaryValueCallBacks);ËÆæÂÄº: CFDictionarySetValue(_dic, (__bridge const void *)(node-&gt;_key), (__bridge const void *)(node));ÂèñÂÄº: CFDictionaryGetValue(_lru-&gt;_dic, (__bridge const void *)(key));ÁßªÈô§: CFDictionaryRemoveValue(_dic, (__bridge const void *)(node-&gt;_key));Ëé∑ÂèñÊï∞Èáè: CFDictionaryGetCount(_dic);ÊòØÂê¶Â≠òÂú®: CFDictionaryContainsKey(_lru-&gt;_dic, (__bridge const void *)(key));ÈáäÊîæ: CFRelease(_dic); 2.ÂÆπÂô®‰∏≠ÂØπË±°ÈîÄÊØÅÊéßÂà∂ ‚ÄúÂØπË±°ÁöÑÈîÄÊØÅËôΩÁÑ∂Ê∂àËÄóËµÑÊ∫ê‰∏çÂ§öÔºå‰ΩÜÁ¥ØÁßØËµ∑Êù•‰πüÊòØ‰∏çÂÆπÂøΩËßÜÁöÑ„ÄÇÈÄöÂ∏∏ÂΩìÂÆπÂô®Á±ªÊåÅÊúâÂ§ßÈáèÂØπË±°Êó∂ÔºåÂÖ∂ÈîÄÊØÅÊó∂ÁöÑËµÑÊ∫êÊ∂àËÄóÂ∞±ÈùûÂ∏∏ÊòéÊòæ„ÄÇÂêåÊ†∑ÁöÑÔºåÂ¶ÇÊûúÂØπË±°ÂèØ‰ª•ÊîæÂà∞ÂêéÂè∞Á∫øÁ®ãÂéªÈáäÊîæÔºåÈÇ£Â∞±Êå™Âà∞ÂêéÂè∞Á∫øÁ®ãÂéª‚Ä¶‚Äù - (void)demo &#123;// ÂØπË±°ÈîÄÊØÅÂíåÁßªÈô§ÂÆπÂô®‰∏≠ÂÖÉÁ¥†‰∏§‰ª∂‰∫ãÈöîÁ¶ªÂºÄ&#123; // Êï∞ÁªÑ‰∏≠ÁöÑÊâÄÊúâÂÖÉÁ¥†Âú®Â≠êÁ∫øÁ®ãÈáäÊîæ NSArray *holder = tmp; tmp = [NSMutableArray array]; if (holder.count &gt; 0) &#123; dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; [holder count]; &#125;); &#125;&#125; &#123; // Êï∞ÁªÑ‰∏≠ÁöÑÊüê‰∏™ÂÖÉÁ¥†Âú®Â≠êÁ∫øÁ®ãÈáäÊîæ id obj = tmp[2]; NSMutableArray *holder = [NSMutableArray array]; [holder addObject:obj]; [tmp removeObject:obj]; if (holder.count &gt; 0) &#123; dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; [holder count]; &#125;); &#125;&#125;&#125; 3.Á∫øÁ®ãÂÆâÂÖ®ÁöÑÂÆûÁé∞ &#123; // ÂèñÂÄºÁ∫øÁ®ãÂÆâÂÖ®pthread_mutex_lock(&amp;_lock);BOOL releaseAsynchronously = _lru-&gt;_releaseAsynchronously;pthread_mutex_unlock(&amp;_lock);return releaseAsynchronously;&#125;&#123; // ËÆæÂÄºÁ∫øÁ®ãÂÆâÂÖ®pthread_mutex_lock(&amp;_lock);_lru-&gt;_releaseAsynchronously = releaseAsynchronously;pthread_mutex_unlock(&amp;_lock);&#125; 4.pthread_mutex_lock‰ΩøÁî® Â£∞ÊòéÈîÅ: pthread_mutex_t _lock;ÂàõÂª∫ÈîÅ: pthread_mutex_init(&amp;_lock, NULL);Âä†ÈîÅ: pthread_mutex_lock(&amp;_lock);Ëß£ÈîÅ: pthread_mutex_unlock(&amp;_lock);Â∞ùËØïÂä†ÈîÅ:if (pthread_mutex_trylock(&amp;_lock) == 0) &#123;pthread_mutex_unlock(&amp;_lock);&#125; else &#123;usleep(10 * 1000); //10 ms&#125;ÈîÄÊØÅÈîÅ: pthread_mutex_destroy(&amp;_lock); 5.if-else ÂçïÂè• if (_name) return nil;else return nil; 3.YYDiskCache ÂÆûÁé∞YYDiskCache‰∏ªË¶ÅË∞ÉÁî®‰∫ÜYYKVStorageÁöÑÊé•Âè£ÔºåÂπ∂Êèê‰æõÂØπÂ§ñ API„ÄÇ ‰∫î‰∏™ÂáΩÊï∞/// Free disk space in bytes.static int64_t _YYDiskSpaceFree() &#123; NSError *error = nil; NSDictionary *attrs = [[NSFileManager defaultManager] attributesOfFileSystemForPath:NSHomeDirectory() error:&amp;error]; if (error) return -1; int64_t space = [[attrs objectForKey:NSFileSystemFreeSize] longLongValue]; if (space &lt; 0) space = -1; return space;&#125;/// String's md5 hash.static NSString *_YYNSStringMD5(NSString *string) &#123; if (!string) return nil; NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding]; unsigned char result[CC_MD5_DIGEST_LENGTH]; CC_MD5(data.bytes, (CC_LONG)data.length, result); return [NSString stringWithFormat: @"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x", result[0], result[1], result[2], result[3], result[4], result[5], result[6], result[7], result[8], result[9], result[10], result[11], result[12], result[13], result[14], result[15] ];&#125;static void _YYDiskCacheInitGlobal() &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; _globalInstancesLock = dispatch_semaphore_create(1); _globalInstances = [[NSMapTable alloc] initWithKeyOptions:NSPointerFunctionsStrongMemory valueOptions:NSPointerFunctionsWeakMemory capacity:0]; &#125;);&#125;static YYDiskCache *_YYDiskCacheGetGlobal(NSString *path) &#123; if (path.length == 0) return nil; _YYDiskCacheInitGlobal(); dispatch_semaphore_wait(_globalInstancesLock, DISPATCH_TIME_FOREVER); id cache = [_globalInstances objectForKey:path]; dispatch_semaphore_signal(_globalInstancesLock); return cache;&#125;static void _YYDiskCacheSetGlobal(YYDiskCache *cache) &#123; if (cache.path.length == 0) return; _YYDiskCacheInitGlobal(); dispatch_semaphore_wait(_globalInstancesLock, DISPATCH_TIME_FOREVER); [_globalInstances setObject:cache forKey:cache.path]; dispatch_semaphore_signal(_globalInstancesLock);&#125; _YYDiskSpaceFree()Êèê‰æõÂâ©‰ΩôÁ£ÅÁõòÁ©∫Èó¥ÁöÑÊü•ËØ¢„ÄÇ_YYNSStringMD5(NSString *string)Êèê‰æõÂ≠óÁ¨¶‰∏≤ËΩ¨ md5„ÄÇ _YYDiskCacheInitGlobal()Áî®‰∫éÂàùÂßãÂåñ‰∏Ä‰∏™Âº∫-Âº±ÁöÑNSMapTableÔºå‰øùÂ≠òYYDiskCacheÂØπË±°„ÄÇ_YYDiskCacheGetGlobal(NSString *path)Áî®‰∫éÊ†πÊçÆË∑ØÂæÑ path Ëé∑ÂèñÂØπÂ∫îÁöÑYYDiskCacheÂØπË±°„ÄÇ_YYDiskCacheSetGlobal(YYDiskCache *cache)Áî®‰∫éÊ†πÊçÆË∑ØÂæÑ path Âú®NSMapTable‰øùÂ≠ò‰∏Ä‰∏™YYDiskCacheÂØπË±°„ÄÇ ‰∏ªË¶ÅÂÆûÁé∞YYDiskCacheÁöÑÂäüËÉΩÊØîÂ¶ÇÁßªÈô§ËøáÊúüÁöÑÂØπË±°„ÄÅÁßªÈô§Ë∂ÖËøáÊï∞ÈáèÈôêÂà∂ÁöÑÂØπË±°Á≠âÔºå‰∏ªË¶ÅÈÄöËøáYYKVStorageÂÆûÁé∞„ÄÇ‰ΩúËÄÖÊää‰øùÂ≠òÁ±ªÂûãÂàÜ‰∏∫‰∏âÁßçÔºö typedef NS_ENUM(NSUInteger, YYKVStorageType) &#123; /// file system. YYKVStorageTypeFile = 0, /// in sqlite. YYKVStorageTypeSQLite = 1, /// based on your choice. YYKVStorageTypeMixed = 2,&#125;; ‰ΩúËÄÖÊåáÊòé‰∫ÜÂéüÂõ†ÔºöTypically, write data to sqlite is faster than extern file, but reading performance is dependent on data size. In my test (on iPhone 6 64G), read data from extern file is faster than from sqlite when the data is larger than 20KB. If you want to store large number of small datas (such as contacts cache),use YYKVStorageTypeSQLite to get better performance. If you want to store large files (such as image cache),use YYKVStorageTypeFile to get better performance. You can use YYKVStorageTypeMixed and choice your storage type for each item. 20kb ‰ª•‰∏ãÁöÑÊåÅ‰πÖÂåñÔºåÊîæÂà∞Êñá‰ª∂‰∏≠„ÄÇ 20kb ‰ª•‰∏äÁöÑÊåÅ‰πÖÂåñÔºåÊîæÂà∞Êï∞ÊçÆÂ∫ìsqlite‰∏≠„ÄÇ‰πüÂèØ‰ª•ÈÄâÊã©Ê∑∑ÂêàÂ≠òÂÇ®„ÄÇ ‰∏â.ÂÖ≥ÈîÆÁÇπ1.Âº±ÂºïÁî®+Âº∫ÂºïÁî® __weak typeof(self) _self = self;dispatch_async(_queue, ^&#123; __strong typeof(_self) self = _self; BOOL contains = [self containsObjectForKey:key];// self Â∫îËØ•ÊòØÂ±ÄÈÉ®ÂèòÈáè&#125;); 2, Âø´ÈÄüÁîüÊàêÊó∂Èó¥Êà≥(10‰ΩçÊï∞) long timestamp = time(NULL); 3.initÊûÑÈÄ†&#123; self = [super init]; if (!self) return nil; //.... return self;&#125; ÊäõÂá∫ÂºÇÂ∏∏ @throw [NSException exceptionWithName:@"name" reason:@"YYDiskCache must be initialized with a path. Use 'initWithPath:' or 'initWithPath:inlineThreshold:' instead." userInfo:nil]; 5.Â∞ùËØïÊçïËé∑ÂºÇÂ∏∏@try &#123; object = [NSKeyedUnarchiver unarchiveObjectWithData:item.value];&#125;@catch (NSException *exception) &#123; // nothing to do...&#125; Âõõ.YYKVStorageYYKVStorageÊ≤°ÊúâÈòÖËØª„ÄÇ‰πç‰∏ÄÁúãÊòØËÆ∏Â§öÁêêÁ¢éÁöÑ SQL Êìç‰ΩúÂíåÊñá‰ª∂Êìç‰ΩúÔºåÊ≤°ÊúâÁ∫≥ÂÖ•ÈòÖËØªËÆ°Âàí„ÄÇ]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØª„ÄåYYModel„Äç]]></title>
    <url>%2F2018%2F12%2F20%2F%E8%AF%BB%E3%80%8CYYModel%E3%80%8D%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫éYYModelÁöÑÁÆÄÂçïÊÄªÁªì„ÄÇ Â∞ùËØïÈòÖËØªYYModelÊ∫êÁ†ÅÔºåÂèëÁé∞Êúâ‰∏Ä‰∫õÁªÜËäÇÂπ∂‰∏çËÉΩÂçÅÂàÜÈÄèÂΩªÂú∞ÁêÜËß£Ê∏ÖÊ•öÔºåÂè™ËÉΩÁï•ÂæÆÁ™•Êé¢Âà∞ÂÖ∂‰∏≠‰∏ªË¶ÅÂéüÁêÜ„ÄÇËøôÈáåÂ∞±ÂΩìÂÅöÁ¨¨‰∏ÄÈÅçÈòÖËØªÁ¨îËÆ∞üòÇüòÇüòÇ„ÄÇ ‰ΩøÁî®ÂàÜÁ±ª@interface NSObject (YYModel)+ (nullable instancetype)yy_modelWithJSON:(id)json;+ (nullable instancetype)yy_modelWithDictionary:(NSDictionary *)dictionary;- (BOOL)yy_modelSetWithJSON:(id)json;- (BOOL)yy_modelSetWithDictionary:(NSDictionary *)dic;- (nullable id)yy_modelToJSONObject;- (nullable NSData *)yy_modelToJSONData;- (nullable NSString *)yy_modelToJSONString;// Ëá™ÂÆö‰πâ- (nullable id)yy_modelCopy;- (void)yy_modelEncodeWithCoder:(NSCoder *)aCoder;- (id)yy_modelInitWithCoder:(NSCoder *)aDecoder;- (NSUInteger)yy_modelHash;- (BOOL)yy_modelIsEqual:(id)model;- (NSString *)yy_modelDescription;@end@interface NSArray (YYModel)// jsonÂà∞Ê®°ÂûãÊï∞ÁªÑ+ (nullable NSArray *)yy_modelArrayWithClass:(Class)cls json:(id)json;@end@interface NSDictionary (YYModel)// jsonÂà∞Â≠óÂÖ∏+ (nullable NSDictionary *)yy_modelDictionaryWithClass:(Class)cls json:(id)json;@end ÊãìÂ±ï@protocol YYModel &lt;NSObject&gt;@optional// Ëá™ÂÆö‰πâÊ®°ÂûãÂ±ûÊÄß‰∏éjson's keyÁöÑÊò†Â∞Ñ+ (nullable NSDictionary&lt;NSString *, id&gt; *)modelCustomPropertyMapper;+ (NSDictionary *)modelCustomPropertyMapper &#123; return @&#123; @"name" : @"n", @"count" : @"ext.c", @"desc1" : @"ext.d", @"desc4" : @".ext", @"modelID" : @[@"ID", @"Id", @"id", @"ext.id"]&#125;;&#125;// ÈªëÂêçÂçï, Ëã•ÂÆûÁé∞ËØ•ÊñπÊ≥ï, ÈªëÂêçÂçï‰πãÂÜÖÁöÑkeyÂùá‰∏ç‰ΩúÂ§ÑÁêÜ+ (nullable NSArray&lt;NSString *&gt; *)modelPropertyBlacklist;+ (NSArray *)modelPropertyBlacklist &#123; return @[@"name", @"age"];&#125;// ÁôΩÂêçÂçï, Ëã•ÂÆûÁé∞ËØ•ÊñπÊ≥ï, ÁôΩÂêçÂçï‰πãÂ§ñÁöÑkeyÂùá‰∏ç‰ΩúÂ§ÑÁêÜ+ (nullable NSArray&lt;NSString *&gt; *)modelPropertyWhitelist;+ (NSArray *)modelPropertyWhitelist &#123; return @[@"name"];&#125;// 1.Ë¶ÅÂú®JSONËΩ¨ModelÁöÑËøáÁ®ã‰∏≠Ê†πÊçÆÊÉÖÂÜµÂàõÂª∫‰∏çÂêåÁ±ªÂûãÁöÑÂÆû‰æã+ (nullable Class)modelCustomClassForDictionary:(NSDictionary *)dictionary;+ (Class)modelCustomClassForDictionary:(NSDictionary*)dictionary &#123; if (dictionary[@"localName"]) &#123; return [YYLocalUser class]; &#125; else if (dictionary[@"remoteName"]) &#123; return [YYRemoteUser class]; &#125; return [YYBaseUser class];&#125;// 2.ËØ•ÊñπÊ≥ïÂèëÁîüÂú®Â≠óÂÖ∏ËΩ¨Ê®°Âûã‰πãÂâç, ÊúÄÂêéÂØπÂ≠óÂÖ∏ÂÅö‰∏ÄÊ¨°Â§ÑÁêÜ- (NSDictionary *)modelCustomWillTransformFromDictionary:(NSDictionary *)dic;//- (NSDictionary *)modelCustomWillTransformFromDictionary:(NSDictionary *)dic&#123; if ([dic[@"sex"] isEqualToString:@"Man"]) &#123; return nil; &#125; return dic;&#125;// 3.JSONËΩ¨‰∏∫ModelÂêé, ËøõË°åÊï∞ÊçÆÊ†°È™å- (BOOL)modelCustomTransformFromDictionary:(NSDictionary *)dic;- (BOOL)modelCustomTransformFromDictionary:(NSDictionary *)dic &#123; NSNumber *timestamp = dic[@"timestamp"]; if (![timestamp isKindOfClass:[NSNumber class]]) return NO; _createdAt = [NSDate dateWithTimeIntervalSince1970:timestamp.floatValue]; return YES;&#125;// Ê®°ÂûãÂÆπÂô®Â±ûÊÄß‰∏≠ÁöÑÊâÄÈúÄË¶ÅÂ≠òÊîæÁöÑÊï∞ÊçÆÁ±ªÂûã+ (nullable NSDictionary&lt;NSString *, id&gt; *)modelContainerPropertyGenericClass;+ (NSDictionary *)modelContainerPropertyGenericClass &#123; return @&#123;@"shadows" : [Shadow class], @"borders" : Border.class, @"attachments" : @"Attachment" &#125;;&#125;// ModelËΩ¨‰∏∫JSONÂêé, ËøõË°åÊï∞ÊçÆÊ†°È™å- (BOOL)modelCustomTransformToDictionary:(NSMutableDictionary *)dic;- (BOOL)modelCustomTransformToDictionary:(NSMutableDictionary *)dic &#123; if (!_createdAt) return NO; dic[@"timestamp"] = @(_createdAt.timeIntervalSince1970); return YES;&#125;@end ÂáΩÊï∞// ÂáΩÊï∞1: Ê†πÊçÆclass‰ø°ÊÅØËé∑ÂèñÂÖ∂ÂØπÂ∫îÁöÑÁ±ªÂûãstatic force_inline YYEncodingNSType YYClassGetNSType(Class cls) &#123; if (!cls) return YYEncodingTypeNSUnknown; if ([cls isSubclassOfClass:[NSMutableString class]]) return YYEncodingTypeNSMutableString; if ([cls isSubclassOfClass:[NSString class]]) return YYEncodingTypeNSString; if ([cls isSubclassOfClass:[NSDecimalNumber class]]) return YYEncodingTypeNSDecimalNumber; if ([cls isSubclassOfClass:[NSNumber class]]) return YYEncodingTypeNSNumber; if ([cls isSubclassOfClass:[NSValue class]]) return YYEncodingTypeNSValue; if ([cls isSubclassOfClass:[NSMutableData class]]) return YYEncodingTypeNSMutableData; if ([cls isSubclassOfClass:[NSData class]]) return YYEncodingTypeNSData; if ([cls isSubclassOfClass:[NSDate class]]) return YYEncodingTypeNSDate; if ([cls isSubclassOfClass:[NSURL class]]) return YYEncodingTypeNSURL; if ([cls isSubclassOfClass:[NSMutableArray class]]) return YYEncodingTypeNSMutableArray; if ([cls isSubclassOfClass:[NSArray class]]) return YYEncodingTypeNSArray; if ([cls isSubclassOfClass:[NSMutableDictionary class]]) return YYEncodingTypeNSMutableDictionary; if ([cls isSubclassOfClass:[NSDictionary class]]) return YYEncodingTypeNSDictionary; if ([cls isSubclassOfClass:[NSMutableSet class]]) return YYEncodingTypeNSMutableSet; if ([cls isSubclassOfClass:[NSSet class]]) return YYEncodingTypeNSSet; return YYEncodingTypeNSUnknown;&#125;// ÂáΩÊï∞2: Âà§Êñ≠YYEncodingTypeÊòØ‰∏çÊòØ‰∏Ä‰∏™Êï∞Â≠ó(Êï¥ÂΩ¢\ÈïøÊï¥Âûã\ÊµÆÁÇπÂûãÁ≠â)static force_inline BOOL YYEncodingTypeIsCNumber(YYEncodingType type) &#123; switch (type &amp; YYEncodingTypeMask) &#123; case YYEncodingTypeBool: case YYEncodingTypeInt8: case YYEncodingTypeUInt8: case YYEncodingTypeInt16: case YYEncodingTypeUInt16: case YYEncodingTypeInt32: case YYEncodingTypeUInt32: case YYEncodingTypeInt64: case YYEncodingTypeUInt64: case YYEncodingTypeFloat: case YYEncodingTypeDouble: case YYEncodingTypeLongDouble: return YES; default: return NO; &#125;&#125;// ÂáΩÊï∞3: Ê†πÊçÆ‰∏Ä‰∏™idÁ±ªÂûãÁöÑÂØπË±°ÂàõÂª∫‰∏Ä‰∏™NSNumberÁ±ªÂûãÁöÑÂØπË±°static force_inline NSNumber *YYNSNumberCreateFromID(__unsafe_unretained id value) &#123; static NSCharacterSet *dot; static NSDictionary *dic; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; dot = [NSCharacterSet characterSetWithRange:NSMakeRange('.', 1)]; dic = @&#123;@"TRUE" : @(YES), @"True" : @(YES), @"true" : @(YES), @"FALSE" : @(NO), @"False" : @(NO), @"false" : @(NO), @"YES" : @(YES), @"Yes" : @(YES), @"yes" : @(YES), @"NO" : @(NO), @"No" : @(NO), @"no" : @(NO), @"NIL" : (id)kCFNull, @"Nil" : (id)kCFNull, @"nil" : (id)kCFNull, @"NULL" : (id)kCFNull, @"Null" : (id)kCFNull, @"null" : (id)kCFNull, @"(NULL)" : (id)kCFNull, @"(Null)" : (id)kCFNull, @"(null)" : (id)kCFNull, @"&lt;NULL&gt;" : (id)kCFNull, @"&lt;Null&gt;" : (id)kCFNull, @"&lt;null&gt;" : (id)kCFNull&#125;; &#125;); // kCFNullÂçï‰æã if (!value || value == (id)kCFNull) return nil; // NSNumberÁõ¥Êé•ËøîÂõû if ([value isKindOfClass:[NSNumber class]]) return value; // NSString, ÂèñÂá∫dic‰∏≠ÂØπÂ∫îÁöÑÂÄº if ([value isKindOfClass:[NSString class]]) &#123; NSNumber *num = dic[value]; if (num) &#123; if (num == (id)kCFNull) return nil; return num; &#125; // Ëøô‰∏™Â≠óÁ¨¶‰∏≤‰∏≠Âê´Êúâ ".", ‰æãÂ¶Ç @"12.344" if ([(NSString *)value rangeOfCharacterFromSet:dot].location != NSNotFound) &#123; const char *cstring = ((NSString *)value).UTF8String; if (!cstring) return nil; double num = atof(cstring); // isfinite()ÊµãËØïÊüê‰∏™ÊµÆÁÇπÊï∞ÊòØ‰∏çÊòØÊúâÈôêÁöÑÊï∞ // isinf()ÊµãËØïÊüê‰∏™ÊµÆÁÇπÊï∞ÊòØÂê¶ÊòØÊó†ÈôêÂ§ß // isnan()ÊµãËØïÊüê‰∏™ÊµÆÁÇπÊï∞ÊòØÂê¶ÊòØ ÈùûÊï∞Â≠ó if (isnan(num) || isinf(num)) return nil; // numÊòØÂê¶ÊòØÊó†ÈôêÂ§ßÊàñËÄÖÊòØÂê¶ÊòØÈùûÊï∞Â≠ó return @(num); // return @(12.344); &#125; else &#123; // Â≠óÁ¨¶‰∏≤‰∏≠Ê≤°Êúâ".", ‰æãÂ¶Ç @"1323" const char *cstring = ((NSString *)value).UTF8String;// ËΩ¨Âåñ‰∏∫CÂ≠óÁ¨¶‰∏≤"1323" if (!cstring) return nil; // atoiÂáΩÊï∞ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Âåñ‰∏∫intÁ±ªÂûãÂèòÈáè. atolÂáΩÊï∞ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Âåñ‰∏∫longÁ±ªÂûãÂèòÈáè. // atollÂáΩÊï∞ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Âåñ‰∏∫long longÁ±ªÂûãÂèòÈáè.atofÂáΩÊï∞ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Âåñ‰∏∫doubleÁ±ªÂûãÂèòÈáè return @(atoll(cstring)); // ËΩ¨Êç¢‰∏∫long longÁ±ªÂûãÂèòÈáè &#125; &#125; return nil;&#125;// ÂáΩÊï∞4: Â∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Âåñ‰∏∫Êó•ÊúüNSDate// Ê†πÊçÆstringÁöÑlengthÂà§Êñ≠ÈúÄË¶ÅË∞ÉÁî®Âì™‰∏Ä‰∏™block, ‰∏∫‰∫ÜÈÅøÂÖçÊïàÁéáËæÉ‰ΩéÁöÑif-else, ÈááÁî®blockÊï∞ÁªÑÁöÑÂΩ¢Âºè, stringÁöÑlengthÊ≠£Â•ΩÂØπÂ∫îblocksÊï∞ÁªÑÁöÑÁ¥¢Âºï, Âç≥Êü•Ë°®Ê≥ï, ÊïàÁéáÂæóÂà∞ÊèêÂçá.// YYNSDateParseBlock parser = blocks[string.length];static force_inline NSDate *YYNSDateFromString(__unsafe_unretained NSString *string) &#123; typedef NSDate* (^YYNSDateParseBlock)(NSString *string); #define kParserNum 34 // ÂÆö‰πâ‰∏Ä‰∏™blockÊï∞ÁªÑ, Êï∞ÁªÑÊòØCÊï∞ÁªÑ static YYNSDateParseBlock blocks[kParserNum + 1] = &#123;0&#125;; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; &#123; /* 2014-01-20 // Google , 10‰∏™Â≠óÁ¨¶, ÂØπÂ∫îblocks[10] */ NSDateFormatter *formatter = [[NSDateFormatter alloc] init]; formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0]; formatter.dateFormat = @"yyyy-MM-dd"; blocks[10] = ^(NSString *string) &#123; return [formatter dateFromString:string]; &#125;; &#125; &#123; /* 2014-01-20 12:24:48 // 19‰∏™Â≠óÁ¨¶, ÂØπÂ∫îblocks[19] 2014-01-20T12:24:48 // Google, 19‰∏™Â≠óÁ¨¶, ÂØπÂ∫îblocks[19] 2014-01-20 12:24:48.000 // 23‰∏™Â≠óÁ¨¶, ÂØπÂ∫îblocks[23] 2014-01-20T12:24:48.000 // 23‰∏™Â≠óÁ¨¶, ÂØπÂ∫îblocks[23] */ NSDateFormatter *formatter1 = [[NSDateFormatter alloc] init]; formatter1.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter1.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0]; formatter1.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss"; NSDateFormatter *formatter2 = [[NSDateFormatter alloc] init]; formatter2.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter2.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0]; formatter2.dateFormat = @"yyyy-MM-dd HH:mm:ss"; NSDateFormatter *formatter3 = [[NSDateFormatter alloc] init]; formatter3.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter3.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0]; formatter3.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss.SSS"; NSDateFormatter *formatter4 = [[NSDateFormatter alloc] init]; formatter4.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter4.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0]; formatter4.dateFormat = @"yyyy-MM-dd HH:mm:ss.SSS"; blocks[19] = ^(NSString *string) &#123; if ([string characterAtIndex:10] == 'T') &#123;// 2014-01-20T12:24:48 return [formatter1 dateFromString:string]; &#125; else &#123;// 2014-01-20 12:24:48 return [formatter2 dateFromString:string]; &#125; &#125;; blocks[23] = ^(NSString *string) &#123; if ([string characterAtIndex:10] == 'T') &#123;// 2014-01-20T12:24:48.000 return [formatter3 dateFromString:string]; &#125; else &#123;// 2014-01-20 12:24:48.000 return [formatter4 dateFromString:string]; &#125; &#125;; &#125; &#123; /* 2014-01-20T12:24:48Z // Github, Apple 2014-01-20T12:24:48+0800 // Facebook 2014-01-20T12:24:48+12:00 // Google 2014-01-20T12:24:48.000Z 2014-01-20T12:24:48.000+0800 2014-01-20T12:24:48.000+12:00 */ NSDateFormatter *formatter = [NSDateFormatter new]; formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ssZ"; NSDateFormatter *formatter2 = [NSDateFormatter new]; formatter2.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter2.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss.SSSZ"; blocks[20] = ^(NSString *string) &#123; return [formatter dateFromString:string]; &#125;; blocks[24] = ^(NSString *string) &#123; return [formatter dateFromString:string]?: [formatter2 dateFromString:string]; &#125;; blocks[25] = ^(NSString *string) &#123; return [formatter dateFromString:string]; &#125;; blocks[28] = ^(NSString *string) &#123; return [formatter2 dateFromString:string]; &#125;; blocks[29] = ^(NSString *string) &#123; return [formatter2 dateFromString:string]; &#125;; &#125; &#123; /* Fri Sep 04 00:12:21 +0800 2015 // Weibo, Twitter Fri Sep 04 00:12:21.000 +0800 2015 */ NSDateFormatter *formatter = [NSDateFormatter new]; formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter.dateFormat = @"EEE MMM dd HH:mm:ss Z yyyy"; NSDateFormatter *formatter2 = [NSDateFormatter new]; formatter2.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter2.dateFormat = @"EEE MMM dd HH:mm:ss.SSS Z yyyy"; blocks[30] = ^(NSString *string) &#123; return [formatter dateFromString:string]; &#125;; blocks[34] = ^(NSString *string) &#123; return [formatter2 dateFromString:string]; &#125;; &#125; &#125;); if (!string) return nil; if (string.length &gt; kParserNum) return nil; YYNSDateParseBlock parser = blocks[string.length]; if (!parser) return nil; return parser(string); #undef kParserNum&#125;// ÂáΩÊï∞5: Ëé∑ÂèñNSBlockÁ±ªstatic force_inline Class YYNSBlockClass() &#123; static Class cls; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; void (^block)(void) = ^&#123;&#125;; cls = ((NSObject *)block).class; while (class_getSuperclass(cls) != [NSObject class]) &#123; cls = class_getSuperclass(cls); &#125; &#125;); return cls; // current is "NSBlock"&#125;// ÂáΩÊï∞6: Ëé∑ÂèñISO NSDateFormatter/** example: 2010-07-09T16:13:30+12:00 2011-01-11T11:11:11+0000 2011-01-26T19:06:43Z length: 20/24/25 */static force_inline NSDateFormatter *YYISODateFormatter() &#123; static NSDateFormatter *formatter = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; formatter = [[NSDateFormatter alloc] init]; formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ssZ"; &#125;); return formatter;&#125;/*&#123; "version": "1.1", "object": &#123; "data": &#123; "phone": "12332123" &#125; &#125;&#125; */// ÂáΩÊï∞7: Ê†πÊçÆkeypath‰ªéÂ≠óÂÖ∏‰∏≠Ëé∑ÂèñÂØπÂ∫îÁöÑÂÄº(Ëøô‰∏™ÂÄºÊòØidÁ±ªÂûã)// keyPaths: @[@"object", @"data", @"phone"] ÂØπÂ∫îÁöÑÂÄºÊòØ @"12332123"// keyPaths: @[@"object", @"data"] ÂØπÂ∫îÁöÑÂÄºÊòØ @&#123;@"phone": @"12332123"&#125;static force_inline id YYValueForKeyPath(__unsafe_unretained NSDictionary *dic, __unsafe_unretained NSArray *keyPaths) &#123; id value = nil; for (NSUInteger i = 0, max = keyPaths.count; i &lt; max; i++) &#123; value = dic[keyPaths[i]]; if (i + 1 &lt; max) &#123; if ([value isKindOfClass:[NSDictionary class]]) &#123; dic = value; &#125; else &#123; return nil; &#125; &#125; &#125; return value;&#125;// ÂáΩÊï∞8: Ê†πÊçÆÂèØÂèòÁöÑkeypath‰ªéÂ≠óÂÖ∏‰∏≠Ëé∑ÂèñÂØπÂ∫îÁöÑÂÄº(Ëøô‰∏™ÂÄºÊòØidÁ±ªÂûã)// multiKeys: @[ @[@"object", @"data"], @"phone"] ÂØπÂ∫îÁöÑÂÄºÊòØ @&#123;@"phone": @"12332123"&#125;// multiKeys: @[@"object", @"data"] ÂØπÂ∫îÁöÑÂÄºÊòØ @&#123;@"data": @&#123;@"phone": @"12332123"&#125;&#125;static force_inline id YYValueForMultiKeys(__unsafe_unretained NSDictionary *dic, __unsafe_unretained NSArray *multiKeys) &#123; id value = nil; for (NSString *key in multiKeys) &#123; if ([key isKindOfClass:[NSString class]]) &#123; value = dic[key]; if (value) break; &#125; else &#123; value = YYValueForKeyPath(dic, (NSArray *)key); if (value) break; &#125; &#125; return value;&#125;// ÂáΩÊï∞9: ‰ªéÊ®°Âûã‰∏≠ÁöÑÂ±ûÊÄß(_YYModelPropertyMetaÁ±ªÂûã)‰∏≠Ëé∑ÂèñNSNumberstatic force_inline NSNumber *ModelCreateNumberFromProperty(__unsafe_unretained id model, __unsafe_unretained _YYModelPropertyMeta *meta) &#123; switch (meta-&gt;_type &amp; YYEncodingTypeMask) &#123; case YYEncodingTypeBool: &#123; return @(((bool (*)(id, SEL))(void *) objc_msgSend)((id)model, meta-&gt;_getter));&#125; //...... &#125;&#125;// ÂáΩÊï∞10: ÂØπÊ®°Âûã‰∏≠ÁöÑÂ±ûÊÄß(_YYModelPropertyMetaÁ±ªÂûã)ËÆæÂÄº. ÂíåÂáΩÊï∞9Á±ª‰ººstatic force_inline void ModelSetNumberToProperty(__unsafe_unretained id model, __unsafe_unretained NSNumber *num, __unsafe_unretained _YYModelPropertyMeta *meta) &#123; switch (meta-&gt;_type &amp; YYEncodingTypeMask) &#123; case YYEncodingTypeBool: &#123; ((void (*)(id, SEL, bool))(void *) objc_msgSend)((id)model, meta-&gt;_setter, num.boolValue); &#125; break; // ...... &#125;&#125;// ÂáΩÊï∞11: ÂØπÊ®°Âûã‰∏≠ÁöÑÂ±ûÊÄß(_YYModelPropertyMetaÁ±ªÂûã)ËÆæÂÄºstatic void ModelSetValueForProperty(__unsafe_unretained id model, __unsafe_unretained id value, __unsafe_unretained _YYModelPropertyMeta *meta) &#123; //......&#125;typedef struct &#123; void *modelMeta; ///&lt; _YYModelMeta void *model; ///&lt; id (self) void *dictionary; ///&lt; NSDictionary (json)&#125; ModelSetContext;// ÂáΩÊï∞12: ÂØπÊ®°Âûã(_context.modelMeta and _context.model)ËÆæÁΩÆ key-valueÈîÆÂÄºÂØπstatic void ModelSetWithDictionaryFunction(const void *_key, const void *_value, void *_context) &#123; ModelSetContext *context = _context; __unsafe_unretained _YYModelMeta *meta = (__bridge _YYModelMeta *)(context-&gt;modelMeta); __unsafe_unretained _YYModelPropertyMeta *propertyMeta = [meta-&gt;_mapper objectForKey:(__bridge id)(_key)]; __unsafe_unretained id model = (__bridge id)(context-&gt;model); while (propertyMeta) &#123; if (propertyMeta-&gt;_setter) &#123; ModelSetValueForProperty(model, (__bridge __unsafe_unretained id)_value, propertyMeta); &#125; // ÊúâÂ§ö‰∏™Â±ûÊÄßÊò†Â∞ÑÂà∞Âêå‰∏Ä‰∏™ key ÂàôÊåáÂêë‰∏ã‰∏Ä‰∏™Ê®°ÂûãÂ±ûÊÄßÂÖÉ propertyMeta = propertyMeta-&gt;_next; &#125;;&#125;/** Apply function for model property meta, to set dictionary to model. @param _propertyMeta should not be nil, _YYModelPropertyMeta. @param _context _context.model and _context.dictionary should not be nil. */// ÂáΩÊï∞13:static void ModelSetWithPropertyMetaArrayFunction(const void *_propertyMeta, void *_context) &#123; ModelSetContext *context = _context; __unsafe_unretained NSDictionary *dictionary = (__bridge NSDictionary *)(context-&gt;dictionary); __unsafe_unretained _YYModelPropertyMeta *propertyMeta = (__bridge _YYModelPropertyMeta *)(_propertyMeta); if (!propertyMeta-&gt;_setter) return; id value = nil; if (propertyMeta-&gt;_mappedToKeyArray) &#123; value = YYValueForMultiKeys(dictionary, propertyMeta-&gt;_mappedToKeyArray); &#125; else if (propertyMeta-&gt;_mappedToKeyPath) &#123; value = YYValueForKeyPath(dictionary, propertyMeta-&gt;_mappedToKeyPath); &#125; else &#123; value = [dictionary objectForKey:propertyMeta-&gt;_mappedToKey]; &#125; if (value) &#123; __unsafe_unretained id model = (__bridge id)(context-&gt;model); ModelSetValueForProperty(model, value, propertyMeta); &#125;&#125;/** Returns a valid JSON object (NSArray/NSDictionary/NSString/NSNumber/NSNull), or nil if an error occurs. @param model Model, can be nil. @return JSON object, nil if an error occurs. */// ÂáΩÊï∞14: Ê®°ÂûãËΩ¨ jsonstatic id ModelToJSONObjectRecursive(NSObject *model) &#123; if (!model || model == (id)kCFNull) return model; if ([model isKindOfClass:[NSString class]]) return model; if ([model isKindOfClass:[NSNumber class]]) return model; if ([model isKindOfClass:[NSDictionary class]]) &#123; if ([NSJSONSerialization isValidJSONObject:model]) return model; NSMutableDictionary *newDic = [NSMutableDictionary new]; [((NSDictionary *)model) enumerateKeysAndObjectsUsingBlock:^(NSString *key, id obj, BOOL *stop) &#123; NSString *stringKey = [key isKindOfClass:[NSString class]] ? key : key.description; if (!stringKey) return; id jsonObj = ModelToJSONObjectRecursive(obj); if (!jsonObj) jsonObj = (id)kCFNull; newDic[stringKey] = jsonObj; &#125;]; return newDic; &#125; if ([model isKindOfClass:[NSSet class]]) &#123; NSArray *array = ((NSSet *)model).allObjects; if ([NSJSONSerialization isValidJSONObject:array]) return array; NSMutableArray *newArray = [NSMutableArray new]; for (id obj in array) &#123; if ([obj isKindOfClass:[NSString class]] || [obj isKindOfClass:[NSNumber class]]) &#123; [newArray addObject:obj]; &#125; else &#123; id jsonObj = ModelToJSONObjectRecursive(obj); if (jsonObj &amp;&amp; jsonObj != (id)kCFNull) [newArray addObject:jsonObj]; &#125; &#125; return newArray; &#125; if ([model isKindOfClass:[NSArray class]]) &#123; if ([NSJSONSerialization isValidJSONObject:model]) return model; NSMutableArray *newArray = [NSMutableArray new]; for (id obj in (NSArray *)model) &#123; if ([obj isKindOfClass:[NSString class]] || [obj isKindOfClass:[NSNumber class]]) &#123; [newArray addObject:obj]; &#125; else &#123; id jsonObj = ModelToJSONObjectRecursive(obj); if (jsonObj &amp;&amp; jsonObj != (id)kCFNull) [newArray addObject:jsonObj]; &#125; &#125; return newArray; &#125; if ([model isKindOfClass:[NSURL class]]) return ((NSURL *)model).absoluteString; if ([model isKindOfClass:[NSAttributedString class]]) return ((NSAttributedString *)model).string; if ([model isKindOfClass:[NSDate class]]) return [YYISODateFormatter() stringFromDate:(id)model]; if ([model isKindOfClass:[NSData class]]) return nil; _YYModelMeta *modelMeta = [_YYModelMeta metaWithClass:[model class]]; if (!modelMeta || modelMeta-&gt;_keyMappedCount == 0) return nil; NSMutableDictionary *result = [[NSMutableDictionary alloc] initWithCapacity:64]; __unsafe_unretained NSMutableDictionary *dic = result; // avoid retain and release in block [modelMeta-&gt;_mapper enumerateKeysAndObjectsUsingBlock:^(NSString *propertyMappedKey, _YYModelPropertyMeta *propertyMeta, BOOL *stop) &#123; if (!propertyMeta-&gt;_getter) return; id value = nil; if (propertyMeta-&gt;_isCNumber) &#123; value = ModelCreateNumberFromProperty(model, propertyMeta); &#125; else if (propertyMeta-&gt;_nsType) &#123; id v = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = ModelToJSONObjectRecursive(v); &#125; else &#123; switch (propertyMeta-&gt;_type &amp; YYEncodingTypeMask) &#123; case YYEncodingTypeObject: &#123; id v = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = ModelToJSONObjectRecursive(v); if (value == (id)kCFNull) value = nil; &#125; break; case YYEncodingTypeClass: &#123; Class v = ((Class (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = v ? NSStringFromClass(v) : nil; &#125; break; case YYEncodingTypeSEL: &#123; SEL v = ((SEL (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = v ? NSStringFromSelector(v) : nil; &#125; break; default: break; &#125; &#125; if (!value) return; if (propertyMeta-&gt;_mappedToKeyPath) &#123; NSMutableDictionary *superDic = dic; NSMutableDictionary *subDic = nil; for (NSUInteger i = 0, max = propertyMeta-&gt;_mappedToKeyPath.count; i &lt; max; i++) &#123; NSString *key = propertyMeta-&gt;_mappedToKeyPath[i]; if (i + 1 == max) &#123; // end if (!superDic[key]) superDic[key] = value; break; &#125; subDic = superDic[key]; if (subDic) &#123; if ([subDic isKindOfClass:[NSDictionary class]]) &#123; subDic = subDic.mutableCopy; superDic[key] = subDic; &#125; else &#123; break; &#125; &#125; else &#123; subDic = [NSMutableDictionary new]; superDic[key] = subDic; &#125; superDic = subDic; subDic = nil; &#125; &#125; else &#123; if (!dic[propertyMeta-&gt;_mappedToKey]) &#123; dic[propertyMeta-&gt;_mappedToKey] = value; &#125; &#125; &#125;]; if (modelMeta-&gt;_hasCustomTransformToDictionary) &#123; // ÂΩì Model ËΩ¨‰∏∫ JSON ÂÆåÊàêÂêéÔºåËØ•ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ // ‰Ω†ÂèØ‰ª•Âú®ËøôÈáåÂØπÊï∞ÊçÆËøõË°åÊ†°È™åÔºåÂ¶ÇÊûúÊ†°È™å‰∏çÈÄöËøáÔºåÂèØ‰ª•ËøîÂõû NOÔºåÂàôËØ• Model ‰ºöË¢´ÂøΩÁï•„ÄÇ // ‰Ω†‰πüÂèØ‰ª•Âú®ËøôÈáåÂÅö‰∏Ä‰∫õËá™Âä®ËΩ¨Êç¢‰∏çËÉΩÂÆåÊàêÁöÑÂ∑•‰Ωú„ÄÇ BOOL suc = [((id&lt;YYModel&gt;)model) modelCustomTransformToDictionary:dic]; if (!suc) return nil; &#125; return result;&#125;/// ÂáΩÊï∞15: Add indent to string (exclude first line)static NSMutableString *ModelDescriptionAddIndent(NSMutableString *desc, NSUInteger indent) &#123; for (NSUInteger i = 0, max = desc.length; i &lt; max; i++) &#123; unichar c = [desc characterAtIndex:i]; if (c == '\n') &#123; for (NSUInteger j = 0; j &lt; indent; j++) &#123; [desc insertString:@" " atIndex:i + 1]; &#125; i += indent * 4; max += indent * 4; &#125; &#125; return desc;&#125;/// ÂáΩÊï∞16: Ê†πÊçÆmodelÁîüÊàê‰∏Ä‰∏™ÊèèËø∞Â≠óÁ¨¶‰∏≤static NSString *ModelDescription(NSObject *model) &#123; static const int kDescMaxLength = 100; if (!model) return @"&lt;nil&gt;"; if (model == (id)kCFNull) return @"&lt;null&gt;"; if (![model isKindOfClass:[NSObject class]]) return [NSString stringWithFormat:@"%@",model]; _YYModelMeta *modelMeta = [_YYModelMeta metaWithClass:model.class]; switch (modelMeta-&gt;_nsType) &#123; case YYEncodingTypeNSString: case YYEncodingTypeNSMutableString: &#123; return [NSString stringWithFormat:@"\"%@\"",model]; &#125; case YYEncodingTypeNSValue: case YYEncodingTypeNSData: case YYEncodingTypeNSMutableData: &#123; NSString *tmp = model.description; if (tmp.length &gt; kDescMaxLength) &#123; tmp = [tmp substringToIndex:kDescMaxLength]; tmp = [tmp stringByAppendingString:@"..."]; &#125; return tmp; &#125; case YYEncodingTypeNSNumber: case YYEncodingTypeNSDecimalNumber: case YYEncodingTypeNSDate: case YYEncodingTypeNSURL: &#123; return [NSString stringWithFormat:@"%@",model]; &#125; case YYEncodingTypeNSSet: case YYEncodingTypeNSMutableSet: &#123; model = ((NSSet *)model).allObjects; &#125; // no break case YYEncodingTypeNSArray: case YYEncodingTypeNSMutableArray: &#123; NSArray *array = (id)model; NSMutableString *desc = [NSMutableString new]; if (array.count == 0) &#123; return [desc stringByAppendingString:@"[]"]; &#125; else &#123; [desc appendFormat:@"[\n"]; for (NSUInteger i = 0, max = array.count; i &lt; max; i++) &#123; NSObject *obj = array[i]; [desc appendString:@" "]; [desc appendString:ModelDescriptionAddIndent(ModelDescription(obj).mutableCopy, 1)]; [desc appendString:(i + 1 == max) ? @"\n" : @";\n"]; &#125; [desc appendString:@"]"]; return desc; &#125; &#125; case YYEncodingTypeNSDictionary: case YYEncodingTypeNSMutableDictionary: &#123; NSDictionary *dic = (id)model; NSMutableString *desc = [NSMutableString new]; if (dic.count == 0) &#123; return [desc stringByAppendingString:@"&#123;&#125;"]; &#125; else &#123; NSArray *keys = dic.allKeys; [desc appendFormat:@"&#123;\n"]; for (NSUInteger i = 0, max = keys.count; i &lt; max; i++) &#123; NSString *key = keys[i]; NSObject *value = dic[key]; [desc appendString:@" "]; [desc appendFormat:@"%@ = %@",key, ModelDescriptionAddIndent(ModelDescription(value).mutableCopy, 1)]; [desc appendString:(i + 1 == max) ? @"\n" : @";\n"]; &#125; [desc appendString:@"&#125;"]; &#125; return desc; &#125; default: &#123; NSMutableString *desc = [NSMutableString new]; [desc appendFormat:@"&lt;%@: %p&gt;", model.class, model]; if (modelMeta-&gt;_allPropertyMetas.count == 0) return desc; // sort property names NSArray *properties = [modelMeta-&gt;_allPropertyMetas sortedArrayUsingComparator:^NSComparisonResult(_YYModelPropertyMeta *p1, _YYModelPropertyMeta *p2) &#123; return [p1-&gt;_name compare:p2-&gt;_name]; &#125;]; [desc appendFormat:@" &#123;\n"]; for (NSUInteger i = 0, max = properties.count; i &lt; max; i++) &#123; _YYModelPropertyMeta *property = properties[i]; NSString *propertyDesc; if (property-&gt;_isCNumber) &#123; NSNumber *num = ModelCreateNumberFromProperty(model, property); propertyDesc = num.stringValue; &#125; else &#123; switch (property-&gt;_type &amp; YYEncodingTypeMask) &#123; case YYEncodingTypeObject: &#123; id v = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, property-&gt;_getter); propertyDesc = ModelDescription(v); if (!propertyDesc) propertyDesc = @"&lt;nil&gt;"; &#125; break; case YYEncodingTypeClass: &#123; id v = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, property-&gt;_getter); propertyDesc = ((NSObject *)v).description; if (!propertyDesc) propertyDesc = @"&lt;nil&gt;"; &#125; break; case YYEncodingTypeSEL: &#123; SEL sel = ((SEL (*)(id, SEL))(void *) objc_msgSend)((id)model, property-&gt;_getter); if (sel) propertyDesc = NSStringFromSelector(sel); else propertyDesc = @"&lt;NULL&gt;"; &#125; break; case YYEncodingTypeBlock: &#123; id block = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, property-&gt;_getter); propertyDesc = block ? ((NSObject *)block).description : @"&lt;nil&gt;"; &#125; break; case YYEncodingTypeCArray: case YYEncodingTypeCString: case YYEncodingTypePointer: &#123; void *pointer = ((void* (*)(id, SEL))(void *) objc_msgSend)((id)model, property-&gt;_getter); propertyDesc = [NSString stringWithFormat:@"%p",pointer]; &#125; break; case YYEncodingTypeStruct: case YYEncodingTypeUnion: &#123; NSValue *value = [model valueForKey:property-&gt;_name]; propertyDesc = value ? value.description : @"&#123;unknown&#125;"; &#125; break; default: propertyDesc = @"&lt;unknown&gt;"; &#125; &#125; propertyDesc = ModelDescriptionAddIndent(propertyDesc.mutableCopy, 1); [desc appendFormat:@" %@ = %@",property-&gt;_name, propertyDesc]; [desc appendString:(i + 1 == max) ? @"\n" : @";\n"]; &#125; [desc appendFormat:@"&#125;"]; return desc; &#125; &#125;&#125; ÂÖ≥ÈîÆÁÇπ 1.Âº∫Âà∂ÂÜÖËÅî #define force_inline __inline__ __attribute__((always_inline)) 2.‰ΩøÁî®‰ª£Á†ÅÂùó, ËäÇÁúÅËÆ∏Â§öÂèòÈáèÂêç &#123; NSDateFormatter *formatter = [[NSDateFormatter alloc] init];&#125;&#123; NSDateFormatter *formatter = [[NSDateFormatter alloc] init];&#125; 3.‰ΩøÁî®blockÊï∞ÁªÑ typedef NSDate* (^YYNSDateParseBlock)(NSString *string);// ÂÆö‰πâ‰∏Ä‰∏™blockÊï∞ÁªÑstatic YYNSDateParseBlock blocks[35] = &#123;0&#125;; 4.Ëé∑ÂèñNSBlockÁ±ª void (^block)(void) = ^&#123;&#125;;cls = ((NSObject *)block).class;while (class_getSuperclass(cls) != [NSObject class]) &#123; cls = class_getSuperclass(cls);&#125; 5.ÂáΩÊï∞ÂèÇÊï∞‰ΩøÁî®__unsafe_unretained Âú® ARC Êù°‰ª∂‰∏ãÔºåÈªòËÆ§Â£∞ÊòéÁöÑÂØπË±°ÊòØ __strong Á±ªÂûãÁöÑÔºåËµãÂÄºÊó∂ÊúâÂèØËÉΩ‰ºö‰∫ßÁîüretain/releaseË∞ÉÁî®ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÂèòÈáèÂú®ÂÖ∂ÁîüÂëΩÂë®ÊúüÂÜÖ‰∏ç‰ºöË¢´ÈáäÊîæÔºåÂàô‰ΩøÁî®__unsafe_unretained `‰ºöËäÇÁúÅÂæàÂ§ßÁöÑÂºÄÈîÄ„ÄÇ ËÆøÈóÆÂÖ∑Êúâ __weakÂ±ûÊÄßÁöÑÂèòÈáèÊó∂ÔºåÂÆûÈôÖ‰∏ä‰ºöË∞ÉÁî® objc_loadWeak() Âíå objc_storeWeak() Êù•ÂÆåÊàêÔºåËøô‰πü‰ºöÂ∏¶Êù•ÂæàÂ§ßÁöÑÂºÄÈîÄÔºåÊâÄ‰ª•Ë¶ÅÈÅøÂÖç‰ΩøÁî® __weakÂ±ûÊÄß„ÄÇ ÂàõÂª∫Âíå‰ΩøÁî®ÂØπË±°Êó∂ÔºåË¶ÅÂ∞ΩÈáèÈÅøÂÖçÂØπË±°ËøõÂÖ•autoreleasepoolÔºå‰ª•ÈÅøÂÖçÈ¢ùÂ§ñÁöÑËµÑÊ∫êÂºÄÈîÄ„ÄÇ 6.forÂæ™ÁéØ‰∏≠ÂÆö‰πâÂèòÈáè, ‰ΩøÁî®unsigned for (unsigned i = 0, max = keyPaths.count; i &lt; max; i++) &#123;&#125; 7.ÂèØÂèòÈáèÂàõÂª∫ÈùôÊÄÅ‰∏çÂèòÈáè, ÈùôÊÄÅÂ∏∏ÈáèÈÖçÂêàdispatch_once‰ΩøÁî® static NSSet *types = nil;static dispatch_once_t onceToken;dispatch_once(&amp;onceToken, ^&#123;NSMutableSet *set = [NSMutableSet new]; types = set;&#125;); 8.Á∫øÁ®ãÂÆâÂÖ®ÁöÑÁºìÂ≠òÂ≠óÂÖ∏ static id cacheWithKey(NSString *key) &#123; if (!key) return nil; static CFMutableDictionaryRef cache; static dispatch_once_t onceToken; static dispatch_semaphore_t lock; dispatch_once(&amp;onceToken, ^&#123; cache = CFDictionaryCreateMutable(CFAllocatorGetDefault(), 0, &amp;kCFTypeDictionaryKeyCallBacks, &amp;kCFTypeDictionaryValueCallBacks); lock = dispatch_semaphore_create(1); &#125;); dispatch_semaphore_wait(lock, DISPATCH_TIME_FOREVER); id obj = CFDictionaryGetValue(cache, (__bridge const void *)(key)); dispatch_semaphore_signal(lock); if (!obj) &#123; obj = [NSObject new]; // Other operation. if (obj) &#123; dispatch_semaphore_wait(lock, DISPATCH_TIME_FOREVER); CFDictionarySetValue(cache, (__bridge const void *)(key), (__bridge const void *)(obj)); dispatch_semaphore_signal(lock); &#125; &#125; return obj;&#125; 9.Ê∂àÊÅØÂèëÈÄÅË∞ÉÁî®Ê†ºÂºè ((int32_t (*)(id, SEL))(void *) objc_msgSend)((id)model, meta-&gt;_getter) 10.NSNullÁöÑÂçï‰æãkCFNull, Êé®Ëçê‰ΩøÁî®, ËÄå‰∏çÊòØÂàõÂª∫[NSNull null] NSNull *null1 = (id)kCFNull;NSNull *null2 = [NSNull null];Class class = Nil;NSDate *date = nil;char *p = NULL; 11.YYClassIvarInfo‰∏≠ÁöÑ name Âíå typeEncoding Â±ûÊÄßÈÉΩÁî® strong ‰øÆÈ•∞„ÄÇNSString ËøôÁ±ªÂ±ûÊÄßÂú®Á°ÆÂÆöÂÖ∂‰∏ç‰ºöÂú®ÂàùÂßãÂåñ‰πãÂêéË¢´‰øÆÊîπÁöÑÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî® strong ÂÅö‰∏ÄÊ¨°ÂçïÁ∫ØÁöÑÂº∫ÂºïÁî®Âú®ÊÄßËÉΩ‰∏äËÆ≤ÊØî copy Ë¶ÅÈ´ò‰∏Ä‰∫õ„ÄÇ 12.NSStringËΩ¨CÂ≠óÁ¨¶‰∏≤ const char *cstring = ((NSString *)value).UTF8String; ÂÆûË∑µ YYModel ÊúÄÊ†∏ÂøÉÁöÑ‰æøÊòØÈÄöËøáÈÅçÂéÜÊ®°ÂûãÁöÑÊâÄÊúâÂ±ûÊÄßÔºåÊ†πÊçÆÂ≠óÂÖ∏ÂÄºÊù•Ë∞ÉÁî®Â±ûÊÄßÁöÑ setter ÊñπÊ≥ï„ÄÇÊ≤°Êúâ‰ΩøÁî®ÊïàÁéá‰Ωé‰∏ãÁöÑ KVCÔºàÊïàÁéá‰Ωé‰∏ãÁöÑÂéüÂõ†ÂèØËÉΩÊòØÈúÄË¶ÅÂØπÊñπÊ≥ïËøõË°åÊêúÁ¥¢ÂêßÔºåÊúâÁ©∫Ê∑±Á©∂Ôºâ„ÄÇÈâ¥‰∫éÊ≠§ÔºåÁî®‰∫Ü300Ë°å‰ª£Á†ÅÁÆÄÂçïÂÜô‰∫Ü‰∏Ä‰∏™Â≠óÂÖ∏ËΩ¨Ê®°ÂûãÁöÑÁé©ÂÖ∑ÔºåÊùÉÂΩìÂÅöÊòØËØªÂÆå YYModel ÁöÑÂÆûË∑µÂêß„ÄÇËØï‰∫Ü‰∏Ä‰∏ãÔºåÊïàÊûúËøòÂèØ‰ª•üòÇ„ÄÇ @protocol YAModelProtocol &lt;NSObject&gt;@optional;+ (NSDictionary &lt;NSString *, NSString *&gt; *)customPropertyKey;+ (NSDictionary &lt;NSString *, Class&gt;*)classInArray;@end@interface NSObject (YAModel)+ (instancetype)ya_modelWithDictionary:(NSDictionary *)dict;+ (instancetype)ya_modelWithJSON:(NSData *)data;+ (NSArray *)ya_modelArrayWithKeyValuesArray:(NSArray &lt;NSDictionary *&gt;*)dictArray;@end // ÁºñÁ†ÅÁ±ªÂûãtypedef NS_OPTIONS(NSUInteger, YAType) &#123; YATypeMask = 0xFF, YATypeUnknown = 0, YATypeBOOL = 1, YATypeNSInteger = 2, YATypeNSUInteger = 3, YATypeCGFloat = 4, YATypeObject = 5, YATypeDate = 6, YATypeClass = 7, YATypeSEL = 8, YATypeArray = 9, YATypeMutableArray = 10, YATypeDictionary = 11, YATypeMutableDictionary = 12, YATypeSet = 13, YATypeMutableSet = 14, YATypeString = 15, YATypeMutableString = 16, YATypeData = 17, YATypeNumber = 18, YATypeDecimalNumber = 19,&#125;;@implementation NSObject (YAModel)static NSDictionary *classArrayDict = nil;+ (instancetype)ya_modelWithDictionary:(NSDictionary *)dict &#123; if (!dict || ![dict isKindOfClass:NSDictionary.class]) return nil; NSDictionary *propertyList = PropertyList(self); id obj = [self new]; ObjSetWithKeyValueList(obj, propertyList, dict); classArrayDict = nil; // Clean memory. return obj;&#125;+ (instancetype)ya_modelWithJSON:(NSData *)data &#123; if (!data || ![data isKindOfClass:NSData.class]) return nil; id json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:nil]; if ([json isKindOfClass:NSDictionary.class]) &#123; return [self ya_modelWithDictionary:json]; &#125; return nil;&#125;+ (NSArray *)ya_modelArrayWithKeyValuesArray:(NSArray&lt;NSDictionary *&gt; *)dictArray &#123; if (!dictArray || ![dictArray isKindOfClass:NSArray.class]) return nil; NSMutableArray *tmp = [NSMutableArray arrayWithCapacity:dictArray.count]; [dictArray enumerateObjectsUsingBlock:^(NSDictionary * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123; if ([obj isKindOfClass:NSDictionary.class]) &#123; id model = [[self class] ya_modelWithDictionary:obj]; [tmp addObject:model]; &#125; &#125;]; return [NSArray arrayWithArray:tmp] ?: nil;&#125;// Ëé∑ÂèñÂ±ûÊÄßÂàóË°® key:Â±ûÊÄßÂêç value: Â±ûÊÄßÁ±ªÂûãstatic NSDictionary *PropertyList(Class cls) &#123; if (!cls) return nil; unsigned int count; objc_property_t *properties = class_copyPropertyList(cls, &amp;count); NSMutableDictionary *tempDict = [NSMutableDictionary new]; for(int i = 0; i &lt; count; i++) &#123; objc_property_t property = properties[i]; NSString *propertyName = [NSString stringWithUTF8String:property_getName(property)]; NSString *propertyAttr = [NSString stringWithUTF8String:property_getAttributes(property)]; NSString *type = [propertyAttr substringWithRange:NSMakeRange(1, 1)]; if ([type isEqualToString:@"@"]) &#123; NSArray *components = [propertyAttr componentsSeparatedByString:@"\""]; if (components.count &gt; 2) &#123; Class propCls = NSClassFromString(components[1]); if (propCls == NSDate.class) &#123; type = @"1"; &#125; else if (propCls == NSArray.class) &#123; type = @"2"; &#125; else if (propCls == NSMutableArray.class) &#123; type = @"3"; &#125; else if (propCls == NSDictionary.class) &#123; type = @"4"; &#125; else if (propCls == NSMutableDictionary.class) &#123; type = @"5"; &#125; else if (propCls == NSSet.class) &#123; type = @"6"; &#125; else if (propCls == NSMutableSet.class) &#123; type = @"7"; &#125; else if (propCls == NSString.class) &#123; type = @"8"; &#125; else if (propCls == NSMutableString.class) &#123; type = @"9"; &#125; else if (propCls == NSData.class) &#123; type = @"10"; &#125; else if (propCls == NSNumber.class) &#123; type = @"11"; &#125; else if (propCls == NSDecimalNumber.class) &#123; type = @"12"; &#125; else if (propCls == NSObject.class) &#123; type = @"@"; &#125; else &#123; type = components[1]; &#125; &#125; &#125; NSNumber *myType = TypeForProperty(type); [tempDict setObject:myType forKey:propertyName]; if (myType.integerValue == 0) &#123; [tempDict setObject:type forKey:propertyName]; &#125; &#125; free(properties); return [NSDictionary dictionaryWithDictionary:tempDict];&#125;static NSNumber *TypeForProperty(NSString *type) &#123; static NSDictionary *_SELDictionary = nil;; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; _SELDictionary = @&#123; @"B": @(YATypeBOOL), @"q": @(YATypeNSInteger), @"Q": @(YATypeNSUInteger), @"d": @(YATypeCGFloat), @"#": @(YATypeClass), @":": @(YATypeSEL), @"@": @(YATypeObject), @"1": @(YATypeDate), @"2": @(YATypeArray), @"3": @(YATypeMutableArray), @"4": @(YATypeDictionary), @"5": @(YATypeMutableDictionary), @"6": @(YATypeSet), @"7": @(YATypeMutableSet), @"8": @(YATypeString), @"9": @(YATypeMutableString), @"10": @(YATypeData), @"11": @(YATypeNumber), @"12": @(YATypeDecimalNumber), &#125;; &#125;); return _SELDictionary[type] ?: @(YATypeUnknown);&#125;static void ObjSetWithArray(Class cls, NSDictionary *propertyDict, NSArray **keyValueArray) &#123; NSMutableArray *tmpArray = [NSMutableArray array]; [*keyValueArray enumerateObjectsUsingBlock:^(id keyValue, NSUInteger idx, BOOL * _Nonnull stop) &#123; if ([keyValue isKindOfClass:NSDictionary.class]) &#123; id obj = [cls new]; ObjSetWithKeyValueList(obj, PropertyList([obj class]), keyValue); [tmpArray addObject:obj]; &#125; &#125;]; *keyValueArray = [NSArray arrayWithArray:tmpArray];&#125;static void ObjSetWithKeyValueList(id obj, NSDictionary *propertyDict, NSDictionary *dict) &#123; Class cls = [obj class]; NSDictionary *customPropertyKeyDict = nil; if ([cls respondsToSelector:@selector(customPropertyKey)]) &#123; customPropertyKeyDict = [cls customPropertyKey]; &#125; if ([cls respondsToSelector:@selector(classInArray)] &amp;&amp; !classArrayDict) &#123; classArrayDict = [cls classInArray]; &#125; [propertyDict.allKeys enumerateObjectsUsingBlock:^(NSString *name, NSUInteger idx, BOOL * _Nonnull stop) &#123; SEL setter = SetterSelectorFromString(name); id value = nil; if (customPropertyKeyDict[name]) &#123; value = customPropertyKeyDict[name]; &#125; else &#123; value = dict[name]; &#125; id propType = propertyDict[name]; YAType type = [propType integerValue]; if (value) &#123; switch (type &amp; YATypeMask) &#123; case YATypeBOOL: &#123; ((void (*)(id, SEL, bool))(void *) objc_msgSend)((id)obj, setter, [value boolValue]); &#125; break; case YATypeNSInteger: &#123; ((void (*)(id, SEL, int64_t))(void *) objc_msgSend)((id)obj, setter, (int64_t)[value longLongValue]); &#125; break; case YATypeNSUInteger: &#123; ((void (*)(id, SEL, uint64_t))(void *) objc_msgSend)((id)obj, setter, (uint64_t)[value unsignedLongLongValue]); &#125; break; case YATypeCGFloat: &#123; long double d = [value doubleValue]; if (isnan(d) || isinf(d)) d = 0; ((void (*)(id, SEL, long double))(void *) objc_msgSend)((id)obj, setter, (long double)d); &#125; break; case YATypeDecimalNumber: &#123; if ([value isKindOfClass:NSNumber.class]) &#123; NSDecimalNumber *decNum = [NSDecimalNumber decimalNumberWithDecimal:[value decimalValue]]; ((void (*)(id, SEL, NSDecimalNumber *))(void *) objc_msgSend)((id)obj, setter, decNum); &#125; &#125; break; case YATypeClass: &#123; ((void (*)(id, SEL, Class))(void *) objc_msgSend)((id)obj, setter, NSClassFromString(value)); &#125; break; case YATypeSEL:&#123; ((void (*)(id, SEL, SEL))(void *) objc_msgSend)((id)obj, setter, NSSelectorFromString(value)); &#125; break; case YATypeDate:&#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, DateFromString(value)); &#125; break; case YATypeArray: &#123; Class cls = classArrayDict[name]; if (cls) &#123; ObjSetWithArray(cls, PropertyList(cls), &amp;value); &#125; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, value); &#125; break; case YATypeMutableArray: &#123; NSString *clsStr = classArrayDict[name]; if (clsStr) &#123; Class cls = NSClassFromString(clsStr); ObjSetWithArray(cls, PropertyList(cls), &amp;value); &#125; value = [NSMutableArray arrayWithArray:value]; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, value); &#125; break; case YATypeSet: &#123; value = [NSSet setWithArray:value]; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, value); &#125; break; case YATypeMutableSet: &#123; value = [NSMutableSet setWithArray:value]; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, value); &#125; break; case YATypeMutableString: case YATypeMutableDictionary: &#123; value = [value mutableCopy]; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, value); &#125; break; case YATypeString: case YATypeDictionary: case YATypeNumber: case YATypeUnknown: case YATypeObject: &#123; if (type == YATypeUnknown &amp;&amp; [propType isKindOfClass:NSString.class]) &#123; // ÂµåÂ•óÊ®°Âûã Class cls = NSClassFromString(propType); if (cls &amp;&amp; [value isKindOfClass:NSDictionary.class]) &#123; id obj = [cls new]; ObjSetWithKeyValueList(obj, PropertyList(cls), value); value = obj; &#125; &#125; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)obj, setter, value); &#125; break; default: break; &#125; &#125; &#125;];&#125;// name ==&gt; setName:static SEL SetterSelectorFromString(NSString *str) &#123; if (!str || str.length &lt;= 0) return nil; NSString *result = [NSString stringWithFormat:@"set%@%@:", [str substringToIndex:1].uppercaseString, [str substringFromIndex:1]]; return NSSelectorFromString(result);&#125;// date string ==&gt; data // @"2016-7-16 09:33:22"static NSDate *DateFromString(NSString *string) &#123; typedef NSDate* (^DateParseBlock)(NSString *string); static DateParseBlock blocks[20] = &#123;0&#125;; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; // @"2016-07-16 09:33:22" // 19‰∏™Â≠óÁ¨¶, ÂØπÂ∫îblocks[19] NSDateFormatter *formatter = [[NSDateFormatter alloc] init]; formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]; formatter.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0]; formatter.dateFormat = @"yyyy-MM-dd HH:mm:ss"; blocks[19] = ^(NSString *string) &#123; return [formatter dateFromString:string]; &#125;; &#125;); if (!string || string.length &gt; 19) return nil; DateParseBlock parser = blocks[string.length]; if (!parser) return nil; return parser(string);&#125;@end ÂÖ∑‰ΩìÊ∫êÁ†ÅÊîæÂú®‰∫ÜÊàëÁöÑ‰ª£Á†ÅÂ∑•ÂÖ∑Â∫ìÈáåÔºåYAKitÔºöhttps://github.com/ChenYalun/YAKit/tree/master/Util/Model ÂèÇËÄÉËµÑÊñô https://juejin.im/post/5a097435f265da431769a49c https://juejin.im/post/5a1296e36fb9a044fb075d5e https://blog.ibireme.com/2015/10/23/ios_model_framework_benchmark/ https://blog.csdn.net/game3108/article/details/52416868]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØ¶Ëß£PerformSelector]]></title>
    <url>%2F2018%2F09%2F30%2F%E8%AF%A6%E8%A7%A3PerformSelector%2F</url>
    <content type="text"><![CDATA[PerformSelectorÁõ∏ÂÖ≥Áü•ËØÜ„ÄÇ ÊÑüËßâperformSelectorÁ≥ªÂàóÊòØ‰∏™ÂæàÁ•ûÂ•áÁöÑÂ≠òÂú®ÔºåËÉΩ‰º†ÂèÇÔºåËÉΩÂª∂ËøüÔºåËøòËÉΩÂ≠êÁ∫øÁ®ãË∞ÉÔºåÂÖ≥ÈîÆËÉΩËÆ©‰ªªÊÑèÂØπË±°ÊâßË°å‰ªªÊÑèÊñπÊ≥ïÔºåÂæàÊÉ≥ÂºÑÊ∏ÖÊ•öÂÆÉÊòØÂíãÂÆûÁé∞ÁöÑÔºåËØª‰∫Ügnustep‰∏≠ÊúâÂÖ≥performSelectorÁöÑÊ∫êÁ†ÅÂêéÔºåËøôÈáåÂÅö‰∏™ÊÄªÁªì„ÄÇ Ê∫êÁ†ÅÂú∞ÂùÄÔºöhttps://github.com/gnustep/libs-base/releases/tag/base-1_25_1 Âü∫Êú¨ÊúÄÂü∫Êú¨ÁöÑperformSelectorÊúâ‰∏â‰∏™Êé•Âè£ÊñπÊ≥ïÔºåÂèØ‰ª•‰∏ç‰º†ÂèÇÔºå‰º†‰∏Ä‰∏™ÂèÇÊï∞‰ª•Âèä‰º†‰∏§‰∏™ÂèÇÊï∞„ÄÇ - (id)performSelector:(SEL)aSelector;- (id)performSelector:(SEL)aSelector withObject:(id)object;- (id)performSelector:(SEL)aSelector withObject:(id)object1 withObject:(id)object2; ‰ΩøÁî®Á§∫‰æã: // Êó†ÂèÇ id obj1 = [self performSelector:@selector(printString)];// ‰∏Ä‰∏™ÂèÇÊï∞id obj2 = [self performSelector:@selector(printString:) withObject:@"string"];// ‰∏§‰∏™ÂèÇÊï∞id obj3 = [self performSelector:@selector(printString:str2:) withObject:@"string" withObject:@&#123;@"key": @(3)&#125;]; ‰ª•‰º†ÈÄí‰∏§‰∏™ÂèÇÊï∞‰∏∫‰æãÔºåÂÆÉÁöÑÂÆûÁé∞ÊòØËøôÊ†∑ÁöÑÔºö - (id)performSelector:(SEL)aSelector withObject:(id)object1 withObject:(id)object2 &#123; IMP msg; if (aSelector == 0) &#123; [NSException raise: NSInvalidArgumentException format: @"%@ null selector given", NSStringFromSelector(_cmd)]; &#125; msg = objc_msg_lookup(self, aSelector); if (!msg) &#123; [NSException raise: NSGenericException format: @"invalid selector '%s' passed to %s", sel_getName(aSelector), sel_getName(_cmd)]; return nil; &#125; return (*msg)(self, aSelector, object1, object2);&#125; ÂèØËßÅÂ∞±ÊòØÊ†πÊçÆÊñπÊ≥ïÂêçÔºå‰ΩøÁî®Runtime‰∏≠ÁöÑobjc_msg_lookup()Ëé∑ÂèñÂà∞ÂáΩÊï∞ÊåáÈíàIMPÔºåËøõËÄåËøõË°åÂáΩÊï∞Ë∞ÉÁî®„ÄÇÂΩìÁÑ∂ÔºåËøòÊúâÂØπÊñπÊ≥ïÂêçÂíåÂáΩÊï∞ÊåáÈíàÁöÑÂÆπÈîôÂ§ÑÁêÜ„ÄÇ ÂÜÖÂ≠òÊ≥ÑÈú≤performSelectorÁ≥ªÂàóÈ¢áÂÖ∑ÊúâÂä®ÊÄÅÊÄßÔºåÂΩì‰ΩøÁî®Ëøô‰∏â‰∏™ÊñπÊ≥ïÊó∂ÔºåÁºñËØëÂô®ÂæàÂÆπÊòìÂ∞±ÁªôÂá∫Ë≠¶ÂëäÔºöPerformSelector may cause a leak because its selector is unknown„ÄÇ‰∏∫‰ªÄ‰πà‰ºöÊèêÁ§∫ÊúâÂÜÖÂ≠òÊ≥ÑÊºèÈóÆÈ¢òÂë¢Ôºü È¶ñÂÖàË¶ÅÊòéÁ°ÆÔºöË∞ÉÁî®performSelector:ÁºñËØëÂô®‰ºöÂÅáËÆæË∞ÉÁî®ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÊòØ‰∏Ä‰∏™ÂØπË±°Ôºå‰∏î‰∏ç‰ºöÂØπËøîÂõûÂÄºËøõË°åretain/release„ÄÇ Â¶ÇÊûúË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØalloc, new, copy, mutableCopyÊñπÊ≥ïÂÆ∂Êóè‰∏≠ÁöÑÊñπÊ≥ï(ÂåÖÂê´‰ª•ÂÆÉ‰ª¨ÂºÄÂ§¥)ÔºåÊñπÊ≥ïË∞ÉÁî®ÁöÑÁªìÊûúÊòØÂºÄËæü‰∫Ü‰∏ÄÂùóÂÜÖÂ≠òÁ©∫Èó¥Ôºå‰ΩÜÊòØÁ≥ªÁªü‰ªçÁÑ∂ÊåâÁÖßÈùûretain/releaseÂ§ÑÁêÜÔºåÊ≤°ÊúâÂØπÂÆÉ‰ª¨ÁöÑÂºïÁî®ËÆ°Êï∞Á∫≥ÂÖ•ÁÆ°ÁêÜÔºåËøôÊó∂ÂÜÖÂ≠òÁ©∫Èó¥Êó†Ê≥ïÈáäÊîæÔºåÂ∞±‰ºö‰∫ßÁîüÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ ÂΩìÊòæÂºèË∞ÉÁî®Ëøô‰∫õÊñπÊ≥ïÊó∂ÔºåÁºñËØëÂô®ÈÉΩËÉΩÊòéÊòæÂàÜÊûêÂá∫Êù•ÔºåÂπ∂ÁªôÂá∫ÊèêÁ§∫ÔºöErrorÔºöPerformSelector names a selector which retains the object„ÄÇÂëäËØâÊàë‰ª¨Ëøô‰∏çÁ¨¶ÂêàÂºïÁî®ËÆ°Êï∞ÁÆ°ÁêÜÁöÑËßÑÂàôÔºåÁºñËØë‰∏çÈÄöËøá„ÄÇ There are really only 4 things that ARC would consider for the return value:4 Ignore non-object types (void, int, etc) Retain object value, then release when it is no longer used (standard assumption) Release new object values when no longer used (methods in the init/ copy family or attributed with ns_returns_retained) Do nothing &amp; assume returned object value will be valid in local scope (until inner most release pool is drained, attributed with ns_returns_autoreleased) The call to methodForSelector: assumes that the return value of the method it‚Äôs calling is an object, but does not retain/release it. So you could end up creating a leak if your object is supposed to be released as in #3 above (that is, the method you‚Äôre calling returns a new object). ÊØîÂ¶ÇËøôÊ†∑Ôºö- (id)newObject &#123; return [NSObject new];&#125; // Ë∞ÉÁî®method family‰∏≠ÁöÑÊñπÊ≥ïÔºö[str performSelector:@selector(copy)];// Ë∞ÉÁî®‰ª•method family‰∏≠ÁöÑÊñπÊ≥ïÂêçÂºÄÂ§¥ÁöÑÊñπÊ≥ïÔºö[self performSelector:@selector(newObject)]; ‰ΩÜÊòØÈöêÂºèË∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÁºñËØëÂô®Êó†ËÉΩ‰∏∫Âäõ‰∫ÜÔºåÂè™ËÉΩÁªôÂá∫Ë≠¶ÂëäÔºöPerformSelector may cause a leak because its selector is unknown„ÄÇ // ÈöêÂºèË∞ÉÁî®Êó†Ê≥ïÂàÜÊûêÂá∫ÈîôËØØ: Âá∫Áé∞ÂÜÖÂ≠òÊ≥ÑÈú≤id obj1 = [str performSelector:NSSelectorFromString(@"copy")];[str performSelector:NSSelectorFromString(@"mutableCopy")];id obj2 = [[NSObject class] performSelector:NSSelectorFromString(@"new")];id obj3 = [self performSelector:NSSelectorFromString(@"newObject")]; Ê∂àÈô§waringÊúÄÁÆÄÂçïÁöÑÔºåÂèØ‰ª•Âà©Áî®#pragmaÊ∂àÈô§Ë≠¶Âëä„ÄÇ #pragma("clang diagnostic push")#pragma("clang diagnostic ignored \"-Warc-performSelector-leaks\"")[person performSelector:selector]; // ÊèíÂÖ•ÈúÄË¶ÅÊ∂àÈô§Ë≠¶ÂëäÁöÑ‰ª£Á†Å#pragma("clang diagnostic pop") ÊàñËÄÖÊç¢ÁßçÊÄùË∑ØÔºåÊ†πÊçÆperformSelectorÁöÑÂÆûÁé∞ÔºåÊïàÊûú‰∏äÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®IMPÔºå‰πüÂèØ‰ª•‰ΩøÁî®objc_msgSend()ÔºåÁîöËá≥‰ΩøÁî®NSInvocation„ÄÅsendActionÁ≠âÔºåËøôÊ†∑Â∞±ËææÂà∞ÂêåÁ≠âÂÆûÁé∞ËÄåÊ≤°ÊúâË≠¶Âëä‰∫Ü„ÄÇ ÊñπÂºè1ÔºömethodForSelectorif (!person) return;// Ëé∑ÂèñÂáΩÊï∞ÊåáÈíàIMP imp = [person methodForSelector:selector];// Á±ªÂûãËΩ¨Êç¢void (*func)(id, SEL) = (void *)imp;// Ë∞ÉÁî®func(person, selector); ÊñπÂºè2ÔºömethodForSelectorÁÆÄÂåñÁâà((void (*)(id, SEL))[person methodForSelector:selector])(self, selector); ÊñπÂºè3Ôºö‰ΩøÁî®objc_msgSend((void *(*)(id, SEL))objc_msgSend)((id)self, NSSelectorFromString(@"show")); ÊñπÂºè4ÔºöNSInvocationSEL selector = NSSelectorFromString(@"show");NSMethodSignature *methodSig = [[self class] instanceMethodSignatureForSelector:selector];NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:methodSig];[invocation setSelector:selector];[invocation setTarget:self];[invocation invoke]; ÊñπÂºè5: sendAction[UIApplication.sharedApplication sendAction:NSSelectorFromString(@"show") to:self from:nil forEvent:nil]; Ëß£ÂÜ≥ÂÜÖÂ≠òÊ≥ÑÊºèÂΩìÊàë‰ª¨‰∏ÄÂÆöË¶ÅË∞ÉÁî®newObjectËøôÁ±ªÁâπÊÆäÁöÑÊñπÊ≥ïÊó∂ÔºàÂèØËÉΩÊÄßÊûÅÂ∞èÔºâÔºåÊÄé‰πàËß£ÂÜ≥ÂÜÖÂ≠òÊ≥ÑÊºèÈóÆÈ¢òÂë¢ÔºüÊääreturnÁöÑÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞ÂáèÂ∞ëÂç≥ÂèØÔºåÊØîÂ¶ÇÔºö ÂΩì‰ΩøÁî®objc_msgSend()Êó∂id obj = CFBridgingRelease(((void *(*)(id, SEL))objc_msgSend)(self, NSSelectorFromString(@"newObject"))); ÂΩì‰ΩøÁî®methodForSelectorÊó∂id obj = CFBridgingRelease(((void *(*)(id, SEL))[self methodForSelector:NSSelectorFromString(@"newObject")])(self, NSSelectorFromString(@"newObject"))); Âª∂Ëøü- (void)performSelector:(SEL)aSelector withObject:(nullable id)anArgument afterDelay:(NSTimeInterval)delay inModes:(NSArray&lt;NSRunLoopMode&gt; *)modes;- (void)performSelector:(SEL)aSelector withObject:(nullable id)anArgument afterDelay:(NSTimeInterval)delay;+ (void)cancelPreviousPerformRequestsWithTarget:(id)aTarget selector:(SEL)aSelector object:(nullable id)anArgument;+ (void)cancelPreviousPerformRequestsWithTarget:(id)aTarget; performSelector:withObject:afterDelay:Ê∫êÁ†ÅÂÆûÁé∞: - (void)performSelector:(SEL)aSelector withObject:(id)argument afterDelay:(NSTimeInterval)seconds &#123; NSRunLoop *loop = [NSRunLoop currentRunLoop]; GSTimedPerformer *item; // itemÂºïÁî®ËÆ°Êï∞+1 item = [[GSTimedPerformer alloc] initWithSelector:aSelector target:self argument:argument delay:seconds]; // ÊåÅÊúâitem [[loop _timedPerformers] addObject:item]; // itemÂºïÁî®ËÆ°Êï∞-1 RELEASE(item); // ÊåÅÊúâtimer [loop addTimer:item-&gt;timer forMode:NSDefaultRunLoopMode];&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏ªË¶ÅÂÅö‰∫ÜËøô‰∫õ‰∫ã: Ëé∑ÂèñÂΩìÂâçÁ∫øÁ®ãÁöÑRunloopÂØπË±°„ÄÇ Ê†πÊçÆÊñπÊ≥ïÂêç„ÄÅÊñπÊ≥ïÂèÇÊï∞„ÄÅÊñπÊ≥ïË∞ÉÁî®ËÄÖÂèäÂª∂ËøüÊó∂Èó¥Á≠â‰ø°ÊÅØÂàõÂª∫‰∏Ä‰∏™GSTimedPerformerÂØπË±°ÔºåÊääËØ•ÂØπË±°Ê∑ªÂä†Âà∞RunloopÁöÑ_timedPerformersÊï∞ÁªÑ‰∏≠‰øùÂ≠ò„ÄÇ ÊääGSTimedPerformer‰∏≠ÁöÑÂÆöÊó∂Âô®timerÊ∑ªÂä†Âà∞Runloop‰∏≠„ÄÇ Â¶ÇÂÆòÊñπÊñáÊ°£ÊâÄËØ¥:This method sets up a timer to perform the aSelector message on the current thread‚Äôs run loop. The timer is configured to run in the default mode (NSDefaultRunLoopMode). When the timer fires, the thread attempts to dequeue the message from the run loop and perform the selector. It succeeds if the run loop is running and in the default mode; otherwise, the timer waits until the run loop is in the default mode. ÁúãÁúãGSTimedPerformerÂÅö‰∫Ü‰ªÄ‰πà: @interface GSTimedPerformer: NSObject &#123;@public SEL selector; id target; id argument; NSTimer *timer;&#125;- (void)fire;- (id)initWithSelector:(SEL)aSelector target:(id)target argument:(id)argument delay:(NSTimeInterval)delay;- (void)invalidate;@end@implementation GSTimedPerformer- (void)dealloc &#123; [self finalize]; TEST_RELEASE(timer); // ÈáäÊîætargetÂØπË±° RELEASE(target); RELEASE(argument); [super dealloc];&#125;- (void)finalize &#123; [self invalidate];&#125;- (void)fire &#123; DESTROY(timer); [target performSelector:selector withObject:argument]; [[[NSRunLoop currentRunLoop] _timedPerformers] removeObjectIdenticalTo:self];&#125;- (id)initWithSelector:(SEL)aSelector target:(id)aTarget argument:(id)anArgument delay:(NSTimeInterval)delay &#123; self = [super init]; if (self != nil) &#123; selector = aSelector; // ÊåÅÊúâtarget target = RETAIN(aTarget); argument = RETAIN(anArgument); timer = [[NSTimer allocWithZone:NSDefaultMallocZone()] initWithFireDate:nil interval:delay target:self selector:@selector(fire) userInfo:nil repeats:NO]; &#125; return self;&#125;- (void)invalidate &#123; if (timer != nil) &#123; [timer invalidate]; DESTROY(timer); &#125;&#125;@end The GSTimedPerformer class is used to hold information about messages which are due to be sent to objects at a particular time. ÂèØËßÅÔºåGSTimedPerformer‰ΩúÁî®Â∞±ÊòØ‰øùÂ≠òÂÖ≥‰∫éÊ∂àÊÅØÁöÑ‰ø°ÊÅØÔºåÂÖ∑‰ΩìÊñπÊ≥ïÁöÑÂª∂ËøüÂíåË∞ÉÁî®‰∏ªË¶ÅËøòÊòØ‰æùÈù†ÂÖ∂ÂÜÖÈÉ®ÁöÑÂÆöÊó∂Âô®„ÄÇÂàÜÊûêÊ∫êÁ†ÅÂèØÁü•ÔºåRunloopÁöÑ_timedPerformersÊï∞ÁªÑÊåÅÊúâ‰∫ÜGSTimedPerformerÔºåRunloopËøòÊåÅÊúâGSTimedPerformerÂÜÖÈÉ®ÁöÑÂÆöÊó∂Âô®timerÔºåÂÆöÊó∂Âô®timerÊåÅÊúâÁùÄtarget(self)„ÄÇËÄåGSTimedPerformerÊåÅÊúâÁùÄtarget(self)ÂíåÂÆöÊó∂Âô®timer„ÄÇ ÂºïÁî®ÂÖ≥Á≥ªÂ¶ÇÂõæÊâÄÁ§∫Ôºö ÂΩìËÆæÁΩÆÁöÑÊó∂Èó¥Âà∞ÁöÑÊó∂ÂÄôÔºåGSTimedPerformerÂÜÖÈÉ®ÁöÑfireÊñπÊ≥ïÂæóÂà∞Ë∞ÉÁî®ÔºåÊ≠§Êó∂Â§ñÁïåÁöÑtarget‰æøË∞ÉÁî®‰∫ÜË¢´ËÆæÁΩÆÁöÑselectorÔºåËµ∑Âà∞‰∫ÜÂª∂ËøüÊâßË°åÁöÑÊïàÊûú„ÄÇÁ¥ßÊé•ÁùÄÔºåRunloopÁöÑ_timedPerformersÊï∞ÁªÑÁßªÈô§‰∫ÜÂØπGSTimedPerformerÁöÑÂºïÁî®ÔºåGSTimedPerformerËá™ÁÑ∂‰ºöÈîÄÊØÅÔºåÂÆÉÁöÑdeallocÊñπÊ≥ïÂæóÂà∞Ë∞ÉÁî®„ÄÇËÄåGSTimedPerformer‰∏≠ÁöÑdeallocÂÜÖÈÉ®Ë∞ÉÁî®‰∫ÜfinalizeÊñπÊ≥ïÔºåfinalizeÊñπÊ≥ïÁöÑÁõÆÁöÑÊòØinvalidateÊéâÂÆöÊó∂Âô®timerÂπ∂ÂáèÂ∞ëÂÆÉÁöÑÂºïÁî®ËÆ°Êï∞„ÄÇÊ≠§Êó∂ÔºåtimerÂè™ÊúâRunloopÊåÅÊúâÁùÄÂÆÉ‰∫ÜÔºåÂÖ≥ÈîÆÊòØtimer‰∏ÄÊó¶Ë¢´invalidateÔºåRunloop‰πü‰∏ç‰ºöÂÜçÊåÅÊúâÂÆÉ‰∫ÜÔºàTimers are removed automatically when they are invalidÔºâ„ÄÇËøôÊ†∑ÔºåtimerÂΩªÂ∫ïÊ≠ªÊéâÔºåÂØπtargetÁöÑÂº∫ÂºïÁî®‰πüÊ≤°Êúâ‰∫ÜÔºå‰∏ÄÂàáÊÅ¢Â§çÂ¶ÇÂàù„ÄÇ Ëøô‰∏ÄÂàáÁöÑÂâçÊèêÂª∫Á´ãÂú®RunloopËøêË°åÂú®NSDefaultRunLoopModeÊ®°Âºè‰∏ãÂπ∂È°∫Âà©Ë∞ÉÁî®fireÊñπÊ≥ï„ÄÇÂΩìÂª∂ËøüÊñπÊ≥ïÂõ†ÁßçÁßçÂéüÂõ†Ê≤°ÊúâÊâßË°åÂ∞±ÂèØËÉΩÂá∫Áé∞ÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ ÂæàÁªèÂÖ∏ÁöÑ‰æãÂ≠êÔºö‰ªéAÊéßÂà∂Âô®pushÂà∞BÊéßÂà∂Âô®ÔºåBÊéßÂà∂Âô®Ê≠§Êó∂ÊâßË°å‰∏Ä‰∏™ÊñπÊ≥ïÔºö[self performSelector:@selector(printInfo) withObject:nil afterDelay:100];„ÄÇÊ≠§Êó∂‰ªéBÊéßÂà∂Âô®popÂà∞AÊéßÂà∂Âô®ÔºåÂæàÊòéÊòæBÊéßÂà∂Âô®Âπ∂Ê≤°ÊúâÈîÄÊØÅÔºåÂõ†‰∏∫RunloopËøòÔºàÈó¥Êé•ÔºâÂº∫ÂºïÁî®ÁùÄÂÆÉÔºåÂèØ‰ª•ÁêÜËß£‰∏∫Âá∫Áé∞‰∫ÜÂÜÖÂ≠òÊ≥ÑÈú≤(Â∞ΩÁÆ°100sÂêéprintInfoÊñπÊ≥ïÂæóÂà∞ÊâßË°åÔºåBÊéßÂà∂Âô®‰ºöÈîÄÊØÅ)„ÄÇ performSelectorÂÖ≥‰∫éÂÜÖÂ≠òÁÆ°ÁêÜÁöÑÊâßË°åÂéüÁêÜÊòØËøôÊ†∑ÁöÑÊâßË°å [self performSelector:@selector(method1:) withObject:self afterDelay:3]; ÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰ºöÂ∞ÜselfÁöÑÂºïÁî®ËÆ°Êï∞Âä†1ÔºåÊâßË°åÂÆåËøô‰∏™ÊñπÊ≥ïÊó∂ÔºåËøò‰ºöÂ∞ÜselfÁöÑÂºïÁî®ËÆ°Êï∞Âáè1ÔºåÂΩìÊñπÊ≥ïËøòÊ≤°ÊúâÊâßË°åÁöÑÊó∂ÂÄôÔºåË¶ÅËøîÂõûÁà∂ËßÜÂõæÈáäÊîæÂΩìÂâçËßÜÂõæÁöÑÊó∂ÂÄôÔºåselfÁöÑËÆ°Êï∞Ê≤°ÊúâÂáèÂ∞ëÂà∞0ÔºåËÄåÂØºËá¥Êó†Ê≥ïË∞ÉÁî®deallocÊñπÊ≥ïÔºåÂá∫Áé∞‰∫ÜÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ ÊØîËæÉÂ•ΩÁöÑÂÅöÊ≥ïÊòØÂèäÊó∂ÂèñÊ∂àÊéâ‰πãÂâçÁöÑÂª∂ËøüË∞ÉÁî®:cancelPreviousPerformRequestsWithTarget: selector:object:ÔºåÈÇ£‰πàcancelPreviousPerformRequestsWithTarget: selector:object:ÂÅö‰∫Ü‰ªÄ‰πàÂë¢? cancelPreviousPerformRequestsWithTarget: selector:object:[NSObject cancelPreviousPerformRequestsWithTarget:self];[NSObject cancelPreviousPerformRequestsWithTarget:self selector:NSSelectorFromString(@"printString:") object:@"str"]; Ëøô‰∏§‰∏™ÊñπÊ≥ïÂèØ‰ª•ÂèñÊ∂àperformÂª∂ËøüË∞ÉÁî®ÔºåÂÆÉ‰ª¨ÂÜÖÈÉ®ÂÅö‰∫Ü‰ªÄ‰πàÔºü + (void)cancelPreviousPerformRequestsWithTarget:(id)targe selector:(SEL)aSelector object:(id)arg &#123; NSMutableArray *perf = [[NSRunLoop currentRunLoop] _timedPerformers]; unsigned count = [perf count]; if (count &gt; 0) &#123; GSTimedPerformer *array[count]; IF_NO_GC(RETAIN(target)); IF_NO_GC(RETAIN(arg)); [perf getObjects: array]; while (count-- &gt; 0) &#123; // ÈÅçÂéÜÊü•Êâæ GSTimedPerformer *p = array[count]; if (p-&gt;target == target &amp;&amp; sel_isEqual(p-&gt;selector, aSelector) &amp;&amp; (p-&gt;argument == arg || [p-&gt;argument isEqual:arg])) &#123; // target\sel\argumentÂùá‰∏ÄËá¥ [p invalidate]; [perf removeObjectAtIndex: count]; &#125; &#125; RELEASE(arg); RELEASE(target); &#125;&#125; Ëé∑ÂèñRunloopÂÜÖÈÉ®ÊåÅÊúâÁöÑ_timedPerformersÊï∞ÁªÑ(Êï∞ÁªÑ‰∏≠ÁöÑÊòØGSTimedPerformerÂØπË±°)„ÄÇ ÂàõÂª∫‰∏Ä‰∏™CËØ≠Ë®ÄÊï∞ÁªÑÔºåÂπ∂Êää_timedPerformersÊï∞ÁªÑ‰∏≠ÁöÑÂÜÖÂÆπcopyÂà∞Ëøô‰∏™CËØ≠Ë®ÄÊï∞ÁªÑarray„ÄÇ ÈÅçÂéÜËØ•CËØ≠Ë®ÄÊï∞ÁªÑarrayÔºöÂ¶ÇÊûúÁªôÂÆöÂèÇÊï∞‰∏≠ÁöÑtarget„ÄÅargument„ÄÅselectorÂùá‰∏Ä‰∏ÄÂØπÂ∫îÔºåÈÇ£‰πàÈîÄÊØÅGSTimedPerformerÂØπË±°‰∏≠ÁöÑÂÆöÊó∂Âô®ÔºåÂπ∂Ê†πÊçÆÂΩìÂâçÁöÑÁ¥¢ÂºïÁßªÈô§_timedPerformersÊï∞ÁªÑÁöÑGSTimedPerformerÂØπË±°„ÄÇ Êç¢Âè•ËØùËØ¥ÔºåÂ¶ÇÊûútarget„ÄÅargument„ÄÅselector‰∏≠Êúâ‰∏Ä‰∏™ÂèÇÊï∞Ê≤°ÊúâÂØπÂ∫îÔºåÈÇ£‰πà‰æø‰∏ç‰ºöÊâßË°åÈîÄÊØÅÂÆöÊó∂Âô®Êìç‰ΩúÂíåÁßªÈô§Êìç‰Ωú„ÄÇÈÇ£‰πàÔºåÂà§ÂÆötarget„ÄÅargument„ÄÅselectorÂùá‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÊ†áÂáÜÊòØÔºöMatching of the argument may be either by pointer equality or by use of the [NSObject -isEqual:] method.Â∞±ÊòØÊåáÈíàÊØîËæÉ‰ª•ÂèäisEqualÊñπÊ≥ï„ÄÇ if(p-&gt;target == target &amp;&amp; sel_isEqual(p-&gt;selector, aSelector)&amp;&amp; (p-&gt;argument == arg || [p-&gt;argument isEqual:arg])) &#123;&#125; ÂÖ∂ÂÆûËøôÈáåÁöÑsel_isEqualÂ∞±Á≠â‰ª∑‰∫é==ÔºåÂ§öËØ¥‰∏ÄÂè•ÔºåSELÂÆûÈôÖ‰∏äÂ∞±ÊòØÊ†πÊçÆÊñπÊ≥ïÂêçhashÂåñ‰∫ÜÁöÑ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºàchar *ÔºâÔºåÂØπ‰∫éÂ≠óÁ¨¶‰∏≤ÁöÑÊØîËæÉÂè™Ë¶ÅÊØîËæÉÂú∞ÂùÄÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÂêåÁêÜÔºå+ (void)cancelPreviousPerformRequestsWithTarget:(id)targetÊñπÊ≥ïÂÆûÁé∞ÂéüÁêÜ‰∏é‰∏äÈù¢ÁöÑÊñπÊ≥ïÁ±ª‰ººÔºåÂè™ÊòØ‰∏çÁî®ÊØîËæÉargumentÂíåselectorÂèÇÊï∞ÔºåÊäätargetÊúâÂÖ≥ÁöÑÊâÄÊúâÂÆöÊó∂Âô®ÈÉΩÈîÄÊØÅÔºåÂπ∂ÊääÊâÄÊúâ‰∏é‰πãÁõ∏ÂÖ≥ÁöÑGSTimedPerformerÂØπË±°ÈÉΩ‰ªé_timedPerformersÊï∞ÁªÑ‰∏≠ÁßªÈô§„ÄÇwhile (count-- &gt; 0) &#123; GSTimedPerformer *p = array[count]; if (p-&gt;target == target) &#123; [p invalidate]; [perf removeObjectAtIndex:count]; &#125;&#125; ÂΩìÊâãÂä®ÈîÄÊØÅÂÆöÊó∂Âô®Âπ∂ÊääGSTimedPerformer‰ªéRunloop‰∏≠ÁßªÈô§Êó∂ÔºåÂÆöÊó∂Âô®ÂØπtargetÁöÑÂº∫ÂºïÁî®‰∏çÂ≠òÂú®ÔºõGSTimedPerformerÈîÄÊØÅÔºåGSTimedPerformerÂØπtargetÁöÑÂº∫ÂºïÁî®‰πü‰∏çÂ≠òÂú®ÔºåËøôÊ†∑ÔºåÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢òËß£ÂÜ≥‰∫Ü„ÄÇËøô‰πüÊòØ‰∏∫‰ªÄ‰πà‰ΩøÁî®cancelPreviousPerformRequestsWithTargetÂèñÊ∂àËøòÊ≤°ÊúâÊâßË°åÁöÑperformÂ∞±ÂèØ‰ª•Ëß£ÂÜ≥targetÊó†Ê≥ïÈáäÊîæÊéâÁöÑÂéüÂõ†„ÄÇ Ê®°Âºè performSelector:target:argument:order:modes:- (void)performSelector:(SEL)aSelector target:(id)target argument:(nullable id)arg order:(NSUInteger)order modes:(NSArray&lt;NSRunLoopMode&gt; *)modes;- (void)cancelPerformSelector:(SEL)aSelector target:(id)target argument:(nullable id)arg;- (void)cancelPerformSelectorsWithTarget:(id)target; ËøôÈáå‰∏ªË¶ÅÁúãperformSelector:target:argument:order:modes:ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇ Sets up sending of aSelector to target with argument. The selector is sent before the next runloop iteration (unless cancelled before then) in any of the specified modes.The target and argument objects are retained.The order value is used to determine the order in which messages are sent if multiple messages have been set up. Messages with a lower order value are sent first.If the modes array is empty, this method has no effect.ËØ¥ÁöÑÂæàÊòéÁôΩ‰∫ÜÔºåÂ∞±ÊòØÂú®ÊåáÂÆöÊ®°ÂºèÁöÑRunloop‰∏ã‰∏ÄÊ¨°Ëø≠‰ª£‰πãÂâçÊääselector„ÄÅargumentÁ≠â‰ø°ÊÅØ‰∏¢ÁªôtargetÔºå‰ª•‰æøË∞ÉÁî®„ÄÇËøôÈáåÁöÑorderÊåáÂÆö‰∫ÜËøô‰∏™Ë∞ÉÁî®ÁöÑ‰ºòÂÖàÁ∫ßÔºåÂÄºË∂äÂ∞èÔºåË∂äÊó©Ë¢´Ë∞ÉÁî®„ÄÇ - (void)performSelector:(SEL)aSelector target:(id)target argument:(id)argument order:(NSUInteger)order modes:(NSArray *)modes &#123; unsigned count = [modes count]; if (count &gt; 0) &#123; NSString *array[count]; GSRunLoopPerformer *item; item = [[GSRunLoopPerformer alloc] initWithSelector:aSelector target:target argument:argument order:order]; // Êäämodes‰∏≠ÁöÑÂÜÖÂÆπcopyÂà∞array if ([modes isProxy]) &#123; unsigned i; for (i = 0; i &lt; count; i++) &#123; array[i] = [modes objectAtIndex:i]; &#125; &#125; else &#123; [modes getObjects:array]; &#125; // ÈÅçÂéÜÊâÄÊúâmode while (count-- &gt; 0) &#123; NSString *mode = array[count]; unsigned end; unsigned i; GSRunLoopCtxt *context; GSIArray performers; context = NSMapGet(_contextMap, mode); if (context == nil) &#123; context = [[GSRunLoopCtxt alloc] initWithMode:mode extra:_extra]; NSMapInsert(_contextMap, context-&gt;mode, context); RELEASE(context); &#125; // Ëé∑ÂèñRunloopÊüê‰∏™mode‰∏ãÂØπÂ∫îÁöÑcontext‰∏≠ÁöÑperformers performers = context-&gt;performers; // performersÁöÑÊï∞Èáè end = GSIArrayCount(performers); for (i = 0; i &lt; end; i++) &#123; // ÈÅçÂéÜÊï¥‰∏™performersÊï∞ÁªÑ GSRunLoopPerformer *p; p = GSIArrayItemAtIndex(performers, i).obj; if (p-&gt;order &gt; order) &#123; // Êñ∞Ê∑ªÂä†ËøõÊù•ÁöÑitemÁöÑ‰ºòÂÖàÁ∫ßÈ´ò‰∫éÂΩìÂâçÁ¥¢ÂºïiÂØπÂ∫îitemÁöÑ‰ºòÂÖàÁ∫ß, ÊèíÂÖ• GSIArrayInsertItem(performers, (GSIArrayItem)((id)item), i); break; &#125; &#125; // Á¨¨‰∏ÄÁßçÂèØËÉΩ: iÂíåendÈÉΩ‰∏∫0, performersÊï∞ÁªÑ‰∏∫Á©∫, ‰∏äÈù¢ÁöÑforÂæ™ÁéØÊ≤°ÊúâÊâßË°å // Á¨¨‰∫åÁßçÂèØËÉΩ: Êñ∞Ê∑ªÂä†ËøõÊù•ÁöÑitemÁöÑ‰ºòÂÖàÁ∫ßÊúÄ‰Ωé, ‰∏äÈù¢ÁöÑforÂæ™ÁéØÊ≤°ÊúâÊâßË°å, ÊääÂÆÉÊ∑ªÂä†Âà∞Êï∞ÁªÑÁöÑÊúÄÂêé‰ΩçÁΩÆ if (i == end) &#123; GSIArrayInsertItem(performers, (GSIArrayItem)((id)item), i); &#125; i = GSIArrayCount(performers); if (i % 1000 == 0 &amp;&amp; i &gt; context-&gt;maxPerformers) &#123; // Êõ¥Êñ∞context‰∏≠ÁöÑperformerÊúÄÂ§ßÊï∞Èáè context-&gt;maxPerformers = i; NSLog(@"WARNING ... there are %u performers scheduled" @" in mode %@ of %@\n(Latest: [%@ %@])", i, mode, self, NSStringFromClass([target class]), NSStringFromSelector(aSelector)); &#125; &#125; RELEASE(item); &#125;&#125; Ê†πÊçÆÊñπÊ≥ïÂÆûÁé∞Êù•ÁúãÔºåËøô‰∏™ÊñπÊ≥ïÂÅö‰∫ÜËøô‰∫õ‰∫ã: Â¶ÇÊûúÊï∞ÁªÑmodes‰∏≠Ê≤°ÊúâÂÜÖÂÆπÂ∞±Áõ¥Êé•return„ÄÇ Êäätarget„ÄÅargument„ÄÅselector„ÄÅorderÁ≠â‰ø°ÊÅØÂåÖË£ÖÊàê‰∏Ä‰∏™GSRunLoopPerformerÂØπË±°„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑarrayÔºåÊäämodes‰∏≠ÁöÑÂÜÖÂÆπcopyÂà∞array„ÄÇ ÈÅçÂéÜarray„ÄÇÊâæÂà∞ÊØè‰∏ÄÁßçmode(NSStringÁ±ªÂûã)Âú®_contextMap(NSMapTableÁ±ªÂûã)Ë°®‰∏≠ÂØπÂ∫îÁöÑcontext(GSRunLoopCtxtÁ±ªÂûã)ÔºåËé∑Âæócontext‰∏≠ÈúÄË¶ÅÊâßË°åÁöÑperformers(GSIArrayÁ±ªÂûã)Êï∞ÁªÑ„ÄÇ ÈÅçÂéÜÂéüÊù•ÁöÑperformersÊï∞ÁªÑÔºåÊ†πÊçÆÁ¨¨2Ê≠•‰∏≠ÂåÖË£ÖÂ•ΩÁöÑGSRunLoopPerformerÂØπË±°ÁöÑ‰ºòÂÖàÁ∫ßorderÔºåÊèíÂÖ•Âà∞performers‰∏≠ÁöÑÂêàÈÄÇ‰ΩçÁΩÆ„ÄÇ ÊÄªËÄåË®Ä‰πãÔºåÂ∞±ÊòØÊäätarget„ÄÅargument„ÄÅselector„ÄÅorderÁ≠â‰ø°ÊÅØÂåÖË£ÖÊàê‰∏Ä‰∏™GSRunLoopPerformerÂØπË±°ÔºåÂπ∂ÊääËØ•ÂØπË±°Ê∑ªÂä†Âà∞RunloopÔºà‰∏≠ÁöÑ_contextMapÔºâÈáåÈù¢ÁöÑperformersÔºå‰æõÂÖ∂Âú®ÂêàÈÄÇÁöÑÊó∂Êú∫Ë∞ÉÁî®„ÄÇÂÖ∑‰ΩìÂï•Êó∂ÂÄôË∞ÉÁî®Âë¢ÔºüÂÆòÊñπÊñáÊ°£ËØ¥ÊòØRunloopÁöÑ‰∏ã‰∏ÄÊ¨°Ëø≠‰ª£ÁöÑÊó∂ÂÄô„ÄÇ Ëá™‰∏çÂøÖËØ¥ÔºåcancelPerformSelector:target:argument:Â∞±ÊòØÊ†πÊçÆselector„ÄÅtargetÂíåargumentÁßªÈô§performersÊï∞ÁªÑ‰∏≠ÁöÑGSRunLoopPerformer„ÄÇË¶ÅÊ±Ç‰∏âËÄÖÂÆåÂÖ®ÂØπÂ∫î„ÄÇcancelPerformSelector:target:ÊòØÊ†πÊçÆselector„ÄÅtargetÁßªÈô§performersÊï∞ÁªÑ‰∏≠Áõ∏ÂÖ≥ÁöÑÊâÄÊúâÁöÑGSRunLoopPerformerÂØπË±°„ÄÇÂéüÁêÜ‰∏é‰∏äÊñá‰∏≠ÊâÄËØ¥ÁöÑcancelPreviousPerformRequestsWithTarget:Âü∫Êú¨‰∏ÄËá¥„ÄÇ Á∫øÁ®ãperformSelector:onThread:withObject:waitUntilDone:modes:- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(nullable id)arg waitUntilDone:(BOOL)wait modes:(nullable NSArray&lt;NSString *&gt; *)array;// equivalent to the first method with kCFRunLoopCommonModes- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(nullable id)arg waitUntilDone:(BOOL)wait;- (void)performSelector:(SEL)aSelector onThread:(NSThread *)thr withObject:(nullable id)arg waitUntilDone:(BOOL)wait modes:(nullable NSArray&lt;NSString *&gt; *)array;// equivalent to the first method with kCFRunLoopCommonModes- (void)performSelector:(SEL)aSelector onThread:(NSThread *)thr withObject:(nullable id)arg waitUntilDone:(BOOL)wait;- (void)performSelectorInBackground:(SEL)aSelector withObject:(nullable id)arg; Á¨¨‰∫å‰∏™ÊñπÊ≥ï‰∏éÁ¨¨‰∏Ä‰∏™ÊñπÊ≥ïÂØπÂ∫îÔºåÂÖ∂modesÊòØkCFRunLoopCommonModesÔºåselectorÂú®‰∏ªÁ∫øÁ®ãÊâßË°å„ÄÇÁ¨¨Âõõ‰∏™ÊñπÊ≥ï‰∏éÁ¨¨‰∏â‰∏™ÊñπÊ≥ïÂØπÂ∫îÔºåÂÖ∂modesÊòØkCFRunLoopCommonModesÔºåselectorÂú®ÊåáÂÆöÁöÑÂ≠êÁ∫øÁ®ãÊâßË°å„ÄÇÁ¨¨‰∫î‰∏™ÊñπÊ≥ïÁúÅÁï•ÂæàÂ§öÂèÇÊï∞ÔºåselectorÂú®ÂÜÖÁΩÆÁöÑÂ≠êÁ∫øÁ®ãÊâßË°å„ÄÇ ÂÖàÂàÜÊûêÁ¨¨Âõõ‰∏™ÊñπÊ≥ïÂç≥ÂèØ„ÄÇÂÖ∑‰ΩìÁöÑÂÆûÁé∞Â¶Ç‰∏ãÊâÄÁ§∫: - (void)performSelector:(SEL)aSelector onThread:(NSThread *)aThread withObject:(id)anObject waitUntilDone:(BOOL)aFlag modes:(NSArray*)anArray &#123; GSRunLoopThreadInfo *info; NSThread *t; if ([anArray count] == 0) return; t = GSCurrentThread(); if (aThread == nil) aThread = t; info = GSRunLoopInfoForThread(aThread); if (t == aThread) &#123; // Perform in current thread. if (aFlag == YES || info-&gt;loop == nil) &#123; // Wait until done or no run loop. [self performSelector:aSelector withObject:anObject]; &#125; else &#123; // Don't wait ... schedule operation in run loop. [info-&gt;loop performSelector:aSelector target:self argument:anObject order:0 modes:anArray]; &#125; &#125; else &#123; GSPerformHolder *h; NSConditionLock *l = nil; // Á∫øÁ®ãFinishedÂà§Êñ≠ if ([aThread isFinished] == YES) &#123; [NSException raise: NSInternalInconsistencyException format: @"perform on finished thread"]; &#125; // ÈòªÂ°ûÁ≠âÂæÖÂä†ÈîÅ if (aFlag == YES) &#123; l = [[NSConditionLock alloc] init]; &#125; h = [GSPerformHolder newForReceiver:self argument:anObject selector:aSelector modes:anArray lock:l]; [info addPerformer:h]; // Êù°‰ª∂ÈîÅÂàõÂª∫ÊàêÂäü(‰πüÂç≥ÂèÇÊï∞aFlag‰∏∫YES) if (l != nil) &#123; [l lockWhenCondition:1]; // ÂΩìÊù°‰ª∂‰∏∫1Êó∂Âä†ÈîÅ [l unlock]; RELEASE(l); // holderÂ∑≤ÁªèÂ§±ÊïàÂàôÊäõÂá∫ÂºÇÂ∏∏ if ([h isInvalidated] == YES) &#123; RELEASE(h); [NSException raise: NSInternalInconsistencyException format: @"perform on finished thread"]; &#125; // holderËá™Ë∫´Â∞±‰∫ßÁîüexception‰∫Ü, ÈÇ£‰πàÂÜçÊ¨°ÊäõÂá∫ÂºÇÂ∏∏ // If we have an exception passed back from the remote thread, re-raise it. if (nil != h-&gt;exception) &#123; NSException *e = AUTORELEASE(RETAIN(h-&gt;exception)); RELEASE(h); [e raise]; &#125; &#125; RELEASE(h); &#125;&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏ªË¶ÅÂÅö‰∫ÜËøô‰∫õ‰ªÄ‰πà? È¶ñÂÖàÂØπ‰º†ËøõÊù•ÁöÑmodes(RunloopÊ®°ÂºèÊï∞ÁªÑ)‰∏™Êï∞ËøõË°åÂà§Êñ≠ÔºåÂ¶ÇÊûú‰∏∫0ÔºåÂàôÁõ¥Êé•return„ÄÇ Ëé∑ÂèñËØ•ÊñπÊ≥ïÊâßË°å‰∏ä‰∏ãÊñá‰∏≠ÁöÑÁ∫øÁ®ãÔºö tÔºåÂπ∂ÊääÂÆÉ‰∏é‰Ωú‰∏∫ÂèÇÊï∞‰º†ËøõÊù•ÁöÑÁ∫øÁ®ãaThreadËøõË°åÊØîËæÉÔºåÁúãÊòØÂê¶‰∏ÄËá¥„ÄÇÂΩìÁÑ∂ÔºåÂ¶ÇÊûú‰º†ËøõÊù•ÁöÑaThread‰∏∫Á©∫ÔºåÈÇ£‰πàÊâßË°åaThread = t;ÔºåÂ∞±ËÆ©selectorÂú®ÂΩìÂâç‰∏ä‰∏ãÊñá‰∏≠ÁöÑÁ∫øÁ®ã‰∏≠ÊâßË°å„ÄÇ ÂΩì‰∏§‰∏™Á∫øÁ®ã‰∏ÄËá¥Êó∂ÔºåÂ¶ÇÊûúÂèÇÊï∞aFlag‰∏∫YESÊàñËÄÖÁ∫øÁ®ãÂØπÂ∫îÁöÑRunloop‰∏∫Á©∫ÔºåËØ¥ÊòéÈúÄË¶ÅÁ≠âÂæÖÔºå‰πüÂç≥Ëøô‰∏™ÊñπÊ≥ïÂ∫îËØ•Á≠âÂà∞selectorË¢´ÊâßË°åÂÆåÊØïÂêéÂÜçreturn„ÄÇËøôÂ∞±Â•ΩÂäû‰∫ÜÔºåÁõ¥Êé•Ë∞ÉÁî®[self performSelector: aSelector withObject: anObject];ÊñπÊ≥ïÔºåÂêåÊ≠•ÊâßË°åÂç≥ÂèØ„ÄÇÂ¶ÇÊûú‰∏çÈúÄË¶ÅÁ≠âÂæÖÂë¢? Êääselector„ÄÅargument„ÄÅmodesÁ≠â‰ø°ÊÅØ‰∫§ÁªôÁ∫øÁ®ãÂØπÂ∫îÁöÑRunloopÂÜçËøõ‰∏ÄÊ≠•Â§ÑÁêÜÔºàschedule operation in run loopÔºâ„ÄÇ ÂΩì‰∏§‰∏™Á∫øÁ®ã‰∏ç‰∏ÄËá¥Êó∂ÔºåÈ¶ñÂÖàÂà§Êñ≠aThreadÊúâÊ≤°ÊúâfinishedÔºåÁ∫øÁ®ãÊ≠ª‰∫ÜËá™ÁÑ∂selectorÊó†Ê≥ïÊâßË°åÔºåÊäõÂá∫ÂºÇÂ∏∏„ÄÇÂÜçËÄÖÂà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÈòªÂ°ûÁ≠âÂæÖÔºåÂ¶ÇÊûúÈúÄË¶ÅÁöÑËØùÂ∞±ÂàõÂª∫‰∏Ä‰∏™Êù°‰ª∂ÈîÅ„ÄÇÊé•ÁùÄÊääselector„ÄÅargument„ÄÅmodesÂèäÊù°‰ª∂ÈîÅÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàê‰∏Ä‰∏™GSPerformHolderÂØπË±°ÔºåÂπ∂ÊääÂÆÉ‰∫§ÁªôÂ∞ÅË£ÖÁ∫øÁ®ã‰ø°ÊÅØÁöÑGSRunLoopThreadInfoÂØπË±°„ÄÇ‰πãÂêéÊòØ‰∏Ä‰∫õÊî∂Â∞æÂ∑•‰ΩúÔºöËÆæÁΩÆÊù°‰ª∂ÈîÅÁöÑconditionÂèä‰∏Ä‰∫õÂºÇÂ∏∏Âà§Êñ≠„ÄÇ ÈúÄË¶ÅÁùÄÈáçËØ¥ÊòéÁöÑÊòØÂèÇÊï∞aFlagÔºö ÊòØÂê¶Á´ãÂç≥ËøîÂõû„ÄÇÂ¶ÇÊûúÂèÇÊï∞aFlag‰∏∫YESÔºåÂàôËøô‰∏™ÊñπÊ≥ïÂ∫îËØ•Á≠âÂà∞selectorË¢´ÊâßË°åÂÆåÊØïÂêéÂÜçreturn„ÄÇÂ¶ÇÊûúselectorÊòØÂú®ÂΩìÂâçÊñπÊ≥ï‰∏ä‰∏ãÊñáÁöÑÁ∫øÁ®ã‰∏≠ÊâßË°åÔºå‰∏îËØ•Á∫øÁ®ãÂØπÂ∫îÁöÑRunloopÊ≤°ÊúârunÔºåÈÇ£‰πà‰ºöÂøΩÁï•modesÔºåÁõ¥Êé•ÊâßË°åÔºöperformSelector:aSelector withObject:„ÄÇ ÂΩì‰∏§‰∏™Á∫øÁ®ã‰∏ÄËá¥Êó∂Ôºå‰πüÂç≥selectorÊâßË°åÁöÑÁ∫øÁ®ãÂ∞±ÊòØÂΩìÂâçÊñπÊ≥ï‰∏ä‰∏ãÊñá‰∏≠ÁöÑÁ∫øÁ®ãÔºåËøôÊØîËæÉÂ•ΩÂ§ÑÁêÜÔºåÊääselector„ÄÅargument„ÄÅmodesÁ≠â‰ø°ÊÅØ‰∫§ÁªôÁ∫øÁ®ãÂØπÂ∫îÁöÑRunloopÂç≥ÂèØÔºåÂ∞±ÊòØÊ®°Âºè‰∏≠ÁöÑÊñπÊ≥ïÔºöperformSelector:target:argument:order:modes:„ÄÇ GSPerformHolder ‰∏§‰∏™Á∫øÁ®ã‰∏ç‰∏ÄËá¥Êó∂Ôºå‚ÄúÊääselector„ÄÅargument„ÄÅmodesÂèäÊù°‰ª∂ÈîÅÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàê‰∏Ä‰∏™GSPerformHolderÂØπË±°ÔºåÂπ∂ÊääÂÆÉ‰∫§ÁªôÂ∞ÅË£ÖÁ∫øÁ®ã‰ø°ÊÅØÁöÑGSRunLoopThreadInfoÂØπË±°‚ÄùÂèàÊòØÊÄé‰πàÂÅöÁöÑÂë¢? (GSPerformHolder *)h = [GSPerformHolder newForReceiver:self argument:anObject selector:aSelector modes:anArray lock:l];[(GSRunLoopThreadInfo *)info addPerformer:h]; newForReceiver:argument:selector:modes:lock: Ëøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÂÅö‰∏Ä‰∫õ‰ø°ÊÅØÂ∞ÅË£ÖÔºåÊó†ÈúÄÂ§öË®Ä„ÄÇ‰∏ªË¶ÅÊòØËøô‰∏™addPerformerÔºåÂà†Èô§#if defined(_WIN32)ÁöÑ‰ª£Á†ÅÂêéÂÖ∑‰ΩìÂÆûÁé∞Â¶Ç‰∏ã: - (void)addPerformer:(id)performer &#123; BOOL signalled = NO; // NSLockÂä†ÈîÅ [lock lock]; NSTimeInterval start = 0.0; // ‰ΩøÁî®writeÂáΩÊï∞Âêë outputFd ‰∏≠ÂÜôÂÖ• 1 Â≠óËäÇÊï∞ÊçÆÔºåÊï∞ÊçÆ‰∏∫: "0"„ÄÇ while (outputFd &gt;= 0 &amp;&amp; NO == (signalled = (write(outputFd, "0", 1) == 1) ? YES : NO)) &#123; NSTimeInterval now = [NSDate timeIntervalSinceReferenceDate]; if (0.0 == start) &#123; start = now; &#125; else if (now - start &gt;= 1.0) &#123; NSLog(@"Unable to signal %@ within a second; blocked?", self); break; &#125; [lock unlock]; [lock lock]; &#125; // ÂÜôÂÖ•Êï∞ÊçÆÊàêÂäüÔºåÊääperformerÊ∑ªÂä†Âà∞GSRunLoopThreadInfoÊï∞ÁªÑ‰∏≠ if (signalled) [performers addObject: performer]; // NSLockËß£ÈîÅ [lock unlock]; // ÂÜôÂÖ•Êï∞ÊçÆÂ§±Ë¥•ÔºåÈîÄÊØÅperformer if (!signalled) [performer invalidate];&#125; Ë°•ÂÖÖwriteÂáΩÊï∞Áü•ËØÜÁÇπ: /* * writeÂáΩÊï∞ * ssize_t write(int __fd, const void * __buf, size_t __nbyte) __DARWIN_ALIAS_C(write); * write ÂáΩÊï∞Âêë __fd ‰∏≠ÂÜôÂÖ• __nbyte Â≠óËäÇÊï∞ÊçÆÔºåÊï∞ÊçÆÊù•Ê∫ê‰∏∫ __buf „ÄÇËøîÂõûÂÄº‰∏ÄËà¨ÊÄªÊòØÁ≠â‰∫é __nbyte * ËøîÂõûÂÄºÂ¶ÇÊûú‰∏çÊòØÁ≠â‰∫é__nbyteÔºåÂ∞±ÊòØÂá∫Èîô‰∫Ü„ÄÇÂ∏∏ËßÅÁöÑÂá∫ÈîôÂéüÂõ†ÊòØÁ£ÅÁõòÁ©∫Èó¥Êª°‰∫ÜÊàñËÄÖË∂ÖËøá‰∫ÜÊñá‰ª∂Â§ßÂ∞èÈôêÂà∂„ÄÇ *//* The write could concievably fail if the pipe is full. * In that case we need to release the lock temporarily to allow the other * thread to consume data from the pipe. It's possible that the thread * and its runloop might stop during that ... so we need to check that * outputFd is still valid. */ ‰∏çÊòØÂçÅÂàÜÁêÜËß£writeÂáΩÊï∞Âú®ËøôÈáåÁöÑ‰ΩúÁî®ÔºåÊ†πÊçÆ‰∏Ä‰∫õÂºÇÂ∏∏‰ø°ÊÅØ&quot;Failed to set non block flag for perform in thread&quot; &quot;Failed to create event to handle perform in thread&quot;ÔºåÂèØËÉΩÊòØÂêëÊñá‰ª∂‰∏≠ÂÜôÂÖ•‰∏Ä‰∫õflagË°®Á§∫Á∫øÁ®ãÊåáÂÆö‰∫ã‰ª∂ÂØπË±°ÁöÑ‰ø°Âè∑Áä∂ÊÄÅÂêß„ÄÇ Â¶ÇÊûú‰ø°Âè∑Áä∂ÊÄÅËÆæÁΩÆÊàêÂäüÔºåÂ∞±ÊääËøô‰∏™performÂØπË±°(GSPerformHolderÁ±ªÂûã)Ê∑ªÂä†Âà∞GSRunLoopThreadInfoÁöÑperformersÊï∞ÁªÑ‰∏≠„ÄÇ Ëøô‰∏™GSRunLoopThreadInfoÂØπË±°ÊääGSPerformHolderÂØπË±°Ê∑ªÂä†Âà∞Ëá™Â∑±Êï∞ÁªÑ‰∏≠ÂêéÔºåÂÖ∑‰ΩìÊúÄÂéüÂÖàÁöÑperform‰ªÄ‰πàÊó∂ÂÄôÊâßË°åÂë¢? ÊòØÂú®Ë∞ÉÁî®GSRunLoopThreadInfoÂØπË±°ÁöÑfireÊñπÊ≥ïÊó∂ÈÄê‰∏™ÊâßË°åÔºö GSRunLoopThreadInfoÂØπË±°ÁöÑfireÊñπÊ≥ïÈÉ®ÂàÜÂÆûÁé∞: for (i = 0; i &lt; c; i++) &#123; GSPerformHolder *h = [toDo objectAtIndex:i]; [loop performSelector:@selector(fire) target:h argument:nil order:0 modes:[h modes]];&#125; ÂèØËßÅÊòØÈÄê‰∏™ÂèñÂá∫Êï∞ÁªÑ‰∏≠ÁöÑGSPerformHolderÂØπË±°Ôºå‰∏Ä‰∏™Êé•‰∏Ä‰∏™Âú∞Ë∞ÉÁî®GSPerformHolderÁöÑfireÊñπÊ≥ïÔºåËøô‰πüÊòØ‰∏™fireÊñπÊ≥ïÔºåÂÆÉÂÜÖÈÉ®ÂÅö‰∫Ü‰ªÄ‰πàÔºüÂ∞±ÊòØ[receiver performSelector: selector withObject: argument];„ÄÇ Êçã‰∏ÄÊçã: ‰∏§‰∏™Á∫øÁ®ã‰∏ç‰∏ÄËá¥Êó∂ÔºåÊääselector„ÄÅargument„ÄÅmodesÂèäÊù°‰ª∂ÈîÅÁ≠â‰ø°ÊÅØÂ∞ÅË£ÖÊàê‰∏Ä‰∏™GSPerformHolderÂØπË±°ÔºåÂπ∂ÊääÂÆÉÊ∑ªÂä†Âà∞GSRunLoopThreadInfoÂØπË±°ÁöÑperformersÊï∞ÁªÑ‰∏≠„ÄÇÂΩìË∞ÉÁî®GSRunLoopThreadInfoÂØπË±°ÁöÑfairÊñπÊ≥ïÊó∂‰ºöÈÅçÂéÜperformersÊï∞ÁªÑÔºåÁÑ∂ÂêéÈÄê‰∏™Ë∞ÉÁî®Êï∞ÁªÑ‰∏≠ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑfairÊñπÊ≥ïÔºåËÄåËøô‰∏™fairÊñπÊ≥ïÂÜÖÈÉ®Â∞±ÊòØË∞ÉÁî®performSelector:withObjectÊñπÊ≥ï„ÄÇ ÊúÄÊúÄÂÖ≥ÈîÆÁöÑ‰∏Ä‰∏™ÈóÆÈ¢ò: ‰ªÄ‰πàÊó∂ÂÄôË∞ÉÁî®GSRunLoopThreadInfoÂØπË±°ÁöÑfairÊñπÊ≥ï? ÂÆòÊñπÊñáÊ°£ËØ¥: May only be called from the runloop when the event/descriptor is triggered. ÊàëÂú®RunloopÁöÑ+(BOOL)awakenedBefore:Âíå -(BOOL)pollUntil:within:ÊñπÊ≥ï‰∏≠ÊâæÂà∞‰∫ÜË∞ÉÁî®ÁóïËøπ„ÄÇ ‰ªªÊÑèÁ∫øÁ®ãË∞ÉÁî®- (void)performSelector:(SEL)aSelector onThread:(NSThread*)aThread withObject:(id)anObject waitUntilDone:(BOOL)aFlag &#123; [self performSelector:aSelector onThread:aThread withObject:anObject waitUntilDone:aFlag modes:commonModes()];&#125; RunloopÁöÑ‰∫îÁßçmodeÂàÜÂà´ÊòØ:NSDefaultRunLoopModeÔºåNSConnectionReplyModeÔºåNSModalPanelRunLoopModeÔºåNSEventTrackingRunLoopModeÔºåNSRunLoopCommonModes„ÄÇËøô‰∏™ÊñπÊ≥ïÁúÅÁï•‰∫ÜmodesÂèÇÊï∞ÔºåÂÜÖÈÉ®‰ΩøÁî®common modeÔºå‰πüÂç≥NSDefaultRunLoopModeÂíåNSConnectionReplyMode(‰∏çÊòØNSEventTrackingRunLoopMode)„ÄÇÊâÄ‰ª•Â¶ÇÊûúÊúâÈº†Ê†áÊàñËÄÖÊâãÂäø‰∫ã‰ª∂ÈúÄË¶ÅÂ§ÑÁêÜÔºåÁúÅÁï•modesÂèÇÊï∞ÂèØËÉΩ‰∏çÊòØ‰∏™Â•ΩÂÅöÊ≥ï„ÄÇ ‰∏ªÁ∫øÁ®ãË∞ÉÁî®- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(id)anObject waitUntilDone:(BOOL)aFlag modes:(NSArray*)anArray &#123; if (defaultThread == nil) defaultThread = [NSThread mainThread]; [self performSelector:aSelector onThread:defaultThread withObject:anObject waitUntilDone:aFlag modes:anArray];&#125; Ëøô‰∏™ÊñπÊ≥ïÊåáÂÆö‰∫Ü‰∏ªÁ∫øÁ®ã„ÄÇ - (void)performSelectorOnMainThread:(SEL)aSelector withObject:(id)anObject waitUntilDone:(BOOL)aFlag &#123; [self performSelectorOnMainThread:aSelector withObject:anObject waitUntilDone:aFlag modes:commonModes()];&#125; Ëøô‰∏§‰∏™ÊñπÊ≥ïÊåáÂÆö‰∫Ü‰∏ªÁ∫øÁ®ãÔºåÂÜÖÈÉ®‰ΩøÁî®common mode„ÄÇ BackgroundË∞ÉÁî®- (void)performSelectorInBackground:(SEL)aSelector withObject:(id)anObject &#123; [NSThread detachNewThreadSelector:aSelector toTarget:self withObject:anObject];&#125; Ëøô‰∏™ÊñπÊ≥ï‰ºöÂàõÂª∫‰∏ÄÊù°‰ªªÊÑèÁöÑÁ∫øÁ®ãÊâßË°åselectorÊñπÊ≥ï„ÄÇ Q&amp;AprintInfoÊñπÊ≥ï‰ºöÊâßË°åÂêóGCDË∞ÉÁî®dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; [self performSelector:@selector(printInfo) withObject:nil afterDelay:1];&#125;); ÂæàÊòéÊòæÊòØ‰∏ç‰ºöÁöÑ„ÄÇÂõ†‰∏∫performSelectorÂÖ∑‰ΩìÂÆûÁé∞‰∏≠Âπ∂Ê≤°Êúâ‰∏ªÂä®Ëß¶ÂèëÁ∫øÁ®ãÂØπÂ∫îRunloopËøêË°å„ÄÇÂ≠êÁ∫øÁ®ãÂØπÂ∫îÁöÑRunloopÊ≤°Êúârun„ÄÇÊÄé‰πàËÆ©ÂÆÉÊâßË°åÔºüÂêØÂä®Runloop: dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; [self performSelector:@selector(printInfo) withObject:nil afterDelay:1]; [[NSRunLoop currentRunLoop] run];&#125;); NSThreadË∞ÉÁî®NSThread *thread = [[NSThread alloc] initWithBlock:^&#123; [self performSelector:@selector(printInfo) withObject:nil afterDelay:1];&#125;];[thread start]; ÂêåÁêÜ: NSThread *thread = [[NSThread alloc] initWithBlock:^&#123; [self performSelector:@selector(printInfo) withObject:nil afterDelay:1]; [[NSRunLoop currentRunLoop] run];&#125;];[thread start]; ËøôÂ∞±Êúâ‰∏Ä‰∏™ÈóÆÈ¢ò‰∫Ü„ÄÇÂú®GCD‰∏≠[[NSRunLoop currentRunLoop] run];ÊîæÂú®performSelectorÂâçÈù¢ÊàñËÄÖÂêéÈù¢Ë≤å‰ººÈÉΩÊòØÂèØ‰ª•ÁöÑÔºå‰ΩÜÊòØÂú®NSThread‰∏≠[[NSRunLoop currentRunLoop] run];Âè™ËÉΩÊîæÂú®performSelectorÁöÑÂêéÈù¢„ÄÇ Âú®NSThreadÊñπÊ≥ï‰∏≠: Âõ†‰∏∫runÊñπÊ≥ïÂè™ÊòØÂ∞ùËØïÊÉ≥Ë¶ÅÂºÄÂêØÂΩìÂâçÁ∫øÁ®ã‰∏≠ÁöÑrunloopÔºå‰ΩÜÊòØÂ¶ÇÊûúËØ•Á∫øÁ®ã‰∏≠Âπ∂Ê≤°Êúâ‰ªª‰Ωï‰∫ã‰ª∂(source„ÄÅtimer„ÄÅobserver)ÁöÑËØùÔºåÂπ∂‰∏ç‰ºöÊàêÂäüÁöÑÂºÄÂêØ„ÄÇ ‰∏∫‰ªÄ‰πàGCD‰∏≠Âç≥‰Ωø[[NSRunLoop currentRunLoop] run];ÊîæÂú®ÂâçÈù¢printInfoÊñπÊ≥ïËøòÊòØË∞ÉÁî®‰∫ÜÂë¢? ‰ª£Á†ÅÂÆûÈôÖÊµãËØïÔºåÂª∂ËøüÊïàÊûúÊ≤°Êúâ‰∫ÜÔºåÂπ∂‰∏îÊúâÊó∂ÊñπÊ≥ïÊâßË°åÔºåÊúâÊó∂ÊñπÊ≥ïÊ≤°ÊúâÊâßË°å„ÄÇ Áªº‰∏äÔºåÂú®Â≠êÁ∫øÁ®ã‰∏≠‰ΩøÁî®performSelectorÁöÑÂª∂ËøüÊñπÊ≥ïÔºåÈúÄË¶ÅÂä†‰∏ä[[NSRunLoop currentRunLoop] run];‰ΩøÂæóRunloopËÉΩÂ§üËøêË°åÔºåÂπ∂‰∏îËØ•ÊñπÊ≥ïË¶ÅÊîæÂú®performSelectorÁöÑÂêéÈù¢Êù•‰øùËØÅRunloopÊàêÂäüËøêË°å„ÄÇ NSThreadÊó†ÊïàNSThread *thread = [[NSThread alloc] initWithBlock:^&#123;&#125;];[thread start];[self performSelector:@selector(printMainInfo) onThread:thread withObject:nil waitUntilDone:NO]; ‰∏äÈù¢ËøôÊÆµ‰ª£Á†Å‰∏∫‰ªÄ‰πàÊ≤°ÊúâÊâßË°åprintMainInfoÊñπÊ≥ï? Â≠êÁ∫øÁ®ãÊâßË°åÂÆåÊìç‰Ωú‰πãÂêéÂ∞±‰ºöÁ´ãÂç≥ÈáäÊîæÔºåÂç≥‰ΩøÊàë‰ª¨‰ΩøÁî®Âº∫ÂºïÁî®ÂºïÁî®Â≠êÁ∫øÁ®ã‰ΩøÂ≠êÁ∫øÁ®ã‰∏çË¢´ÈáäÊîæÔºå‰πü‰∏çËÉΩÁªôÂ≠êÁ∫øÁ®ãÂÜçÊ¨°Ê∑ªÂä†Êìç‰ΩúÔºåÊàñËÄÖÂÜçÊ¨°ÂºÄÂêØ„ÄÇËøôÈáåÂèØ‰ª•‰ΩøÁî®Runloop„ÄÇÂ≠êÁ∫øÁ®ãËé∑ÂèñÂÖ∂ÂØπÂ∫îÁöÑRunloopÂØπË±°Âπ∂‰Ωø‰πãËøêË°å„ÄÇ‰∏ÄËà¨‰ΩøÁî®Â∏∏È©ªÂ≠êÁ∫øÁ®ã„ÄÇ Ê≠£Á°ÆÂÆûË∑µÔºöNSThread *thread = [[NSThread alloc] initWithBlock:^&#123; // ÊâßË°å‰∏ÄÊ¨°ËÄåÂ∑≤ NSRunLoop *currentRunLoop = [NSRunLoop currentRunLoop]; [currentRunLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]];&#125;];[thread start];[self performSelector:@selector(printMainInfo) onThread:thread withObject:nil waitUntilDone:NO]; Â∞èÁªìÊ¢≥ÁêÜÊú¨ÊñáÔºåÊØîËæÉÈáçË¶ÅÁöÑÂá†‰∏™Â∞èÁÇπÂ¶Ç‰∏ãÔºö performSelectorÂÜÖÈÉ®ÁöÑÂÆûÁé∞Â∞±ÊòØ‰ΩøÁî®IMPÁõ¥Êé•Ë∞ÉÁî®ÂØπË±°ÁöÑÊñπÊ≥ï„ÄÇ ‰∏•Ê†ºÈÅµÂÆàARCËßÑÂàôÔºåÊ≥®ÊÑèÊñπÊ≥ïÁöÑÂëΩÂêçÔºå‰∏çÁÑ∂‰ºö‰∏∫ÂÜÖÂ≠òÊ≥ÑÊºèÂüã‰∏ã‰ºèÁ¨î„ÄÇ ÂèçÂ∞ÑNSSelectorFromString()ÂæàÂº∫Â§ßÔºå‰ΩÜÊòØ‰ΩøÁî®@selector()ÊòæÂºèÂëäËØâÁºñËØëÂô®Â∞ÜË¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØÊõ¥‰ºòÁöÑÈÄâÊã©„ÄÇ performSelectorËÉΩÂÆûÁé∞Âª∂ËøüÊòØÂõ†‰∏∫ÂÆöÊó∂Âô®ÔºåË¶ÅÂèäÊó∂ÂèñÊ∂àÊó†Ê≥ïÊâßË°åÁöÑÂª∂ËøüÊñπÊ≥ï„ÄÇ Â≠êÁ∫øÁ®ã‰∏≠‰ΩøÁî®Âª∂ËøüÊñπÊ≥ïÔºåÈúÄË¶ÅÊâãÂä®‰ΩøÂæóRunloopËÉΩÂ§üËøêË°å„ÄÇ NSTimerÂú®ÂÖ∂invalidateÊñπÊ≥ïË∞ÉÁî®ÂêéÔºåRunloop‰ºöËá™Âä®ÁßªÈô§ÂØπÂÆÉÁöÑÂºïÁî®„ÄÇ ÂèÇËÄÉËµÑÊñôAdvanced Memory Management Programming GuideObjective-C‰πãperformSelectorÁºñËØëÂô®ÂÜÖÂ≠òÊ≥ÑÈú≤Ë≠¶ÂëäÁî®performSelectorÁöÑÊó∂ÂÄôË¶ÅÊ≥®ÊÑèÂà´ÂÜÖÂ≠òÊ≥ÑÈú≤‰∫ÜPerformSelector May Cause a LeakperformSelector Ê≥®ÊÑèÈóÆÈ¢òÂèäÂéüÁêÜc/c++ read ÂáΩÊï∞Âíå write ÂáΩÊï∞]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RuntimeÂü∫Á°Ä]]></title>
    <url>%2F2018%2F07%2F10%2FRuntime%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[2018.8.26 Êõ¥Êñ∞ClassÂÆö‰πâ2019.3.25 Êõ¥Êñ∞ËÆæÁΩÆweakÂÖ≥ËÅîÂ±ûÊÄß ÂÖ≥‰∫éRuntimeÁöÑÁÆÄÂçïÊÄªÁªì„ÄÇ ‰ª£Á†Å‰∏≠ÁúÅÁï•OBJC2_UNAVAILABLE,‰πüÂç≥‰∏çÂèØÁõ¥Êé•ËÆøÈóÆÁªìÊûÑ‰Ωì‰∏≠ÁöÑÊàêÂëò. ‰∏Ä„ÄÅRuntimeClassObjective-C2.0‰πãÂâçClassÁöÑÂÆö‰πâstruct objc_class &#123; Class isa OBJC_ISA_AVAILABILITY;#if !__OBJC2__ // Áà∂Á±ª Class super_class; const char *name; long version; long info; long instance_size; struct objc_ivar_list *ivars; struct objc_method_list **methodLists; // ÊñπÊ≥ïÁºìÂ≠ò struct objc_cache *cache; struct objc_protocol_list *protocols;#endif&#125;;struct objc_cache &#123; unsigned int mask /* total = mask + 1 */; unsigned int occupied; Method buckets[1];&#125;;Ê†πÊçÆÊ∫êÁ†ÅÔºåÊúÄÊñ∞ÂÆö‰πâÂ§ßËá¥Â¶Ç‰∏ã:struct objc_class : objc_object &#123; // Class ISA; Class isa; Class superclass; cache_t cache;// ÊñπÊ≥ïÁºìÂ≠ò class_data_bits_t bits; // Áî®‰∫éËé∑ÂèñÂÖ∑‰ΩìÁöÑÁ±ª‰ø°ÊÅØ&#125;; YAPerson *person = [[YAPerson alloc] init]; Class cls = [person class]; // Ëé∑ÂèñÂÆû‰æãÂØπË±°ÂØπÂ∫îÁöÑClass Class class1 = object_getClass(person); // Ëé∑ÂèñÊåáÂÆöÂêçÁß∞ÁöÑÁ±ªÂØπË±° Class class3 = objc_getClass("YAPerson"); Class class2 = objc_getRequiredClass("YAPerson"); // Ëé∑ÂèñÊåáÂÆöÂêçÁß∞ÁöÑÂÖÉÁ±ªÂØπË±° Class class4 = objc_getMetaClass("YAPerson"); // ÊâæÂà∞ÊåáÂÆöÂêçÁß∞ÁöÑÁ±ªÂØπË±° Class class5 = objc_lookUpClass("NSObject"); NSLog(@"%@%@%@%@%@",class1,class2,class3,class4,class5); // ËÆæÁΩÆÂØπË±°ÂØπÂ∫îÁöÑClass,ËøîÂõûÂéüÂÖàÁöÑclass Class oriClass = object_setClass(person, [NSObject class]); // ÊòØÂê¶ÊòØÁ±ªÂØπË±°ÊàñÂÖÉÁ±ªÂØπË±° BOOL isClass = object_isClass(person); // ÊòØÂê¶ÊòØÂÖÉÁ±ªÂØπË±° BOOL isMetaClass = class_isMetaClass(class4); // Ëé∑ÂèñÁà∂Á±ª Class superClass = class_getSuperclass(cls); // Ëé∑ÂèñÁ±ªÁöÑÁâàÊú¨ int version = class_getVersion(cls); // ËÆæÁΩÆÁ±ªÁöÑÁâàÊú¨ class_setVersion(cls, 88); // Ëé∑ÂèñÂÆû‰æãÂ§ßÂ∞è typedef __SIZE_TYPE__ size_t; size_t size = class_getInstanceSize(cls); // int objc_getClassList(Class *buffer, int bufferCount)// // Class *objc_copyClassList(unsigned int *outCount)// // Ëé∑ÂèñÁ±ªÁöÑÂêçÁß∞ const char *name = class_getName(cls); // Âä®ÊÄÅÂàõÂª∫Á±ª //Class objc_allocateClassPair(Class superclass, const char *name, size_t extraBytes) //void objc_registerClassPair(Class cls) // Âä®ÊÄÅÂ∫üÂºÉÁ±ª //Class objc_duplicateClass(Class original, const char *name, size_t extraBytes) //void objc_disposeClassPair(Class cls) //id o = objc_storeWeak(&amp;weakObject, weakObject); //id result = objc_loadWeak(&amp;weakObject); BlockÁªôblockÂàõÂª∫‰∏Ä‰∏™ÂÖ≥ËÅîÁöÑÂáΩÊï∞ÊåáÈíàIMP imp_implementationWithBlock(id block)Ëé∑ÂèñÂáΩÊï∞ÊåáÈíàÂÖ≥ËÅîÁöÑblockid imp_getBlock(IMP anImp)ÁßªÈô§ÂáΩÊï∞ÊåáÈíàÂØπÂ∫îÁöÑblockBOOL imp_removeBlock(IMP anImp) ÂÆû‰æãÊºîÁªÉ // Â£∞Êòéblocktypedef void (^Block) ();// ÂÆö‰πâblockBlock block = ^() &#123; NSLog(@"ÂìàÂìàÂìà");&#125;;// ÁªôblockÂàõÂª∫‰∏Ä‰∏™ÂÖ≥ËÅîÁöÑÂáΩÊï∞ÊåáÈíàIMP imp = imp_implementationWithBlock(block);// Ë∞ÉÁî®block(*imp)();// Ëé∑ÂèñÂáΩÊï∞ÊåáÈíàÂÖ≥ËÅîÁöÑblockid blockObject = imp_getBlock(imp);NSLog(@"%@",blockObject);// ÁßªÈô§ÂáΩÊï∞ÊåáÈíàÂØπÂ∫îÁöÑblockBOOL isRemoveBlock = imp_removeBlock(imp);if (isRemoveBlock) &#123; NSLog(@"ÊàêÂäüÁßªÈô§");&#125; SELËé∑ÂèñSELÁöÑÂêçÁß∞(char *Á±ªÂûã)const char *sel_getName(SEL sel)Ê≥®ÂÜåSELSEL sel_registerName(const char *str)ÊØîËæÉSELBOOL sel_isEqual(SEL lhs, SEL rhs) ÂÆû‰æãÊºîÁªÉ // Ëé∑ÂèñSELÁöÑÂêçÁß∞(char *Á±ªÂûã)const char *selName = sel_getName(@selector(viewWillAppear:));printf("%s",selName);// Ê≥®ÂÜåSELSEL newSel = sel_registerName("haha");// ÊØîËæÉSELBOOL isEqual = sel_isEqual(@selector(viewWillAppear:), newSel);NSLog(@"%d",isEqual); IvarÂÆö‰πâ‰∏Ä‰∏™objc_ivarÁªìÊûÑ‰ΩìÊåáÈíàIvartypedef struct objc_ivar *Ivar;struct objc_ivar &#123; ÊàêÂëòÂèòÈáèÂêçÁß∞ char *ivar_name; ÊàêÂëòÂèòÈáèÁ±ªÂûã char *ivar_type; ÂÅèÁßªÈáè int ivar_offset; #ifdef __LP64__ int space; #endif&#125; ÂÖ≥‰∫éÂÅèÁßªÈáèÁöÑÂÆö‰πâ(Â∞±ÊòØÊï¥Âûã)#if defined(__PTRDIFF_TYPE__) typedef __PTRDIFF_TYPE__ __darwin_ptrdiff_t; /* ptr1 - ptr2 */#elif defined(__LP64__) typedef long __darwin_ptrdiff_t; /* ptr1 - ptr2 */#else typedef int __darwin_ptrdiff_t; /* ptr1 - ptr2 */#endif /* __GNUC__ */ #ifndef _PTRDIFF_T#define _PTRDIFF_T typedef __darwin_ptrdiff_t ptrdiff_t;#endif /* _PTRDIFF_T */ÊàêÂëòÂèòÈáèÂàóË°®struct objc_ivar_list &#123; ÊàêÂëòÂèòÈáèÊï∞Èáè int ivar_count;#ifdef __LP64__ int space;#endif /* variable length structure */ struct objc_ivar ivar_list[1];&#125; Ëé∑ÂèñÂÆû‰æãÂèòÈáèIvar class_getInstanceVariable(Class cls, const char *name) //Ëé∑ÂèñÁ±ªÂèòÈáè//Ivar class_getClassVariable(Class cls, const char *name) Ëé∑ÂèñÊàêÂëòÂèòÈáèÂàóË°®Ivar *class_copyIvarList(Class cls, unsigned int *outCount) Ëé∑ÂèñIvarÂèòÈáèÁöÑÂêçÁß∞const char *ivar_getName(Ivar v) Ëé∑ÂèñIvarÂèòÈáèÁöÑÂÅèÁßªÈáèptrdiff_t ivar_getOffset(Ivar v) Ëé∑ÂèñIvarÂèòÈáèÁöÑÁºñÁ†Åconst char *ivar_getTypeEncoding(Ivar v) ËÆæÁΩÆÊàêÂëòÂèòÈáèÁöÑÂÄºvoid object_setIvarWithStrongDefault(id obj, Ivar ivar, id value)ËÆæÁΩÆÊàêÂëòÂèòÈáèÁöÑÂÄºvoid object_setIvar(id obj, Ivar ivar, id value)Ëé∑ÂèñIvarÂØπÂ∫îÁöÑÊàêÂëòÂèòÈáèÂØπË±°id object_getIvar(id obj, Ivar ivar)IvarLayoutÁõ∏ÂÖ≥const uint8_t *class_getIvarLayout(Class cls)const uint8_t *class_getWeakIvarLayout(Class cls)void class_setIvarLayout(Class cls, const uint8_t *layout)void class_setWeakIvarLayout(Class cls, const uint8_t *layout) Ê∑ªÂä†ÊàêÂëòÂèòÈáèBOOL class_addIvar(Class cls, const char *name, size_t size, uint8_t alignment, const char *types) ÂÆû‰æãÊºîÁ§∫ - (void)viewDidLoad &#123; YAPerson *person = [[YAPerson alloc] init]; Class cls = [person class]; // Ëé∑ÂèñÂÆû‰æãÂèòÈáè Ivar ivar_num = class_getInstanceVariable(cls, "num"); Ivar ivar_name = class_getInstanceVariable(cls, "name"); //Ëé∑ÂèñÁ±ªÂèòÈáè //Ivar class_getClassVariable(Class cls, const char *name) // Ëé∑ÂèñIvarÂèòÈáèÁöÑÂêçÁß∞ const char *name = ivar_getName(ivar_name); printf("%s\n",name); // Ëé∑ÂèñIvarÂèòÈáèÁöÑÂÅèÁßªÈáè ptrdiff_t p = ivar_getOffset(ivar_num); printf("%td",p); // ÊâìÂç∞16 // Ëé∑ÂèñIvarÂèòÈáèÁöÑÁºñÁ†Å const char *typeEncoding = ivar_getTypeEncoding(ivar_name); printf("%s\n",typeEncoding); // ÊâìÂç∞ @"NSString" // ËÆæÁΩÆÊàêÂëòÂèòÈáèÁöÑÂÄº object_setIvarWithStrongDefault(person, ivar_name, @"haha"); NSLog(@"%@",person-&gt;name); // ËÆæÁΩÆÊàêÂëòÂèòÈáèÂØπÂ∫îÁöÑÂÄº object_setIvar(person, ivar_name, @"hahaaaaaa"); NSLog(@"%@",person-&gt;name); //Ëé∑ÂèñIvarÂØπÂ∫îÁöÑÊàêÂëòÂèòÈáèÂØπË±° id object = object_getIvar(person, ivar_name); NSLog(@"%@",object); // Âä®ÊÄÅÊ∑ªÂä†ÊàêÂëòÂèòÈáè // ÂøÖÈ°ªÂú® objc_allocateClassPair ‰πãÂêé Âíå Âú®objc_registerClassPair‰πãÂâçË∞ÉÁî® // ‰∏çËÉΩÁªô‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÁ±ªÊ∑ªÂä†ÊàêÂëòÂèòÈáè Class peopleClass = objc_allocateClassPair(cls, "YAPeople", 0); class_addIvar(peopleClass, "_gayFriend", sizeof(id), log2(sizeof(id)), @encode(id)); class_addIvar(peopleClass, "_girlFriend", sizeof(id), log2(sizeof(id)), @encode(id)); class_addIvar(peopleClass, "_company", sizeof(id), log2(sizeof(id)), @encode(id)); objc_registerClassPair(peopleClass); // ÊâìÂç∞ÊàêÂëòÂèòÈáèÂàóË°® NSLog(@"%@", [self ya_getIvarList:peopleClass]); // IvarLayoutÁõ∏ÂÖ≥ // ivarLayout Âíå weakIvarLayout ÂàÜÂà´ËÆ∞ÂΩï‰∫ÜÂì™‰∫õ ivar ÊòØ strong ÊàñÊòØ weakÔºåÈÉΩÊú™ËÆ∞ÂΩïÁöÑÂ∞±ÊòØÂü∫Êú¨Á±ªÂûãÂíå __unsafe_unretained ÁöÑÂØπË±°Á±ªÂûã const uint8_t *ivarLayoutArray= class_getIvarLayout(cls); const uint8_t *weakIvarLayoutArray = class_getWeakIvarLayout(cls); if (ivarLayoutArray) &#123; int i = 0; uint8_t value_s = ivarLayoutArray[i]; while (value_s != 0x0) &#123; printf("\\x%02x\n", value_s); value_s = ivarLayoutArray[++i]; &#125; &#125; //void class_setIvarLayout(Class cls, const uint8_t *layout) //void class_setWeakIvarLayout(Class cls, const uint8_t *layout) &#125;/** Ê†πÊçÆclassËé∑ÂèñÊàêÂëòÂèòÈáèÂàóË°® @param class Á±ª @return ÊàêÂëòÂèòÈáèÂ≠óÂÖ∏(ÂêçÁß∞:Á±ªÂûã) */- (NSDictionary *)ya_getIvarList:(Class)class &#123; // ÊàêÂëòÂèòÈáèÊï∞Èáè unsigned int count = 0; // Ëé∑ÂèñÊàêÂëòÂèòÈáèÂàóË°® Ivar *ivarList = class_copyIvarList(class, &amp;count); // Â≠òÂÇ®ÊàêÂëòÂèòÈáè NSMutableDictionary *dict = [NSMutableDictionary dictionary]; // Ëé∑ÂèñÊàêÂëòÂèòÈáèÁ±ªÂûã‰∏éÊàêÂëòÂèòÈáèÂêçÁß∞ for (unsigned int i = 0; i &lt; count; i++) &#123; // ÊàêÂëòÂèòÈáèÁ±ªÂûã const char *c_ivarType = ivar_getTypeEncoding(ivarList[i]); // ÊàêÂëòÂèòÈáèÂêçÁß∞ const char *c_ivarName = ivar_getName(ivarList[i]); // Âà©Áî®Â≠óÂÖ∏Â≠òÂÇ®,Ê†ºÂºè‰∏∫ ÊàêÂëòÂèòÈáèÂêçÁß∞:ÂØπÂ∫îÁöÑÊàêÂëòÂèòÈáèÁ±ªÂûã NSString *ivarName = [NSString stringWithUTF8String:c_ivarName]; dict[ivarName] = [NSString stringWithUTF8String:c_ivarType]; &#125; // ÈúÄË¶ÅÊâãÂä®free free(ivarList); return [NSDictionary dictionaryWithDictionary:dict];&#125; MethodÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÊñπÊ≥ïÁºñÁ†ÅÂíåÁ±ªÂûãÁºñÁ†Å: #define _C_ID '@'#define _C_CLASS '#'#define _C_SEL ':'#define _C_CHR 'c'#define _C_UCHR 'C'#define _C_SHT 's'#define _C_USHT 'S'#define _C_INT 'i'#define _C_UINT 'I'#define _C_LNG 'l'#define _C_ULNG 'L'#define _C_LNG_LNG 'q'#define _C_ULNG_LNG 'Q'#define _C_FLT 'f'#define _C_DBL 'd'#define _C_BFLD 'b'#define _C_BOOL 'B'#define _C_VOID 'v'#define _C_UNDEF '?'#define _C_PTR '^'#define _C_CHARPTR '*'#define _C_ATOM '%'#define _C_ARY_B '['#define _C_ARY_E ']'#define _C_UNION_B '('#define _C_UNION_E ')'#define _C_STRUCT_B '&#123;'#define _C_STRUCT_E '&#125;'#define _C_VECTOR '!'#define _C_CONST 'r' Code Meaning r const n in N inout o out O bycopy R byref V oneway ‰ª•‰∏ä‰ø°ÊÅØÂú®ÂÖ∑‰ΩìÂ∫îÁî®Êó∂,ÂèØ‰ª•Ëá™ÂÆö‰πâ‰∏Ä‰∏™Êûö‰∏æËé∑Âèñ. typedef struct objc_method *Method;struct objc_method &#123; // ÊñπÊ≥ïÁöÑÂêçÁß∞ SEL method_name; // ÊñπÊ≥ïÁöÑÂèÇÊï∞Á±ªÂûã char *method_types; // ÊñπÊ≥ïÁöÑÂÆûÁé∞(ÂáΩÊï∞ÊåáÈíà) IMP method_imp; &#125; Ê†πÊçÆÊñπÊ≥ïÂêçÁß∞Ëé∑ÂèñMethodMethod class_getInstanceMethod(Class cls, SEL name)Method class_getClassMethod(Class cls, SEL name)Ëé∑ÂèñMethodÁöÑÊñπÊ≥ïÂêçÁß∞SEL method_getName(Method m)Ëé∑ÂèñMethodÁöÑÊñπÊ≥ïÂÆûÁé∞IMP method_getImplementation(Method m) IMP class_getMethodImplementation(Class cls, SEL name) Ëé∑ÂèñMethodÁöÑËøîÂõûÂÄºÁ±ªÂûã(ÈúÄÊâãÂä®ÈáäÊîæ)char *method_copyReturnType(Method m)//void method_getReturnType(Method m, char *dst, size_t dst_len)Ëé∑ÂèñÊåáÂÆöMethodÁöÑÁ±ªÂûãconst char *method_getTypeEncoding(Method m) Ëé∑ÂèñMethodÁöÑÂèÇÊï∞Êï∞Èáèunsigned int method_getNumberOfArguments(Method m)Ëé∑ÂèñMethod‰∏≠Á¨¨i‰∏™ÂèÇÊï∞ÁöÑÁ±ªÂûã(Char *Á±ªÂûã)(ÈúÄÊâãÂä®ÈáäÊîæ)char *method_copyArgumentType(Method m, unsigned int index) Ëé∑ÂèñÊñπÊ≥ïÂàóË°®Method *class_copyMethodList(Class cls, unsigned int *outCount) ËÆæÁΩÆIMPIMP method_setImplementation(Method m, IMP imp)‰∫§Êç¢ÊñπÊ≥ïÂÆûÁé∞void method_exchangeImplementations(Method m1, Method m2) Ê∑ªÂä†ÊñπÊ≥ïBOOL class_addMethod(Class cls, SEL name, IMP imp, const char *types) ÊõøÊç¢ÊñπÊ≥ï IMP class_replaceMethod(Class cls, SEL name, IMP imp, const char *types) Ê†áÊòéÈúÄË¶ÅÊâãÂä®ÈáäÊîæÁöÑÂä®ÊÄÅÂÜÖÂ≠ò(Â¶ÇËøîÂõûÂÄºÁ±ªÂûã/ÂèÇÊï∞Á±ªÂûã)// ÂèäÊó∂ÈáäÊîæif (argumentType) free(argumentType); ÂÆû‰æãÊºîÁ§∫ - (void)viewDidLoad &#123; [super viewDidLoad]; YAPerson *person = [[YAPerson alloc] init]; // Ëé∑ÂèñMethod Method method = class_getInstanceMethod([person class] , NSSelectorFromString(@"nameWithArg:arg:arg:arg:arg:")); // Ëé∑ÂèñMethodÁöÑÊñπÊ≥ïÂêçÁß∞ SEL sel = method_getName(method); NSLog(@"%@",NSStringFromSelector(sel)); // Ëé∑ÂèñMethodÁöÑÊñπÊ≥ïÂÆûÁé∞ IMP imp1 = method_getImplementation(method); IMP imp2 = class_getMethodImplementation([person class],sel); // Ëé∑ÂèñMethodÁöÑËøîÂõûÂÄºÁ±ªÂûã(ÈúÄÊâãÂä®ÈáäÊîæ) char *returnType = method_copyReturnType(method); if (returnType) &#123; NSLog(@"%@",[NSString stringWithUTF8String:returnType]); free(returnType); &#125; // Ëé∑ÂèñÊåáÂÆöMethodÁöÑÁ±ªÂûã const char *typeEncoding = method_getTypeEncoding(method); if (typeEncoding) &#123; NSLog(@"%@",[NSString stringWithUTF8String:typeEncoding]); &#125; // Ëé∑ÂèñMethodÁöÑÂèÇÊï∞Êï∞Èáè unsigned int arguementCount = method_getNumberOfArguments(method); if (arguementCount &gt; 0) &#123; for (unsigned int i = 0; i &lt; arguementCount; i++) &#123; //Ëé∑ÂèñMethod‰∏≠Á¨¨i‰∏™ÂèÇÊï∞ÁöÑÁ±ªÂûã(Char *Á±ªÂûã)(ÈúÄÊâãÂä®ÈáäÊîæ) char *arguementType = method_copyArgumentType(method, i); NSLog(@"%@",[NSString stringWithUTF8String:arguementType]); // ÊâãÂä®ÈáäÊîæ if (arguementType) &#123; free(arguementType); &#125; &#125; &#125; // ËÆæÁΩÆÊñ∞ÁöÑÊñπÊ≥ïÂÆûÁé∞IMP,Âπ∂ËøîÂõûÂéüÂÖàÁöÑIMP IMP imp3 = method_setImplementation(method, imp2);&#125;/** Method Swizzling ‰∏ÄËà¨ÊîæÂú®loadÊñπÊ≥ï‰∏≠,Âπ∂‰∏î‰ΩøÁî®dispatch_once,ÈúÄË¶ÅË∞ÉÁî® class_addMethod ÊñπÊ≥ï */+ (void)load &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; Class cls = [self class]; SEL oldSelector = NSSelectorFromString(@"XXXX"); SEL newSelector = NSSelectorFromString(@"XXXXXXXX"); Method oldMethod = class_getInstanceMethod(cls, oldSelector); Method newMethod = class_getInstanceMethod(cls, newSelector); // Â∞ùËØïÁªôÊóßÁöÑÊñπÊ≥ïoldSelectorÊ∑ªÂä†Êñ∞ÁöÑÊñπÊ≥ïnewSelectotÁöÑÂÆûÁé∞,Â¶ÇÊûúÂ∑≤ÁªèÂ≠òÂú®ÊñπÊ≥ïÂÆûÁé∞,ÂàôÊ∑ªÂä†Â§±Ë¥• BOOL isSuccess = class_addMethod(cls, oldSelector, method_getImplementation(newMethod), method_getTypeEncoding(newMethod)); if (isSuccess) &#123; // Ê∑ªÂä†ÊàêÂäü,ÈÇ£‰πàÁî®ÊóßÁöÑÊñπÊ≥ïÂÆûÁé∞ÊõøÊç¢Êñ∞ÁöÑÊñπÊ≥ïÂÆûÁé∞ class_replaceMethod(cls, newSelector, method_getImplementation(oldMethod), method_getTypeEncoding(oldMethod)); &#125; else &#123; // ÊóßÁöÑÊñπÊ≥ïÂ∑≤ÁªèÊúâ‰∫ÜÂÆûÁé∞,Áõ¥Êé•‰∫§Êç¢Âç≥ÂèØ method_exchangeImplementations(newMethod, oldMethod); &#125; &#125;); /* ‰ΩøÁî® Method Swizzling ÁöÑÁõÆÁöÑÈÄöÂ∏∏ÈÉΩÊòØ‰∏∫‰∫ÜÁªôÁ®ãÂ∫èÂ¢ûÂä†ÂäüËÉΩÔºåËÄå‰∏çÊòØÂÆåÂÖ®Âú∞ÊõøÊç¢Êüê‰∏™ÂäüËÉΩÔºåÊâÄ‰ª•Êàë‰ª¨‰∏ÄËà¨ÈÉΩÈúÄË¶ÅÂú®Ëá™ÂÆö‰πâÁöÑÂÆûÁé∞‰∏≠Ë∞ÉÁî®ÂéüÂßãÁöÑÂÆûÁé∞„ÄÇSwizzlingÂ∫îËØ•ÊÄªÊòØÂú®+load‰∏≠ÊâßË°åÂú®Objective-C‰∏≠ÔºåËøêË°åÊó∂‰ºöËá™Âä®Ë∞ÉÁî®ÊØè‰∏™Á±ªÁöÑ‰∏§‰∏™ÊñπÊ≥ï„ÄÇ+load‰ºöÂú®Á±ªÂàùÂßãÂä†ËΩΩÊó∂Ë∞ÉÁî®Ôºå+initialize‰ºöÂú®Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®Á±ªÁöÑÁ±ªÊñπÊ≥ïÊàñÂÆû‰æãÊñπÊ≥ï‰πãÂâçË¢´Ë∞ÉÁî®„ÄÇËøô‰∏§‰∏™ÊñπÊ≥ïÊòØÂèØÈÄâÁöÑÔºå‰∏îÂè™ÊúâÂú®ÂÆûÁé∞‰∫ÜÂÆÉ‰ª¨Êó∂Êâç‰ºöË¢´Ë∞ÉÁî®„ÄÇÁî±‰∫émethod swizzling‰ºöÂΩ±ÂìçÂà∞Á±ªÁöÑÂÖ®Â±ÄÁä∂ÊÄÅÔºåÂõ†Ê≠§Ë¶ÅÂ∞ΩÈáèÈÅøÂÖçÂú®Âπ∂ÂèëÂ§ÑÁêÜ‰∏≠Âá∫Áé∞Á´û‰∫âÁöÑÊÉÖÂÜµ„ÄÇ+loadËÉΩ‰øùËØÅÂú®Á±ªÁöÑÂàùÂßãÂåñËøáÁ®ã‰∏≠Ë¢´Âä†ËΩΩÔºåÂπ∂‰øùËØÅËøôÁßçÊîπÂèòÂ∫îÁî®Á∫ßÂà´ÁöÑË°å‰∏∫ÁöÑ‰∏ÄËá¥ÊÄß„ÄÇÁõ∏ÊØî‰πã‰∏ãÔºå+initializeÂú®ÂÖ∂ÊâßË°åÊó∂‰∏çÊèê‰æõËøôÁßç‰øùËØÅ‚Äì‰∫ãÂÆû‰∏äÔºåÂ¶ÇÊûúÂú®Â∫îÁî®‰∏≠Ê≤°‰∏∫ÁªôËøô‰∏™Á±ªÂèëÈÄÅÊ∂àÊÅØÔºåÂàôÂÆÉÂèØËÉΩÊ∞∏Ëøú‰∏ç‰ºöË¢´Ë∞ÉÁî®„ÄÇSwizzlingÂ∫îËØ•ÊÄªÊòØÂú®dispatch_once‰∏≠ÊâßË°å‰∏é‰∏äÈù¢Áõ∏ÂêåÔºåÂõ†‰∏∫swizzling‰ºöÊîπÂèòÂÖ®Â±ÄÁä∂ÊÄÅÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂú®ËøêË°åÊó∂ÈááÂèñ‰∏Ä‰∫õÈ¢ÑÈò≤Êé™ÊñΩ„ÄÇÂéüÂ≠êÊÄßÂ∞±ÊòØËøôÊ†∑‰∏ÄÁßçÊé™ÊñΩÔºåÂÆÉÁ°Æ‰øù‰ª£Á†ÅÂè™Ë¢´ÊâßË°å‰∏ÄÊ¨°Ôºå‰∏çÁÆ°ÊúâÂ§öÂ∞ë‰∏™Á∫øÁ®ã„ÄÇGCDÁöÑdispatch_onceÂèØ‰ª•Á°Æ‰øùËøôÁßçË°å‰∏∫ÔºåÊàë‰ª¨Â∫îËØ•Â∞ÜÂÖ∂‰Ωú‰∏∫method swizzlingÁöÑÊúÄ‰Ω≥ÂÆûË∑µ„ÄÇ*/&#125;/** Ê†πÊçÆclassËé∑ÂèñÊñπÊ≥ïÂàóË°® @param class Á±ª @return ÊñπÊ≥ïÂêçÁß∞Êï∞ÁªÑ */+ (NSArray *)ya_getMethodList:(Class)class &#123; // ÊñπÊ≥ïÂàóË°®Êï∞Èáè unsigned int methodCount = 0; // Ëé∑ÂèñÊñπÊ≥ïÂàóË°® Method *methodList = class_copyMethodList(class, &amp;methodCount); // Â≠òÂÇ®ÊñπÊ≥ïÂêçÁß∞ NSMutableArray *array = [NSMutableArray array]; if (methodList) &#123; for (unsigned int i = 0; i &lt; methodCount; i ++) &#123; // Ëé∑ÂèñÊñπÊ≥ï Method method = methodList[i]; // Ëé∑ÂèñÊñπÊ≥ïÂêçÁß∞ SEL sel = method_getName(method); [array addObject:NSStringFromSelector(sel)]; &#125; // ÊâãÂä®ÈáäÊîæ free(methodList); &#125; return [NSArray arrayWithArray:array];&#125;/** ‰∫§Êç¢ÂÆû‰æãÊñπÊ≥ïÂÆûÁé∞ @param class Á±ª @param aSEL ÊñπÊ≥ï‰∏ÄÁöÑÂêçÁß∞ @param bSEL ÊñπÊ≥ï‰∫åÁöÑÂêçÁß∞ */+ (void)ya_exchangeInstanceMethod:(Class)class firstMethod:(SEL)aSEL secondMethod:(SEL)bSEL &#123; Method aMethad = class_getInstanceMethod(class, aSEL); Method bMethod = class_getInstanceMethod(class, bSEL); // ‰∫§Êç¢ÊñπÊ≥ïÂÆûÁé∞ method_exchangeImplementations(aMethad, bMethod);&#125;/** ‰∫§Êç¢Á±ªÊñπÊ≥ïÂÆûÁé∞ @param class Á±ª @param aSEL ÊñπÊ≥ï‰∏ÄÁöÑÂêçÁß∞ @param bSEL ÊñπÊ≥ï‰∫åÁöÑÂêçÁß∞ */+ (void)ya_exchangeClassMethod:(Class)class firstMethod:(SEL)aSEL secondMethod:(SEL)bSEL &#123; Method aMethad = class_getClassMethod(class, aSEL); Method bMethod = class_getClassMethod(class, bSEL); // ‰∫§Êç¢ÊñπÊ≥ïÂÆûÁé∞ method_exchangeImplementations(aMethad, bMethod);&#125;/** ‰∏∫Á±ªÊ∑ªÂä†Âêç‰∏∫newSELÁöÑ(ÂÆû‰æã)ÊñπÊ≥ï @param class Á±ª @param aSEL Êñ∞ÁöÑÊñπÊ≥ïÂêçÁß∞ @param bSEL Â∑≤ÁªèÂ≠òÂú®ÁöÑÊñπÊ≥ïÂêçÁß∞ @return ÊòØÂê¶Ê∑ªÂä†ÊàêÂäü */+ (BOOL)ya_addMethod:(Class)class newSEL:(SEL)aSEL existSEL:(SEL)bSEL &#123; // Ëé∑ÂèñÂ∑≤ÁªèÂ≠òÂú®ÁöÑÊñπÊ≥ï Method method = class_getInstanceMethod(class, bSEL); // Ëé∑ÂèñÂ∑≤ÁªèÂ≠òÂú®ÁöÑÊñπÊ≥ïÁöÑÂÆûÁé∞ IMP imp = class_getMethodImplementation(class, bSEL); // Ëé∑Âèñtype const char *type = method_getTypeEncoding(method); // ÁªôclassÊ∑ªÂä†ÂêçÁß∞‰∏∫aSELÁöÑÊñπÊ≥ïÂÆûÁé∞ return class_addMethod(class, aSEL, imp, type); /* Â¶ÇÊûúÁà∂Á±ª‰∏≠Â∑≤ÁªèÊúâËØ•ÂêçÁß∞ÁöÑÊñπÊ≥ï,ÈÇ£‰πàË∞ÉÁî®ÂêéÂ∞ÜÈáçÂÜôËØ•ÊñπÊ≥ï Â¶ÇÊûúÊú¨Á±ª‰∏≠Â∑≤ÁªèÊúâ‰∫ÜËØ•ÂêçÁß∞ÁöÑÊñπÊ≥ïÂÆûÁé∞,ÈÇ£‰πàÂ∞ÜÊ∑ªÂä†Â§±Ë¥• */&#125; Propertytypedef struct objc_property *objc_property_t;Â±ûÊÄßÁõ∏ÂÖ≥‰ø°ÊÅØtypedef struct &#123; const char *name; const char *value; &#125; objc_property_attribute_t;Ëé∑ÂèñÂ±ûÊÄßobjc_property_t class_getProperty(Class cls, const char *name)Ëé∑ÂèñÂ±ûÊÄßÂàóË°®objc_property_t *class_copyPropertyList(Class cls, unsigned int *outCount)Ëé∑ÂèñÂ±ûÊÄß‰ø°ÊÅØÂàóË°®objc_property_attribute_t *property_copyAttributeList(objc_property_t property, unsigned int *outCount)Ëé∑ÂèñÂ±ûÊÄß‰ø°ÊÅØ‰∏≠Êüê‰∏™Valuechar *property_copyAttributeValue(objc_property_t property, const char *attributeName)Ê∑ªÂä†Â±ûÊÄßBOOL class_addProperty(Class cls, const char *name, const objc_property_attribute_t *attributes, unsigned int attributeCount)ÊõøÊç¢Â±ûÊÄßvoid class_replaceProperty(Class cls, const char *name, const objc_property_attribute_t *attributes, unsigned int attributeCount)Ëé∑ÂèñÂ±ûÊÄßÂêçÁß∞const char *property_getName(objc_property_t property) Ëé∑ÂèñÂ±ûÊÄßÁõ∏ÂÖ≥‰ø°ÊÅØconst char *property_getAttributes(objc_property_t property) ÂÆû‰æãÊºîÁ§∫ - (void)viewDidLoad &#123;YAPerson *person = [[YAPerson alloc] init]; Class cls = [person class]; // Ëé∑ÂèñÂ±ûÊÄß objc_property_t property = class_getProperty(cls, "school"); // Ëé∑ÂèñÂ±ûÊÄßÂêçÁß∞ const char *propertyName = property_getName(property); printf("%s\n",propertyName); // Ëé∑ÂèñÂ±ûÊÄß‰ø°ÊÅØÂàóË°® // objc_property_attribute_t *property_copyAttributeList(objc_property_t property, unsigned int *outCount) // Ëé∑ÂèñÂ±ûÊÄßÁõ∏ÂÖ≥‰ø°ÊÅØ const char *propertyAttributes = property_getAttributes(property); printf("%s\n",propertyAttributes); // ÊâìÂç∞ T@"NSObject",W,N,V_school // Ê†πÊçÆËé∑ÂèñÂ±ûÊÄß‰ø°ÊÅØ‰∏≠ÁöÑnameËé∑ÂèñÂØπÂ∫îÁöÑValue char *propertyValue = property_copyAttributeValue(property, "T"); // Á±ªÂûã printf("%s\n",propertyValue); /* T Á±ªÂûã ‰æãÂ¶Ç:NSObject V ÂÄº(ÊàêÂëòÂèòÈáè) ‰æãÂ¶Ç _school C copy N nonatommic */ // Ê∑ªÂä†Â±ûÊÄß objc_property_attribute_t type = &#123; "T", [[NSString stringWithFormat:@"@\"%@\"",NSStringFromClass([NSString class])] UTF8String] &#125;; //type objc_property_attribute_t ownership0 = &#123; "C", "" &#125;; // C = copy objc_property_attribute_t ownership = &#123; "N", "" &#125;; //N = nonatomic objc_property_attribute_t backingivar = &#123; "V", [[NSString stringWithFormat:@"_%s", "propertyName"] UTF8String] &#125;; //variable name objc_property_attribute_t attrs[] = &#123; type, ownership0, ownership, backingivar &#125;; if (class_addProperty(cls, "propertyName", attrs, 4)) &#123; NSLog(@"Ê∑ªÂä†ÊàêÂäü"); &#125; // ÊõøÊç¢Â±ûÊÄß //void class_replaceProperty(Class cls, const char *name, const objc_property_attribute_t *attributes, unsigned int attributeCount) &#125;/** Ê†πÊçÆclassËé∑ÂèñÁ±ªÁöÑÂ±ûÊÄßÂàóË°® @param class Á±ª @return Â±ûÊÄßÂàóË°®Êï∞ÁªÑ */+ (NSArray *)ya_getPropertyList:(Class)class &#123; // ÁßÅÊúâ/ÂÖ¨Êúâ/Á±ªÊâ©Â±ï‰∏≠ÁöÑÊâÄÊúâÂ±ûÊÄßÊï∞Èáè unsigned int count = 0; // Ëé∑ÂèñÂ±ûÊÄßÂàóË°® objc_property_t *propertyList = class_copyPropertyList(class, &amp;count); // Â≠òÂÇ®Â±ûÊÄßÂêçÁß∞ NSMutableArray *array = [NSMutableArray array]; for (unsigned int i = 0; i &lt; count; i ++) &#123; const char* c_propertyName = property_getName(propertyList[i]); [array addObject:[NSString stringWithUTF8String:c_propertyName]]; &#125; // ÊâãÂä®ÈáäÊîæ free(propertyList); return [NSArray arrayWithArray:array];&#125; ProtocolÊú¨ÈÉ®ÂàÜÂ∫îÁî®ËæÉÂ∞ë,Êú™ÂÅöËØ¶ÁªÜÂÆûË∑µ. struct objc_protocol_list &#123; struct objc_protocol_list *next; long count; __unsafe_unretained Protocol *list[1];&#125;;ÊòØÂê¶ÈÅµÂæ™ÂçèËÆÆBOOL class_conformsToProtocol(Class cls, Protocol *protocol)ÂçèËÆÆÂàóË°®Protocol * __unsafe_unretained *class_copyProtocolList(Class cls, unsigned int *outCount)Protocol * __unsafe_unretained *objc_copyProtocolList(unsigned int *outCount)Protocol * __unsafe_unretained *protocol_copyProtocolList(Protocol *proto, unsigned int *outCount)Âä®ÊÄÅÊ∑ªÂä†ÂçèËÆÆBOOL class_addProtocol(Class cls, Protocol *protocol) Ëé∑ÂèñÊåáÂÆöÂêçÁß∞ÁöÑÂçèËÆÆProtocol *objc_getProtocol(const char *name)ÂçèËÆÆAÊòØÂê¶ÈÅµÂæ™ÂçèËÆÆBBOOL protocol_conformsToProtocol(Protocol *proto, Protocol *other)‰∏§‰∏™ÂçèËÆÆÊòØÂê¶Áõ∏Á≠âBOOL protocol_isEqual(Protocol *proto, Protocol *other)Ëé∑ÂèñÊüê‰∏™ÂçèËÆÆÁöÑÂêçÁß∞const char *protocol_getName(Protocol *p)Âä®ÊÄÅÁîüÊàêÂçèËÆÆProtocol *objc_allocateProtocol(const char *name)void objc_registerProtocol(Protocol *proto) ÁªôÂçèËÆÆÊ∑ªÂä†ÊñπÊ≥ïvoid protocol_addMethodDescription(Protocol *proto, SEL name, const char *types, BOOL isRequiredMethod, BOOL isInstanceMethod) ÁªôÂçèËÆÆÊ∑ªÂä†ÂçèËÆÆvoid protocol_addProtocol(Protocol *proto, Protocol *addition) ÁªôÂçèËÆÆÊ∑ªÂä†Â±ûÊÄßvoid protocol_addProperty(Protocol *proto, const char *name, const objc_property_attribute_t *attributes, unsigned int attributeCount, BOOL isRequiredProperty, BOOL isInstanceProperty)/** Ê†πÊçÆclassËé∑ÂèñÈÅµÂæ™ÁöÑÂçèËÆÆÂàóË°® @param class Á±ª @return ÂçèËÆÆÂêçÁß∞ÂàóË°® */+ (NSArray *)ya_getProtocolList:(Class)class &#123; // ÂçèËÆÆÂàóË°®Êï∞Èáè unsigned int count = 0; // Ëé∑ÂèñÂçèËÆÆÂàóË°® __unsafe_unretained Protocol **protocolList = class_copyProtocolList(class, &amp;count); // Â≠òÂÇ®ÂçèËÆÆ NSMutableArray *array = [NSMutableArray array]; for (NSInteger i = 0; i &lt; count; i ++) &#123; // Ëé∑ÂèñÂçèËÆÆ Protocol *protocol = protocolList[i]; // Ëé∑ÂèñÂçèËÆÆÂêçÁß∞ const char *c_protocolName = protocol_getName(protocol); [array addObject:[NSString stringWithUTF8String:c_protocolName]]; &#125; // ÊâãÂä®ÈáäÊîæ free(protocolList); return [NSArray arrayWithArray:array];&#125; ‰∫å„ÄÅÊäÄËÉΩÊ∂àÊÅØËΩ¨Âèë+ (BOOL)resolveInstanceMethod:(SEL)sel &#123; if (sel_isEqual(sel, NSSelectorFromString(@"ss"))) &#123; // Ë¶ÅÊ±ÇÂèÇÊï∞Ë¶ÅÂåπÈÖç [YARuntime ya_addMethod:[self class] newSEL:sel existSEL:@selector(printPersonalInfo)]; return YES; &#125; return [super resolveInstanceMethod:sel]; &#125; - (id)forwardingTargetForSelector:(SEL)aSelector &#123; if (sel_isEqual(aSelector, NSSelectorFromString(@"ss"))) &#123; // ËΩ¨ÂèëÁªôÂ∑≤ÁªèÂ≠òÂú®ÁöÑÂØπË±° return [[YAPerson alloc] init]; &#125; return [super forwardingTargetForSelector:aSelector];&#125; - (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector &#123; NSMethodSignature *signature = [super methodSignatureForSelector:aSelector]; // Ê≤°ÊúâÊâæÂà∞signature(ÊñπÊ≥ïÁ≠æÂêç),Âè™ËÉΩÊâãÂä®Êèê‰æõ if (signature == nil) &#123; signature = [NSMethodSignature signatureWithObjCTypes:"@@:"]; &#125; return signature;&#125;- (void)forwardInvocation:(NSInvocation *)anInvocation &#123; YAPerson *personClass = [[YAPerson alloc] init]; SEL sel = anInvocation.selector; if ([personClass respondsToSelector:sel]) &#123; // ÊúÄÂêé‰∏ÄÊ¨°Êú∫‰ºö [anInvocation invokeWithTarget:personClass]; &#125; else &#123; // ÂõûÂ§©‰πèÂäõ [self doesNotRecognizeSelector:sel]; &#125;&#125; Â§öÈáçÁªßÊâø ‰∏ç‰ºöÂÅöËèúÁöÑÁ®ãÂ∫èÂëò‰∏çÊòØÂ•ΩÁî∑‰∫∫„ÄÇ YADeveloper ÁªßÊâøËá™ YAMan,ÊÉ≥ËÆ©YADeveloperÂÆû‰æãÂØπË±°ÂêåÊó∂ÂÖ∑Â§áÂìçÂ∫î YAManÊñπÊ≥ïÂíå YACookÊñπÊ≥ïÁöÑËÉΩÂäõ„ÄÇ YAMan: @interface YAMan : NSObject- (void)printMan;@end@implementation YAMan- (void)printMan &#123; NSLog(@"ÊàëÊòØ‰∏Ä‰∏™Áî∑‰∫∫");&#125;@end YACook: @interface YACook : NSObject - (void)printCook;@end@implementation YACook- (void)printCook &#123; NSLog(@"ÊàëÊòØ‰∏™‰ºöÂÅöËèúÁöÑ‰∫∫");&#125;@end YADeveloper: @class YACook;@interface YADeveloper : YAMan@property (nonatomic,strong) YACook *cook;- (void)printDev;// Â£∞ÊòéYACookÁöÑÊñπÊ≥ï,‰ΩøÁºñËØëÈÄöËøá- (void)printCook;@end@implementation YADeveloper- (void)printDev &#123; NSLog(@"ÊàëÊòØ‰∏™‰ºöÂÜôÁ®ãÂ∫èÁöÑ‰∫∫");&#125;- (id)forwardingTargetForSelector:(SEL)aSelector &#123; if (sel_isEqual(aSelector, NSSelectorFromString(@"printCook"))) &#123; // ÈúÄË¶ÅÈ¢ÑÂÖàÂØπself.cookÂàùÂßãÂåñ return self.cook; // ÊàñËÄÖÁõ¥Êé•ÂàõÂª∫ // return [[YACook alloc] init]; &#125; return [super forwardingTargetForSelector:aSelector];&#125;@end ÂÖ≥ËÅîÂºïÁî®Ê≥®ÊÑèÁÇπ: objc_removeAssociatedObjects ÂáΩÊï∞‰∏ÄËà¨‰∏çÂèØÊâãÂä®Ë∞ÉÁî®ÔºåÂõ†‰∏∫Ëøô‰∏™ÂáΩÊï∞‰ºöÁßªÈô§‰∏Ä‰∏™ÂØπË±°ÁöÑÊâÄÊúâÂÖ≥ËÅîÂØπË±°ÔºåÂ∞ÜËØ•ÂØπË±°ÊÅ¢Â§çÊàê‚ÄúÂéüÂßã‚ÄùÁä∂ÊÄÅ„ÄÇËøôÊ†∑ÂÅöÂ∞±ÂæàÊúâÂèØËÉΩÊääÂà´‰∫∫Ê∑ªÂä†ÁöÑÂÖ≥ËÅîÂØπË±°‰πü‰∏ÄÂπ∂ÁßªÈô§ÔºåËøôÂπ∂‰∏çÊòØÊàë‰ª¨ÊâÄÂ∏åÊúõÁöÑ„ÄÇÊâÄ‰ª•‰∏ÄËà¨ÁöÑÂÅöÊ≥ïÊòØÈÄöËøáÁªô objc_setAssociatedObject ÂáΩÊï∞‰º†ÂÖ• nil Êù•ÁßªÈô§Êüê‰∏™Â∑≤ÊúâÁöÑÂÖ≥ËÅîÂØπË±°„ÄÇ ÂÖ≥ËÅîÂØπË±°‰∏éË¢´ÂÖ≥ËÅîÂØπË±°Êú¨Ë∫´ÁöÑÂ≠òÂÇ®Âπ∂Ê≤°ÊúâÁõ¥Êé•ÁöÑÂÖ≥Á≥ªÔºåÂÆÉÊòØÂ≠òÂÇ®Âú®ÂçïÁã¨ÁöÑÂìàÂ∏åË°®‰∏≠ÁöÑ„ÄÇÁªôÂàÜÁ±ªÊ∑ªÂä†weakÂ±ûÊÄß Áªô‰ªªÊÑèÂØπË±°A Ê∑ªÂä† weakÂ±ûÊÄß B ÈóÆÈ¢òÂÖ≥ÈîÆÁÇπ:Âú®Â±ûÊÄßÈîÄÊØÅÁöÑÊó∂ÂÄôÔºåÂ∞ÜÂÖ∂ÁΩÆ‰∏∫Á©∫(ÊàñËÄÖËØ¥Âú®ÂÖ≥ËÅîÂØπË±°ÈîÄÊØÅÁöÑÊó∂ÂÄôÔºå‰Ωøobjc_getAssociatedObjectÂæóÂà∞ÁöÑÊòØnil)„ÄÇ ÊñπÊ≥ï‰∏ÄÈÄöËøáÁªßÊâøÂÖ≥ËÅîÂØπË±°B ÔºåÈáçÂÜôÂÖ∂deallocÊñπÊ≥ïÂç≥ÂèØÈÄÇÊó∂ÊääA‰∏≠ÁöÑÂÖ≥ËÅîÂØπË±°ËøîÂõûÂÄºËÆæÁΩÆ‰∏∫nilÔºåËææÂà∞Ëá™Âä®ÁΩÆÁ©∫ÁöÑÁõÆÁöÑÔºåËøô‰πüÊòØÊúÄÊú¨ËÉΩÁöÑÊñπÊ≥ï„ÄÇ ÁªôNSObjectÊ∑ªÂä†ÂàÜÁ±ªÔºå‰πüÂç≥‰ªª‰ΩïÁªßÊâøËá™NSObjectÁöÑÂØπË±°ÈÉΩÂèØ‰ª•ÊúâweakÂ±ûÊÄß„ÄÇ @interface NSObject (YAWeakProperty)@property (nonatomic, weak) YAProperty *property;@end@implementation NSObject (YAWeakProperty)// const static char *key = "key";- (id)property &#123; return objc_getAssociatedObject(self, @selector(property));&#125;- (void)setProperty:(YAProperty *)property &#123; objc_setAssociatedObject(self, @selector(property), property, OBJC_ASSOCIATION_ASSIGN); [property setAssociate:self selector:@selector(setProperty:)];&#125;@end ÂÖ≥ËÅîÂºïÁî®ÁöÑkey‰∏ÄËà¨‰ΩøÁî®getterÊñπÊ≥ïÁöÑselectorÔºåÊ≠§Êó∂getÊñπÊ≥ï‰∏≠ÁöÑkey‰πüÂèØ‰ΩøÁî®_cmdÔºå‰∫åËÄÖÁ≠âÊïà„ÄÇ Â±ûÊÄßÁöÑÂÆûÁé∞: @interface YAProperty : NSObject- (void)setAssociate:(NSObject *)associatedObject selector:(SEL)sel;@end// Á±ªÊâ©Â±ï@interface YAProperty()&#123; __weak id _associatedObject; SEL _sel;&#125;@end@implementation YAProperty- (void)setAssociate:(NSObject *)associatedObject selector:(SEL)sel &#123; _associatedObject = associatedObject; _sel = sel;&#125;- (void)dealloc &#123; ((void (*)(id, SEL,id)) objc_msgSend)(_associatedObject, _sel, nil);&#125;@end ÁÑ∂ËÄåÊúâ‰∏™ÈóÆÈ¢ò:Ê∑ªÂä†ÁöÑÂ±ûÊÄßÁªßÊâøËá™NSObjectÊó∂ÈùûÂ∏∏ÂÆåÁæéÔºå‰ΩÜÊòØÂÆûÈôÖÈ°πÁõÆ‰∏≠‰∏çÂèØËÉΩÁªô‰ªªÊÑèÂØπË±°Ê∑ªÂä†ÁöÑÂ±ûÊÄßÈÉΩÊòØNSObjectÔºåÊúâÂèØËÉΩÊòØNSString/NSArray/NSDictionary/NSSetÁ≠âÁ≠â„ÄÇÈÇ£‰πàÂ∞±Âè™ËÉΩÁªßÊâøËá™NSString/NSArray/NSDictionary/NSSetÁ≠âÁ≥ªÁªüÁ±ªÔºåËøôÊ†∑‰ºöÂá∫Áé∞‰∏ÄÁ≥ªÂàó‰∏ÄÁ≥ªÂàó‰∏ÄÁ≥ªÂàóÈóÆÈ¢òÔºåËãπÊûúÂπ∂‰∏çÂª∫ËÆÆÊàë‰ª¨‰ΩøÁî®NSString/NSArray/NSDictionary/NSSetÁ≠âÁöÑÊ¥æÁîüÁ±ª(Ëøô‰∫õÁ±ªÂ∑≤ÁªèË∂≥Â§üÂ•Ω‰∫ÜÔºå‰∏çÈúÄË¶ÅÁîªËõáÊ∑ªË∂≥)„ÄÇ ÊñπÊ≥ï‰∫å Áî®‰∏Ä‰∏™NSPointerArrayÔºàÂº±ÂºïÁî®Á±ªÂûãÁöÑÊï∞ÁªÑÔºâÂåÖ‰∏ÄÂ±ÇÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇËôΩÁÑ∂ÂÖ≥ËÅîÂ±ûÊÄßÁöÑpolicy‰∏çÊîØÊåÅweakÔºå‰ΩÜÊòØ‰Ω†ÂèØ‰ª•ÊääË¶ÅÂÖ≥ËÅîÁöÑÂØπË±°ÊîæÂÖ•‰∏Ä‰∏™Âº±ÂºïÁî®Êï∞ÁªÑÈáåÈù¢ÔºåÁÑ∂ÂêéÊääËøô‰∏™Âº±ÂºïÁî®Êï∞ÁªÑËÆæÁΩÆ‰∏∫ÂÖ≥ËÅîÂØπË±°ÔºåÊØèÊ¨°ÂèñÂÄºÁöÑÊó∂ÂÄôÔºåÂè™ÈúÄË¶Å‰ªéËøô‰∏™Âº±ÂºïÁî®Êï∞ÁªÑÈáåÈù¢ÂèñÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ‰∏ÄÊ†∑ÂèØ‰ª•ËææÂà∞ÂÖ≥ËÅîÂº±ÂºïÁî®ÂØπË±°ÁöÑÊïàÊûú„ÄÇ ÊñπÊ≥ï‰∏âA ÂÖ≥ËÅî CB ÂÖ≥ËÅî CC ÈîÄÊØÅ ÈÄöÁü•BB ÂÜçÂëäËØâ A ÊñπÊ≥ïÂõõÈòÖËØªÂ§ßÁ•ûÂçöÂÆ¢ÂèëÁé∞ÁöÑÊñ∞ÊñπÊ≥ïÔºåËßÅ2019Âπ¥Êñ∞ÂÜôÁöÑÊñáÁ´†Ôºö Weak Associated Object ‰∏â„ÄÅË¶ÅÁÇπfree()free() ÂáΩÊï∞Áî®Êù•ÈáäÊîæÂä®ÊÄÅÂàÜÈÖçÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂÖ∂ÂéüÂûã‰∏∫Ôºö void free (void* ptr);free() ÂèØ‰ª•ÈáäÊîæÁî± malloc()„ÄÅcalloc()„ÄÅrealloc() ÂàÜÈÖçÁöÑÂÜÖÂ≠òÁ©∫Èó¥Ôºå‰ª•‰æøÂÖ∂‰ªñÁ®ãÂ∫èÂÜçÊ¨°‰ΩøÁî®„ÄÇ// ÂèäÊó∂ÈáäÊîæÂ≠óÁ¨¶‰∏≤Â∏∏Èáèif (argumentType) free(argumentType); NONNULLNS_ASSUME_NONNULL_BEGINÂíåNS_ASSUME_NONNULL_END„ÄÇÂú®Ëøô‰∏§‰∏™ÂÆè‰πãÈó¥ÁöÑ‰ª£Á†ÅÔºåÊâÄÊúâÁÆÄÂçïÊåáÈíàÂØπË±°ÈÉΩË¢´ÂÅáÂÆö‰∏∫ nonnull#define NS_ASSUME_NONNULL_BEGIN _Pragma("clang assume_nonnull begin")#define NS_ASSUME_NONNULL_END _Pragma("clang assume_nonnull end") __covariant__covariant - ÂçèÂèòÊÄßÔºåÂ≠êÁ±ªÂûãÂèØ‰ª•Âº∫ËΩ¨Âà∞Áà∂Á±ªÂûãÔºàÈáåÊ∞èÊõøÊç¢ÂéüÂàôÔºâ__contravariant - ÈÄÜÂèòÊÄßÔºåÁà∂Á±ªÂûãÂèØ‰ª•Âº∫ËΩ¨Âà∞Â≠êÁ±ªÂûãÔºàWTFÔºâ __kindof ÂÜÖËÅî__attribute__((always_inline)) ÁöÑÊÑèÊÄùÊòØÂº∫Âà∂ÂÜÖËÅî ÂèÇËÄÉÂπ∂ÊÑüË∞¢ÈùíÁéâ‰ºèÊ°àÂçóÂ≥∞Â≠ê]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂºÄÊ∫êÈ°πÁõÆÔºöYAScrollPlaceView]]></title>
    <url>%2F2017%2F10%2F01%2F%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%EF%BC%9AYAScrollPlaceView%2F</url>
    <content type="text"><![CDATA[2019.8.4 Ë°•ÂÖÖÂÜÖÂÆπ ÂèØ‰ª•ÁªôUIScrollView„ÄÅUITableViewÊ∑ªÂä†Â§¥Â∞æËßÜÂõæ„ÄÇ ‰∏Ä„ÄÅÂâçË®ÄÁôæÂ∫¶ÁïÖÂê¨ÊòØÊàëÂ∑•‰ΩúÂêéÁöÑÁ¨¨‰∏Ä‰∏™È°πÁõÆÔºåÂ§ßÊ¶ÇÂ∞±ÊòØÊâãÁôæÈáåÈù¢ÁöÑ‚ÄúÂñúÈ©¨ÊãâÈõÖ‚Äù„ÄÇ Êüê‰∏ÄÂ§©UEÊèê‰∫Ü‰∏™ÈúÄÊ±ÇÔºåÂ§ßÊÑèÂ∞±ÊòØÂú®UITableViewÂ∫ïÈÉ®Âä†‰∏™logoÂõæÁâáÔºåË¶ÅÊ±ÇËøôÂº†ÂõæÁâáËÉΩÈöèÁùÄUITableViewCellÁöÑÊªëÂä®ËÄåË∑üÁùÄÊªëÂä®„ÄÇ‰πç‰∏ÄÊÉ≥ÔºåÂèØ‰ª•‰ΩøÁî®Áõ¥Êé•‰ΩøÁî®UITableViewÁöÑtableFooterViewÔºåËµãÂÄº‰∏™UIImageViewÂç≥ÂèØÔºåÂèØÊòØËøòÊúâ‰∏Ä‰∏™Ë¶ÅÊ±ÇÔºöÂΩìÊï∞ÊçÆÂæàÂ∞ëÁöÑÊó∂ÂÄôÔºåËøô‰∏™logoÂõæÁâáÂøÖÈ°ªÁ¥ßÊå®ÁùÄÂ±èÂπïÊúÄ‰∏ãÊñπ„ÄÇÂæàÊòæÁÑ∂ÔºåtableFooterViewËá™Â∑±‰ºöË∑ëÂà∞È°∂ÈÉ®ÔºåÊª°Ë∂≥‰∏ç‰∫ÜÈúÄÊ±Ç„ÄÇ ÂÖ≥ÈîÆÊòØÔºåÈÇ£‰∏ÄÈòµÂ≠êÂàöËØª‰∫ÜMJRefreshÁöÑÊ∫êÁ†ÅÔºåÂèàÁó¥Ëø∑‰∫éRuntimeÁöÑÂêÑÁßçÈ≠îÊ≥ïÔºåËµ∞ÁÅ´ÂÖ•È≠îÁöÑÂéâÂÆ≥ÔºåËøòÁâπÂà´ÊÉ≥ÂÜô‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆÈÄûËÉΩÔºå‰∫éÊòØËøô‰∏™ËÉΩÁªôUIScrollViewÊ∑ªÂä†Â§¥ÈÉ®„ÄÅÂ∞æÈÉ®ËßÜÂõæÁöÑÊ°ÜÊû∂‰∫ßÁîü‰∫Ü„ÄÇ È°πÁõÆÂú∞ÂùÄ:https://github.com/ChenYalun/YAScrollPlaceView ‰∫å„ÄÅÊÄùË∑ØÊÄùË∑ØÂæàÁÆÄÂçï„ÄÇ ‰ΩøÁî®KVOÁõëÂê¨UIScrollViewÁöÑcontentSizeÂíåcontentOffset„ÄÇ Ê†πÊçÆcontentSizeÁ°ÆÂÆöFooterViewÁöÑ‰ΩçÁΩÆ„ÄÇ // ‰º™‰ª£Á†ÅHeaderView.y = -size.height;FooterView.y = contentSize.height; ËÆæÁΩÆUIScrollViewÁöÑcontentInsetÔºåÁªôÂç†‰ΩçËßÜÂõæËÖæÂá∫Á©∫Èó¥„ÄÇ Ê†πÊçÆcontentOffset.yÁ°ÆÂÆöÂΩìÂâçÂç†‰ΩçËßÜÂõæÊòØÂê¶ÂèØ‰ª•Ë∑üÁùÄÊªëÂä®„ÄÇ// ‰º™‰ª£Á†Åif (contentOffset.y + scrollView.height - scrollView.contentInset.bottom - scrollView.contentSize.height &gt;= 0) &#123; FooterView.y = contentOffset.y + scrollView.height - scrollView.contentInset.bottom;&#125; Â§ßËá¥Â∞±ÊòØËøôÊ†∑ÔºåÂâ©‰∏ãÁöÑÂ∞±ÊòØÊó∂Êú∫ÂíåÊé•Âè£‰∫Ü„ÄÇ Âú®didMoveToSuperview‰∏≠Ê∑ªÂä†KVOÔºåÂú®willMoveToSuperview‰∏≠ÁßªÈô§KVO„ÄÇ Ëøô‰∏§‰∏™ÊàêÂèåÊàêÂØπÔºå‰πãÊâÄ‰ª•‰∏çÊîæÂú®deallocÈáåÈù¢ÁßªÈô§ÔºåÊòØËÄÉËôëÂà∞ÊúâÂêå‰∏Ä‰∏™ËßÜÂõæË¢´didMoveToSuperviewÂ§öÊ¨°ÁöÑÊÉÖÂÜµ„ÄÇÂΩìÁÑ∂ÔºåËßÜÂõædeallocÁöÑÊó∂ÂÄôÊòØ‰ºöË∞ÉÁî®willMoveToSuperviewÊñπÊ≥ïÁöÑÔºåÂè™‰∏çËøáËøô‰∏™newSuperview‰∏∫Á©∫„ÄÇ ÁªôUIScrollViewÊ∑ªÂä†ÂÖ≥ËÅîÂ±ûÊÄß„ÄÇÊó†ÈúÄÂ§öË®ÄÔºåÊ≤°Êúâ‰æµÂÖ•ÊÄß„ÄÇ - (YAScrollHeaderView *)scrollHeaderView &#123; return objc_getAssociatedObject(self, @selector(scrollHeaderView));&#125;- (void)setScrollHeaderView:(YAScrollHeaderView *)scrollHeaderView &#123; if (scrollHeaderView == self.scrollHeaderView) return ; [self.scrollHeaderView removeFromSuperview]; [self addSubview:scrollHeaderView]; objc_setAssociatedObject(self, @selector(scrollHeaderView), scrollHeaderView, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125; ÁªìÊûÑËÆæËÆ° YAScrollHeaderViewÂíåYAScrollFooterViewÂùáÁªßÊâøËá™YAScrollPlaceView„ÄÇÔºàËøôÊòØÊ®°‰ªø‰∫ÜMJRefreshÔºâ„ÄÇÊ†∏ÂøÉÈÄªËæëÁªü‰∏ÄÂú®‰∏äÂ±ÇÂÆûÁé∞„ÄÇ YAScrollHeaderViewÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆËá™Â∑±scrollPlaceViewType‰∏∫YAScrollPlaceViewTypeHeader„ÄÇ YAScrollFooterViewÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆËá™Â∑±scrollPlaceViewType‰∏∫YAScrollPlaceViewTypeFooter„ÄÇËøôÊ†∑ÔºåYAScrollPlaceViewÂ∞±ÂèØ‰ª•Ê†πÊçÆÂ≠êÁ±ªÊù•Á°ÆÂÆöÂç†‰ΩçËßÜÂõæÁöÑÈÄªËæë„ÄÇ ‰∏â„ÄÅ‰ΩøÁî®Êö¥Èú≤Âá∫Êù•ÁöÑÊé•Âè£ÂæàÊ∏ÖÊô∞„ÄÇisFixedÁî®‰∫éËÆæÁΩÆÂç†‰ΩçËßÜÂõæÊòØÂê¶Âú®offsetË∂ÖÂá∫ÂèØËßÅÂå∫ÂüüÔºàËøáÂ§ßÊàñËÄÖËøáÂ∞èÔºâÊó∂Ë∑üÈöèÁùÄÊªëÂä®„ÄÇËøô‰∏™Âç†‰ΩçËßÜÂõæÂèØ‰ª•Âä®ÊÄÅÊòæÁ§∫ÊàñËÄÖÈöêËóèÔºåcanAnimateËÆæÁΩÆÂÖ∂Âä®ÁîªÊïàÊûúÔºåshowAnimationDurationÂíådismissAnimationDuration‰∏çÂøÖÂ§öËØ¥ÔºåÊòØÂä®ÁîªÊó∂Èó¥„ÄÇ @property (nonatomic, assign) BOOL isFixed; ///&lt; default NO.Fix the place view to the top or bottom.@property (nonatomic, assign) BOOL canAnimate; ///&lt; default YES.@property (nonatomic, assign) CGFloat height; ///&lt; default 0@property (nonatomic, assign, readonly) BOOL isVisible;; ///&lt; default NO.@property (nonatomic, assign) NSTimeInterval showAnimationDuration; ///&lt; default 0.15@property (nonatomic, assign) NSTimeInterval dismissAnimationDuration; ///&lt; default 0.15- (void)showWithCompletion:(YAScrollPlaceViewShowCompletion)completion;- (void)dismissWithCompletion:(YAScrollPlaceViewDismissCompletion)completion; ÁªôScrollViewËÆæÁΩÆÂç†‰ΩçÂõæÁâáUIImage *headerImage = [UIImage imageNamed:@"header"];YAScrollHeaderView *headerView = [YAScrollHeaderView scrollHeaderViewWithSize:CGSizeMake(self.view.bounds.size.width, 100) backgroundImage:headerImage];self.scrollView.scrollHeaderView = headerView; Â∑¶ÂõæÔºöÊï∞ÊçÆËæÉÂ§öÊó∂ÔºåËßÜÂõæÂõ∫ÂÆöÔºà‰πüÂèØ‰ª•ÈÖçÁΩÆ‰∏çÂõ∫ÂÆöÔºâÔºõÂè≥ÂõæÔºöÊï∞ÊçÆÊûÅÂ∞ëÊó∂ÔºåËßÜÂõæ‰∏çÂõ∫ÂÆö„ÄÅË∑üÁùÄÊªëÂä®Ôºà‰πüÂèØ‰ª•ÈÖçÁΩÆ‰∏∫Âõ∫ÂÆöÔºâ„ÄÇ ÁªôtableViewËÆæÁΩÆÁ©∫ÁôΩÂç†‰ΩçYAScrollFooterView *footerView = [YAScrollFooterView new];footerView.height = 100;footerView.isFixed = YES;self.tableView.scrollFooterView = footerView; Âä®ÊÄÅÂú∞ÊòæÁ§∫ÊàñËÄÖÈöêËóèself.tableView.scrollHeaderView = self.header;self.header.showAnimationDuration = 0.8f;self.header.dismissAnimationDuration = 0.8f;[self.header show];// [self.header dismissWithCompletion:nil]; Âõõ„ÄÅÊÄªÁªìÊï¥‰ΩìËÄåË®ÄÔºåÂÆûÁé∞Ëµ∑Êù•ËøòÊòØÊØîËæÉËΩªÊùæÁöÑÔºåÊ≤°ÊúâÂï•ÊûÅÂÖ∂Â§çÊùÇÁöÑÈÄªËæë„ÄÇ‰∏çËøá‰Ωú‰∏∫ÊàëÁöÑÁ¨¨‰∏Ä‰∏™ÂºÄÊ∫êFrameworkÔºåËøòÊå∫ÊúâÁ∫™ÂøµÊÑè‰πâÁöÑ„ÄÇÊúâ‰∏ÄÊñπÊúâ‰∫åÔºå‰∫åÁîü‰∏âÔºå‰∏âÁîü‰∏áÁâ©„ÄÇ ÂêéËÆ∞2018Âπ¥ÁßãÔºåÂ≠òÂú®‰∏§Âπ¥ÁöÑÁôæÂ∫¶ÁïÖÂê¨Ê≠£Âºè‰∏ãÁ∫ø„ÄÇÂñúÈ©¨ÊãâÈõÖ„ÄÅÊáí‰∫∫Âê¨‰π¶ÔºåËøòÊ¥ªÁùÄ„ÄÇ2019Âπ¥8ÊúàÔºåÊï¥ÁêÜÂçöÂÆ¢Êó∂ÔºåÂÆåÂñÑÊñáÁ´†ÂÜÖÂÆπÂπ∂‰øÆÂ§çÊ°ÜÊû∂ÁöÑbug„ÄÇ]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÂºÄÊ∫êÈ°πÁõÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êü•ÊâæÁÆóÊ≥ïÊÄªÁªì]]></title>
    <url>%2F2017%2F04%2F21%2F%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫éÊü•ÊâæÁÆóÊ≥ï„ÄÇ ÂâçË®Ä Êú¨Êñá‚ÄùÂÆåÂÖ®‰∫åÂèâÊ†ë‚ÄùÁöÑÂÆö‰πâÈááÁî®ÂõΩÂÜÖÂÆö‰πâB-Ê†ë Âç≥ BÊ†ë,‰∏§ËÄÖÊòØÁõ∏ÂêåÊ¶ÇÂøµ,ËÄåÈùûÊåá‰∫åÂèâÊêúÁ¥¢Ê†ë(ÁôæÂ∫¶ÁôæÁßë) ‰∫âËÆÆ1.ÂõΩÂÜÖÊó©ÊúüÊïôÊùê‰∏≠ÔºåÊª°‰∫åÂèâÊ†ë‰∏ÄËà¨Êåá perfect binary treeÔºåÊâÄ‰ª•‰ºöÊúâÊª°‰∫åÂèâÊ†ëÊòØÂÆåÂÖ®‰∫åÂèâÊ†ëÁöÑ‰∏Ä‰∏™Áâπ‰æãÁöÑËØ¥Ê≥ï. 2.Ê†ëÁöÑÊ∑±Â∫¶ÁöÑÂÆö‰πâÔºåÊúâÁöÑÊ†πÁªìÁÇπ‰ªé0ÂºÄÂßãËÆ°Êï∞ÔºåÊúâÁöÑ‰ªé1ÂºÄÂßãËÆ°Êï∞. 3.ÁªìÁÇπ ‰∏é ËäÇÁÇπ ÊòØÂØπNodeÁöÑÁøªËØë,ÂèØ‰ª•ÁúãÂÅöÁ≠âÂêå. Áª¥Âü∫ÁôæÁßëÂÆö‰πâ1.Ê†π‰∫åÂèâÊ†ë(Rooted Binary Tree)ÔºöÊúâ‰∏Ä‰∏™Ê†πÁªìÁÇπÔºåÊØè‰∏™ÁªìÁÇπËá≥Â§öÊúâ‰∏§‰∏™Â≠©Â≠ê„ÄÇ 2.Êª°‰∫åÂèâÊ†ë(Full Binary Tree)ÔºöË¶Å‰πàÊòØÂè∂Â≠êÁªìÁÇπ(ÁªìÁÇπÁöÑÂ∫¶‰∏∫0)ÔºåË¶Å‰πàÁªìÁÇπÂêåÊó∂ÂÖ∑ÊúâÂ∑¶Âè≥Â≠êÊ†ë(ÁªìÁÇπÁöÑÂ∫¶‰∏∫2)„ÄÇ 3.ÂÆåÂÖ®‰∫åÂèâÊ†ë(Complete Binary Tree)ÔºöÊØèÂ±ÇÁªìÁÇπÈÉΩÂÆåÂÖ®Â°´Êª°ÔºåÂú®ÊúÄÂêé‰∏ÄÂ±Ç‰∏äÂ¶ÇÊûú‰∏çÊòØÊª°ÁöÑÔºåÂàôÂè™Áº∫Â∞ëÂè≥ËæπÁöÑËã•Âπ≤ÁªìÁÇπ„ÄÇ 4.ÂÆåÁæé‰∫åÂèâÊ†ë(Perfect Binary Tree)ÊâÄÊúâÁöÑÈùûÂè∂Â≠êÁªìÁÇπÈÉΩÊúâ‰∏§‰∏™Â≠©Â≠êÔºåÊâÄÊúâÁöÑÂè∂Â≠êÁªìÁÇπÈÉΩÂú®Âêå‰∏ÄÂ±Ç„ÄÇÂç≥ÊØèÂ±ÇÁªìÁÇπÈÉΩÂÆåÂÖ®Â°´Êª°„ÄÇ 5.Êó†ÈôêÂÆåÂÖ®‰∫åÂèâÊ†ë(Infinite Complete Binary Tree)Ôºö ÊØè‰∏™ÁªìÁÇπÈÉΩÊúâ‰∏§‰∏™Â≠©Â≠êÔºåÁªìÁÇπÁöÑÂ±ÇÊï∞ÊòØÊó†ÈôêÁöÑ„ÄÇ 6.Âπ≥Ë°°‰∫åÂèâÊ†ë(Balanced Binary Tree)Ôºö‰πüÁß∞‰∏∫AVLÊ†ëÔºåÂÆÉÊòØ‰∏ÄÊ£µÁ©∫Ê†ëÊàñÂÆÉÁöÑÂ∑¶Âè≥‰∏§‰∏™Â≠êÊ†ëÁöÑÈ´òÂ∫¶Â∑ÆÁöÑÁªùÂØπÂÄº‰∏çË∂ÖËøá1ÔºåÂπ∂‰∏îÂ∑¶Âè≥‰∏§‰∏™Â≠êÊ†ëÈÉΩÊòØ‰∏ÄÊ£µÂπ≥Ë°°‰∫åÂèâÊ†ë„ÄÇ Êª°‰∫åÂèâÊ†ë(Full Binary Tree)Â¶ÇÊûú‰∏ÄÊ£µ‰∫åÂèâÊ†ëÁöÑÁªìÁÇπË¶Å‰πàÊòØÂè∂Â≠êË¶Å‰πàÊúâ‰∏§‰∏™Â≠©Â≠êÁªìÁÇπ,Âàô‰∏∫Êª°‰∫åÂèâÊ†ë ÊÄßË¥®:1.ÊÄªÁªìÁÇπ‰∏™Êï∞ÂëàÁé∞‰∏™Êï∞‰∏∫:0 1 3 7 15‚Ä¶Êª°Ë∂≥2^(n) -1,ÂÖ∂‰∏≠n‰∏∫Ê†ëÁöÑÊ∑±Â∫¶(ÊúÄÂ§ßÂ±Ç) 2.Á¨¨kÂ±Ç(k‰∏ç‰∏∫0)ÁªìÁÇπ‰∏™Êï∞:1 2 4 8‚Ä¶Êª°Ë∂≥2^(k - 1) 3.Êª°‰∫åÂèâÊ†ëÊòØÂÆåÂÖ®‰∫åÂèâÊ†ë ÂÆåÂÖ®‰∫åÂèâÊ†ë(Complete Binary Tree)Ëã•ËÆæ‰∫åÂèâÊ†ëÁöÑÊ∑±Â∫¶‰∏∫hÔºåÈô§Á¨¨ h Â±ÇÂ§ñÔºåÂÖ∂ÂÆÉÂêÑÂ±Ç (1ÔΩûh-1) ÁöÑÁªìÁÇπÊï∞ÈÉΩËææÂà∞ÊúÄÂ§ß‰∏™Êï∞ÔºåÁ¨¨ h Â±ÇÊâÄÊúâÁöÑÁªìÁÇπÈÉΩËøûÁª≠ÈõÜ‰∏≠Âú®ÊúÄÂ∑¶ËæπÔºåËøôÂ∞±ÊòØÂÆåÂÖ®‰∫åÂèâÊ†ë„ÄÇ ÊÄßË¥®:ÂÆåÂÖ®‰∫åÂèâÊ†ë‰∏≠Â∫¶‰∏∫1ÁöÑÁªìÁÇπÊï∞Âè™Êúâ‰∏§ÁßçÂèØËÉΩ0Êàñ1,ÈÇ£‰πà:ÊÄªÁªìÁÇπÊï∞‰∏∫n,Êúâ n0=n/2 Êàñ n0=(n+1)/2 Â≠òÂÇ®È°∫Â∫èÂ≠òÂÇ®ÁöÑÊéíÂ∫èÊï∞ÁªÑÊèíÂÖ•ÂíåÂà†Èô§ÁöÑÊó∂ÂÄôÊó∂Èó¥Â§çÊùÇÂ∫¶ËææÂà∞O(n),È°∫Â∫èÂ≠òÂÇ®ÁªìÊûÑ‰∏çÈÄÇ‰∫éÂä®ÊÄÅÁöÑÊÉÖÂÜµ ÈìæÂºèÂ≠òÂÇ®ÈìæË°®ÁöÑÊü•ÊâæÈúÄË¶ÅO(n) Êü•ÊâæÊü•ÊâæË°®:Áî±Âêå‰∏ÄÁ±ªÂûãÁöÑÊï∞ÊçÆÂÖÉÁ¥†ÊûÑÊàêÁöÑÈõÜÂêà.ÂÖ≥ÈîÆÂ≠ó:Êï∞ÊçÆÂÖÉÁ¥†‰∏≠Êüê‰∏™Êï∞ÊçÆÈ°πÁöÑÂÄº.‰∏ªÂÖ≥ÈîÆÂ≠ó:ÂèØ‰ª•ÂîØ‰∏ÄÂú∞Ê†áËØÜ‰∏Ä‰∏™ËÆ∞ÂΩï.Ê¨°ÂÖ≥ÈîÆÂ≠ó:ÂèØ‰ª•ËØÜÂà´Â§ö‰∏™Êï∞ÊçÆÂÖÉÁ¥†.Êü•Êâæ:Ê†πÊçÆÁªôÂÆöÁöÑÊüê‰∏™ÂÄº,Âú®Êü•ÊâæË°®‰∏≠Á°ÆÂÆö‰∏Ä‰∏™ÂÖ∂ÂÖ≥ÈîÆÂ≠óÁ≠â‰∫éÁªôÂÆöÂÄºÁöÑÊï∞ÊçÆÂÖÉÁ¥†(ÊàñËÆ∞ÂΩï).ÈùôÊÄÅÊü•ÊâæË°®:Âè™‰ΩúÊü•ÊâæÊìç‰ΩúÁöÑÊü•ÊâæË°®.Âä®ÊÄÅÊü•ÊâæË°®:Âú®Êü•ÊâæËøáÁ®ã‰∏≠ÂêåÊó∂ÊèíÂÖ•Êü•ÊâæË°®‰∏≠‰∏çÂ≠òÂú®ÁöÑÊï∞ÊçÆÂÖÉÁ¥†,ÊàñËÄÖ‰ªéÊü•ÊâæË°®‰∏≠Âà†Èô§Â∑≤ÁªèÂ≠òÂú®ÁöÑÊüê‰∏™Êï∞ÊçÆÂÖÉÁ¥†. È°∫Â∫èË°®Êü•ÊâæÈ°∫Â∫èÊü•Êâæ(Á∫øÊÄßÊü•Êâæ):‰ªéË°®‰∏≠Á¨¨‰∏Ä‰∏™ËÆ∞ÂΩïÂºÄÂßã,ÈÄê‰∏™ËøõË°åËÆ∞ÂΩïÁöÑÂÖ≥ÈîÆÂ≠óÂíåÁªôÂÆöÂÄºÁöÑÊØîËæÉ. # È°∫Â∫èÊü•ÊâæÁöÑÂÆûÁé∞def sequentialSearch(key, numbers): length = len(numbers) for i in xrange(length): # Êü•ÊâæÊàêÂäüËøîÂõûÁ¥¢Âºï if key == numbers[i]: return i # Êü•ÊâæÂ§±Ë¥•ËøîÂõû-1 return -1 ÊúÄÂ•ΩÊÉÖÂÜµ:Âú®Á¨¨‰∏Ä‰∏™‰ΩçÁΩÆÊâæÂà∞,Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(1)ÊúÄÂùèÊÉÖÂÜµ:Âú®ÊúÄÂêé‰∏Ä‰∏™‰ΩçÁΩÆÊâæÂà∞,Êó∂Èó¥Â§çÊùÇÂ∫¶O(n)Êü•Êâæ‰∏çÊàêÂäü:Êó∂Èó¥Â§çÊùÇÂ∫¶O(n)Âπ≥ÂùáÊü•ÊâæÊ¨°Êï∞:(n+1)/2Âπ≥ÂùáÊó∂Èó¥Â§çÊùÇÂ∫¶:O(n) ÊúâÂ∫èË°®Êü•Êâæ1.‰∫åÂàÜÊü•Êâæ ÊäòÂçäÊü•Êâæ(‰∫åÂàÜÊü•Êâæ):Âú®Á∫øÊÄßË°®‰∏≠ÁöÑËÆ∞ÂΩïÊúâÂ∫èÁöÑÂâçÊèê‰∏ãËøõË°åÊü•Êâæ.Âèñ‰∏≠Èó¥ÂÖÉÁ¥†‰Ωú‰∏∫ÊØîËæÉÂØπË±°,Ëã•ÁªôÂÆöÂÄº‰∏é‰∏≠Èó¥ÂÖÉÁ¥†Áõ∏Á≠â,ÂàôÊü•ÊâæÊàêÂäü,Ëã•ÁªôÂÆöÂÄºÂ∞è‰∫é‰∏≠Èó¥ÂÖÉÁ¥†,ÂàôÂú®‰∏≠Èó¥ÂÖÉÁ¥†ÁöÑÂ∑¶ÂçäÂå∫ÁªßÁª≠Êü•Êâæ,Ëã•ÁªôÂÆöÂÄºÂ§ß‰∫é‰∏≠Èó¥ÂÖÉÁ¥†,ÂàôÂú®‰∏≠Èó¥ÂÖÉÁ¥†ÁöÑÂè≥ÂçäÂå∫ÁªßÁª≠Êü•Êâæ,‰∏çÊñ≠ÈáçÂ§çÊü•ÊâæËøáÁ®ã,Áõ¥Âà∞Êü•ÊâæÊàêÂäü,ÊàñÊü•ÊâæÂ§±Ë¥•. # ‰∫åÂàÜÊü•ÊâæÁöÑÂÆûÁé∞def binarySearch(key, numbers): # Â∑¶ËæπÁïå low = 0 # Âè≥ËæπÁïå high = len(numbers) - 1 while low &lt;= high: # ‰∏≠Èó¥ÂÖÉÁ¥†Á¥¢Âºï mid = (low + high) / 2 # Êü•ÊâæÊàêÂäü if numbers[mid] == key: return mid # Âú®Â∑¶Âå∫Èó¥ if numbers[mid] &gt; key: high = mid - 1 # Âú®Âè≥Âå∫Èó¥ if numbers[mid] &lt; key: low = mid + 1 # Êü•ÊâæÂ§±Ë¥•ËøîÂõû-1 return -1 ÊúÄÂ•ΩÊÉÖÂÜµ:ÊòØ‰∏≠Èó¥ÂÖÉÁ¥†,‰∏ÄÊ¨°Âç≥ÂèØÊâæÂà∞,Êó∂Èó¥Â§çÊùÇÂ∫¶O(1)ÊúÄÂùèÊÉÖÂÜµ:ÂÆåÂÖ®‰∫åÂèâÊ†ëÁöÑÊ∑±Â∫¶Âä†1,Âç≥floor(logn) + 1Ê¨°,Êó∂Èó¥Â§çÊùÇÂ∫¶O(logn).(Ê≥®ÊÑè:lognËøôÈáåÊåá‰ª•2‰∏∫Â∫ï,floorË°®Á§∫Âêë‰∏ãÂèñÊï¥) 2.ÊèíÂÄºÊü•Êâæ‰∫åÂàÜÊü•ÊâæÁöÑ‰ºòÂåñÁâà,Ê†∏ÂøÉÊòØÊèíÂÄºÂÖ¨Âºè:(key - numbers[low]) / (numbers[high] - numbers[low]) Ê†∏ÂøÉ‰ª£Á†Å: // ÊèíÂÄºmid = low + (high - low) * (key - numbers[low]) / (numbers[high] - numbers[low]) # ÊèíÂÄºÊü•ÊâæÁöÑÂÆûÁé∞def interpolationSearch(key, numbers): # Â∑¶ËæπÁïå low = 0 # Âè≥ËæπÁïå high = len(numbers) - 1 while low &lt;= high: # Ê†∏ÂøÉ‰ª£Á†Å mid = low + (high - low) * (key - numbers[low]) / (numbers[high] - numbers[low]) # Êü•ÊâæÊàêÂäü if numbers[mid] == key: return mid # Âú®Â∑¶Âå∫Èó¥ if numbers[mid] &gt; key: high = mid - 1 # Âú®Âè≥Âå∫Èó¥ if numbers[mid] &lt; key: low = mid + 1 # Êü•ÊâæÂ§±Ë¥•ËøîÂõû-1 return -1 ‰ªéÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏ä,‰æùÁÑ∂ÊòØO(logn),‰ΩÜÊòØÂØπ‰∫éË°®ÈïøËæÉÂ§ß,ÂÖ≥ÈîÆÂ≠óÂàÜÂ∏ÉÊØîËæÉÂùáÂåÄÁöÑÊü•ÊâæË°®,ÊÄßËÉΩÁõ∏ÂØπ‰∫åÂàÜÊü•ÊâæÊõ¥Â•Ω.‰ΩÜÊòØ,ÂàÜÂ∏ÉÊûÅ‰∏çÂùáÂåÄÁöÑÊï∞ÊçÆ,‰∏çÊòØÂæàÂêàÈÄÇ,ÊØîÂ¶Ç[1,2,4,3000,3003‚Ä¶9988899,8988998] ÊèíÂÄºÊü•ÊâæÂú®ÂÆûÈôÖ‰ΩøÁî®Êó∂Ôºå‰∏ÄËà¨Ë¶ÅÊª°Ë∂≥‰∏§‰∏™ÂÅáËÆæÊù°‰ª∂Ôºö (1)ÊØè‰∏ÄÊ¨°ÂØπÊï∞ÊçÆÁöÑËÆøÈóÆ‰∏éÈÄöÂ∏∏ÁöÑÊåá‰ª§Áõ∏ÊØîÔºåË¥πÁî®ÈÉΩÊòØÁõ∏ÂΩìÊòÇË¥µÁöÑ„ÄÇ‰æãÂ¶ÇÔºåÂæÖÊü•ÊâæÁöÑË°®‰∏ÄÂÆöÊòØÂú®Á£ÅÁõòËÄåÈùûÂÜÖÂ≠ò‰∏≠ÔºåÂõ†ËÄåÊØè‰∏ÄÊ¨°ÊØîËæÉÈÉΩË¶ÅËøõË°åÁ£ÅÁõòËÆøÈóÆ„ÄÇ (2)Êï∞ÊçÆ‰∏ç‰ªÖÊòØÂ∑≤Ë¢´ÊéíÂ•ΩÂ∫èÁöÑÔºåËÄå‰∏îÂëàÁé∞ÂùáÂåÄÂàÜÂ∏ÉÁâπÂæÅ„ÄÇ 3.ÊñêÊ≥¢ÈÇ£Â•ëÊü•ÊâæÂà©Áî®ÈªÑÈáëÂàÜÂâ≤ÂéüÁêÜÂÆûÁé∞,ÊäòÂçäÊü•ÊâæÁÆóÊ≥ïÊù•ËøõË°å‰øÆÊîπÂíåÊîπËøõ.ÂØπ‰∫éÊñêÊ≥¢ÈÇ£Â•ëÊï∞Âàó,ÂâçÂêé‰∏§‰∏™Êï∞Â≠óÁöÑÊØîÂÄºÈöèÁùÄÊï∞ÂàóÁöÑÂ¢ûÂä†,Ë∂äÊù•Ë∂äÊé•ËøëÈªÑÈáëÊØîÂÄº:0.618 0.01.00.50.6666666666670.60.6250.6153846153850.6190476190480.6176470588240.6181818181820.617977528090.6180555555560.6180257510730.6180371352790.6180327868850.6180344478220.61803381340.6180340557280.6180339631670.618033998522...... ÂØπ‰∫éÊñêÊ≥¢ÈÇ£Â•ëÊï∞Âàó:0 1 1 2 3 5 8 13 21 34 55 89 ‚Ä¶ ÂéüÁêÜ:ÊØîÂ¶ÇËøôÈáåÁöÑ89ÔºåÂÅáÂÆöÂÆÉÊòØÊï¥‰∏™ÊúâÂ∫èË°®ÁöÑÂÖÉÁ¥†‰∏™Êï∞ÔºåËÄå89ÊòØÁî±ÂâçÈù¢ÁöÑ‰∏§‰∏™Êï∞34Âíå55Áõ∏Âä†‰πãÂêéÁöÑÂíåÔºå‰πüÂç≥ÊääÂÖÉÁ¥†‰∏™Êï∞‰∏∫89ÁöÑÊúâÂ∫èË°®ÂàÜÊàêÁî±Ââç55‰∏™Êï∞ÊçÆÂÖÉÁ¥†ÁªÑÊàêÁöÑÂâçÂçäÊÆµÂíåÁî±Âêé34‰∏™Êï∞ÊçÆÂÖÉÁ¥†ÁªÑÊàêÁöÑÂêéÂçäÊÆµÔºåÈÇ£‰πàÂâçÂçäÊÆµÂÖÉÁ¥†‰∏™Êï∞ÂíåÊï¥‰∏™ÊúâÂ∫èË°®ÈïøÂ∫¶ÁöÑÊØîÂÄºÂ∞±Êé•ËøëÈªÑÈáëÊØîÂÄº0.618ÔºåÂÅáÂ¶ÇË¶ÅÊü•ÊâæÁöÑÂÖÉÁ¥†Âú®ÂâçÂçäÊÆµÔºåÈÇ£‰πàÁªßÁª≠ÊåâÁÖßÊñêÊ≥¢ÈÇ£Â•ëÊï∞ÂàóÊù•ÁúãÔºå55 = 34 + 21ÔºåÊâÄ‰ª•ÁªßÁª≠ÊääÂâçÂçäÊÆµÂàÜÊàêÂâç34‰∏™Êï∞ÊçÆÂÖÉÁ¥†ÁöÑÂâçÂçäÊÆµÂíåÂêé21‰∏™ÂÖÉÁ¥†ÁöÑÂêéÂçäÊÆµÔºåÁªßÁª≠Êü•ÊâæÔºåÂ¶ÇÊ≠§ÂèçÂ§çÔºåÁõ¥Âà∞Êü•ÊâæÊàêÂäüÊàñÂ§±Ë¥•. ÂΩìÊúâÂ∫èË°®ÁöÑÂÖÉÁ¥†‰∏™Êï∞‰∏çÊòØÊñêÊ≥¢ÈÇ£Â•ëÊï∞Âàó‰∏≠ÁöÑÊüê‰∏™Êï∞Â≠óÊó∂ÔºåÈúÄË¶ÅÊääÊúâÂ∫èË°®ÁöÑÂÖÉÁ¥†‰∏™Êï∞ÈïøÂ∫¶Ë°•ÈΩêÔºåËÆ©ÂÆÉÊàê‰∏∫ÊñêÊ≥¢ÈÇ£Â•ëÊï∞Âàó‰∏≠ÁöÑ‰∏Ä‰∏™Êï∞ÂÄº,‰πüÂç≥ÊääÈúÄË¶ÅË°•ÈΩêÁöÑÁöÑÂÖÉÁ¥†ÈÉΩËµãÂÄº‰∏∫ÊúâÂ∫èË°®ÁöÑÊúÄÂ§ßÂÄº„ÄÇ Ê†∏ÂøÉ:(1)ÂΩìkey == numbers[mid],Êü•ÊâæÊàêÂäü(2)ÂΩìkey &lt; numbers[mid],Êñ∞ËåÉÂõ¥ÊòØÁ¨¨low‰∏™Âà∞Á¨¨mid-1‰∏™,ËåÉÂõ¥‰∏™Êï∞ÊòØF(k-1) - 1‰∏™,Âç≥ÊúâÂ∫èÂàóË°®Â∑¶ËæπÁöÑÈïøÂ∫¶(3)ÂΩìkey &gt; numbers[mid]Êó∂,Êñ∞ËåÉÂõ¥ÊòØÁ¨¨mid+1Âà∞Á¨¨high‰∏™,ËåÉÂõ¥‰∏™Êï∞ÊòØF(k-2) - 1‰∏™,Âç≥ÊúâÂ∫èÂàóË°®Âè≥ËæπÁöÑÈïøÂ∫¶ k Ë°®Á§∫ÂàóË°®ÁöÑÈïøÂ∫¶k-1Ë°®Á§∫Á¥¢ÂºïF(k-1)Ë°®Á§∫ÂàóË°®ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥† ÂÖÉÁ¥†ÊÄª‰∏™Êï∞ = Â∑¶Âå∫Èó¥‰∏™Êï∞ + Âè≥Âå∫Èó¥‰∏™Êï∞ + ‰∏≠Èó¥ÁöÑ‰∏Ä‰∏™ÂÖÉÁ¥†,Âç≥: F(k)-1 = F(k-1)-1 + F(k-2)-1 + 1 ÊñêÊ≥¢ÈÇ£Â•ëÊü•ÊâæÁÆóÊ≥ïÂ¶Ç‰∏ãÔºö # ÊñêÊ≥¢ÈÇ£Â•ëÊü•Êâædef Fbonacci(index): if index &lt; 0: return a, b = 0, 1 for i in range(index): a, b = b, a + b return a def FbonacciSearch(key, numbers): # Á°ÆÂÆöËØ•Â∫èÂàóÂú®ÊñêÊ≥¢ÈÇ£Â•ëÊï∞Âàó‰∏≠ÁöÑ‰ΩçÁΩÆ n, length = 0, len(numbers) while length &gt; Fbonacci(n) - 1: n += 1 # Â°´Êª°ÂÖÉÁ¥† for i in xrange(n,Fbonacci(n)): numbers.append(numbers[-1]) low, high = 0, n - 1 while low &lt;= high: # Ëé∑ÂèñÈªÑÈáëÂàÜÂâ≤‰∏ãÊ†á mid = low + Fbonacci(n - 1) - 1 # Â∑¶Âå∫Èó¥ #Ëã•keyÊØîËøô‰∏™ÂÖÉÁ¥†Â∞è,ÂàôkeyÂÄºÂ∫îËØ•Âú®lowËá≥mid-1‰πãÈó¥ÔºåÂâ©‰∏ãÁöÑËåÉÂõ¥‰∏™Êï∞‰∏∫F(k-1)-1 if key &lt; numbers[mid]: high = mid - 1 n -= 1 # Âè≥Âå∫Èó¥ #Ëã•keyÊØîËøô‰∏™ÂÖÉÁ¥†Â∞è,ÂàôkeyÂÄºÂ∫îËØ•Âú®lowËá≥mid-1‰πãÈó¥ÔºåÂâ©‰∏ãÁöÑËåÉÂõ¥‰∏™Êï∞‰∏∫F(k-1)-1 if key &gt; numbers[mid]: low = mid + 1 n -= 2 # Áõ∏Á≠â else: # ÊàêÂäüÊâæÂà∞ if mid &lt;= n: return mid # Ë°•ÂÖ®ÁöÑÊï∞,ËøîÂõûn else: return n return -1 4.ÊØîËæÉ‰∫åÂàÜÊü•ÊâæÊòØÂä†Ê≥ï‰∏éÈô§Ê≥ïËøêÁÆóÊèíÂÄºÊü•ÊâæÊòØÂ§çÊùÇÁöÑÂõõÂàôËøêÁÆóÊñêÊ≥¢ÈÇ£Â•ëÊü•ÊâæÊòØÂä†ÂáèÊ≥ïËøêÁÆó Á∫øÊÄßÁ¥¢ÂºïÊü•ÊâæÁ¥¢Âºï:Êää‰∏Ä‰∏™ÂÖ≥ÈîÆÂ≠ó‰∏éÂÆÉÂØπÂ∫îÁöÑËÆ∞ÂΩïÁõ∏ÂÖ≥ËÅîÁöÑËøáÁ®ã.Á∫øÊÄßÁ¥¢Âºï:ÊääÁ¥¢ÂºïÈ°πÈõÜÂêàÁªÑÁªá‰∏∫Á∫øÊÄßÁªìÊûÑ,‰πüÂç≥Á¥¢ÂºïË°® 1.Á®†ÂØÜÁ¥¢ÂºïÁ®†ÂØÜÁ¥¢Âºï:Â∞ÜÊï∞ÊçÆÈõÜÁöÑÊØè‰∏™ËÆ∞ÂΩïÂØπÂ∫î‰∏Ä‰∏™Á¥¢ÂºïÈ°π,‰∏îÁ¥¢ÂºïÈ°π‰∏ÄÂÆöÊåâÁÖßÂÖ≥ÈîÆÁ†ÅÊúâÂ∫èÊéíÂàó. 2.ÂàÜÂùóÁ¥¢ÂºïÂØπÊï∞ÊçÆÈõÜËøõË°åÂàÜÂùó,‰ΩøÂàÜÂùóÊúâÂ∫è,ÁÑ∂ÂêéÂØπÊØè‰∏ÄÂùóÂª∫Á´ã‰∏Ä‰∏™Á¥¢ÂºïÈ°π,‰ªéËÄåÂáèÂ∞ëÁ¥¢ÂºïÈ°πÁöÑ‰∏™Êï∞. ÂùóÈúÄË¶ÅÊª°Ë∂≥ÁöÑÊù°‰ª∂:(1)ÂùóÂÜÖÊó†Â∫è:ÊØè‰∏ÄÂùóÁöÑËÆ∞ÂΩï‰∏çË¶ÅÊ±ÇÊúâÂ∫è.(2)ÂùóÈó¥ÊúâÂ∫è:ÊØîÂ¶Ç,Ë¶ÅÊ±ÇÁ¨¨‰∫åÂùóÊâÄÊúâËÆ∞ÂΩïÁöÑÂÖ≥ÈîÆÂ≠óÂùáË¶ÅÂ§ß‰∫éÁ¨¨‰∏ÄÂùóÊâÄÊúâËÆ∞ÂΩïÁöÑÂÖ≥ÈîÆÂ≠ó.Á¨¨‰∏âÂùóÂ§ß‰∫éÁ¨¨‰∫åÂùó‚Ä¶ ÂàÜÂùóÁ¥¢ÂºïÁöÑÁ¥¢ÂºïÈ°πÁªìÊûÑ: ÊúÄÂ§ßÂÖ≥ÈîÆÁ†Å:Â≠òÂÇ®ÊØè‰∏ÄÂùó‰∏≠ÁÇπÊúÄÂ§ßÂÖ≥ÈîÆÂ≠ó Â≠òÂÇ®Âùó‰∏≠ËÆ∞ÂΩïÁöÑ‰∏™Êï∞,‰æø‰∫éÂæ™ÁéØ Áî®‰∫éÊåáÂêëÂùóÈ¶ñÊï∞ÊçÆÂÖÉÁ¥†ÁöÑÊåáÈíà,‰æø‰∫éÈÅçÂéÜ Êü•ÊâæÂàÜ‰∏§Ê≠•:(1)Âú®ÂàÜÂùóÁ¥¢ÂºïË°®‰∏≠Êü•ÊâæÂÖ≥ÈîÆÂ≠óÊâÄÂú®ÁöÑÂùó.(2)Ê†πÊçÆÂùóÈ¶ñÊåáÈíàÊâæÂà∞Áõ∏Â∫îÁöÑÂùó,Âπ∂Âú®Âùó‰∏≠È°∫Â∫èÊü•ÊâæÂÖ≥ÈîÆÁ†Å. ËÆæn‰∏™ËÆ∞ÂΩïË¢´Âπ≥ÂùáÂàÜÊàêmÂùó,ÊØè‰∏™ÂùótÊù°ËÆ∞ÂΩï,Âàôn=mtÊü•ÊâæÁ¥¢ÂºïË°®ÁöÑÂπ≥ÂùáÊü•ÊâæÈïøÂ∫¶:(1+m)/2Êü•ÊâæËÆ∞ÂΩïÁöÑÂπ≥ÂùáÊü•ÊâæÈïøÂ∫¶:(t+1)/2 ÂàôÂùó‰∏≠Êü•ÊâæËÆ∞ÂΩïÁöÑÂπ≥ÂùáÊü•ÊâæÈïøÂ∫¶: (1+m)/2 + (t+1)/2 = (m+t)/2+1 = (n/t+t)/2+1 ÊúÄ‰Ω≥ÊÉÖÂÜµ:m‰∏étÁõ∏Á≠â,‰πüÂç≥n = t^2 = m^2 ,ÂàôÂéüÂºè‰∏∫: = (t*t/t+t)/2+1 = t+1 = n^0.5 + 1 (^ Ë°®Á§∫Ê¨°Êñπ) Áî±Ê≠§ÂàÜÂùóÁ¥¢ÂºïÊØîÈ°∫Â∫èÊü•ÊâæO(n)ÊèêÈ´ò‰∏çÂ∞ë. 3.ÂÄíÊéíÁ¥¢ÂºïÁ¥¢ÂºïÈ°πÁöÑÁªìÊûÑ:Ê¨°ÂÖ≥ÈîÆÁ†Å‰∏éËÆ∞ÂΩïÂè∑Ë°®Ê†πÊçÆÂ±ûÊÄß(Ê¨°ÂÖ≥ÈîÆÁ†Å,Â≠óÊÆµ)ÁöÑÂÄºÊü•ÊâæËÆ∞ÂΩï.ËØ•Á¥¢ÂºïË°®‰∏≠ÁöÑÊØè‰∏ÄÈ°πÂåÖÊã¨‰∏Ä‰∏™Â±ûÊÄßÂÄºÂíåÂÖ∑ÊúâËØ•Â±ûÊÄßÂÄºÁöÑÂêÑËÆ∞ÂΩïÁöÑÂú∞ÂùÄ.Áî±‰∫é‰∏çÊòØÁî±ËÆ∞ÂΩïÁ°ÆÂÆöÂ±ûÊÄßÂÄºËÄåÊòØÁî±Â±ûÊÄßÂÄºÁ°ÆÂÆöËÆ∞ÂΩï,Âõ†ËÄåÁß∞‰∏∫ÂÄíÊéíÁ¥¢Âºï. ‰ºòÁÇπ:ÁîüÊàêÁ¥¢ÂºïË°®Âêé‰∏çÁî®ËØªÂèñËÆ∞ÂΩïÂ∞±ÂèØÁü•ÈÅìÁªìÊûú,Êü•ÊâæÈùûÂ∏∏Âø´Áº∫ÁÇπ:ËÆ∞ÂΩïÂè∑‰∏çÂÆöÈïø ‰∫åÂèâÊêúÁ¥¢Ê†ëÂ¶ÇÊûúÊü•ÊâæÁöÑÊï∞ÊçÆÈõÜÊòØÊúâÂ∫èÁ∫øÊÄßË°®,Âπ∂‰∏îÊòØÈ°∫Â∫èÂ≠òÂÇ®ÁöÑ,ÂèØ‰ª•‰ΩøÁî®‰∫åÂàÜÊü•Êâæ/ÊèíÂÄºÊü•Êâæ/ÊñêÊ≥¢ÈÇ£Â•ëÊü•Êâæ,‰ΩÜÊòØÂú®ÊèíÂÖ•Âà†Èô§Êìç‰Ωú‰∏äËÄóË¥πÂ§ßÈáèÊó∂Èó¥,Áî±Ê≠§ÂºïÂá∫Êó¢ÂèØ‰ª•‰ΩøÂæóÊèíÂÖ•Âà†Èô§ÊïàÁéá‰∏çÈîôÂèàÂèØ‰ª•È´òÊïàÁéáÊü•ÊâæÁöÑÁÆóÊ≥ï====&gt;‰ΩøÁî®‰∫åÂèâÊ†ëÊï∞ÊçÆÁªìÊûÑ:Âú®ÂàõÂª∫ÈõÜÂêàÊó∂Â∞±ËÄÉËôë‰ΩøÁî®‰∫åÂèâÊ†ëÁªìÊûú,ËÄå‰∏îÊòØÊéíÂ•ΩÂ∫èÁöÑ‰∫åÂèâÊ†ë.ÊûÑÈÄ†‰∫åÂèâÊêúÁ¥¢Ê†ëÁöÑÁõÆÁöÑ‰∏çÊòØ‰∏∫‰∫ÜÊéíÂ∫è,ËÄåÊòØ‰∏∫‰∫ÜÊèêÈ´òÊèíÂÖ•/Âà†Èô§ÁöÑÊïàÁéá. ‰∫åÂèâÊü•ÊâæÊ†ë,‰πüÁß∞(‰∫åÂèâÊêúÁ¥¢Ê†ë,ÊúâÂ∫è‰∫åÂèâÊ†ë,ÊéíÂ∫è‰∫åÂèâÊ†ë,‰∫åÂèâÊéíÂ∫èÊ†ëÔºâ,ÊòØÊåá‰∏ÄÊ£µÁ©∫Ê†ëÊàñËÄÖÂÖ∑Êúâ‰∏ãÂàóÊÄßË¥®ÁöÑ‰∫åÂèâÊ†ëÔºö Ëã•‰ªªÊÑèËäÇÁÇπÁöÑÂ∑¶Â≠êÊ†ë‰∏çÁ©∫ÔºåÂàôÂ∑¶Â≠êÊ†ë‰∏äÊâÄÊúâÁªìÁÇπÁöÑÂÄºÂùáÂ∞è‰∫éÂÆÉÁöÑÊ†πÁªìÁÇπÁöÑÂÄºÔºõ Ëã•‰ªªÊÑèËäÇÁÇπÁöÑÂè≥Â≠êÊ†ë‰∏çÁ©∫ÔºåÂàôÂè≥Â≠êÊ†ë‰∏äÊâÄÊúâÁªìÁÇπÁöÑÂÄºÂùáÂ§ß‰∫éÂÆÉÁöÑÊ†πÁªìÁÇπÁöÑÂÄºÔºõ ‰ªªÊÑèËäÇÁÇπÁöÑÂ∑¶„ÄÅÂè≥Â≠êÊ†ë‰πüÂàÜÂà´‰∏∫‰∫åÂèâÊü•ÊâæÊ†ëÔºõ Ê≤°ÊúâÈîÆÂÄºÁõ∏Á≠âÁöÑËäÇÁÇπ„ÄÇ ÊÄßË¥®:1.Â∑¶Â∞è‰∫éÊ†πÂ∞è‰∫éÂè≥2.ÂÄº‰∏çÈáçÂ§ç3.‚Äù‰∏≠Â∫èÈÅçÂéÜ‚ÄúÂèØ‰ª•ËÆ©ÁªìÁÇπÊúâÂ∫è4.‰∫åÂèâÊêúÁ¥¢Ê†ëÊúâ‰∏§ÁßçÁªìÁÇπÂà†Èô§ÊñπÂºè:ÂèñË¢´Âà†Èô§ÁªìÁÇπÁöÑÂè≥Â≠êÊ†ë‰∏≠ÁöÑÊúÄÂ∞èÂÖÉÁ¥†Êõø‰ª£ÊàñËÄÖÂèñË¢´Âà†Èô§ÁªìÁÇπÁöÑÂ∑¶Â≠êÊ†ë‰∏≠ÁöÑÊúÄÂ§ßÂÖÉÁ¥†Êõø‰ª£ ‰ºòÂäø:Êü•Êâæ„ÄÅÊèíÂÖ•ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ËæÉ‰Ωé„ÄÇ‰∏∫O(log n)‰∫åÂèâÊü•ÊâæÊ†ëÁöÑÊúÄÂùèÊïàÁéáÊòØO(n),Ê≠§Êó∂ÈÄÄÂåñ‰∏∫Á∫øÊÄßÁªìÊûÑ # -*- coding:utf-8 -*-class BinarySearchTreeNode(): def __init__(self,val = 0): self.val = val self.left = None self.right = None # ÂØªÊâæÁªìÁÇπ def find(self, data): if self.val == data: return True elif data &lt; self.val and self.left: return self.left.find(data) elif data &gt; self.val and self.right: return self.right.find(data) else: return False # ÂØªÊâæÊúÄÂ∞èÁªìÁÇπ def findMinData(self): if self.left: return self.left.findMinData() else: return self.val # ÂØªÊâæÊúÄÂ§ßÁªìÁÇπ def findMaxData(self): if self.right: return self.right.findMaxData() else: return self.val # ÊèíÂÖ•ÁªìÁÇπ # ÂΩìdata‰∏é‰∫åÂèâÊêúÁ¥¢Ê†ë‰∏≠ÊüêÁªìÁÇπvalÁõ∏Á≠âÊó∂‰∏ç‰ΩúÂ§ÑÁêÜ def insertNode(self, data): # Âú®Âè≥Â≠êÊ†ë‰∏ä if self.val &lt; data: if self.right: self.right.insertNode(data) else: self.right = BinarySearchTreeNode(data) # Âú®Â∑¶Â≠êÊ†ë‰∏ä if self.val &gt; data: if self.left: self.left.insertNode(data) else: self.left = BinarySearchTreeNode(data) # ÊâìÂç∞‰∫åÂèâÊêúÁ¥¢Ê†ë # Â∑¶Ê†πÂè≥ÈÅçÂéÜ def printTree(self): if self.left: self.left.printTree() print self.val, if self.right: self.right.printTree() # ÁªìÁÇπÁöÑÂà†Èô§ # ÂΩìÂà†Èô§‰∏Ä‰∏™Âè∂Â≠êÁªìÁÇπÊó∂,Áõ¥Êé•Âà†Èô§Âç≥ÂèØ # ÂΩìÂà†Èô§ÁöÑÁªìÁÇπÂè™Êúâ‰∏Ä‰∏™Â≠©Â≠êÊó∂,Áî®ËØ•Â≠©Â≠êÊõøÊç¢ # ÂΩìÂà†Èô§ÁöÑÁªìÁÇπÊúâ‰∏§‰∏™Â≠©Â≠êÊó∂,ÂØªÊâæËØ•ÁªìÁÇπÂè≥Â≠êÊ†ë‰∏≠ÁöÑÊúÄÂ∞èÊï∞ÊçÆ‰ª£ÊõøÂ≠êËäÇÁÇπ def daleteNode(self, data): # ÂâçÊèêÊòØËØ•ÁªìÁÇπÂú®‰∫åÂèâÊêúÁ¥¢Ê†ë‰∏≠ËÉΩÊâæÂà∞ if not self.find(data): return self if data &lt; self.val: self.left = self.left.daleteNode(data) return self elif data &gt; self.val: self.right = self.right.daleteNode(data) return self elif self.left and self.right: # ÊâæÂà∞Âè≥Â≠êÊ†ëÊúÄÂ∞èÁöÑÁªìÁÇπ,Ëé∑ÂèñÂÄº val = self.right.findMinData() # ÊääÊúÄÂ∞èÁªìÁÇπÁöÑÂÄºÁªôËá™Â∑± self.val = val # Âà†Èô§Âè≥Â≠êÊ†ë‰∏≠ÁöÑÊúÄÂ∞èÁªìÁÇπ,‰Ωøself.rightÊåáÂêëÂè≥Â≠êÊ†ëÁöÑÊ†πËäÇÁÇπ # self.right.daleteNode(val)ÊúÄÁªàËøîÂõûÂè≥Â≠êÊ†ëÁöÑÊ†πËäÇÁÇπ self.right = self.right.daleteNode(val) return self else: # Â∑¶ÁªìÁÇπÂ≠òÂú® if self.left: # Áõ¥Êé•ÊåáÂêëÂ∑¶ÁªìÁÇπ return self.left # Âè≥ÁªìÁÇπÂ≠òÂú®,Êàñ‰∏çÂ≠òÂú®ÁªìÁÇπ else: # Áõ¥Êé•ÊåáÂêëÂè≥ÁªìÁÇπ return self.righta = BinarySearchTreeNode(10)a.insertNode(8)a.insertNode(12)a.insertNode(6)a.insertNode(9)a.insertNode(11)a.insertNode(14)a.insertNode(7)a.insertNode(13)a.insertNode(5)a.insertNode(2)a.printTree()print "\n"print a.find(11)print a.find(100000)print a.findMaxData()print a.findMinData()a.daleteNode(1000000)a.daleteNode(10)a.daleteNode(14)a.daleteNode(2)a.printTree() ‰∫åÂèâÊêúÁ¥¢Ê†ë‰ª•ÈìæÊé•ÁöÑÊñπÂºèÂ≠òÂÇ®,‰øùÊåÅ‰∫ÜÈìæÊé•Â≠òÂÇ®ÁªìÊûÑÂú®ÊâßË°åÊèíÂÖ•ÊàñÂà†Èô§Êó∂ÁöÑ‰ºòË∂äÊÄß. ÂØπ‰∫é‰∫åÂèâÊêúÁ¥¢Ê†ëÁöÑÊü•Êâæ,ÊØîËæÉÊ¨°Êï∞Á≠â‰∫éÁªôÂÆöÂÄºÁöÑÁªìÁÇπÂú®‰∫åÂèâÊêúÁ¥¢Ê†ëÁöÑÂ±ÇÊï∞.ÊúÄÂ∞ë‰∏∫1Ê¨°(‰∏∫Ê†πËäÇÁÇπ),ÊúÄÂ§ö‰∏çË∂ÖËøáÊ†ëÁöÑÊ∑±Â∫¶(ÊúÄÂ∑ÆÊòØÊûÅÁ´ØÁöÑÂè≥ÊñúÊ†ëÊàñÂ∑¶ÊñúÊ†ë). ‰∫åÂèâÊéíÂ∫èÊ†ëÂÄòËã•ÊòØÂπ≥Ë°°ÁöÑ,ÂÖ∂Ê∑±Â∫¶‰∏éÂÆåÂÖ®‰∫åÂèâÊ†ëÁõ∏Âêå,Âùá‰∏∫floor(logn) + 1,Êü•ÊâæÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(logn),Ëøë‰ºº‰∏éÊäòÂçäÊü•Êâæ,Ëã•‰∏çÊòØÂπ≥Ë°°ÁöÑ,ÁîöËá≥ÊºîÂåñ‰∏∫ÊûÅÁ´ØÁöÑÂè≥ÊñúÊ†ëÊàñÂ∑¶ÊñúÊ†ë,Êü•ÊâæÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n),Á≠âÂêå‰∫éÈ°∫Â∫èÊü•Êâæ. Âõ†Ê≠§,Âπ≥Ë°°Ëá≥ÂÖ≥ÈáçË¶Å. Âπ≥Ë°°‰∫åÂèâÊ†ë(AVLÊ†ë)Âπ≥Ë°°‰∫åÂèâÊêúÁ¥¢Ê†ëÊòØÊîπËøõÁöÑ‰∫åÂèâÊêúÁ¥¢Ê†ë,‰πüÊòØ‰∫åÂèâÊêúÁ¥¢Ê†ë„ÄÇ ‰∏ÄËà¨ÁöÑ‰∫åÂèâÊêúÁ¥¢Ê†ëÁöÑÊü•ËØ¢Â§çÊùÇÂ∫¶ÊòØË∑üÊ∑±Â∫¶ÊúâÂÖ≥ÔºåÂõ†Ê≠§ÂΩìÁªìÁÇπÁöÑÊ∑±Â∫¶ÊôÆÈÅçËæÉÂ§ßÊó∂ÔºåÊü•ËØ¢ÁöÑÂùáÊëäÂ§çÊùÇÂ∫¶‰ºö‰∏äÂçáÔºå‰∏∫‰∫ÜÊõ¥È´òÊïàÁöÑÊü•ËØ¢ÔºåÂπ≥Ë°°Ê†ëÂ∫îËøêËÄåÁîü‰∫Ü„ÄÇ ÂèØ‰ª•‰ΩøÊü•ÊâæÊ†ëÁöÑÈ´òÂ∫¶‰∏∫ O (log(n)) ÂÆö‰πâ:ÂÆÉÊòØ‰∏ÄÊ£µÁ©∫Ê†ëÊàñÂÆÉÁöÑÂ∑¶Âè≥‰∏§‰∏™Â≠êÊ†ëÁöÑÈ´òÂ∫¶Â∑ÆÁöÑÁªùÂØπÂÄº‰∏çË∂ÖËøá1ÔºåÂπ∂‰∏îÂ∑¶Âè≥‰∏§‰∏™Â≠êÊ†ëÈÉΩÊòØ‰∏ÄÊ£µÂπ≥Ë°°‰∫åÂèâÊ†ë„ÄÇ AVLÊ†ë‰∏≠ÁöÑÊØè‰∏™ÁªìÁÇπÈÉΩÊúâ‰∏Ä‰∏™Âπ≥Ë°°Âõ†Â≠êÔºàbalance factorÔºåBFÔºâÔºåÂÆÉË°®Á§∫Ëøô‰∏™ÁªìÁÇπÁöÑÂ∑¶„ÄÅÂè≥Â≠êÊ†ëÁöÑÊ∑±Â∫¶Â∑ÆÔºå‰πüÂ∞±ÊòØÂ∑¶Â≠êÊ†ëÁöÑÊ∑±Â∫¶ÂáèÂéªÂè≥Â≠êÊ†ëÁöÑÊ∑±Â∫¶ÁöÑÁªìÊûúÂÄº„ÄÇAVLÊ†ë‰∏äÊâÄÊúâÁªìÁÇπÁöÑBFÂÄºÂè™ËÉΩÊòØ-1„ÄÅ0„ÄÅ1„ÄÇÂèç‰πãÔºåÂè™Ë¶Å‰∫åÂèâÊ†ë‰∏ä‰∏Ä‰∏™ÁªìÁÇπÁöÑBFÁöÑÁªùÂØπÂÄºÂ§ß‰∫é1ÔºåÂàôËØ•‰∫åÂèâÊ†ëÂ∞±‰∏çÊòØÂπ≥Ë°°‰∫åÂèâÊ†ë„ÄÇÂú®ËøõË°åÊèíÂÖ•ÂíåÂà†Èô§ÁöÑÊó∂ÂÄôÊâæÂá∫Â§±ÂéªÂπ≥Ë°°ÁöÑËäÇÁÇπÔºåËøõË°åÂøÖË¶ÅÁöÑÊóãËΩ¨Êìç‰Ωú‰øùËØÅÊ†ëÁöÑÂπ≥Ë°°„ÄÇ Êü•Êâæ„ÄÅÊèíÂÖ•ÂíåÂà†Èô§Âú®Âπ≥ÂùáÂíåÊúÄÂùèÊÉÖÂÜµ‰∏ãÈÉΩÊòØOÔºàlog nÔºâ ÊúÄÂ∞ëÁªìÁÇπËÆæn(h)ÊòØÈ´òÂ∫¶‰∏∫hÁöÑAVLÊ†ëÔºåÂàôÁªìÁÇπÊï∞ÊúÄÂ∞ëÊó∂Êúâ:n(h) = n(h-1) + n(h-2) + 1 h(VALÊ†ëÁöÑÈ´òÂ∫¶) ÊúÄÂ∞ëÁªìÁÇπÊï∞ 0 1 1 2 2 4 3 7 4 12 5 20 ‚Ä¶ ‚Ä¶ ÊòæËÄåÊòìËßÅÔºåÊª°Ë∂≥ÁöÑÂÖ≥Á≥ª‰∏∫:È´òÂ∫¶‰∏∫hÁöÑAVLÊ†ëÔºåÂÖ∂ÊúÄÂ∞ëÁªìÁÇπÊï∞Èáè‰∏∫F(h+2) - 1ÔºåÂÖ∂‰∏≠F(x)‰∏∫ÊñêÊ≥¢ÈÇ£Â•ëÊï∞ÂàóÈÄóÂè∑‰∏îËßÑÂÆö‰ªé1ÂºÄÂßãÔºåÂç≥F(0) = 1ÔºåF(1) = 2 Ë∞ÉÊï¥RR(Âè≥ÂçïÊóã):È∫ªÁÉ¶ÁªìÁÇπÂú®ÂèëÁé∞ÁªìÁÇπÁöÑÂè≥Â≠êÊ†ëÁöÑÂè≥Â≠êÊ†ë‰∏ä RL():È∫ªÁÉ¶ÁªìÁÇπÂú®ÂèëÁé∞ÁªìÁÇπÁöÑÂè≥Â≠êÊ†ëÁöÑÂ∑¶Â≠êÊ†ë‰∏ä LL(Â∑¶ÂçïÊóã):È∫ªÁÉ¶ÁªìÁÇπÂú®ÂèëÁé∞ÁªìÁÇπÁöÑÂ∑¶Â≠êÊ†ëÁöÑÂ∑¶Â≠êÊ†ë‰∏ä LR():È∫ªÁÉ¶ÁªìÁÇπÂú®ÂèëÁé∞ÁªìÁÇπÁöÑÂ∑¶Â≠êÊ†ëÁöÑÂè≥Â≠êÊ†ë‰∏ä Â†ÜÂ†Ü:Áî®Êï∞ÁªÑË°®Á§∫ÁöÑÂÆåÂÖ®‰∫åÂèâÊ†ëÊúâÂ∫èÊÄß:‰ªª‰∏ÄÁªìÁÇπÁöÑÂÖ≥ÈîÆÂ≠óÊòØÂÖ∂Â≠êÊ†ëÊâÄÊúâÁªìÁÇπÁöÑÊúÄÂ§ßÂÄº(ÊàñËÄÖÊúÄÂ∞èÂÄº)Ôºå‰ªéÊ†πÁªìÁÇπÂà∞‰ªªÊÑèÁªìÁÇπË∑ØÂæÑ‰∏äÁªìÁÇπÂ∫èÂàóÁöÑÊúâÂ∫èÊÄß„ÄÇÊúÄÂ§ßÂ†Ü,‰πüÁß∞‰∏∫Â§ßÈ°∂Â†Ü:ÊúÄÂ§ßÂÄºÊúÄÂ∞èÂ†Ü,‰πüÁß∞‰∏∫Â∞èÈ°∂Â†Ü:ÊúÄÂ∞èÂÄº ÊúÄÂ§ßÂ†ÜÁöÑÂª∫Á´ã:ÊñπÊ≥ï‰∏Ä:Ëá™Â∫ïÂêë‰∏äË∞ÉÊï¥Â†ÜÔºåÈ¶ñÂÖàÂ∞Ün‰∏™ËäÇÁÇπÊåâËæìÂÖ•È°∫Â∫èÂ≠òÂÖ•Ôºå‰ΩøÂÖ∂Êª°Ë∂≥ÂÆåÂÖ®‰∫åÂèâÊ†ëÁöÑÁªìÊûÑÁâπÊÄßÔºåÁÑ∂ÂêéË∞ÉÊï¥ÂêÑËäÇÁÇπÁöÑ‰ΩçÁΩÆ„ÄÇ ÊñπÊ≥ï‰∫å:ÈÄöËøáÊèíÂÖ•Êìç‰ΩúÔºåÂ∞Ün‰∏™ÂÖÉÁ¥†‰∏Ä‰∏™‰∏™Âú∞Áõ∏ÁªßÊèíÂÖ•Âà∞‰∏Ä‰∏™ÂàùÂßã‰∏∫Á©∫ÁöÑÂ†Ü‰∏≠ÔºåÂÖ∂Êó∂Èó¥‰ª£‰ª∑ÊúÄÂ§ß‰∏∫O(nlogn)„ÄÇ Â†ÜÈ°∂ÂÖÉÁ¥†ÁöÑÂà†Èô§ÂÖÉÁ¥†ÁöÑÊèíÂÖ• ÂìàÂ§´ÊõºÊ†ëÂ∏¶ÊùÉË∑ØÂæÑÈïøÂ∫¶:ËÆæ‰∫åÂèâÊ†ëÊúân‰∏™Âè∂Â≠êËäÇÁÇπÔºåÊØè‰∏™Âè∂Â≠êËäÇÁÇπÂ∏¶ÊúâÊùÉÂÄºWÔºå‰ªéÊ†πËäÇÁÇπÂà∞ÊØè‰∏™Âè∂Â≠êËäÇÁÇπÁöÑÈïøÂ∫¶‰∏∫LÔºåÂàôÊØè‰∏™Âè∂Â≠êËäÇÁÇπÁöÑÂ∏¶ÊùÉË∑ØÂæÑÈïøÂ∫¶‰πãÂíå‰∏∫WPL=‚àëWL„ÄÇÂìàÂ§´ÊõºÊ†ëÂç≥ÊòØÊúÄ‰ºò‰∫åÂèâÊ†ë:WPLÊúÄÂ∞èÁöÑ‰∫åÂèâÊ†ë„ÄÇ ÊÄßË¥®: Ê≤°ÊúâÂ∫¶‰∏∫1ÁöÑÁªìÁÇπ(ÊåâÁÖßÊûÑÈÄ†ÂìàÂ§´ÊõºÊ†ëÁöÑËßÑÂàôÔºåÊòæËÄåÊòìËßÅ)„ÄÇ n‰∏™Âè∂Â≠êËäÇÁÇπÁöÑÂìàÂ§´ÊõºÊ†ëÂÖ±Êúâ 2 * n - 1‰∏™ÁªìÁÇπ„ÄÇ ÂìàÂ§´ÊõºÊ†ëÁöÑ‰ªªÊÑèÈùûÂè∂Â≠êÁªìÁÇπÁöÑÂ∑¶Âè≥Â≠êÊ†ë‰∫§Êç¢Âêé‰ªçÊòØÂìàÂ§´ÊõºÊ†ë„ÄÇ ÂØπÂêå‰∏ÄÁªÑÊùÉÂÄºÁöÑÔºåÂèØËÉΩÂ≠òÂú®‰∏çÂêåÁªìÊûÑÁöÑÂá†Ê£µÂìàÂ§´ÊõºÊ†ëÔºå‰ΩÜÊòØÂÆÉ‰ª¨ÁöÑWPLÊòØÁõ∏ÂêåÁöÑ„ÄÇ ÊÄßË¥®2Êé®ÂØº:Ê†πÊçÆÂìàÂ§´ÊõºÊ†ëÊ≤°ÊúâÂ∫¶‰∏∫1ÁöÑÁªìÁÇπÔºåÂàô n1 = 0ÔºåÂèàÊ†πÊçÆ n0 = n2 + 1Ôºåsum = n0 + n1 + n2ÔºåÂàôÊúâ: sum = n0 + n1 + n2 = n0 + n2 = n0 + n0 - 1 = 2 * n0 - 1 = 2 * n - 1 // nÂç≥n0 ÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâáÂõæÁâá ÂõæaÁöÑWPL‰∏∫ 5 2 + 7 2 + 2 2 + 13 2 = 54ÂõæbÁöÑWPL‰∏∫ 13 1 + 7 2 + 2 3 + 5 3 = 48PLÁöÑËÆ°ÁÆóÊñπÂºè‰∏∫:ËØ•ËäÇÁÇπÁöÑÊùÉÂÄº * ‰ªéÊ†πËäÇÁÇπÂà∞ËØ•ËäÇÁÇπÁöÑÊ†ëÊûùÊï∞Èáè ÂìàÂ§´ÊõºÊ†ëÁöÑÊûÑÈÄ†:ÊØèÊ¨°ÊääÊùÉÂÄºÊúÄÂ∞èÁöÑ‰∏§‰∏™‰∫åÂèâÊ†ëÂêàÂπ∂ÔºåÂèÇÁÖßÊúÄÂ§ßÂ†ÜÁöÑË∞ÉÊï¥„ÄÇ Á∫¢ÈªëÊ†ëÁ∫¢ÈªëÊ†ëÊòØÊØè‰∏™ËäÇÁÇπÈÉΩÂ∏¶ÊúâÈ¢úËâ≤Â±ûÊÄßÁöÑ‰∫åÂèâÊü•ÊâæÊ†ëÔºåÈ¢úËâ≤‰∏∫Á∫¢Ëâ≤ÊàñÈªëËâ≤„ÄÇÂú®‰∫åÂèâÊü•ÊâæÊ†ëÂº∫Âà∂‰∏ÄËà¨Ë¶ÅÊ±Ç‰ª•Â§ñÔºåÂØπ‰∫é‰ªª‰ΩïÊúâÊïàÁöÑÁ∫¢ÈªëÊ†ëÊàë‰ª¨Â¢ûÂä†‰∫ÜÂ¶Ç‰∏ãÁöÑÈ¢ùÂ§ñË¶ÅÊ±ÇÔºö Ôºà1ÔºâÊØè‰∏™ËäÇÁÇπÊàñËÄÖÊòØÈªëËâ≤ÔºåÊàñËÄÖÊòØÁ∫¢Ëâ≤„ÄÇÔºà2ÔºâÊ†πËäÇÁÇπÊòØÈªëËâ≤„ÄÇÔºà3ÔºâÊØè‰∏™Âè∂Â≠êËäÇÁÇπÔºàNILÔºâÊòØÈªëËâ≤„ÄÇ [Ê≥®ÊÑèÔºöËøôÈáåÂè∂Â≠êËäÇÁÇπÔºåÊòØÊåá‰∏∫Á©∫(NILÊàñNULL)ÁöÑÂè∂Â≠êËäÇÁÇπÔºÅ]Ôºà4ÔºâÊØè‰∏™Á∫¢Ëâ≤ËäÇÁÇπÂøÖÈ°ªÊúâ‰∏§‰∏™ÈªëËâ≤ÁöÑÂ≠êËäÇÁÇπ„ÄÇÔºà5ÔºâÂØπ‰∫é‰ªª‰∏ÄÁªìÁÇπËÄåË®ÄÔºåÂÖ∂Âà∞Âè∂ÁªìÁÇπÊ†ëÂ∞æÁ´ØNILÊåáÈíàÁöÑÊØè‰∏ÄÊù°Ë∑ØÂæÑÈÉΩÂåÖÂê´Áõ∏ÂêåÊï∞ÁõÆÁöÑÈªëÁªìÁÇπ„ÄÇ ‰∏ÄÊ£µn‰∏™ÁªìÁÇπÊòØÁ∫¢ÈªëÊ†ëÂßãÁªà‰øùÊåÅ‰∫ÜlognÁöÑÈ´òÂ∫¶,ÊâÄ‰ª•Á∫¢ÈªëÊ†ëÁöÑÊü•Êâæ„ÄÅÊèíÂÖ•„ÄÅÂà†Èô§ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÊúÄÂùè‰∏∫O(log n) Á∫¢ÈªëÊ†ë‰πãÊâÄ‰ª•ÊòØÂπ≥Ë°°ÁöÑ‰∫åÂèâÊü•ÊâæÊ†ëÔºåÊòØÂõ†‰∏∫ÊØè‰∏™ËäÇÁÇπÈÉΩÊúâË°®Á§∫ÂÖ∂È¢úËâ≤ÁöÑÂüüÂÄºÔºöÁ∫¢ÊàñÈªëÔºåÂú®ÊèíÂÖ•ÂíåÂà†Èô§Êìç‰ΩúÁöÑÊó∂ÂÄô‰æùÊçÆËäÇÁÇπÁöÑÈ¢úËâ≤ÂêëÂπ≥Ë°°ÁöÑÊñπÂêëË∞ÉÊï¥„ÄÇ ‚ÄúÂè∂ÁªìÁÇπ‚Äù Êàñ‚ÄùNULLÁªìÁÇπ‚ÄùÔºåÂÆÉ‰∏çÂåÖÂê´Êï∞ÊçÆËÄåÂè™ÂÖÖÂΩìÊ†ëÂú®Ê≠§ÁªìÊùüÁöÑÊåáÁ§∫ÔºåËøô‰∫õÁªìÁÇπ‰ª•ÂèäÂÆÉ‰ª¨ÁöÑÁà∂ÁªìÁÇπÔºåÂú®ÁªòÂõæ‰∏≠ÈÉΩ‰ºöÁªèÂ∏∏Ë¢´ÁúÅÁï•„ÄÇ ÂΩìÊàë‰ª¨Âú®ÂØπÁ∫¢ÈªëÊ†ëËøõË°åÊèíÂÖ•ÂíåÂà†Èô§Á≠âÊìç‰ΩúÊó∂ÔºåÂØπÊ†ëÂÅö‰∫Ü‰øÆÊîπÔºåÈÇ£‰πàÂèØËÉΩ‰ºöËøùËÉåÁ∫¢ÈªëÊ†ëÁöÑÊÄßË¥®„ÄÇ ‰∏∫‰∫ÜÁªßÁª≠‰øùÊåÅÁ∫¢ÈªëÊ†ëÁöÑÊÄßË¥®ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂØπÁªìÁÇπËøõË°åÈáçÊñ∞ÁùÄËâ≤Ôºå‰ª•ÂèäÂØπÊ†ëËøõË°åÁõ∏ÂÖ≥ÁöÑÊóãËΩ¨Êìç‰Ωú Â∑¶Êóã:Â∑¶Âè≥Â∑¶Âè≥Êóã:Âè≥Â∑¶Âè≥ Â§öË∑ØÊü•ÊâæÊ†ë(BÊ†ë)BÊ†ëÂç≥‰∏∫B-Ê†ë„ÄÅB_Ê†ë,ÂèàÂè´Âπ≥Ë°°Â§öË∑ØÊü•ÊâæÊ†ë.Â§öË∑ØÊü•ÊâæÊ†ë:ÂÖ∂ÊØè‰∏Ä‰∏™ÁªìÁÇπÁöÑÂ≠©Â≠êÊï∞ÂèØ‰ª•Â§ö‰∫é‰∏§‰∏™,ÊØè‰∏Ä‰∏™ÁªìÁÇπÂ§ÑÂèØ‰ª•Â≠òÂÇ®Â§ö‰∏™ÂÖÉÁ¥†. ‰∏Ä‰∏™ËäÇÁÇπÂè™ËÉΩÂ≠òÂÇ®‰∏Ä‰∏™ÂÖÉÁ¥†,Âú®ÂÖÉÁ¥†ÈùûÂ∏∏Â§öÁöÑÊó∂ÂÄô,Â∞±‰ΩøÂæóË¶Å‰πàÊ†ëÁöÑÂ∫¶ÈùûÂ∏∏Â§ß,Ë¶Å‰πàÊ†ëÁöÑÈ´òÂ∫¶ÈùûÂ∏∏Â§ß,ÁîöËá≥‰∏§ËÄÖÈÉΩÂøÖÈ°ªË∂≥Â§üÂ§ßÊâçÂèØ‰ª•,Ëøô‰ΩøÂæóÂÜÖÂ≠òÂ≠òÂèñÂ§ñÊùëÊ¨°Êï∞ÈùûÂ∏∏Â§ö,ÈÄ†Êàê‰∫ÜÊó∂Èó¥ÊïàÁéá‰∏äÁöÑÁì∂È¢à,‰∫éÊòØÂºïÂÖ•Â§öË∑ØÊü•ÊâæÊ†ë. Ê†ëÁöÑÈ´òÂ∫¶Ë∂äÈ´òÔºåÊü•ÊâæÊñá‰ª∂ÊâÄÈúÄË¶ÅÁöÑÁ£ÅÁõòIOËØªÂÜôÊ¨°Êï∞Ë∂äÂ§öÔºåÊâÄ‰ª•‰∏∫‰∫ÜÂáèÂ∞ëÁ£ÅÁõòÁöÑIOËØªÂÜôÔºåË¶ÅÊÉ≥ÂäûÊ≥ïËøõ‰∏ÄÊ≠•Èôç‰ΩéÊ†ëÁöÑÈ´òÂ∫¶„ÄÇ Âõ†Ê≠§ÔºåÂÖ∑ÊúâÂ§ö‰∏™Â≠©Â≠êÁöÑBÊ†ë‰æøÂ∫îËøêËÄåÁîüÔºåÂõ†‰∏∫BÊ†ëÊØè‰∏Ä‰∏™ÁªìÁÇπÂèØ‰ª•ÊúâÂá†‰∏™Âà∞Âá†ÂçÉ‰∏™Â≠©Â≠êÔºå‰ΩøÂæóÂú®ÁªìÁÇπÊï∞ÁõÆ‰∏ÄÂÆöÁöÑÊÉÖÂÜµ‰∏ãÔºåÊ†ëÁöÑÈ´òÂ∫¶‰ºöÂ§ßÂ§ßÈôç‰ΩéÔºå‰ªéËÄåÊúâÊïàÂáèÂ∞ëÁ£ÅÁõòIOËØªÂÜôÊ∂àËÄó„ÄÇ B+Ê†ë„ÄÅBÊ†ëÁ≠âÁöÑÊ†πÁªìÁÇπÂíåÈÉ®ÂàÜÈ°∂Â±ÇÊï∞ÊçÆÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠ÔºåÂ§ßÈÉ®ÂàÜ‰∏ãÂ±ÇÊï∞ÊçÆÂ≠òÂú®Á£ÅÁõò‰∏ä„ÄÇ 2-3Ê†ë2-3Ê†ëÊòØËøôÊ†∑‰∏ÄÊ£µÂ§öË∑ØÊü•ÊâæÊ†ë:ÂÖ∂‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÁªìÁÇπÈÉΩÂÖ∑Êúâ‰∏§‰∏™Â≠©Â≠êÊàñ‰∏â‰∏™Â≠©Â≠ê. ‰∏Ä‰∏™2ÁªìÁÇπÂåÖÂê´‰∏Ä‰∏™ÂÖÉÁ¥†Âíå‰∏§‰∏™Â≠©Â≠ê(ÊàñÊ≤°ÊúâÂ≠©Â≠ê),‰∏é‰∫åÂèâÊéíÂ∫èÊ†ëÁ±ª‰ºº,Â∑¶Â≠êÊ†ëÂåÖÂê´ÁöÑÂÖÉÁ¥†Â∞è‰∫éËØ•ÂÖÉÁ¥†,Âè≥Â≠êÊ†ëÂåÖÂê´ÁöÑÂÖÉÁ¥†Â§ß‰∫éËØ•ÂÖÉÁ¥†,‰∏é‰∫åÂèâÊéíÂ∫èÊ†ë‰∏çÂêåÁöÑÊòØ,Ëøô‰∏™2ÁªìÁÇπË¶Å‰πàÊ≤°ÊúâÂ≠©Â≠ê,Ë¶Å‰πàÂ∞±Êúâ‰∏§‰∏™,‰∏çËÉΩÂè™Êúâ‰∏Ä‰∏™Â≠©Â≠ê. ‰∏Ä‰∏™3ÁªìÁÇπÂåÖÂê´‰∏ÄÂ∞è‰∏ÄÂ§ß‰∏§‰∏™ÂÖÉÁ¥†Âíå‰∏â‰∏™Â≠©Â≠ê(ÊàñÊ≤°ÊúâÂ≠©Â≠ê),‰∏Ä‰∏™3ÁªìÁÇπË¶Å‰πàÊ≤°ÊúâÂ≠©Â≠ê,Ë¶Å‰πàÂÖ∑Êúâ3‰∏™Â≠©Â≠ê.Â¶ÇÊûúÂÖ∑Êúâ3‰∏™Â≠©Â≠êÁöÑËØù,Â∑¶Â≠êÊ†ëÂåÖÂê´ÁöÑÂÖÉÁ¥†Â∞è‰∫éËæÉÂ∞èÂÖÉÁ¥†ÁöÑÂÖÉÁ¥†,Âè≥Â≠êÊ†ëÂåÖÂê´ÁöÑÂÖÉÁ¥†Â§ß‰∫éËæÉÂ§ßÂÖÉÁ¥†ÁöÑÂÖÉÁ¥†,‰∏≠Èó¥Â≠êÊ†ëÂåÖÂê´‰ªã‰∫é‰∏§ÂÖÉÁ¥†‰πãÈó¥ÁöÑÂÖÉÁ¥†. Âπ∂‰∏î2-3Ê†ë‰∏≠ÊâÄÊúâÂè∂Â≠êÈÉΩÂú®Âêå‰∏ÄÂ±ÇÊ¨°‰∏ä. 2-3Ê†ëÁöÑÊèíÂÖ• 2-3Ê†ëÁöÑÂà†Èô§ 2-3-4Ê†ë2-3Ê†ëÁöÑÊ¶ÇÂøµÊâ©Â±ï,ÂåÖÊã¨‰∫Ü4ÁªìÁÇπÁöÑ‰ΩøÁî®.‰∏Ä‰∏™4ÁªìÁÇπÂåÖÂê´Â∞è‰∏≠Â§ß‰∏â‰∏™ÂÖÉÁ¥†ÂíåÂõõ‰∏™Â≠©Â≠ê(ÊàñËÄÖÊ≤°ÊúâÂ≠©Â≠ê). BÊ†ëBÊ†ëÊòØ‰∏ÄÁßçÂπ≥Ë°°ÁöÑÂ§öË∑ØÊü•ÊâæÊ†ë,2-3Ê†ëÂíå2-3-4Ê†ëÈÉΩÊòØBÊ†ëÁöÑÁâπ‰æã.ÁªìÁÇπÊúÄÂ§ßÁöÑÂ≠©Â≠êÊï∞ÁõÆÁß∞‰∏∫BÊ†ëÁöÑÈò∂.2-3Ê†ëÊòØ3Èò∂BÊ†ë,2-3-4Ê†ëÊòØ4Èò∂BÊ†ë. A B-tree of order m is a tree which satisfies the following properties: Every node has at most m children. Every non-leaf node (except root) has at least ‚åàm/2‚åâ children. The root has at least two children if it is not a leaf node. A non-leaf node with k children contains k‚àí1 keys. All leaves appear in the same level ‰∏ÄÊ£µmÈò∂ÁöÑBÊ†ëÊª°Ë∂≥‰ª•‰∏ãÊù°‰ª∂1.ÊØè‰∏™ÁªìÁÇπËá≥Â§öÊúâmÊ£µÂ≠êÊ†ë2.Èô§Ê†πÁªìÁÇπÂ§ñ,ÂÖ∂‰ªñÂàÜÊîØÁªìÁÇπËá≥Â∞ëÊúâceil(m/2)Ê£µÂ≠êÊ†ë(ceil()ÂáΩÊï∞Âêë‰∏äÂèñÊï¥3.Ê†πÁªìÁÇπËá≥Â∞ëÊúâ‰∏§Ê£µÂ≠êÊ†ë,Èô§ÈùûÊ†ëÂè™ÂåÖÂê´‰∏Ä‰∏™ÁªìÁÇπ4.Êúâk‰∏™Â≠©Â≠êÁöÑÈùûÂè∂ÁªìÁÇπÊúâk-1‰∏™ÂÖ≥ÈîÆÁ†Å,ÂÖ≥ÈîÆÁ†ÅÊåâÈÄíÂ¢ûÊ¨°Â∫èÊéíÂàó5.ÊâÄÊúâÂè∂Â≠êÁªìÁÇπÂú®Âêå‰∏ÄÂ±Ç BÊ†ëÂ¶Ç‰ΩïÂÅöÂà∞ÂáèÂ∞ëËÆøÈóÆÂ§ñÂ≠òÊ¨°Êï∞Á°¨ÁõòÂ∞Ü‰ø°ÊÅØÂàÜÂâ≤ÊàêÁõ∏Á≠âÂ§ßÂ∞èÁöÑÈ°µÈù¢,ÊØèÊ¨°Á°¨ÁõòËØªÂÜôÈÉΩÊòØ‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™ÂÆåÊï¥ÁöÑÈ°µÈù¢,ÂØπ‰∏Ä‰∏™Á°¨ÁõòÊù•ËØ¥,‰∏ÄÈ°µÁöÑÈïøÂ∫¶ÂèØËÉΩÊòØ211Âà∞214Â≠óËäÇ. Âú®‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑBÊ†ëÂ∫îÁî®‰∏≠,Ë¶ÅÂ§ÑÁêÜÁöÑÁ°¨ÁõòÊï∞ÊçÆÈáèÂæàÂ§ß,Âõ†Ê≠§Êó†Ê≥ï‰∏ÄÊ¨°ÂÖ®ÈÉ®Ë£ÖÂÖ•ÂÜÖÂ≠ò,Âõ†Ê≠§ÈúÄË¶ÅÂØπBÊ†ëËøõË°åË∞ÉÊï¥,‰ΩøÂæóBÊ†ëÁöÑÈò∂Ê†ë‰∏éÁ°¨ÁõòÂ≠òÂÇ®ÁöÑÈ°µÈù¢Â§ßÂ∞èÁõ∏ÂåπÈÖç.Âú®ÊúâÈôêÂÜÖÂ≠òÁöÑÊÉÖÂÜµ‰∏ã,ÊØè‰∏ÄÊ¨°Á£ÅÁõòÁöÑËÆøÈóÆÊàë‰ª¨ÈÉΩÂèØ‰ª•Ëé∑ÂæóÊúÄÂ§ßÈáèÁöÑÊï∞ÊçÆ,Áî±‰∫éBÊ†ëÊØèËäÇÁÇπÂèØ‰ª•ÂÖ∑ÊúâÊØî‰∫åÂèâÊ†ëÂ§öÂæóÂ§öÁöÑÂÖÉÁ¥†,ÊâÄ‰ª•ÂáèÂ∞ë‰∫ÜÂøÖÈ°ªËÆøÈóÆÁªìÁÇπÂíåÊï∞ÊçÆÂùóÁöÑÊï∞Èáè,ÊèêÈ´ò‰∫ÜÊÄßËÉΩ.BÊ†ëÁöÑÊï∞ÊçÆÁªìÊûÑÂ∞±ÊòØ‰∏∫ÂÜÖÂ§ñÂ≠òÁöÑÊï∞ÊçÆ‰∫§‰∫íÂáÜÂ§áÁöÑ. B+Ê†ëB+ Ê†ëÊòØ‰∏ÄÁßçÊ†ëÊï∞ÊçÆÁªìÊûÑÔºåÈÄöÂ∏∏Áî®‰∫éÊï∞ÊçÆÂ∫ìÂíåÊìç‰ΩúÁ≥ªÁªüÁöÑÊñá‰ª∂Á≥ªÁªü‰∏≠„ÄÇNTFS, ReiserFS, NSS, XFS, JFS, ReFS ÂíåBFSÁ≠âÊñá‰ª∂Á≥ªÁªüÈÉΩÂú®‰ΩøÁî®B+Ê†ë‰Ωú‰∏∫ÂÖÉÊï∞ÊçÆÁ¥¢Âºï„ÄÇ B+ Ê†ëÁöÑÁâπÁÇπÊòØËÉΩÂ§ü‰øùÊåÅÊï∞ÊçÆÁ®≥ÂÆöÊúâÂ∫èÔºåÂÖ∂ÊèíÂÖ•‰∏é‰øÆÊîπÊã•ÊúâËæÉÁ®≥ÂÆöÁöÑÂØπÊï∞Êó∂Èó¥Â§çÊùÇÂ∫¶„ÄÇB+ Ê†ëÂÖÉÁ¥†Ëá™Â∫ïÂêë‰∏äÊèíÂÖ•ÔºåËøô‰∏é‰∫åÂèâÊ†ëÊÅ∞Â•ΩÁõ∏Âèç„ÄÇ ‰∏ÄÊ£µmÈò∂ÁöÑB+Ê†ë‰∏éBÊ†ëÁöÑÂå∫Âà´Âú®‰∫é: ÊúânÊ£µÂ≠êÊ†ëÁöÑÁªìÁÇπÂåÖÂê´Êúân‰∏™ÂÖ≥ÈîÆÂ≠ó ÊâÄÊúâÁöÑÂè∂Â≠êËäÇÁÇπÂåÖÂê´ÂÖ®ÈÉ®ÁöÑÂÖ≥ÈîÆÂ≠ó‰ø°ÊÅØ,‰ª•ÂèäÊåáÂêëÂê´Ëøô‰∫õÂÖ≥ÈîÆÂ≠óËÆ∞ÂΩïÁöÑÊåáÈíà,Âè∂Â≠êËäÇÁÇπÊú¨Ë∫´‰æùÂÖ≥ÈîÆÂ≠óÁöÑÂ§ßÂ∞èËá™Â∞èËÄåÂ§ßÈ°∫Â∫èÈìæÊé• ÊâÄÊúâÂàÜÊîØÁªìÁÇπÂèØ‰ª•ÁúãÊàêÊòØÁ¥¢Âºï,ÁªìÁÇπ‰∏≠‰ªÖÂê´ÊúâÂÖ∂Â≠êÊ†ëÁöÑÊúÄÂ§ß(ÊúÄÂ∞è)ÂÖ≥ÈîÆÂ≠ó. Â•ΩÂ§Ñ:Â¶ÇÊûúË¶ÅÈöèÊú∫Êü•Êâæ,Â∞±‰ªéÊ†πËäÇÁÇπÂá∫Âèë,‰∏éBÊ†ëÁöÑÊü•ÊâæÊñπÂºèÁõ∏Âêå,Âè™‰∏çËøáÂç≥‰ΩøÂú®ÂàÜÊîØÁªìÁÇπÊâæÂà∞‰∫ÜÂæÖÊü•ÊâæÁöÑÂÖ≥ÈîÆÂ≠ó,ÂÆÉ‰πüÂè™ÊòØÁî®Êù•Á¥¢ÂºïÁöÑ,‰∏çËÉΩÊèê‰æõÂÆûÈôÖËÆ∞ÂΩïÁöÑËÆøÈóÆ,ËøòÊòØÈúÄË¶ÅÂà∞ËææÂåÖÂê´Ê≠§ÂÖ≥ÈîÆÂ≠óÁöÑÁªàÁ´ØÁªìÁÇπ. Â¶ÇÊûúÈúÄË¶Å‰ªéÊúÄÂ∞èÂÖ≥ÈîÆÂ≠óËøõË°åËá™Â∞èËÄåÂ§ßÁöÑÈ°∫Â∫èÊü•Êâæ,ÂèØ‰ª•‰ªéÊúÄÂ∑¶Á´ØÁöÑÂè∂Â≠êÁªìÁÇπÂá∫Âèë,‰∏çÁªèËøáÂàÜÊîØÁªìÁÇπ,ËÄåÊòØÊ≤øÁùÄÊåáÂêë‰∏ã‰∏ÄÂè∂Â≠êÁöÑÊåáÈíàÂ∞±ÂèØÈÅçÂéÜÊâÄÊúâÁöÑÂÖ≥ÈîÆÂ≠ó. B+Ê†ëÈÄÇÂêàÊúâËåÉÂõ¥ÁöÑÊü•Êâæ(ÊØîÂ¶ÇÂπ¥ÈæÑ18‚Äì22),‰ªéÊ†πËäÇÁÇπÂá∫ÂèëÊâæÂà∞18,ÂÜçÂú®Âè∂Â≠êÁªìÁÇπ‰∏≠ÊåâÈ°∫Â∫èÊâæÂà∞Á¨¶ÂêàË¶ÅÊ±ÇÁöÑËÆ∞ÂΩï. B+Ê†ëÁöÑÊèíÂÖ•/Âà†Èô§‰∏éBÊ†ëÁ±ª‰ºº,Âè™‰∏çËøáÊèíÂÖ•Âà†Èô§ÁöÑÂÖÉÁ¥†ÈÉΩÊòØÂú®Âè∂Â≠êÁªìÁÇπ‰∏äËøõË°å. Êï£ÂàóË°®Êü•ÊâæÂ≠òÂÇ®‰ΩçÁΩÆ = f(ÂÖ≥ÈîÆÂ≠ó) ËÆ∞ÂΩïÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÂíåÂÆÉÁöÑÂÖ≥ÈîÆÂ≠ó‰πãÈó¥Âª∫Á´ãÁöÑ‰∏Ä‰∏™Á°ÆÂÆöÁöÑÂØπÂ∫îÂÖ≥Á≥ª.ÊØè‰∏™ÂÖ≥ÈîÆÂ≠ókeyÂØπÂ∫î‰∏Ä‰∏™Â≠òÂÇ®‰ΩçÁΩÆf(key),Êü•ÊâæÊó∂Ê†πÊçÆËøô‰∏™Á°ÆÂÆöÁöÑÂØπÂ∫îÂÖ≥Á≥ªÊâæÂà∞ÁªôÂÆökeyÁöÑÊò†Â∞Ñf(key). fÁß∞‰∏∫Êï£ÂàóÂáΩÊï∞,ÂèàÁß∞ÂìàÂ∏åÂáΩÊï∞,ÈááÁî®Êï£ÂàóÊäÄÊúØÂ∞ÜËÆ∞ÂΩïÂ≠òÂÇ®Âú®‰∏ÄÂùóËøûÁª≠ÁöÑÂ≠òÂÇ®Á©∫Èó¥‰∏≠,ËøôÂùóËøûÁª≠ÁöÑÂ≠òÂÇ®Á©∫Èó¥Áß∞‰∏∫Êï£ÂàóË°®ÊàñÂìàÂ∏åË°®,ÂÖ≥ÈîÆÂ≠óÂØπÂ∫îÁöÑËÆ∞ÂΩïÂ≠òÂÇ®‰ΩçÁΩÆÁß∞‰∏∫Êï£ÂàóÂú∞ÂùÄ. ÂÜ≤Á™Å:key1‰∏çÁ≠â‰∫ékey2,‰ΩÜÊòØf(key1)=f(key2),key1Âíåkey2Áß∞‰∏∫Êï£ÂàóÂáΩÊï∞ÁöÑÂêå‰πâËØç. Â∏∏Áî®ÁöÑÊï£ÂàóÂáΩÊï∞1.Áõ¥Êé•ÂÆöÂùÄÊ≥ïf(key) = a * key + b (a,b‰∏∫Â∏∏Êï∞) ‰ºòÁÇπ:ÁÆÄÂçïÂùáÂåÄ,‰∏ç‰ºö‰∫ßÁîüÂÜ≤Á™Å,‰ΩÜÈúÄË¶Å‰∫ãÂÖàÁü•ÈÅìÂÖ≥ÈîÆÂ≠óÁöÑÂàÜÂ∏ÉÊÉÖÂÜµ,ÈÄÇÂêàÊü•ÊâæË°®ËæÉÂ∞è‰∏îËøûÁª≠ÁöÑÊÉÖÂÜµ. 2.Êï∞Â≠óÂàÜÊûêÊ≥ïÊâãÊú∫Âè∑Á†ÅÁ≠â,ÂØπÊï∞Â≠óËøõË°åÊäΩÂèñ,ÂèçËΩ¨,Â∑¶ÁéØ‰ΩçÁßª,Âè≥ÁéØ‰ΩçÁßªÁ≠âÊñπÂºèÂêàÁêÜÂú∞Â∞ÜÂÖ≥ÈîÆÂ≠óÂàÜÈÖçÂà∞Êï£ÂàóË°®ÁöÑÂêÑ‰ΩçÁΩÆ. ÈÄÇÂêàÂ§ÑÁêÜÂÖ≥ÈîÆÂ≠ó‰ΩçÊï∞ÊØîËæÉÂ§ßÁöÑÊÉÖÂÜµ,Â¶ÇÊûú‰∫ãÂÖàÁü•ÈÅìÂÖ≥ÈîÆÂ≠óÁöÑÂàÜÂ∏É‰∏îÂÖ≥ÈîÆÂ≠óÁöÑËã•Âπ≤‰ΩçÂàÜÂ∏ÉÂùáÂåÄ,ÂèØ‰ª•‰ΩøÁî®. 3.Âπ≥ÊñπÂèñ‰∏≠Ê≥ïÂÖ≥ÈîÆÂ≠ó1234‚Äî-&gt;Âπ≥ÊñπÂêé:1522756‚Äî‚Äì&gt;ÊäΩÂèñ‰∏≠Èó¥ÁöÑ3‰Ωç‚Äî‚Äî&gt;227,Áî®‰ΩúÊï£ÂàóÂú∞ÂùÄ. ÈÄÇÂêà‰∏çÁü•ÈÅìÂÖ≥ÈîÆÂ≠óÁöÑÂàÜÂ∏É,ËÄå‰ΩçÊï∞Âèà‰∏çÊòØÂæàÂ§ßÁöÑÊÉÖÂÜµ 4.ÊäòÂè†Ê≥ï‰ªéÂ∑¶Âà∞Âè≥ÂàÜÂâ≤Êàê‰ΩçÊï∞Áõ∏Á≠âÁöÑÂá†ÈÉ®ÂàÜ,Âè†Âä†Ê±ÇÂíå,ÊåâÁÖßÊï£ÂàóË°®Èïø,ÂèñÂêéÂá†‰Ωç‰Ωú‰∏∫Êï£ÂàóÂú∞ÂùÄ. 9876543210‚Äî‚Äì&gt;987 654 321 0‚Äî‚Äì&gt;Ê±ÇÂíå987+654+321+0=1962,Ê±ÇÂêé‰∏â‰Ωç:962 ÈÄÇÂêà‰∏çÈúÄË¶Å‰∫ãÂÖàÁü•ÈÅìÂÖ≥ÈîÆÂ≠óÁöÑÂàÜÂ∏É.ÈÄÇÂêàÂÖ≥ÈîÆÂ≠ó‰ΩçÊï∞ËæÉÂ§öÁöÑÊÉÖÂÜµ. 5.Èô§Áïô‰ΩôÊï∞Ê≥ïÊúÄÂ∏∏Áî®,Êï£ÂàóË°®Èïø‰∏∫mÁöÑÂÖ¨Âºè: f(key) = key mod p (p&lt;=m) Ëã•Êï£ÂàóË°®Ë°®Èïøm,ÈÄöÂ∏∏p‰∏∫Â∞è‰∫éÊàñËÄÖÁ≠â‰∫éË°®ÈïøÁöÑÊúÄÂ∞èË¥®Êï∞Êàñ‰∏çÂåÖÂê´Â∞è‰∫é20Ë¥®Âõ†Â≠êÁöÑÂêàÊï∞. 6.ÈöèÊú∫Êï∞Ê≥ïf(key) = random(key) ÂΩìÂÖ≥ÈîÆÂ≠óÁöÑÈïøÂ∫¶‰∏çÁ≠âÊó∂,ÈááÁî®Ëøô‰∏™ÊñπÊ≥ï. Â∏∏Áî®ÁöÑÂ§ÑÁêÜÂÜ≤Á™ÅÊñπÊ≥ï1.ÂºÄÊîæÂÆöÂùÄÊ≥ïÁ∫øÊÄßÊé¢ÊµãÊ≥ï f(key) = (f(key) + d) mod m (d = 1,2,3...) ‰∫åÊ¨°Êé¢ÊµãÊ≥ï f(key) = (f(key) + d) mod m (d = 1^2,-1^2,2^2,-2^2,3^2,-3^2...q^2,-q^2,ÂÖ∂‰∏≠q&lt;=m/2) ÈöèÊú∫Êé¢ÊµãÊ≥ï f(key) = (f(key) + d) mod m (d ÊòØ‰∏Ä‰∏™ÈöèÊú∫Êï∞Âàó) 2.ÂÜçÊï£ÂàóÂáΩÊï∞Ê≥ïf(key) = RH(key) ÊØèÊ¨°ÂèëÁîüÊï£ÂàóÂÜ≤Á™ÅÊó∂,Â∞±Êç¢‰∏Ä‰∏™Êï£ÂàóÂáΩÊï∞ËÆ°ÁÆó. 3.ÈìæÂú∞ÂùÄÊ≥ïÊèê‰æõÁªù‰∏ç‰ºöÊâæ‰∏çÂà∞Âú∞ÂùÄÁöÑ‰øùÈöú,‰ΩÜÊòØÂ∏¶Êù•Êü•ÊâæÊó∂ÈúÄË¶ÅÈÅçÂéÜÂçïÈìæË°®ÁöÑÊÄßËÉΩÊçüËÄó. 4.ÂÖ¨ÂÖ±Ê∫¢Âá∫Âå∫Ê≥ïÂ¢ûÊ∑ªÊ∫¢Âá∫Ë°®.ÂØπÁªôÂÆöÂÄºÈÄöËøáÊï£ÂàóÂáΩÊï∞ËÆ°ÁÆóÂá∫Êï£ÂàóÂú∞ÂùÄÂêé,ÂÖà‰∏éÂü∫Êú¨Ë°®ÁöÑÁõ∏Â∫î‰ΩçÁΩÆËøõË°åÊØîÂØπ,Â¶ÇÊûúÁõ∏Á≠â,ÊàêÂäü,Âê¶Âàô,Âà∞Ê∫¢Âá∫Ë°®‰∏≠ËøõË°åÈ°∫Â∫èÊü•Êâæ. ÂèÇËÄÉÂπ∂Ëá¥Ë∞¢Áü•‰πé ÁÅ∞ÊùâÊ†ëHAIYANG XUv_JULY_v]]></content>
      <tags>
        <tag>ÁÆóÊ≥ï</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØª„ÄäObjective-CÈ´òÁ∫ßÁºñÁ®ã„Äã]]></title>
    <url>%2F2017%2F04%2F13%2F%E8%AF%BB%E3%80%8AObjective-C%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E3%80%8B%2F</url>
    <content type="text"><![CDATA[2019.08.21 Âà†Èô§IMPË∞ÉÁî®Á§∫‰æã„ÄÅÂà†Èô§block‰∏≠ÁöÑ‰∏Ä‰∫õËØØËß£ ÂÖ≥‰∫éARC/Block/GCD„ÄÇ ËØªÊÑüÂØíÂÅáÈáåÂ∞±Â§ßËá¥Áúã‰∫Ü‰∏ÄÈÅçÔºå‰ΩÜÊòØÂê∏Êî∂ÁöÑ‰∏çÂÆåÂÖ®„ÄÇËøô‰∏§‰∏âÂ§©ÂèàËµ∂Á¥ß‰ªéÂõæ‰π¶È¶ÜÂÄüÊù•Áøª‰∏ÄÁøªÔºåËøòÊòØÊî∂Ëé∑Êª°Êª°„ÄÇËøôÈáåËÆ∞‰∏ã‰∏Ä‰∫õÊØîËæÉÂ•ΩÁé©ÁöÑÈóÆÈ¢ò„ÄÇ ÈóÆÈ¢ò‰∏Ä.‰∏∫‰ªÄ‰πàËãπÊûú‰∏ªË¶ÅÈááÁî®Êï£ÂàóË°®ÁÆ°ÁêÜÂºïÁî®ËÆ°Êï∞GNUstepÂ∞ÜÂºïÁî®ËÆ°Êï∞‰øùÂ≠òÂú®ÂØπË±°Âç†Áî®ÂÜÖÂ≠òÂùóÂ§¥ÈÉ®ÁöÑÂèòÈáè‰∏≠„ÄÇ‰ºòÁÇπÔºö Âè™ÈúÄÂ∞ëÈáè‰ª£Á†Å„ÄÇ ËÉΩÁªü‰∏ÄÁÆ°ÁêÜÂºïÁî®ËÆ°Êï∞Áî®ÂÜÖÂ≠òÂùó‰∏éÂØπË±°Áî®ÂÜÖÂ≠òÂùó„ÄÇ ËãπÊûúÈááÁî®Êï£ÂàóË°®ÔºàÂºïÁî®ËÆ°Êï∞Ë°®ÔºåDenseMap Á±ªÂÆûÁé∞ÔºâÁÆ°ÁêÜÂºïÁî®ËÆ°Êï∞„ÄÇ‰ºòÁÇπÔºö ÂØπË±°Áî®ÂÜÖÂ≠òÂùóÁöÑÂàÜÈÖçÊó†ÈúÄËÄÉËôëÂÜÖÂ≠òÂùóÂ§¥ÈÉ®„ÄÇ ÂºïÁî®ËÆ°Êï∞Ë°®ËÆ∞ÂΩï‰∏≠Â≠òÊúâÂÜÖÂ≠òÂùóÂú∞ÂùÄÔºåÂèØËøΩÊ∫ØÂêÑÂØπË±°ÁöÑÂÜÖÂ≠òÂùó„ÄÇÊúâÂä©‰∫éÊ£ÄÊµãÂØπË±°ÁöÑÊåÅÊúâËÄÖÊòØÂê¶Â≠òÂú®ÔºåÂèØÊ£ÄÊµãÂÜÖÂ≠òÊ≥ÑÊºè„ÄÇ Ê≥®ÔºöÂ¶ÇÊûúËÆæÂ§áÊòØ 64 ‰ΩçÁéØÂ¢ÉÂπ∂‰∏î‰ΩøÁî® Objective-C 2.0ÔºåÈÇ£‰πà‚Äú‰∏Ä‰∫õ‚ÄùÂØπË±°‰ºö‰ΩøÁî®ÂÖ∂ isa ÊåáÈíàÁöÑ‰∏ÄÈÉ®ÂàÜÁ©∫Èó¥Êù•Â≠òÂÇ®ÂÆÉÁöÑÂºïÁî®ËÆ°Êï∞„ÄÇ ËãπÊûú‰∏∫‰ªÄ‰πà‰∏çÈááÁî®ÂûÉÂúæÂõûÊî∂ÔºàGCÔºâÔºü ËãπÊûúÊõæÂú®OS X 10.5 Â∞ùËØï‰ΩøÁî®Ôºå‰∏çËøáÂú® 10.7 ÁöÑÊó∂ÂÄôÊää GC Êç¢Êàê‰∫Ü ARC„ÄÇGC Êúâ‰∏™ÈóÆÈ¢òËÆ©ËãπÊûú‰∏çËÉΩÂøçÔºöÂûÉÂúæÂõûÊî∂ÁöÑÊó∂ÂÄôÔºåÊï¥‰∏™Á®ãÂ∫èÈúÄË¶ÅÊöÇÂÅúÔºåËã±ÊñáÊääËøô‰∏™ËøáÁ®ãÂè´ÂÅöÔºöStop the World„ÄÇÊâÄÊúâÁöÑÂØπË±°ÈÉΩÈúÄË¶Å‰∏ÄËµ∑ÂõûÊî∂Êó∂ÔºåÈÄ†ÊàêÁî®Êà∑‰ΩìÈ™å‰∏çÂ•Ω„ÄÇ ARCÁõ∏ÂØπ‰∫éGCÊâÄÂÖ∑ÊúâÁöÑ‰ºòÁÇπÔºö ARCÂ∑•‰ΩúÂú®ÁºñËØëÊúüÔºåÂú®ËøêË°åÊó∂Ê≤°ÊúâÈ¢ùÂ§ñÂºÄÈîÄÔºàARCÊòØÁºñËØëÂô®Êääretain„ÄÅreleaseÁ≠âÊñπÊ≥ïÊèíÂÖ•Âà∞‰ª£Á†Å‰∏≠ÁöÑÔºåÊâÄ‰ª•ËØ¥ÊòØÂ∑•‰ΩúÂú®ÁºñËØëÊúüÔºâ„ÄÇ ARCÁöÑÂÜÖÂ≠òÂõûÊî∂ÊòØÂπ≥Á®≥ËøõË°åÁöÑÔºåÂØπË±°‰∏çË¢´‰ΩøÁî®Êó∂‰ºöÁ´ãÂç≥Ë¢´ÂõûÊî∂„ÄÇËÄåGCÁöÑÂÜÖÂ≠òÂõûÊî∂ÊòØ‰∏ÄÈòµ‰∏ÄÈòµÁöÑÔºåÂõûÊî∂Êó∂ÈúÄË¶ÅÊöÇÂÅúÁ®ãÂ∫èÔºå‰ºöÊúâ‰∏ÄÂÆöÁöÑÂç°È°ø„ÄÇ ARCÁõ∏ÂØπ‰∫éGCÊâÄÂÖ∑ÊúâÁöÑÁº∫ÁÇπÔºö ÈúÄË¶ÅÈ¢ùÂ§ñÁöÑÁ©∫Èó¥Êù•ËÆ∞ÂΩïÂºïÁî®Êï∞ÔºåÂØπË±°ÂÖ≥Á≥ªÂèëÁîüÂèòÂåñÊó∂ÈúÄË¶ÅÁªèÂ∏∏‰øÆÊîπÂºïÁî®Êï∞„ÄÇ ‰∏çËÉΩÂ§ÑÁêÜÂæ™ÁéØÂºïÁî®ÈóÆÈ¢ò„ÄÇ ÁÆÄÂçï‰ªãÁªçGCÁöÑÂéüÁêÜ Âü∫‰∫é‰∫ãÂÆûÔºöÂ§ßÈÉ®ÂàÜÁöÑÂØπË±°ÁöÑÁîüÂëΩÊúüÈÉΩÂæàÁü≠„ÄÇ GC Â∞ÜÂÜÖÂ≠ò‰∏≠ÁöÑÂØπË±°‰∏ªË¶ÅÂàÜÊàê‰∏§‰∏™Âå∫ÂüüÔºöYoung Âå∫Âíå Old Âå∫„ÄÇÂØπË±°ÂÖàÂú® Young Âå∫Ë¢´ÂàõÂª∫ÔºåÁÑ∂ÂêéÂ¶ÇÊûúÁªèËøá‰∏ÄÊÆµÊó∂Èó¥ËøòÂ≠òÊ¥ªÁùÄÔºåÂàôË¢´ÁßªÂä®Âà∞Old Âå∫„ÄÇÔºàÂÖ∂ÂÆûËøòÊúâ‰∏ÄPermÂå∫Ôºå‰ΩÜÊòØÂÜÖÂ≠òÂõûÊî∂ÁÆóÊ≥ïÈÄöÂ∏∏‰∏çÊ∂âÂèäËøô‰∏™Âå∫ÂüüÔºâ„ÄÇ YoungÂå∫ÁöÑÂØπË±°Âõ†‰∏∫Â§ßÈÉ®ÂàÜÁîüÂëΩÊúüÈÉΩÂæàÁü≠ÔºåÊØèÊ¨°ÂõûÊî∂‰πãÂêéÂè™ÊúâÂ∞ëÈÉ®ÂàÜËÉΩÂ§üÂ≠òÊ¥ªÔºåÊâÄ‰ª•ÈááÁî®ÁöÑÁÆóÊ≥ïÂè´CopyingÁÆóÊ≥ïÔºåÁÆÄÂçïËØ¥Êù•Â∞±ÊòØÁõ¥Êé•ÊääÊ¥ªÁùÄÁöÑÂØπË±°Â§çÂà∂Âà∞Âè¶‰∏Ä‰∏™Âú∞Êñπ„ÄÇYoung Âå∫ÂÜÖÈÉ®ÂèàÂàÜÊàê‰∫Ü‰∏âÂùóÂå∫ÂüüÔºöEdenÂå∫ÔºåFromÂå∫ÔºåToÂå∫„ÄÇÊØèÊ¨°ÊâßË°å Copying ÁÆóÊ≥ïÊó∂ÔºåÂç≥Â∞ÜÂ≠òÊ¥ªÁöÑÂØπË±°‰ªé Eden Âå∫Âíå From Âå∫Â§çÂà∂Âà∞ToÂå∫ÔºåÁÑ∂Âêé‰∫§Êç¢ From Âå∫ÂíåToÂå∫ÁöÑÂêçÂ≠óÔºàÂç≥From Âå∫ÂèòÊàê To Âå∫ÔºåToÂå∫ÂèòÊàêFromÂå∫Ôºâ„ÄÇ OldÂå∫ÁöÑÂõûÊî∂ÁÆóÊ≥ïÂè´ Mark-Sweep ÁÆóÊ≥ï„ÄÇÁÆÄÂçïÊù•ËØ¥ÔºåÂ∞±ÊòØÂè™ÊòØÊää‰∏çÁî®ÁöÑÂØπË±°ÂÖàÊ†áËÆ∞ÔºàMarkÔºâÂá∫Êù•ÔºåÁÑ∂ÂêéÂõûÊî∂ÔºàSweepÔºâÔºåÊ¥ªÁùÄÁöÑÂØπË±°Â∞±‰∏çÂä®ÂÆÉ‰∫Ü„ÄÇÂõ†‰∏∫Â§ßÈÉ®ÂàÜÂØπË±°ÈÉΩÊ¥ªÁùÄÔºåÊâÄ‰ª•ÂõûÊî∂‰∏ãÊù•ÁöÑÂØπË±°Âπ∂‰∏çÂ§ö„ÄÇ‰ΩÜÊòØËøô‰∏™ÁÆóÊ≥ï‰ºöÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºöÂÆÉ‰ºö‰∫ßÁîüÂÜÖÂ≠òÁ¢éÁâáÔºåÊâÄ‰ª•ÂÆÉ‰∏ÄËà¨Ëøò‰ºöÂ∏¶ÊúâÊï¥ÁêÜÂÜÖÂ≠òÁ¢éÁâáÁöÑÈÄªËæëÔºåÂú®ÁÆóÊ≥ï‰∏≠Âè´ÂÅö Compact„ÄÇ ‚ÄìÂèÇËÄÉËá™Ëá™Âä®ÂºïÁî®ËÆ°Êï∞(ARC)ÂíåÂûÉÂúæÂõûÊî∂(GC) ‰∫å.Â¶Ç‰ΩïÊèêÈ´òObjective-CÊñπÊ≥ïÁöÑÈÄüÂ∫¶ÈááÁî®IMP Caching„ÄÇ‰∏ÄËà¨ËÄåË®ÄÈÄüÂ∫¶ÊòØÂÖ∂‰ªñÊñπÊ≥ïÁöÑ‰∏§ÂÄç„ÄÇ id autorelease_class = [NSAutoreleasePool class];SEL autorelease_sel = @selector(addObject:);IMP autorelease_imp = [autorelease_class methodForSelector:autorelease_sel]; - (id) autorelease &#123; (*autorelease_imp)(autorelease_class,autorelease_sel,self);&#125; - (id)autorelease &#123; [NSAutoreleasePool addObject:self];&#125; Ê≥®Ôºö‰ª•‰∏äÊòØ‰π¶‰∏≠ÁöÑÁ§∫‰æã‰ª£Á†ÅÔºåÂÆûÈôÖ‰∏äÂú®ARCÊó∂‰ª£Â∑≤Áªè‰∏çÈúÄË¶ÅË∞ÉÁî®autoreleaseÊñπÊ≥ï‰∫Ü„ÄÇ‰ΩúËÄÖÊòØÊÉ≥ÂëäËØâÊàë‰ª¨ÔºåÂèØ‰ª•Áõ¥Êé•ÈÄöËøáÂáΩÊï∞ÊåáÈíàIMPË∞ÉÁî®Áõ∏ÂÖ≥ÊñπÊ≥ïÔºåÁªïËøáÊ∂àÊÅØÂèëÈÄÅ„ÄÇÊØîÂ¶ÇÔºö // ÂÅáÂÆöÈúÄË¶ÅÂ§öÊ¨°Ë∞ÉÁî®Êüê‰∏™ÂÆû‰æãÊñπÊ≥ï- (void)showWithName:(NSString *)name &#123; NSLog(@"my name is %@", name);&#125;// Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãËøôÊ†∑Ë∞ÉÁî®[self showWithName:@"Ya"];// ÂèØ‰ª•ÈÄöËøáIMPÁõ¥Êé•Ë∞ÉÁî®typedef id(*_IMP) (id, SEL, ...);SEL sel = @selector(showWithName:);_IMP imp = (_IMP)[self methodForSelector:sel];imp(self, sel, @"Ya"); Â¶ÇÊûúË¶ÅË∞ÉÁî®Á±ªÊñπÊ≥ïÔºå‰º†ÂÖ•Á±ªÂØπË±°Âç≥ÂèØÔºö _IMP imp = (_IMP)[self.class methodForSelector:sel];imp(self.class, sel, @"Ya"); IMPÈªòËÆ§ÊòØÊó†ÂèÇÊï∞ÔºåÊó†ËøîÂõûÂÄºÁ±ªÂûãÔºå‰∏îËá™Â∏¶_cmdÂíåselector„ÄÇÂ¶ÇÊûúË¶Å‰ΩøÁî®Â∏¶ÂèÇÊï∞ÊàñËÄÖÂ∏¶ËøîÂõûÂÄºÁöÑIMPÂèØ‰ª•ÈáçÊñ∞ÂÆö‰πâ‰∏Ä‰∏™‚ÄúIMP‚ÄùÔºö_IMPÔºötypedef id (*_IMP)(id, SEL,...);ÊàñËÄÖÂÖ≥Èó≠Xcode‰∏≠ÁöÑÁºñËØëÈÄâÈ°π„ÄÇ ‰∏â.ÈùûÊòæÂºè‰ΩøÁî®__autoreleasingÁöÑÂú∫ÊôØÊúâÂì™‰∫õÂú∫ÊôØ‰∏Ä:@autoreleasepool„ÄÇ ÁºñËØëÂô®‰ºöÊ£ÄÊü•@autoreleasepoolÂùó‰∏≠ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÊûú‰∏çÊòØ‰ª•alloc/new/copy/mutableCopyÂºÄÂ§¥ÔºåÂàôËá™Âä®ÊääÊñπÊ≥ïËøîÂõûÂÄºÁöÑÂØπË±°Ê≥®ÂÜåÂà∞autoreleasepool‰∏≠„ÄÇ @autoreleasepool &#123; NSObject *object = [[NSObject alloc] init]; // ==&gt;NSObject __strong *object = [[NSObject alloc] init]; NSArray *array = [NSArray array]; // ==&gt;NSArray __autoreleasing *array = [NSArray array]; &#125; Âú∫ÊôØ‰∫å:ÊñπÊ≥ïÁöÑËøîÂõûÂÄº„ÄÇ Ê≤°ÊúâÊòæÂºèÊåáÂÆöÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶ÔºåÊâÄ‰ª•ÈªòËÆ§‰∏∫__strong„ÄÇÁî±‰∫éreturn‰ΩøÂæóÂèòÈáèarrayË∂ÖÂá∫‰ΩúÁî®ÂüüÔºåÂº∫ÂºïÁî®ÂØπÂ∫îÊåÅÊúâÁöÑÂØπË±°‰ºöÈáäÊîæ„ÄÇ‰ΩÜÊòØËØ•ÂØπË±°‰Ωú‰∏∫ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÔºåÁºñËØëÂô®Ëá™Âä®Â∞ÜÂÖ∂Ê≥®ÂÜåÂà∞Ëá™Âä®ÈáäÊîæÊ±†‰∏≠ÔºåÂª∂ÁºìÈáäÊîæ(Âê¶ÂàôÂ¶ÇÊûúÁ´ãÂç≥ÈáäÊîæÔºåÈÇ£ËøîÂõûÂÄºÂ∞±Ê≤°ÊúâÊÑè‰πâ‰∫Ü)„ÄÇ - (id)array &#123; NSArray *array = [NSArray array]; // ==&gt;NSArray __strong *array = [NSArray array]; return array;&#125; Âú∫ÊôØ‰∏â:__weak‰øÆÈ•∞ÁöÑÂèòÈáè„ÄÇ__weak‰øÆÈ•∞ÁöÑÂèòÈáè‰ºöË¢´Ëá™Âä®Ê≥®ÂÜåÂà∞Ëá™Âä®ÈáäÊîæÊ±†‰∏≠„ÄÇÁî±‰∫é__weak‰∏çÊåÅÊúâÂØπË±°ÁöÑÂº∫ÂºïÁî®ÔºåÂú®ËÆøÈóÆËØ•ÂØπË±°ÁöÑÊó∂ÂÄôÔºåËØ•ÂØπË±°ÊúâÂèØËÉΩÂ∑≤ÁªèÈáäÊîæÔºå‰ΩÜÊòØË¶Å‰øùËØÅËÉΩËÆøÈóÆÂà∞ËØ•ÂØπË±°ÔºåÊâÄ‰ª•ÊääÂÆÉÊ≥®ÂÜåÂà∞Ëá™Âä®ÈáäÊîæÊ±†‰∏≠ÔºåÁ°Æ‰øù@autoreleasepoolÂùóÁªìÊùü‰πãÂâçËØ•ÂØπË±°Â≠òÂú®„ÄÇ id __weak object; Âú∫ÊôØÂõõ:ÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÁöÑÊåáÈíà„ÄÇÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÈªòËÆ§__strong‰øÆÈ•∞„ÄÇÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÁöÑÊåáÈíàÈªòËÆ§__autoreleasing‰øÆÈ•∞„ÄÇ NSObject *o;// ==&gt;NSObject __strong *o; NSObject **o;// ==&gt;NSObject* __autoreleasing *o; ‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®ÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÁöÑÊåáÈíà?ÈÄöÂ∏∏ÊòØÂõû‰º†ÂÄº„ÄÇÂú®CÂáΩÊï∞‰∏≠ÔºåÊó†Ê≥ïËøîÂõûÂ§ö‰∏™ÂÄºÔºåÂÄüÂä©ÊåáÈíàÂèØ‰ª•Âõû‰º†ÂÄº„ÄÇ // Ê±Ç‰∏§‰∏™Êï∞ÁöÑÂíå ÁßØNSInteger sum(NSInteger a, NSInteger b, NSInteger *product) &#123; // ËÆ°ÁÆó‰πòÁßØ *product = a * b; // ËøîÂõûÊ±ÇÂíå return a + b;&#125;// ‰ΩøÁî®NSInteger a = 3, b = 32, summation, product;summation = sum(a,b,&amp;product); NSLog(@"%ld--%ld",summation,product); Âú®Objective-C‰∏≠Â∏∏Áî®‰∫éNSErrorÂØπË±°„ÄÇ NSError *error = nil;NSURL *url = [NSURL URLWithString:@"ËøôÈáåÊòØURL"];[NSString stringWithContentsOfURL:url encoding:NSUTF8StringEncoding error:&amp;error]; stringWithContentsOfURL:encoding:error:ÊñπÊ≥ïËøîÂõûÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÊòØÂú®Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÁöÑÊó∂ÂÄôÂèØËÉΩÂèëÁîüÈîôËØØÔºå‰∫éÊòØ‰º†ÂÖ•ÊåáÂêëNSErrorÂØπË±°ÁöÑÊåáÈíàÁöÑÊåáÈíàÔºåÁî®‰∫éÂõû‰º†ÂÄº(errorÊòØÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÔºå*errorÊòØËØ•ÂØπË±°Ôºå&amp;errorÊòØÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÁöÑÊåáÈíà)„ÄÇ ËµãÁªôÂØπË±°ÊåáÈíàÊó∂ÔºåÂèòÈáèÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶ÂøÖÈ°ª‰øùÊåÅ‰∏ÄËá¥ÔºåÂê¶Âàô‰ºöÂá∫Èîô„ÄÇ‰øÆÈ•∞errorÁöÑÊòØ__strongÔºåËÄåËøôÈáåË¶ÅÊ±Ç‰º†ÂÖ•ÁöÑÊåáÈíàÁöÑÁ±ªÂûãÊòØ__autoreleasingÔºö(NSError * _Nullable __autoreleasing * _Nullable)Ôºå‰øÆÈ•∞Á¨¶‰∏ç‰∏ÄËá¥Ôºå‰∏çÁ¨¶ÂêàËßÑÂàôÔºå‰ΩÜÊòØÁºñËØëÂô®ÂÅö‰∫ÜËΩ¨Êç¢„ÄÇ // ËΩ¨Êç¢ÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶NSError *error = nil;NSError __autoreleasing *tmp = error;BOOL result = [obj performOperationWithError:&amp;tmp];error = tmp; ÂèØÊòØ‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®__autoreleasingÂë¢? ÂÆûÈôÖ‰∏ä‰∏çÊ≥®ÂÜåÂà∞Ëá™Âä®ÈáäÊîæÊ±†‰πüËÉΩ‰º†(ËøîÂõû)ÂÄºÔºåÂ∞±ÂÉèCÂáΩÊï∞‰∏≠ÁöÑÂõû‰º†‰πòÁßØÂÄº‰∏ÄÊ†∑„ÄÇ‰ΩÜÊòØËøôÊ†∑ÂÅö‰∏çÁ¨¶ÂêàÂÜÖÂ≠òÁÆ°ÁêÜËßÑÂàôÔºåÂè™Êúâ‰Ωú‰∏∫alloc/new/copy/mutableCopy ÂºÄÂ§¥ÁöÑÊñπÊ≥ïÔºåËÉΩÂ§üËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâ„ÄÇ‰πüÂç≥ÂÖ∂‰ªñÊñπÊ≥ïÁöÑËøîÂõûÂÄºÂèñÂæóÂØπË±°(Â∞±ÂÉèÂú∫ÊôØ‰∫å‰∏≠ÁöÑËøîÂõûÂÄºÂèñÂæóÂØπË±°‰∏ÄÊ†∑)ÈúÄË¶ÅÊ≥®ÂÜåÂà∞Ëá™Âä®ÈáäÊîæÊ±†„ÄÇ Â¶ÇËøôÁßç‰∏çÁ¨¶ÂêàÂÜÖÂ≠òÁÆ°ÁêÜËßÑÂàôÁöÑ‰ª£Á†Å: while (CFGetRetainCount(object) != 1) &#123; CFRelease(object);&#125;while (_objc_rootRetainCount(object) != 1) &#123; _objc_rootRelease(object);&#125; Âõõ.ÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÂú∫ÊôØÊúâÂì™‰∫õ1. Core FundationÁöÑÁ±ªÂûãËΩ¨Êç¢CFMutableArrayRef array = CFArrayCreateMutable(kCFAllocatorDefault, 0, NULL); // ÂºïÁî®ËÆ°Êï∞‰∏∫1printf("%ld\n",CFGetRetainCount(array)); id obj = (__bridge id)array; // ÂºïÁî®ËÆ°Êï∞‰∏∫2printf("%ld\n",CFGetRetainCount(array)); // ‰∏çË¶Å‰ΩøÁî®_objc_rootRetainCount(),Âæà‰∏çÂáÜÂæà‰∏çÂáÜÂæà‰∏çÂáÜ//NSLog(@"%d",_objc_rootRetainCount(fontRef)); // Â¶ÇÊûú‰∏ç‰ΩøÁî®CFRelease()Â∞±‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºèCFRelease(array);printf("%ld\n",CFGetRetainCount(array)); ‰∏ªË¶ÅÂéüÂõ†ÊòØËé∑ÂèñÂà∞CFÂØπË±°ÂêéÊ≤°ÊúâÂØπÂÖ∂ÂºïÁî®ËÆ°Êï∞ÂÅöÂá∫ÂêàÈÄÇÁöÑÂ§ÑÁêÜ„ÄÇ 2. ‰ΩøÁî®callocÂáΩÊï∞ÂàõÂª∫Âä®ÊÄÅÊï∞ÁªÑ// Â£∞ÊòéÂä®ÊÄÅÊï∞ÁªÑ// ÈªòËÆ§‰∏∫__autoreleasing‰øÆÈ•∞,ÈúÄÊòæÂºèÊåáÊòé‰∏∫__strongid __strong *array = nil;// ‰ΩøÁî®callocÂàÜÈÖçÂÜÖÂ≠òarray = (id __strong *)calloc(10, sizeof(id));// ‰ΩøÁî®array[0] = @"Aaren";// ÁÆÄÂçïÈáäÊîæÂÜÖÂ≠ò,ÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºè// ÂÆûÈôÖ‰∏äÂØπË±°array[0]ËøòÂ≠òÂú®free(array); Ê≠£Á°ÆÂÅöÊ≥ï: // Â£∞ÊòéÂä®ÊÄÅÊï∞ÁªÑ// ÈªòËÆ§‰∏∫__autoreleasing‰øÆÈ•∞,ÈúÄÊòæÂºèÊåáÊòé‰∏∫__strongid __strong *array = nil;// Â£∞ÊòéÂÆπÈáèNSInteger num = 10;// ‰ΩøÁî®callocÂàÜÈÖçÂÜÖÂ≠òarray = (id __strong *)calloc(num, sizeof(id));// ‰ΩøÁî®array[0] = @"Aaren";for (NSInteger i = 0;i &lt; num; i ++)&#123; array[i] = nil;&#125;// ÈáäÊîæÂÜÖÂ≠òfree(array); Ê≥®ÊÑè:1.‰∏çË¶Å‰ΩøÁî®mallocÂáΩÊï∞ÂàÜÈÖçÂÜÖÂ≠òÔºåmallocÂáΩÊï∞ÂàÜÈÖçÂÜÖÂ≠òÂå∫ÂüüÊ≤°ÊúâË¢´ÂàùÂßãÂåñ‰∏∫0ÔºåÂèØËÉΩ‰∫ßÁîüÈöèÊú∫ËÆøÈóÆÂØºËá¥ÈîôËØØÔºåÊâÄ‰ª•ËøòÈúÄË¶Å‰ΩøÁî®memset()ÂáΩÊï∞Â∞ÜÂÜÖÂ≠òÂ°´ÂÖÖ‰∏∫0„ÄÇ 2.ÂØπ‰∫éNSMutableSet/NSMutableArray/NSMutableDictionaryÁ≠âÂÆπÂô®Ôºå‰∏çÈúÄË¶Å‰∫∫‰∏∫ÊâãÂä®ÁÆ°ÁêÜ„ÄÇ 3. MRC‰∏ãÁöÑÂåøÂêçÂØπË±°[[NSObject alloc] init]; ÂåøÂêçÂØπË±°Âú®MRC‰∏ã‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºè(C++‰∏≠ÁöÑÂåøÂêçÂØπË±°ÂàõÂª∫ÂÆåÊØïÂêéÁ´ãÂç≥Ë∞ÉÁî®ÊûêÊûÑÂáΩÊï∞ÂÅöÈîÄÊØÅÂ§ÑÁêÜ)„ÄÇ ‰ΩÜÊòØÂú®ARCÁéØÂ¢É‰∏ãÔºå‰∏ç‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºè„ÄÇ id temp = objc_msgSend(NSObject, @selector(alloc));objc_msgSend(temp,@selector(init));objc_release(temp); ÂàõÂª∫ÂÆåÊØïÁ´ãÂç≥ÈîÄÊØÅÔºåËøô‰πüËß£Èáä‰∫Ü‰∏∫‰ªÄ‰πà‰ΩøÁî®__weak‰øÆÈ•∞Â∞ÜË¶ÅÂàõÂª∫ÁöÑÂØπË±°‰ºöÊúâË≠¶Âëä„ÄÇ NSObject * __weak object = [[NSObject alloc] init]; // ÊàñËÄÖid __weak object = [[NSObject alloc] init]; Ë≠¶ÂëäÔºöAssigning retained object to weak variable; object will be released after assignment„ÄÇ 4. blockÁöÑÂæ™ÁéØÂºïÁî®block‰Ωú‰∏∫Á±ªÂÆû‰æãÁöÑÊàêÂëòÂèòÈáèÔºåblockÂÜÖÈÉ®ÂèàÂº∫ÂºïÁî®ÁùÄÁ±ªÂÆû‰æã„ÄÇ @interface YAUser () &#123; block _block;&#125; - (void)func &#123; // Âæ™ÁéØÂºïÁî® _block = ^() &#123; NSLog(@"%p", self); &#125;; &#125; ‰∫î.__weakÂ¶Ç‰ΩïÂÆûÁé∞weak Ë°®ÁöÑ‰ΩúÁî®ÊòØÂú®ÂØπË±°ÊâßË°å dealloc ÁöÑÊó∂ÂÄôÂ∞ÜÊâÄÊúâÊåáÂêëËØ•ÂØπË±°ÁöÑ weak ÊåáÈíàÁöÑÂÄºËÆæ‰∏∫ nilÔºåÈÅøÂÖçÊÇ¨Á©∫ÊåáÈíà„ÄÇËãπÊûú‰ΩøÁî®‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑ weak Ë°®Êù•‰øùÂ≠òÊâÄÊúâÁöÑ weak ÂºïÁî®„ÄÇÂπ∂Â∞ÜÂØπË±°‰Ωú‰∏∫ÈîÆÔºåweak_entry_t ‰Ωú‰∏∫ÂÄº„ÄÇweak_entry_t ‰∏≠‰øùÂ≠ò‰∫ÜÊâÄÊúâÊåáÂêëËØ•ÂØπË±°ÁöÑ weak ÊåáÈíà„ÄÇ struct weak_table_t &#123; weak_entry_t *weak_entries; size_t num_entries; uintptr_t mask; uintptr_t max_hash_displacement;&#125;; ÂÖ≠.Core Fundation ‰∏é FoundationÂ¶Ç‰ΩïËΩ¨Êç¢1.__bridgeÂè™ÂÅöÁ±ªÂûãËΩ¨Êç¢Ôºå‰∏ç‰øÆÊîπÁõ∏ÂÖ≥ÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞ÔºåÂéüÊù•ÁöÑ Core Foundation ÂØπË±°Âú®‰∏çÁî®Êó∂ÔºåÈúÄË¶ÅË∞ÉÁî® CFRelease ÊñπÊ≥ï„ÄÇ CFMutableArrayRef array = CFArrayCreateMutable(kCFAllocatorDefault, 0, NULL);// ÂºïÁî®ËÆ°Êï∞‰∏∫1printf("%ld\n",CFGetRetainCount(array));// objÂº∫ÂºïÁî®ËØ•ÂØπË±°(ÈªòËÆ§‰∏∫__strong)id obj = (__bridge id)array;// ÂºïÁî®ËÆ°Êï∞‰∏∫2printf("%ld\n",CFGetRetainCount(array));// Â¶ÇÊûú‰∏ç‰ΩøÁî®CFRelease()Â∞±‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºèCFRelease(array);printf("%ld\n",CFGetRetainCount(array)); 2.__bridge_transferÂ∏∏Áî®Âú®CFÂØπË±°ËΩ¨ÂåñÊàêOCÂØπË±°Êó∂ÔºåÂ∞ÜCFÂØπË±°ÁöÑÊâÄÊúâÊùÉ‰∫§ÁªôOCÂØπË±°ÔºåÊ≠§Êó∂ARCÂ∞±ËÉΩËá™Âä®ÁÆ°ÁêÜËØ•ÂÜÖÂ≠òÔºå‰ΩúÁî®ÂêåCFBridgingRelease()„ÄÇ CFMutableArrayRef array = CFArrayCreateMutable(kCFAllocatorDefault, 0, NULL); // ÂºïÁî®ËÆ°Êï∞‰∏∫1printf("%ld\n",CFGetRetainCount(array)); // objÊåÅÊúâÂØπË±° arrayÊîæÂºÉÊåÅÊúâÂØπË±°,Áõ∏ÂΩì‰∫éÂÅö‰∫ÜCFRelease() id obj = (__bridge_transfer id)array; 3.__bridge_retained‰∏é__bridge_transfer Áõ∏ÂèçÔºåÂ∏∏Áî®Âú®Â∞ÜOCÂØπË±°ËΩ¨ÂåñÊàêCFÂØπË±°Ôºå‰∏îOCÂØπË±°ÁöÑÊâÄÊúâÊùÉ‰πü‰∫§ÁªôCFÂØπË±°Êù•ÁÆ°ÁêÜÔºåÂç≥OCÂØπË±°ËΩ¨ÂåñÊàêCFÂØπË±°Êó∂ÔºåÊ∂âÂèäÂà∞ÂØπË±°Á±ªÂûãÂíåÂØπË±°ÊâÄÊúâÊùÉÁöÑËΩ¨ÂåñÔºå‰ΩúÁî®ÂêåCFBridgingRetain()„ÄÇ NSMutableArray *obj = [NSMutableArray array];CFMutableArrayRef array2 = (__bridge_retained CFMutableArrayRef)obj;// ÂºïÁî®ËÆ°Êï∞‰∏∫2,objÊåÅÊúâÂØπË±°,array2‰πüÊåÅÊúâÂØπË±°printf("%ld\n",CFGetRetainCount(array2));// ‰ΩøÁî®ÂÆåÊØï,ÊâãÂä®release,Âê¶ÂàôÂÜÖÂ≠òÊ≥ÑÊºèCFRelease((array2)); ‰∏É.ÁÆÄÂçï‰ªãÁªçblockblockÊòØËÉΩÊåÅÊúâ‰ΩúÁî®ÂüüÂèòÈáèÁöÑÂåøÂêçÂáΩÊï∞ÔºåÊú¨Ë¥®‰∏äÊòØObjective-CÂØπË±°„ÄÇËØ≠Ê≥ïÊ†ºÂºè:^ ËøîÂõûÂÄºÁ±ªÂûã ÂèÇÊï∞ÂàóË°® Ë°®ËææÂºèÔºåÂÖ∂‰∏≠ËøîÂõûÂÄºÁ±ªÂûãÂèØÁúÅÁï•ÔºåÊó†ÂèÇÊï∞Êó∂ÂèÇÊï∞ÂàóË°®ÂèØÁúÅÁï•„ÄÇÂ£∞Êòéblock‰∏éÂ£∞ÊòéÂáΩÊï∞ÊåáÈíàÁ±ª‰ººÔºåÊâßË°åblock‰∏éË∞ÉÁî®ÂáΩÊï∞Á±ª‰ºº„ÄÇ // ËøîÂõûÂÄºÁ±ªÂûã (*f) ÂèÇÊï∞Á±ªÂûãint (*f)(int) = &amp;func; // Â£∞Êòéblockint (^blk)(int); // ËµãÂÄºint (^blk2)(int) = ^(int a)&#123; return 0;&#125;; // Ëµ∑Âà´Âêçtypedef int (^block) (int); blockÁöÑ‰∏âÁßçÁ±ªÂûã Â¶ÇÊûúblockÊ≤°ÊúâËÆøÈóÆÂ§ñÈÉ®ÁöÑÂ±ÄÈÉ®ÂèòÈáèÔºåÊàñËÄÖËÆøÈóÆÁöÑÂ±ÄÈÉ®ÂèòÈáèË¢´static‰øÆÈ•∞ÔºåblockÂ≠òÂÇ®Âú®ÈùôÊÄÅÂå∫ÔºåÊòØNSConcreteGlobalBlock„ÄÇ ÂÖ∂‰ªñÊÉÖÂÜµ‰∏ãÔºåËØ≠Ê≥ïÁîüÊàêÁöÑblockÂ≠òÊîæÂú®Ê†à‰∏≠ÔºåÊòØNSConcreteStackBlock„ÄÇ ÂΩìÊääÊ†à‰∏≠ÁöÑblockÂ§çÂà∂Âà∞Â†Ü‰∏äÊó∂ÔºåÊòØNSConcreteMallocBlock„ÄÇ blockÂ§çÂà∂Âà∞Â†Ü‰∏äÁöÑÊÉÖÂÜµÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÁºñËØëÂô®‰ºöÂ∞ÜÂàõÂª∫Âú®Ê†à‰∏äÁöÑ block Ëá™Âä®Êã∑Ë¥ùÂà∞Â†Ü‰∏äÔºåÂè™ÊúâÂΩì block ‰Ωú‰∏∫ÊñπÊ≥ïÊàñÂáΩÊï∞ÁöÑÂèÇÊï∞‰º†ÈÄíÊó∂ÔºåÁºñËØëÂô®‰∏ç‰ºöËá™Âä®Ë∞ÉÁî® copy ÊñπÊ≥ï„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂΩìÊñπÊ≥ïÊàñËÄÖÂáΩÊï∞‰∏≠block‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÔºåËÄåËøô‰∏™block‰∏çË¢´‰Ωú‰∏∫ÊàêÂëòÂèòÈáèËµãÂÄºÔºåÊàë‰ª¨ÈúÄË¶ÅÊâãÂä®Ë∞ÉÁî®copyÊñπÊ≥ï„ÄÇ ÁºñËØëÂô®ÊàñËÄÖÊñπÊ≥ïÂÜÖÈÉ®Â∑≤ÁªèÂÆûÁé∞copy‰ª£Á†ÅÁöÑÊÉÖÂÜµ: block‰Ωú‰∏∫ÂáΩÊï∞ËøîÂõûÂÄº„ÄÇ ËµãÂÄºÁªô __strong id Á±ªÂûãÁöÑÂØπË±°Êàñ block ÁöÑÊàêÂëòÂèòÈáè„ÄÇ CocoaÊ°ÜÊû∂ÊñπÊ≥ïÂêçÂê´ÊúâusingBlock„ÄÇ GCD‰∏≠ÁöÑAPI„ÄÇ ÂÖ∂‰ªñÊÉÖÂÜµÈúÄË¶ÅÊâãÂä®Â§çÂà∂„ÄÇ // Á®ãÂ∫èÂºÇÂ∏∏:Ê†à‰∏äÁöÑblockË¢´Â∫üÂºÉ typedef void(^block) (void); - (id)getBlockArray &#123; int val = 10; return [[NSArray alloc] initWithObjects: ^&#123;NSLog(@"blk0:%d", val);&#125;, ^&#123;NSLog(@"blk1:%d", val);&#125;, nil];&#125;- (void)viewDidLoad &#123; [super viewDidLoad]; block b = [self getBlockArray][0]; b();&#125; ÊâãÂä®Â∞Üblock Â§çÂà∂Âà∞Â†Ü‰∏ä: typedef void(^block) (void);- (id)getBlockArray &#123; int val = 10; return [[NSArray alloc] initWithObjects: [^&#123;NSLog(@"blk0:%d", val);&#125; copy], [^&#123;NSLog(@"blk1:%d", val);&#125; copy], nil];&#125;- (void)viewDidLoad &#123; [super viewDidLoad]; block b = [self getBlockArray][0]; b();&#125; blockÊçïËé∑ÂèòÈáè1.ÂØπ‰∫éÂÆû‰æãÂèòÈáè„ÄÅÈùôÊÄÅÂÖ®Â±ÄÂèòÈáè„ÄÅÈùôÊÄÅÂ±ÄÈÉ®ÂèòÈáèÔºåÂÖ®Â±ÄÂèòÈáèÔºåÊó†ËÆ∫ÂÖ∂‰∏∫Âü∫Êú¨Á±ªÂûãËøòÊòØÂØπË±°Á±ªÂûãÔºåÂú®block‰∏≠ÂèØËØªÂèØÂÜô„ÄÇ ÂÆö‰πâÂú®ÂáΩÊï∞ÂÜÖÈÉ®ÁöÑÂèòÈáèÁß∞‰∏∫Â±ÄÈÉ®ÂèòÈáèÔºàLocal VariableÔºâ„ÄÇÂú®ÊâÄÊúâÂáΩÊï∞Â§ñÈÉ®ÂÆö‰πâÁöÑÂèòÈáèÁß∞‰∏∫ÂÖ®Â±ÄÂèòÈáèÔºàGlobal VariableÔºâÔºåÂÆÉÁöÑ‰ΩúÁî®ÂüüÈªòËÆ§ÊòØÊï¥‰∏™Á®ãÂ∫èÔºå‰πüÂ∞±ÊòØÊâÄÊúâÁöÑÊ∫êÊñá‰ª∂„ÄÇ // ÈùôÊÄÅÂÖ®Â±ÄÂèòÈáèstatic NSInteger globalAge = 10;static NSString *globalName = @"Aaren";@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; // Â±ÄÈÉ®ÂèòÈáè NSInteger age = 12; // ÈùôÊÄÅÂ±ÄÈÉ®ÂèòÈáè static NSInteger staticAge = 17; static NSString *staticName = @"Bob"; YAUser *user = [[YAUser alloc] init]; void (^func)() = ^() &#123; // ‰øÆÊîπÂÆû‰æãÂèòÈáè user.age = 18; user.name = @"Jack"; NSLog(@"%ld",user.age); NSLog(@"%@",user.name); // ‰øÆÊîπÈùôÊÄÅÂ±ÄÈÉ®ÂèòÈáè staticAge = 22; staticName = @"Lucy"; NSLog(@"%ld",staticAge); NSLog(@"%@",staticName); // ‰øÆÊîπÈùôÊÄÅÂÖ®Â±ÄÂèòÈáè globalAge = 14; globalName = @"Allen"; NSLog(@"%ld",globalAge); NSLog(@"%@",globalName); &#125;; func(); NSLog(@"%ld",user.age); NSLog(@"%@",user.name); NSLog(@"%ld",staticAge); NSLog(@"%@",staticName); NSLog(@"%ld",globalAge); NSLog(@"%@",globalName);&#125;@end 2.ÂØπ‰∫éÂ±ÄÈÉ®ÂèòÈáèÔºåÊó†ËÆ∫ÂÖ∂ÊòØÂü∫Êú¨Á±ªÂûãËøòÊòØÂØπË±°Á±ªÂûãÔºåÂú®block‰∏≠‰∏∫Âè™ËØªÔºåÂΩì‰ΩøÁî®__block‰øÆÈ•∞Êó∂ÔºåÂèòÈáèÂèØËØªÂèØÂÜô„ÄÇ__block‰øÆÈ•∞ÁöÑÂØπË±°Á±ªÂûãÂèòÈáèÔºåÂú®ARCÁéØÂ¢É‰∏ãÔºåblockÂØπÂÖ∂Âº∫ÂºïÁî®„ÄÇÂú®ÈùûARCÁéØÂ¢É‰∏ãÔºåblock‰∏ç‰ºöÂØπÂÖ∂retain„ÄÇ - (void)viewDidLoad &#123; [super viewDidLoad]; // Â±ÄÈÉ®ÂèòÈáè __block NSInteger age = 17; __block NSString *name = @"Bob"; void (^func)() = ^() &#123; // ‰øÆÊîπÂ±ÄÈÉ®ÂèòÈáè age = 18; name = @"Jack"; NSLog(@"%ld",age); NSLog(@"%@",name); &#125;; func(); // ‰øÆÊîπÂ±ÄÈÉ®ÂèòÈáè age = 22; name = @"Aaren"; NSLog(@"%ld",age); NSLog(@"%@",name);&#125; blockÁöÑÂæ™ÁéØÂºïÁî®Capturing ‚Äòself‚Äô strongly in this block is likely to lead to a retain cycle. .hÊñá‰ª∂ @interface YAUser : NSObject@property (nonatomic, strong) NSObject *object;- (void)func;@end .mÊñá‰ª∂ typedef void (^block) ();@interface YAUser () &#123; block _block;&#125;@end@implementation YAUser- (void)func &#123; // Âæ™ÁéØÂºïÁî® self.object = [[NSObject alloc] init]; _block = ^() &#123; NSLog(@"%@", self.object); &#125;; _block();&#125;@end Áî±‰∫éblockËµãÂÄºÁªô‰∫ÜÊàêÂëòÂèòÈáèÔºåÊâÄ‰ª•Âú®Ê†à‰∏äÁîüÊàêÁöÑblockË¢´Â§çÂà∂Âà∞Â†Ü‰∏ä„ÄÇËÄåblockÂº∫ÂºïÁî®‰∫ÜselfÁöÑÊàêÂëòÂèòÈáèobjectÔºåÂÆûÈôÖ‰∏äÊòØÊåÅÊúâ‰∫ÜselfÔºåselfÊåÅÊúâblockÁöÑÂêåÊó∂blockÊåÅÊúâselfÔºå‰∫éÊòØselfÂíåblockÂæ™ÁéØÂºïÁî®„ÄÇ Ëß£ÂÜ≥ÊñπÊ°à‰∏ÄÔºöÈááÁî®__weak‰øÆÈ•∞„ÄÇ- (void)func &#123; // __weakËß£ÂÜ≥Âæ™ÁéØÂºïÁî® self.object = [[NSObject alloc] init]; // Â£∞Êòé‰∫Ü‰∏Ä‰∏™selfÁ±ªÂûãÁöÑweakÊåáÈíàÔºåÂêçÂ≠óÂè´ÂÅöweakSelf. __weak typeof(self) weakSelf = self; _block = ^() &#123; NSLog(@"%@", weakSelf.object); &#125;; _block();&#125; Êõ¥Êîπ‰∏ÄÊñπÁöÑÂº∫ÂºïÁî®‰∏∫Âº±ÂºïÁî®ÊâìÁ†¥‰∫ÜÂæ™ÁéØÂºïÁî®„ÄÇ‰ΩÜÊòØÊúâÁëïÁñµÔºöblockÂÜÖÈÉ®ÂèØËÉΩÊçïËé∑Âà∞Á©∫ÂÄº„ÄÇ - (void)func &#123; // __weakËß£ÂÜ≥Âæ™ÁéØÂºïÁî® self.object = [[NSObject alloc] init]; __weak typeof(self) weakSelf = self; _block = ^() &#123; // Áé∞Âú®Á´ãÂç≥‰ΩøÁî®weakSelf.object NSLog(@"%@", weakSelf.object); // ÈúÄË¶ÅÂºÇÊ≠•ÊâßË°å,‰ΩÜÊòØÂç¥Êó†Ê≥ï‰øùËØÅweakSelf.object‰∏ÄÂÆöÂ≠òÂú® dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSLog(@"%@",weakSelf.object); &#125;); &#125;; // Ë∞ÉÁî®block _block(); // Ëá™‰ª•‰∏∫blockË∞ÉÁî®ÂÆåÊØï,‰∏çÂÜçÈúÄË¶Åself.objectÁöÑÂÄº‰∫Ü,Â§ßËÉÜÂú∞Â∞Üself.objectÊîπ‰∏∫ÂÖ∂‰ªñÂÄº self.object = nil;&#125; ËøôÁßçÊÉÖÂÜµÂ∞±ÈÄ†ÊàêblockÂÜÖÈÉ®Ê≠£Âú®‰ΩøÁî®ÊåÅÊúâÂèòÈáèÁöÑÊó∂ÂÄôÔºåÂèòÈáèÁöÑÂÄºÂç¥ÊÑèÂ§ñÂú∞ÊîπÂèò‰∫ÜÔºåÁîöËá≥‰∏∫nilÔºåÊûÅÊòìÂºïÂèëÈóÆÈ¢ò„ÄÇÊúÄ‰Ω≥ÊñπÊ°àÔºöÂº±ÂºïÁî®Âä†Âº∫ÂºïÁî® - (void)func &#123; // __weakËß£ÂÜ≥Âæ™ÁéØÂºïÁî® self.object = [[NSObject alloc] init]; __weak typeof(self) weakSelf = self; _block = ^() &#123; // __strongÂèØ‰ª•‰∏çÂä†,ÈªòËÆ§‰∏∫__strong,‰ΩÜÊúÄÂ•ΩÂä†‰∏ä,Êõ¥ÈÜíÁõÆ __strong NSObject *strongObject = weakSelf.object; // ÊúÄÂ•ΩÂä†‰∏äÂà§Êñ≠,‰øùËØÅstrongObject‰∏ç‰∏∫Á©∫ if (strongObject) &#123; // Áé∞Âú®Á´ãÂç≥‰ΩøÁî®weakSelf.object NSLog(@"%@",strongObject); // ÈúÄË¶ÅÂºÇÊ≠•ÊâßË°å,ÂèØ‰ª•‰øùËØÅweakSelf.objectÁöÑÂÄº‰∏çÊîπÂèò dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSLog(@"%@",strongObject); &#125;); &#125; &#125;; // Ë∞ÉÁî®block _block(); // ÊîæÂøÉÂú∞Â∞Üself.objectÊîπ‰∏∫ÂÖ∂‰ªñÂÄº self.object = nil;&#125; Ëøô‰πàÂÅöÂèØ‰ª•‰øùËØÅÂú®blockÊâßË°åÊúüÈó¥ÊåÅÊúâÁöÑÂèòÈáè‰∏çÊîπÂèò„ÄÇ‰ΩÜÂ¶ÇÊûúÂú®blockÊâßË°å‰πãÂâçËØ•ÂèòÈáèÂ∑≤Áªè‰∏∫nilÔºåÈÇ£ÂõûÂ§©‰πèÂäõ„ÄÇ ËØÑ‰ª∑:ËøôÁßçÊñπÂºè‰∏ç‰ºöÈÄ†ÊàêÂæ™ÁéØÂºïÁî®ÔºöblockÂº±ÂºïÁî®ÁöÑÊñπÂºèÊåÅÊúâself.objectÔºåÂç≥‰∏ç‰ºöÂΩ±Âìçself.objectÁöÑÈáäÊîæ„ÄÇÂú®block‰∏≠ÊòØÈÄöËøáÂ±ÄÈÉ®ÂèòÈáèÂº∫ÂºïÁî®self.objectÔºå‰ΩúÁî®ÂüüÁªìÊùüÔºåÂ±ÄÈÉ®ÂèòÈáèÈîÄÊØÅÔºå‰∏çÂÜçÂº∫ÂºïÁî®Ôºå‰ªéÊ≠§‰Ω†ÊàëÊòØË∑Ø‰∫∫„ÄÇ Ê≥®ÊÑè‰∫ãÈ°π:1.Èô§‰∫Ü‰ΩøÁî®typeof()‰πãÂ§ñÔºåËøòÂèØ‰ª•Áõ¥Êé•Â£∞Êòé‰∏éselfÁõ∏ÂêåÁ±ªÂûãÁöÑÂèòÈáèÔºå‰ΩÜ‰æùÁÑ∂ÈúÄË¶Å‰ΩøÁî®__weak‰øÆÈ•∞„ÄÇ __weak YAUser *weakSelf = self; 2.Âæ™ÁéØÂºïÁî®ÁöÑÊú¨Ë¥®ÊòØblockÂº∫ÂºïÁî®‰∫Üself„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰ª• ‰ª•‰∏ä‰ª£Á†Å‰∏∫‰æãÔºöblockÊåÅÊúâ‰∫ÜselfÁöÑÊüê‰∏™ÊàêÂëòÂèòÈáèÔºå‰∏îblockÂú®Âêå‰∏Ä‰∏™‰ΩúÁî®ÂüüÂÜÖÂæóÂà∞Ë∞ÉÁî®ÔºåÂÆåÂÖ®ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊñπÂºèËß£ÂÜ≥ÔºàÈùû‰∏ªÊµÅÊñπÂºèÔºåÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã‰∏çÂèØËÉΩÂú®block‰∏≠Âè™‰ΩøÁî®‰∏Ä‰∏™ÊàêÂëòÂèòÈáèÔºå‰∏Ä‰∏™ËÑëÊ¥ûËÄåÂ∑≤ÔºåÂÆûÈôÖÂºÄÂèë‰∏çË¶ÅËøô‰πàÂÅöÔºâ„ÄÇ - (void)func &#123; // Âæ™ÁéØÂºïÁî® self.object = [[NSObject alloc] init]; NSObject *weakObject = self.object; _block = ^() &#123; NSLog(@"%@", weakObject); &#125;; _block();&#125; ‰ΩøÁî®Âú∫ÊôØ:‰∏çÈúÄË¶ÅÂØπblock‰∏≠ÊåÅÊúâÁöÑÂèòÈáèËøõË°åÂÜôÂÖ•Êìç‰ΩúÔºå‰πüÂç≥‰ªÖ‰ªÖËØªÂèñÂèòÈáè„ÄÇÂΩìblockÂºÇÊ≠•‰ΩøÁî®ÊåÅÊúâÁöÑÂèòÈáèÊó∂ÔºåÊ≥®ÊÑèÂº±ÂºïÁî®+Âº∫ÂºïÁî®ÈÖçÂêà‰ΩøÁî®„ÄÇÂª∫ËÆÆÁªü‰∏ÄÈááÁî® typeof(self) + Âº±ÂºïÁî® + Âº∫ÂºïÁî®ÁöÑÂΩ¢Âºè„ÄÇ Ëß£ÂÜ≥ÊñπÊ°à‰∫åÔºöÈááÁî®__block‰øÆÈ•∞„ÄÇ‰∫ßÁîüÂæ™ÁéØÂºïÁî®ÁöÑ‰ª£Á†Å: - (void)func &#123; // Âæ™ÁéØÂºïÁî® _block = ^() &#123; NSLog(@"%p", self); &#125;;&#125;- (void)execBlock &#123; _block();&#125; Ëß£ÂÜ≥Âæ™ÁéØÂºïÁî®: - (void)func &#123; // Ëß£ÂÜ≥Âæ™ÁéØÂºïÁî® __block id tmp = self; _block = ^() &#123; NSLog(@"%p", tmp); // ÂÖ≥ÈîÆÊâÄÂú® tmp = nil; &#125;;&#125;- (void)execBlock &#123; _block();&#125; ËØÑ‰ª∑:__blockÊú¨Ë∫´‰∏çËÉΩËß£ÂÜ≥Âæ™ÁéØÂºïÁî®ÔºåÂÖ≥ÈîÆÂú®‰∫é Âú®block‰∏≠Â∞Ü__block‰øÆÈ•∞ÁöÑÂèòÈáèÁΩÆ‰∏∫Á©∫„ÄÇÂΩìÈúÄË¶ÅÂØπÊåÅÊúâÁöÑÂèòÈáèËøõË°åÂÜôÂÖ•Êìç‰ΩúÊó∂ÂèØ‰ª•‰ΩøÁî®„ÄÇ Ê≥®ÊÑè‰∫ãÈ°π:blockÂøÖÈ°ªÊâßË°åÔºåÂê¶Âàô‰ªçÁÑ∂‰∏ç‰ºöËß£ÂÜ≥Âæ™ÁéØÂºïÁî®„ÄÇÂ¶Ç‰∏ãÈù¢‰ª£Á†Å: - (void)func &#123; // Ëß£ÂÜ≥Âæ™ÁéØÂºïÁî® __block id tmp = self; _block = ^() &#123; NSLog(@"%p",tmp); tmp = nil; &#125;;&#125;- (void)execBlock &#123; // blockÊ≤°ÊúâÊâßË°å,‰ªçÁÑ∂‰∏çËÉΩËß£ÂÜ≥Âæ™ÁéØÂºïÁî® // _block();&#125; ‰∏∫‰ªÄ‰πàblockÊ≤°ÊúâÊâßË°åÂ∞±Êó†Ê≥ïËß£ÂÜ≥Âæ™ÁéØÂºïÁî®Âë¢?Âú®block‰∏≠Âá∫Áé∞tmpÂèòÈáèÁöÑÈÇ£ÂàªËµ∑(tmpÂèòÈáèÂç≥self)ÔºåblockÂ∞±Â∑≤ÁªèÊåÅÊúâ‰∫ÜselfÔºåÂç≥‰∫ßÁîü‰∫ÜÂæ™ÁéØÂºïÁî®ÔºåÂ¶ÇÔºö _block = ^() &#123;tmp;&#125;; ËÄåÂè™ÊúâÈÄöËøáÊâßË°åblockÊâçËÉΩÊäänilËµãÁªôtmpÔºåÊâçËÉΩÊâìÁ†¥Âæ™ÁéØÂºïÁî®„ÄÇÂõ†Ê≠§ÔºåÊâßË°åblockÁöÑÁõÆÁöÑÊòØÊäänilËµã‰∫àtmpÔºåËÄåÊäänilËµã‰∫àtmp‰æøËÉΩËß£ÂÜ≥Âæ™ÁéØÂºïÁî®ÁöÑÂéüÂõ†ÊòØÊâìÁ†¥‰∫ÜblockÂØπselfÁöÑÂº∫ÂºïÁî®„ÄÇ ÂÖ´.ÁÆÄË¶Å‰ªãÁªçGCDÂ∏∏Áî®API1.dispatch_async‰∏édispatch_sync// ÂºÇÊ≠•ÊâßË°ådispatch_async(dispatch_get_main_queue(), ^&#123; &#125;); // ÂêåÊ≠•ÊâßË°ådispatch_sync(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; &#125;); 2.dispatch_queue_t‰ΩøÁî®Á≥ªÁªüÊèê‰æõÁöÑqueue // ‰∏ªÈòüÂàó:‰∏≤Ë°åÈòüÂàódispatch_queue_t mainQueue = dispatch_get_main_queue();// ÂÖ®Â±ÄÈòüÂàó:Âπ∂Ë°åÈòüÂàódispatch_queue_t globalQueue1 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);dispatch_queue_t globalQueue2 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);dispatch_queue_t globalQueue3 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0);dispatch_queue_t globalQueue4 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0); Ëá™Â∑±ÂàõÂª∫queue // ‰∏ÄËà¨ÊåáÂÆöËøô‰∏§ÁßçÁ±ªÂûã// DISPATCH_QUEUE_SERIAL// DISPATCH_QUEUE_CONCURRENTdispatch_queue_t createQueue = dispatch_queue_create("com.chenyalun.gcd.createQueue", DISPATCH_QUEUE_SERIAL);dispatch_async(createQueue, ^&#123; NSLog(@" ");&#125;);// If your deployment target is iOS 6.0 or Mac OS X 10.8 or later//dispatch_release(createQueue);// ÊåáÂÆöÂàõÂª∫ÁöÑÈòüÂàó‰∏églobalQueue‰∫´ÊúâÂêå‰∏Ä‰ºòÂÖàÁ∫ß// ‰∏çÂèØÊåáÂÆöÁ≥ªÁªüÁöÑÈòüÂàódispatch_set_target_queue(createQueue, globalQueue); Ê≥®ÊÑè: Áé∞Âú®ÈÄÇÈÖçÁöÑÁâàÊú¨‰∏ÄËà¨Â§ß‰∫éiOS6ÔºåÂõ†Ê≠§‰∏çÂøÖ‰πü‰∏çËÉΩÂØπËá™Â∑±ÂàõÂª∫ÁöÑqueueËøõË°ådispatch_releaseÔºå‰∏çÈúÄË¶ÅÊãÖÂøÉÂÜÖÂ≠òÊ≥ÑÊºè„ÄÇ Ëá™Â∑±ÂàõÂª∫ÁöÑÈòüÂàó‰∏•Ê†ºÊåâÁÖßÊ†ºÂºèÊù•ÔºåÂ∞§ÂÖ∂ÊòØ‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÁöÑqueueÁöÑÂêçÁß∞Ôºö‚Äùcom.chenyalun.gcd.createQueue‚Äù Á¨¨‰∫å‰∏™ÂèÇÊï∞ËÆæÁΩÆ‰∏∫NULLÔºåÂàô‰∏∫‰∏≤Ë°åÈòüÂàó„ÄÇspecify DISPATCH_QUEUE_SERIAL (or NULL) to create a serial queue or specify DISPATCH_QUEUE_CONCURRENT to create a concurrent queue. In earlier versions, you must specify NULL for this parameter. 3.dispatch_resume/dispatch_suspendÈòüÂàóÁöÑÊåÇËµ∑‰∏éÊÅ¢Â§ç // ÂÖ®Â±ÄÈòüÂàó:Âπ∂Ë°åÈòüÂàódispatch_queue_t globalQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0); dispatch_async(globalQueue, ^&#123; NSLog(@"ÈòüÂàó‰∏≠ÁöÑÊâìÂç∞");&#125;); // ÊåÇËµ∑dispatch_suspend(globalQueue); NSLog(@"‰∏ªÁ∫øÁ®ãÁöÑÊâìÂç∞"); // ÊÅ¢Â§çÊâßË°ådispatch_resume(globalQueue); 4.dispatch_apply// ÊåáÂÆöËø≠‰ª£ÁöÑÊ¨°Êï∞NSArray *array = @[@1, @2, @3, @4, @5, @6, @7];dispatch_apply(array.count, globalQueue, ^(size_t index) &#123; NSLog(@"%@", [array objectAtIndex:index]);&#125;); 5.dispatch_groupdispatch_group_t group = dispatch_group_create();dispatch_group_async(group, globalQueue, ^&#123; NSLog(@"‰ªªÂä°‰∏Ä");&#125;);dispatch_group_async(group, globalQueue, ^&#123; NSLog(@"‰ªªÂä°‰∫å");&#125;);dispatch_group_async(group, globalQueue, ^&#123; NSLog(@"‰ªªÂä°‰∏â");&#125;); // ‰øùËØÅ‰ª•‰∏ä‰∏â‰∏™‰ªªÂä°ÊâßË°åÂÆåÊØïÂÜçÊâßË°å‰∏ãÈù¢ÁöÑ‰ªªÂä°dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123; NSLog(@"‰ªªÂä°‰∏Ä„ÄÅ‰∫å„ÄÅ‰∏âÈÉΩÂ∑≤ÂÆåÊàê");&#125;); dispatch_group_t group = dispatch_group_create();dispatch_group_async(group, globalQueue, ^&#123; NSLog(@"‰ªªÂä°‰∏Ä");&#125;);dispatch_group_async(group, globalQueue, ^&#123; NSLog(@"‰ªªÂä°‰∫å");&#125;);dispatch_group_async(group, globalQueue, ^&#123; NSLog(@"‰ªªÂä°‰∏â");&#125;); // ‰øùËØÅ‰ª•‰∏ä‰∏â‰∏™‰ªªÂä°ÊâßË°åÂÆåÊØïÂÜçÊâßË°å‰∏ãÈù¢ÁöÑ‰ªªÂä°// DISPATCH_TIME_NOW ‰∏çÁ≠âÂæÖ// DISPATCH_TIME_FOREVER Ê∞∏‰πÖÁ≠âÂæÖNSInteger result = dispatch_group_wait(group, DISPATCH_TIME_FOREVER);if (result == 0) &#123; // group‰∏≠ÁöÑ‰ªªÂä°ÂÖ®ÈÉ®ÊâßË°åÂÆåÊØï NSLog(@"group‰∏≠ÁöÑ‰ªªÂä°ÂÖ®ÈÉ®ÊâßË°åÂÆåÊØï");&#125; else &#123; // ‰ªªÂä°Ê≤°ÊúâÊâßË°åÂÆåÊØï&#125; 6.dispatch_barrierdispatch_async(globalQueue, ^&#123; NSLog(@"Á¨¨‰∏Ä‰∏™‰ªªÂä°");&#125;);dispatch_async(globalQueue, ^&#123; NSLog(@"Á¨¨‰∫å‰∏™‰ªªÂä°");&#125;);// Ê†ÖÊ†èÂáΩÊï∞dispatch_barrier_async(globalQueue, ^&#123; NSLog(@"----------------------");&#125;);dispatch_async(globalQueue, ^&#123; NSLog(@"Á¨¨‰∏â‰∏™‰ªªÂä°„ÄÇ");&#125;);dispatch_async(globalQueue, ^&#123; NSLog(@"Á¨¨Âõõ‰∏™‰ªªÂä°");&#125;); 7.dispatch_once// typedef long dispatch_once_t;// static long onceToken;static dispatch_once_t onceToken;dispatch_once(&amp;onceToken, ^&#123; NSLog(@"‰ªÖ‰ªÖÊâßË°å‰∏ÄÊ¨°");&#125;); 8.dispatch_afterdispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(3.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; NSLog(@"ÊääË¶ÅÊâßË°åÁöÑ‰ªªÂä°ËøΩÂä†Âà∞‰∏ªÈòüÂàó‰∏≠");&#125;); ÊåáÂÆö3Áßí‰πãÂêéÊääË¶ÅÊâßË°åÁöÑ‰ªªÂä°ËøΩÂä†Âà∞‰∏ªÈòüÂàó‰∏≠„ÄÇÊúÄÊó©3.0ÁßíÂêéÊâßË°åÔºåÊúÄËøü3+1/60ÁßíÂêéÊâßË°åÔºåËã•‰∏ªÁ∫øÁ®ãÊúâÂª∂ËøüÔºåÊó∂Èó¥‰ºöÊõ¥Èïø„ÄÇ // DISPATCH_TIME_NOW// DISPATCH_TIME_FOREVER// Êó∂Èó¥ÁöÑÂçï‰Ωç‰∏∫ÊØ´ÂæÆÁßídispatch_time_t time = dispatch_time(DISPATCH_TIME_FOREVER, 3000000); 7.dispatch_semaphoreÊõ¥ÁªÜÁ≤íÂ∫¶ÁöÑÊéí‰ªñÊéßÂà∂// ÂÖ®Â±ÄÈòüÂàó:Âπ∂Ë°åÈòüÂàódispatch_queue_t globalQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);// ËÆæÁΩÆ‰ø°Âè∑Èáè‰∏∫1,‰πüÂç≥‰øùËØÅÂêåÊó∂ËÆøÈóÆÁöÑÊï∞Èáè‰∏∫1dispatch_semaphore_t semaphore = dispatch_semaphore_create(1);NSMutableArray *array = [NSMutableArray array];// Ëø≠‰ª£Ê∑ªÂä†ÂØπË±°dispatch_apply(100, globalQueue, ^(size_t index) &#123; // Â∞ÜË¶ÅÊ∑ªÂä†ÂÖÉÁ¥†Ââç‰∏ÄÁõ¥Á≠âÂæÖ‰ø°Âè∑Èáè‰∏∫1 dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER); // ÊîæÂøÉÂú∞ÁªôÊï∞ÁªÑÊ∑ªÂä†ÂÖÉÁ¥† [array addObject:[NSNumber numberWithInt:(int)index]]; // Ê∑ªÂä†ÂÆåÊàêÂêéÈáäÊîæ‰ø°Âè∑Èáè dispatch_semaphore_signal(semaphore);&#125;);]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØª„ÄäSQLÂøÖÁü•ÂøÖ‰ºö„Äã]]></title>
    <url>%2F2017%2F04%2F09%2F%E8%AF%BB%E3%80%8ASQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫éSQLiteÊï∞ÊçÆÂ∫ì„ÄÇ ÈááÁî® SQLite Êï∞ÊçÆÂ∫ì„ÄÇÊâÄÊúâÂëΩ‰ª§ÈÉΩÊï≤‰∫Ü‰∏ÄÈÅçÔºåÊ≤°ÊØõÁóÖ„ÄÇ ‰∏Ä„ÄÅÊèêË¶Å1.ËØ≠Ë®Ä Êï∞ÊçÆÂÆö‰πâËØ≠Ë®ÄCREATE ÂàõÂª∫Ë°®/ËßÜÂõæ/ÂÖ∂‰ªñÂØπË±°ALTER ‰øÆÊîπÂØπË±°DROP Âà†Èô§Ë°®/ËßÜÂõæ/ÂÖ∂‰ªñÂØπË±° Êï∞ÊçÆÊìçÁ∫µËØ≠Ë®ÄSELECT Ê£ÄÁ¥¢Êï∞ÊçÆINSERT ÂàõÂª∫ËÆ∞ÂΩïUPDATE ‰øÆÊîπËÆ∞ÂΩïDELETE Âà†Èô§ËÆ∞ÂΩï Êï∞ÊçÆÊéßÂà∂ËØ≠Ë®ÄGRANT Ëµã‰∫àÁî®Êà∑ÁâπÊùÉREVOKE Êî∂ÂõûÁî®Êà∑ÁâπÊùÉ 2.Ê¶ÇÂøµË°®ÔºöÊüêÁßçÁâπÂÆöÁ±ªÂûãÊï∞ÊçÆÁöÑÁªìÊûÑÂåñÊ∏ÖÂçïÂ≠óÊÆµÔºöÈôêÂÆöÊï∞ÊçÆ‰∏≠ÁöÑÂàó(Âêç)ËÆ∞ÂΩïÔºöÊ∞¥Âπ≥ÊéíÂàóÁöÑÊï∞ÊçÆÁöÑÂÆû‰ΩìÂàóÔºöË°®‰∏≠ÁöÑ‰∏Ä‰∏™Â≠óÊÆµÊ®°ÂºèÔºöÊï∞ÊçÆÂ∫ìÂíåË°®ÁöÑÂ∏ÉÂ±ÄÂèäÁâπÊÄßNULLÂÄºÔºöË°®‰∏≠‰ª•Á©∫ÁôΩÂΩ¢ÂºèÂá∫Áé∞ÁöÑÂÄºÔºåË°®Á§∫Ê≤°ÊúâËÆæÂÄº‰∏ªÈîÆÂÄºÔºö‰∏çÈáçÂ§çÔºå‰∏ç‰∏∫Á©∫Ôºå‰∏çËÉΩ‰øÆÊîπÔºå‰∏çËÉΩÈáçÁî® 3.Á±ªÂûãSQLiteÊó†Á±ªÂûãÔºåÂú®Ë°®Â£∞Êòé‰∏≠ÊòéÁ°Æ‰∫ÜÂ≠óÊÆµÁ±ªÂûãÔºå‰ªçÁÑ∂ÂèØ‰ª•Âú®ËØ•Â≠óÊÆµ‰∏≠Â≠òÂÇ®ÂÖ∂ÂÆÉÁ±ªÂûãÁöÑÊï∞ÊçÆ„ÄÇ NULLÔºöË°®Á§∫ËØ•ÂÄº‰∏∫NULLÂÄº„ÄÇINTEGERÔºö Êó†Á¨¶Âè∑Êï¥ÂûãÂÄº„ÄÇREALÔºöÊµÆÁÇπÂÄº„ÄÇTEXTÔºöÊñáÊú¨Â≠óÁ¨¶‰∏≤ÔºåÂ≠òÂÇ®‰ΩøÁî®ÁöÑÁºñÁ†ÅÊñπÂºè‰∏∫UTF-8„ÄÅUTF-16BE„ÄÅUTF-16LE„ÄÇBLOBÔºöÂ≠òÂÇ®BlobÊï∞ÊçÆÔºåËØ•Á±ªÂûãÊï∞ÊçÆÂíåËæìÂÖ•Êï∞ÊçÆÂÆåÂÖ®Áõ∏Âêå„ÄÇÂ∏ÉÂ∞îÊï∞ÊçÆÁ±ªÂûãÔºöSQLiteÂπ∂Ê≤°ÊúâÊèê‰æõ‰∏ìÈó®ÁöÑÂ∏ÉÂ∞îÂ≠òÂÇ®Á±ªÂûãÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØÂ≠òÂÇ®Êï¥Âûã1Ë°®Á§∫trueÔºå0Ë°®Á§∫false„ÄÇÊó•ÊúüÂíåÊó∂Èó¥Êï∞ÊçÆÁ±ªÂûãÔºö‰ª•TEXT„ÄÅREALÂíåINTEGERÁ±ªÂûãÂàÜÂà´‰∏çÂêåÁöÑÊ†ºÂºèË°®Á§∫ËØ•Á±ªÂûãÔºåÂ¶ÇÔºöTEXT: "YYYY-MM-DD HH:MM:SS.SSS"REAL: ‰ª•JulianÊó•ÊúüÊ†ºÂºèÂ≠òÂÇ®INTEGER: ‰ª•UnixÊó∂Èó¥ÂΩ¢Âºè‰øùÂ≠òÊï∞ÊçÆÂÄºÔºåÂç≥‰ªé1970-01-01 00:00:00Âà∞ÂΩìÂâçÊó∂Èó¥ÊâÄÊµÅÁªèÁöÑÁßíÊï∞„ÄÇ 4.Ê≥®Èáä Ê≠£Ë°åÊ≥®Èáä # Ê≥®ÈáäÂÜÖÂÆπ Â§öË°åÊ≥®Èáä /* Ê≥®ÈáäÂÜÖÂÆπ */ Ë°åÂ∞æÊ≥®Èáä --Ê≥®ÈáäÂÜÖÂÆπ 5.ÊèêÁ§∫ Â§öÊù°ËØ≠Âè•ÂøÖÈ°ª‰ª•ÂàÜÂè∑ÂàÜÈöî„ÄÇ SQLËØ≠Âè•‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇ Á©∫Ê†º‰ºöË¢´ÂøΩÁï•ÔºåÂèØ‰ª•ÂÜôÊàêÂ§öË°å„ÄÇ 6.Á∫¶Êùü NOT NULLÔºöÈùûÁ©∫Á∫¶ÊùüÔºå‰∏çËÉΩÊúâNULLÂÄº„ÄÇ ID INTEGER NOT NULL DEFAULTÔºöÈªòËÆ§ÂÄºÔºåÊï∞ÊçÆÊú™ÊåáÂÆöÁöÑÈªòËÆ§ÂÄºÔºåÂ¶ÇÈªòËÆ§Êó∂Èó¥:date(&#39;now&#39;)„ÄÇ SALARY REAL DEFAULT 5000.0 -- Âà†Èô§ÈªòËÆ§Á∫¶Êùü-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE tALTER COLUMN SALARY DROP DEFAULT UNIQUEÔºöÂîØ‰∏ÄÔºåÂàó‰∏≠ÊâÄÊúâÊï∞ÊçÆÂêÑ‰∏çÁõ∏Âêå„ÄÇ AGE INTEGER UNIQUE ‰∏ªÈîÆÔºöÂîØ‰∏ÄÊ†áËØÜÊï∞ÊçÆË°®‰∏≠ÁöÑËÆ∞ÂΩïÔºå‰∏ç‰∏∫Á©∫„ÄÇ PRIMARY KEY(ID,name) -- Â¢ûÂä†‰∏ªÈîÆ(ÂâçÊèêÂàóÂ∑≤ÁªèÂ£∞Êòé‰∏∫ÈùûÁ©∫)-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE t ADD PRIMARY KEY(ID) -- Âà†Èô§‰∏ªÈîÆ-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE t DROP PRIMARY KEY Â§ñÈîÆÔºöÂîØ‰∏ÄÊ†áËØÜÂÖ∂‰ªñË°®‰∏≠ÁöÑ‰∏ÄÊù°ËÆ∞ÂΩï„ÄÇ FOREIGN KEY(name) REFERENCES q(name)-- Â¢ûÂä†Â§ñÈîÆ-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE tADD FOREIGN KEY (C_ID) REFERENCES USER (ID)-- Âà†Èô§Â§ñÈîÆ-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE t DROP FOREIGN KEY CHECKÔºö‰øùËØÅÂàó‰∏≠ÊâÄÊúâÂÄºÊª°Ë∂≥Êüê‰∏ÄÊù°‰ª∂„ÄÇ AGE INT NOT NULL CHECK(AGE&lt;=18) Â¢ûÂä†CHECK-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE tMODIFY AGE INT NOT NULL CHECK(AGE&gt;=18)ÊàñËÄÖALTER TABLE tADD CONSTRAINT checkConstraint CHECK(AGE&gt;=18) -- Âà†Èô§CHECK-- Âú®SQLite‰∏≠‰∏çÂèØÁî®ALTER TABLE tDROP CONSTRAINT checkConstraint 7.ËåÉÂºèÁ¨¨‰∏ÄËåÉÂºèÔºà1NFÔºâÔºöÂº∫Ë∞ÉÁöÑÊòØÂàóÁöÑÂéüÂ≠êÊÄßÔºåÂç≥Âàó‰∏çËÉΩÂ§üÂÜçÂàÜÊàêÂÖ∂‰ªñÂá†ÂàóÔºåÂ¶Ç‚ÄùÂú∞ÂùÄ‚ÄùÂèØ‰ª•ÁªÜÂàÜ‰∏∫Ôºö‚ÄùÁúÅÔºåÂ∏Ç‚Äù„ÄÇ Á¨¨‰∫åËåÉÂºèÔºà2NFÔºâÔºöÈ¶ñÂÖàÊòØ 1NFÔºåÂÖ∂Ê¨°‰∏ÄÊòØË°®ÂøÖÈ°ªÊúâ‰∏Ä‰∏™‰∏ªÈîÆÔºõ‰∫åÊòØÊ≤°ÊúâÂåÖÂê´Âú®‰∏ªÈîÆ‰∏≠ÁöÑÂàóÂøÖÈ°ªÂÆåÂÖ®‰æùËµñ‰∫é‰∏ªÈîÆÔºåËÄå‰∏çËÉΩÂè™‰æùËµñ‰∫é‰∏ªÈîÆÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ Á¨¨‰∏âËåÉÂºèÔºà3NFÔºâÔºöÈ¶ñÂÖàÊòØ 2NFÔºåÂÖ∂Ê¨°Èùû‰∏ªÈîÆÂàóÂøÖÈ°ªÁõ¥Êé•‰æùËµñ‰∫é‰∏ªÈîÆÔºå‰∏çËÉΩÂ≠òÂú®‰º†ÈÄí‰æùËµñ„ÄÇÂç≥‰∏çËÉΩÂ≠òÂú®ÔºöÈùû‰∏ªÈîÆÂàó A ‰æùËµñ‰∫éÈùû‰∏ªÈîÆÂàó BÔºåÈùû‰∏ªÈîÆÂàó B ‰æùËµñ‰∫é‰∏ªÈîÆÁöÑÊÉÖÂÜµ„ÄÇ 8.ÂáΩÊï∞ ‰º†ÈÄÅÈó®Ôºöhttp://www.cnblogs.com/stephen-liu74/archive/2012/02/15/2322027.html Â≠óÁ¨¶‰∏≤Â§ÑÁêÜ:UPPER() ÔºöÂ§ßÂÜôËΩ¨Êç¢LENGTH() ÔºöÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶LOWER()ÔºöÂ∞èÂÜôËΩ¨Êç¢LTRIM() ÔºöÂéªÊéâÂ≠óÁ¨¶‰∏≤Â∑¶ËæπÁöÑÁ©∫Ê†ºRTRIM() ÔºöÂéªÊéâÂ≠óÁ¨¶‰∏≤Âè≥ËæπÁöÑÁ©∫Ê†º Êó•ÊúüÊó∂Èó¥Â§ÑÁêÜdate(&#39;now&#39;) ËøîÂõûÂΩìÂâçÊó•Êúü„ÄÇ date(&#39;now&#39;,&#39;start of month&#39;,&#39;1 month&#39;,&#39;-1 day&#39;)ËøîÂõûÂΩìÂâçÊúàÁöÑÊúÄÂêé‰∏ÄÂ§©„ÄÇ Êï∞ÂÄºÂ§ÑÁêÜÂáΩÊï∞ABS() ÁªùÂØπÂÄºCOS() ËßíÂ∫¶ÁöÑ‰ΩôÂº¶EXP() Êï∞ÁöÑÊåáÊï∞ÂÄºPI() ËøîÂõûÂúÜÂë®ÁéáSIN() ËßíÂ∫¶ÁöÑÊ≠£Âº¶ÂÄºSQRT() Âπ≥ÊñπÊ†πTAN() ËßíÂ∫¶ÁöÑÊ≠£Âàá ËÅöÈõÜÂáΩÊï∞AVG() Âπ≥ÂùáÂÄºÔºåÂøΩÁï•NULLÂÄº„ÄÇCOUNT() ÊüêÂàóÁöÑË°åÊï∞ÔºåËã•ÊåáÂÆöÂàóÂêçÂàô‰ºöÂøΩÁï•NULLÂÄºÔºåËÄåCOUNT(*)ÂØπË°®‰∏≠Ë°åÁöÑÊï∞ÁõÆËøõË°åËÆ°Êï∞ÔºåÊó†ËÆ∫ÊòØÂê¶‰∏∫NULLÈÉΩËÆ°Êï∞ÔºåDISTINCT‰∏çËÉΩÁî®‰∫éCOUNT(*)ÔºåÂ¶ÇCOUNT(DISTINCT *)‰∏∫ÈîôËØØÂÜôÊ≥ï„ÄÇ MAX() ÊüêÂàóÁöÑÊúÄÂ§ßÂÄºÔºåÂøΩÁï•NULLÂÄºMIN() ÊüêÂàóÁöÑÊúÄÂ∞èÂÄºÔºåÂøΩÁï•NULLÂÄºSUM() ÊüêÂàóÂÄºÁöÑÂíåÔºåÂøΩÁï•NULLÂÄº ÂÖ∂‰ªñÊü•ÁúãÁâàÊú¨select sqlite_version(); 9.ËßÜÂõæËßÜÂõæÂè™‰∏çËøáÊòØÈÄöËøáÁõ∏ÂÖ≥ÁöÑÂêçÁß∞Â≠òÂÇ®Âú®Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑ‰∏Ä‰∏™ SQLite ËØ≠Âè•„ÄÇËßÜÂõæÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™‰ª•È¢ÑÂÆö‰πâÁöÑ SQLite Êü•ËØ¢ÂΩ¢ÂºèÂ≠òÂú®ÁöÑË°®ÁöÑÁªÑÂêà„ÄÇSQLite‰ªÖÊîØÊåÅÂè™ËØªËßÜÂõæÔºåÊâÄ‰ª•ËßÜÂõæÂèØ‰ª•ÂàõÂª∫ÔºåÂèØ‰ª•ËØªÔºå‰ΩÜÂÖ∂ÂÜÖÂÆπ‰∏çËÉΩÊõ¥Êîπ„ÄÇ ËßÜÂõæÁöÑ‰ΩúÁî®:ËßÜÂõæÊòØ‰∏ÄÁßçËôöË°®ÔºåÂÖÅËÆ∏Áî®Êà∑ÂÆûÁé∞‰ª•‰∏ãÂá†ÁÇπÔºö Áî®Êà∑ÊàñÁî®Êà∑ÁªÑÊü•ÊâæÁªìÊûÑÊï∞ÊçÆÁöÑÊñπÂºèÊõ¥Ëá™ÁÑ∂ÊàñÁõ¥ËßÇ„ÄÇ ÈôêÂà∂Êï∞ÊçÆËÆøÈóÆÔºåÁî®Êà∑Âè™ËÉΩÁúãÂà∞ÊúâÈôêÁöÑÊï∞ÊçÆÔºåËÄå‰∏çÊòØÂÆåÊï¥ÁöÑË°®„ÄÇ Ê±áÊÄªÂêÑÁßçË°®‰∏≠ÁöÑÊï∞ÊçÆÔºåÁî®‰∫éÁîüÊàêÊä•Âëä„ÄÇ 10.‰∫ãÂä°‰∫ãÂä°ÊòØ‰∏Ä‰∏™ÂØπÊï∞ÊçÆÂ∫ìÊâßË°åÂ∑•‰ΩúÂçïÂÖÉÔºåÊòØ‰ª•ÈÄªËæëÈ°∫Â∫èÂÆåÊàêÁöÑÂ∑•‰ΩúÂçï‰ΩçÊàñÂ∫èÂàó„ÄÇ‰∫ãÂä°ÊòØÊåá‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êõ¥ÊîπÊï∞ÊçÆÂ∫ìÁöÑÊâ©Â±ï„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûúÊ≠£Âú®ÂàõÂª∫‰∏Ä‰∏™ËÆ∞ÂΩïÊàñËÄÖÊõ¥Êñ∞‰∏Ä‰∏™ËÆ∞ÂΩïÊàñËÄÖ‰ªéË°®‰∏≠Âà†Èô§‰∏Ä‰∏™ËÆ∞ÂΩïÔºåÈÇ£‰πàÊ≠£Âú®ËØ•Ë°®‰∏äÊâßË°å‰∫ãÂä°„ÄÇÈáçË¶ÅÁöÑÊòØË¶ÅÊéßÂà∂‰∫ãÂä°‰ª•Á°Æ‰øùÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄßÂíåÂ§ÑÁêÜÊï∞ÊçÆÂ∫ìÈîôËØØ„ÄÇÂèØ‰ª•ÊääËÆ∏Â§öÁöÑ SQLite Êü•ËØ¢ËÅîÂêàÊàê‰∏ÄÁªÑÔºåÊääÊâÄÊúâËøô‰∫õÊîæÂú®‰∏ÄËµ∑‰Ωú‰∏∫‰∫ãÂä°ÁöÑ‰∏ÄÈÉ®ÂàÜËøõË°åÊâßË°å„ÄÇ ‰∫ãÂä°ÂÖ∑Êúâ‰ª•‰∏ãÂõõ‰∏™Ê†áÂáÜÂ±ûÊÄßÔºåÈÄöÂ∏∏Ê†πÊçÆÈ¶ñÂ≠óÊØçÁº©ÂÜô‰∏∫ ACIDÔºö AtomicityÔºàÂéüÂ≠êÊÄßÔºâÂéüÂ≠êÊÄßÊòØÊåá‰∫ãÂä°ÊòØ‰∏Ä‰∏™‰∏çÂèØÂÜçÂàÜÂâ≤ÁöÑÂ∑•‰ΩúÂçï‰ΩçÔºå‰∫ãÂä°‰∏≠ÁöÑÊìç‰ΩúË¶Å‰πàÈÉΩÂèëÁîüÔºåË¶Å‰πàÈÉΩ‰∏çÂèëÁîü„ÄÇ ConsistencyÔºà‰∏ÄËá¥ÊÄßÔºâ‰∏ÄËá¥ÊÄßÊòØÊåáÂú®‰∫ãÂä°ÂºÄÂßã‰πãÂâçÂíå‰∫ãÂä°ÁªìÊùü‰ª•ÂêéÔºåÊï∞ÊçÆÂ∫ìÁöÑÂÆåÊï¥ÊÄßÁ∫¶ÊùüÊ≤°ÊúâË¢´Á†¥Âùè„ÄÇËøôÊòØËØ¥Êï∞ÊçÆÂ∫ì‰∫ãÂä°‰∏çËÉΩÁ†¥ÂùèÂÖ≥Á≥ªÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄß‰ª•Âèä‰∏öÂä°ÈÄªËæë‰∏äÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ IsolationÔºàÈöîÁ¶ªÊÄßÔºâÂ§ö‰∏™‰∫ãÂä°Âπ∂ÂèëËÆøÈóÆÊó∂Ôºå‰∫ãÂä°‰πãÈó¥ÊòØÈöîÁ¶ªÁöÑÔºå‰∏Ä‰∏™‰∫ãÂä°‰∏çÂ∫îËØ•ÂΩ±ÂìçÂÖ∂ÂÆÉ‰∫ãÂä°ËøêË°åÊïàÊûú„ÄÇ DurabilityÔºàÊåÅ‰πÖÊÄßÔºâÊåÅ‰πÖÊÄßÔºåÊÑèÂë≥ÁùÄÂú®‰∫ãÂä°ÂÆåÊàê‰ª•ÂêéÔºåËØ•‰∫ãÂä°ÊâÄÂØπÊï∞ÊçÆÂ∫ìÊâÄ‰ΩúÁöÑÊõ¥Êîπ‰æøÊåÅ‰πÖÁöÑ‰øùÂ≠òÂú®Êï∞ÊçÆÂ∫ì‰πã‰∏≠ÔºåÂπ∂‰∏ç‰ºöË¢´ÂõûÊªö„ÄÇ Êí§ÈîÄROLLBACK ÂëΩ‰ª§ÊòØÁî®‰∫éÊí§Ê∂àÂ∞öÊú™‰øùÂ≠òÂà∞Êï∞ÊçÆÂ∫ìÁöÑ‰∫ãÂä°ÁöÑ‰∫ãÂä°ÂëΩ‰ª§„ÄÇROLLBACK ÂëΩ‰ª§Âè™ËÉΩÁî®‰∫éÊí§ÈîÄËá™‰∏äÊ¨°ÂèëÂá∫ COMMIT Êàñ ROLLBACK ÂëΩ‰ª§‰ª•Êù•ÁöÑ‰∫ãÂä°„ÄÇ BEGIN TRANSACTION;DELETE FROM t WHERE ID = 6;ROLLBACK; Êèê‰∫§ BEGIN TRANSACTION;DELETE FROM t WHERE ID = 5;-- Ë¶ÅÂÅöÁöÑ‰∫ãEND TRANSACTION; -- ÊàñËÄÖ‰ΩøÁî®‰ª•‰∏ãËØ≠Ê≥ïBEGIN;DELETE FROM t WHERE ID = 6;COMMIT; Ê≥®ÊÑèÔºö‰øùÂ≠òÁÇπÂú® SQLite (‚â• 3.6.8)ÊîØÊåÅ‰øùÁïôÁÇπË∂äÂ§öË∂äÂ•Ω„ÄÇSAVEPOINT delRow; ROLLBACK TO delRow; 11.Á¥¢ÂºïÁ¥¢ÂºïÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊü•ÊâæË°®ÔºåÊï∞ÊçÆÂ∫ìÊêúÁ¥¢ÂºïÊìéÁî®Êù•Âä†Âø´Êï∞ÊçÆÊ£ÄÁ¥¢ÔºåÁÆÄÂçïÂú∞ËØ¥ÔºåÁ¥¢ÂºïÊòØ‰∏Ä‰∏™ÊåáÂêëË°®‰∏≠Êï∞ÊçÆÁöÑÊåáÈíà„ÄÇÂàõÂª∫Á¥¢ÂºïCREATE INDEX in_name_age ON t(name, age); Âà†Èô§Á¥¢ÂºïDROP INDEX in_name; 12.È°∫Â∫è Â≠êÂè• ËØ¥Êòé ÊòØÂê¶ÂøÖÈ°ª‰ΩøÁî® SELECT ËøîÂõûÂàó ÊòØ FROM Ê£ÄÁ¥¢ÁöÑË°® ‰ªéË°®‰∏≠ÈÄâÊã©Êï∞ÊçÆÊó∂‰ΩøÁî® WHERE Ë°åÁ∫ßËøáÊª§ Âê¶ GROUP BY ÂàÜÁªÑ ÊåâÁªÑËÆ°ÁÆóËÅöÈõÜÊó∂‰ΩøÁî® HAVING ÁªÑÁ∫ßËøáÊª§ Âê¶ ORDER BY ËæìÂá∫ÊéíÂ∫è Âê¶ Â¶ôËÆ∞Ôºö SELECT kindID, COUNT(*) FROM table WHERE PRICE &gt; 10 GROUP BY kindID HAVING COUNT(*) &gt;=2 ORDER BY kindID; ‰∫å„ÄÅÂëΩ‰ª§1.SELECTÊ£ÄÁ¥¢Âçï‰∏™Âàó-- SELECT ÂàóÂêç FROM Ë°®Âêç SELECT age FROM t; Ê£ÄÁ¥¢Â§ö‰∏™ÂàóSELECT name, age, groupID FROM t; Ê£ÄÁ¥¢ÊâÄÊúâÂàóSELECT * FROM t;-- Ê£ÄÁ¥¢‰∏çÂøÖË¶ÅÁöÑÂàó‰ºöÈôç‰ΩéÊ£ÄÁ¥¢ÂíåÂ∫îÁî®Á®ãÂ∫èÁöÑÊÄßËÉΩ Ê£ÄÁ¥¢Âπ∂ËøîÂõû‰∏çÂêåÁöÑÂÄºSELECT DISTINCT name, age FROM t; -- DISTINCT‰ΩúÁî®‰∫éÊâÄÊúâÁöÑÂàó,Â¶ÇSELECT DISTINCT groupID, age FROM t;-- ‰ΩúÁî®‰∫égroupID, age‰∏§Âàó-- ÂΩìgroupID, ageÂèåÂèåÈáçÂ§ç,Âè™‰ºöËøîÂõû‰∏Ä‰∏™ÁªìÊûú ÈôêÂà∂ÁªìÊûú-- ‰∏çË∂ÖËøá5Ë°åSELECT name, age FROM t LIMIT 5; -- ‰ªéÁ¨¨10Ë°åÂºÄÂßãÊ£ÄÁ¥¢,‰∏çË∂ÖËøá7Ë°åSELECT name, age FROM t LIMIT 5 OFFSET 3; LIMITÈôêÂà∂ËøîÂõûÁöÑË°åÊï∞ÔºåOFFSETÊåáÂÆö‰ªéÂì™ÂºÄÂßã„ÄÇ Ë°åÊï∞ÊåáÁöÑÊòØÁ¥¢ÂºïË°åÔºåÂç≥‰ªéÁ¨¨0Ë°åÂºÄÂßã„ÄÇ 2.ORDEY BYORDEY BYÂ≠êÂè•Ë¶Å‰øùËØÅÊîæÂà∞ÊúÄÂêé„ÄÇ Âçï‰∏™ÂàóÊéíÂ∫è-- ‰ª•ageÂÄºÁöÑÂ≠óÊØçÈ°∫Â∫è/Â§ßÂ∞èÊéíÂàóSELECT name FROM t ORDER BY age; Â§ö‰∏™ÂàóÊéíÂ∫è-- È¶ñÂÖàÊåâÁÖßage,Âú®age‰∏≠ÊåâÁÖßnameSELECT name, age FROM t ORDER BY age, name; ÊåâÂàó‰ΩçÁΩÆÊéíÂ∫è-- È¶ñÂÖàÊåâÁÖßage,Âú®age‰∏≠ÊåâÁÖßname-- 3ÂØπÂ∫îage, 1ÂØπÂ∫îIDSELECT ID, name, age FROM t ORDER BY 3, 1; ÊåâÈôçÂ∫èÊéíÂ∫è-- DESC Âè™‰ΩúÁî®Âú®ÂÆÉÂâçÈù¢ÁöÑÂàóSELECT ID, name, age FROM t ORDER BY 3 DESC;SELECT ID, name, age FROM t ORDER BY 1 DESC,3 DESC; 3.WHEREÂ∏∏Áî®Êìç‰ΩúÁ¨¶:‰∏ÄËà¨Ôºö= ! = &lt; &gt; &gt;= &lt;=‰ªã‰∫é‰πãÈó¥ÔºöBETWEEN AND‰∏∫Á©∫ÂÄºÔºöIS NULL ‰∏ÄËà¨‰ΩøÁî®SELECT age, name FROM table WHERE age &lt; 10;-- ÂçïÂºïÂè∑Áî®Êù•ÈôêÂÆöÂ≠óÁ¨¶‰∏≤-- Â∞ÜÂÄº‰∏éÂ≠óÁ¨¶‰∏≤Á±ªÂûãÁöÑÂàóÊØîËæÉÈúÄË¶ÅÈôêÂÆöÂºïÂè∑-- Â∞ÜÂÄº‰∏éÊï∞ÂÄºÂàóËøõË°åÊØîËæÉ‰∏çÁî®ÂºïÂè∑SELECT ID, name, age FROM t WHERE age = 18;SELECT ID, name, age FROM t WHERE name = 'Âº†Êó†Âøå'; ËåÉÂõ¥Á≠õÈÄâSELECT ID, name, age FROM t WHERE age BETWEEN 18 AND 22; Á©∫ÂÄºÊ£ÄÊü•SELECT ID, name, age FROM t WHERE sex IS NULL; 4.AND ORAND ‰ºòÂÖàÁ∫ßÂ§ß‰∫éORÁªÑÂêà‰ΩøÁî®Ê≥®ÊÑèÂä†Êã¨Âè∑SELECT ID, name, age FROM t WHERE age = 18 AND name = 'ÂîêÂÉß';SELECT ID, name, age FROM t WHERE age = 18 OR groupID = 1; ÁªÑÂêà‰ΩøÁî®SELECT ID, name, age FROM t WHERE (age = 18 OR ID &lt; 12) AND groupID = 1; 5.INÂÖ≥ÈîÆÂ≠óÂåπÈÖç -- 18,19Â≤ÅSELECT ID, name, age FROM t WHERE age IN (18, 19); 6.NOTÂê¶ÂÆöÂÖ∂ÂêéÁöÑÈôêÂÆöÊù°‰ª∂ SELECT ID, name, age FROM t WHERE age NOT IN (18, 19);SELECT ID, name, age FROM t WHERE NOT age &lt; 22; 7.LIKE% ÈÄöÈÖçÁ¨¶Ë°®Á§∫‰ªª‰ΩïÂ≠óÁ¨¶Âá∫Áé∞‰ªªÊÑèÊ¨°Êï∞Ôºå‰∏ç‰ºöÂåπÈÖçNULL„ÄÇ SELECT ID, name, age FROM t WHERE name LIKE 'Âº†%';SELECT ID, name, age FROM t WHERE name LIKE '%ÂÖ≠'; _ÈÄöÈÖçÁ¨¶ÂåπÈÖçÂçï‰∏™Â≠óÁ¨¶ÔºåÊ≥®ÊÑèLIKEÂêéÁöÑÂÄº‰ΩøÁî®Â≠óÁ¨¶‰∏≤SELECT ID, name, age FROM t WHERE age LIKE '2_'; Ê≥®ÊÑè:SQLite ‰∏çÊîØÊåÅ[] ÈÄöÈÖçÁ¨¶[] ÈÄöÈÖçÁ¨¶ÊåáÂÆö‰∏ÄÁ≥ªÂàóÁöÑÂ≠óÁ¨¶,Âè™Ë¶ÅÊª°Ë∂≥Ëøô‰∫õÂ≠óÁ¨¶ÂÖ∂‰∏≠‰πã‰∏Ä,‰∏î‰ΩçÁΩÆÂá∫Áé∞Âú®‚Äú[]‚ÄùÈÄöÈÖçÁ¨¶ÁöÑ‰ΩçÁΩÆÁöÑÂ≠óÁ¨¶‰∏≤Â∞±Êª°Ë∂≥Êü•ËØ¢Êù°‰ª∂SELECT ID, name, age FROM t WHERE name LIKE '[Áâõ]%';-- Âê¶ÂÆöSELECT ID, name, age FROM t WHERE name LIKE '[^Áâõ]%'; Ê≥®ÊÑèÔºöÂ∞ë‰ΩøÁî®ÈÄöÈÖçÁ¨¶ÔºåÂ∞ΩÈáè‰∏çË¶ÅÊääÈÄöÈÖçÁ¨¶ÁΩÆ‰∫éÂºÄÂßãÂ§Ñ 8.ÊãºÊé•‰ΩøÁî® || ÊãºÊé•Â§ö‰∏™ÂàóSELECT age || '(' || name || ')' FROM t;-- ÁªìÊûú: 23(ÁâõÈ≠îÁéã) ‰ΩøÁî®RTRIMÂéªÈô§Â°´ÂÖÖÂàóÂÆΩÁöÑÊñáÊú¨ÂÄºSELECT age || '(' || RTRIM(name) || ')' FROM t; RTRIM() ÂéªÊéâÂ≠óÁ¨¶‰∏≤Âè≥ËæπÁöÑÁ©∫Ê†ºLTRIM() ÂéªÊéâÂ≠óÁ¨¶‰∏≤Â∑¶ËæπÁöÑÁ©∫Ê†ºTRIM() ÂéªÊéâÂ≠óÁ¨¶‰∏≤Â∑¶Âè≥‰∏§ËæπÁöÑÁ©∫Ê†º ‰ΩøÁî®Âà´ÂêçAS Ë¶ÅÊ±ÇÂæóÂà∞ÁöÑÊòØ‰∏ÄÂàóSELECT age || '(' || RTRIM(name) || ')' AS Results FROM t; ÊâßË°åËÆ°ÁÆóSELECT age + 3, name FROM t; 9.GROUP BYGROUP BYÂ≠êÂè•ÂøÖÈ°ªÂá∫Áé∞Âú®WHEREÂ≠êÂè•‰πãÂêéÔºåORDER BYÂ≠êÂè•‰πãÂâçSELECT groupID, COUNT(*) FROM t GROUP BY groupID;/* Âê´ÊúâCOUNT(*)ÁöÑÂàÜÁªÑÁöÑÁªìÊûú‰∏çËØ•ÂåÖÂê´ÊØèÂàóÁã¨ÊúâÁöÑÂ≠óÊÆµ,Â¶Çname,IDÁ≠â,ËÄåÂ∫îËØ•ÊòØÂÖ±ÊÄßÁöÑÂ≠óÊÆµ,Â¶ÇÂàÜÁªÑIDÁ≠â,Âõ†‰∏∫ÁõÆÁöÑÊòØÂæóÁü•ÊüêÁªÑÁöÑCOUNT*/ SELECT name FROM t GROUP BY name; 10.HAVING1.WHEREËøáÊª§Ë°åÔºåËÄåHAVINGËøáÊª§ÂàÜÁªÑÔºåHAVINGÊîØÊåÅÊâÄÊúâWHEREÊìç‰ΩúÁ¨¶„ÄÇ2.WHEREÂú®Êï∞ÊçÆÂàÜÁªÑÂâçËøõË°åËøáÊª§ÔºåHAVINGÂú®Êï∞ÊçÆÂàÜÁªÑÂêéËøõË°åËøáÊª§„ÄÇ SELECT groupID, COUNT(*) FROM t GROUP BY groupID HAVING COUNT(*) &gt; 5;-- Á≠õÈÄâÊØèÁªÑÊï∞ÈáèÂ§ß‰∫é5 11.ORDER BYÊéíÂ∫èHAVINGÂ∏∏‰∏éGROUP BYËøûÁî®SELECT groupID, COUNT(*) FROM t WHERE age &gt; 18 GROUP BY groupID HAVING COUNT(*) &gt; 2ORDER BY groupID DESC; 12.Â≠êÊü•ËØ¢Âú®SELECTËØ≠Âè•‰∏≠ÔºåÂ≠êÊü•ËØ¢ÊÄªÊòØ‰ªéÂÜÖÂêëÂ§ñÂ§ÑÁêÜ„ÄÇ‰Ωú‰∏∫Â≠êÊü•ËØ¢ÁöÑSELECTËØ≠Âè•Âè™ËÉΩÊü•ËØ¢Âçï‰∏™Âàó„ÄÇ‰ºÅÂõæÊ£ÄÁ¥¢Â§ö‰∏™ÂàóÂ∞ÜËøîÂõûÈîôËØØ„ÄÇSELECT name, age FROM t WHERE age IN (SELECT age FROM t WHERE age &gt; 10 AND sex IS NULL); 13.ËøûÊé•ÂÜÖËøûÊé•ÊòØÊçÆÊ†πÊçÆÊØè‰∏™Ë°®ÂÖ±ÊúâÁöÑÂàóÁöÑÂÄºÂåπÈÖç‰∏§‰∏™Ë°®‰∏≠ÁöÑË°åSELECT t.name, age FROM t INNER JOIN q ON t.ID = q.ID; SELECT t.name, t.age FROM t, q WHERE t.name = q.name; -- Ê≥®ÊÑèË°®ÁöÑÂêçÁß∞Ë¶ÅÂåπÈÖç Ëá™ËøûÊé•ÔºåÊü•ËØ¢‰∏≠ÈúÄË¶ÅÁöÑ‰∏§‰∏™Ë°®ÂÆûÈôÖ‰∏äÊòØÁõ∏ÂêåÁöÑË°®SELECT a.name, a.age FROM t AS a, t AS b WHERE a.name = b.name AND b.ID = 10; Â§ñËøûÊé•1.Â§ñËøûÊé•ÂèØ‰ª•ÊòØÂ∑¶ÂêëÂ§ñËøûÊé•„ÄÅÂè≥ÂêëÂ§ñËøûÊé•ÊàñÂÆåÊï¥Â§ñÈÉ®ËøûÊé•2.Âú®‰ΩøÁî®OUTER JOINËØ≠Ê≥ïÊó∂ÔºåÂøÖÈ°ª‰ΩøÁî®RIGHTÊàñLEFTÂÖ≥ÈîÆÂ≠óÊåáÂÆöÂåÖÊã¨ÂÖ∂ÊâÄÊúâË°åÁöÑË°®(RIGHTÊåáÂá∫ÁöÑÊòØOUTER JOINÂè≥ËæπÁöÑË°®ÔºåËÄåLEFTÊåáÂá∫ÁöÑÊòØOUTER JOINÂ∑¶ËæπÁöÑË°®)„ÄÇ3.Â∑¶ÂêëÂ§ñËøûÊé•ÁöÑÁªìÊûúÈõÜÂåÖÊã¨LEFT OUTERÂ≠êÂè•‰∏≠ÊåáÂÆöÁöÑÂ∑¶Ë°®ÁöÑÊâÄÊúâË°åÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØËøûÊé•ÂàóÊâÄÂåπÈÖçÁöÑË°å„ÄÇ4.Âè≥ÂêëÂ§ñËøûÊé•ÊòØÂ∑¶ÂêëÂ§ñËøûÊé•ÁöÑÂèçÂêëËøûÊé•„ÄÇÂ∞ÜËøîÂõûÂè≥Ë°®ÁöÑÊâÄÊúâË°å„ÄÇÂ¶ÇÊûúÂè≥Ë°®ÁöÑÊüêË°åÂú®Â∑¶Ë°®‰∏≠Ê≤°ÊúâÂåπÈÖçË°åÔºåÂàôÂ∞Ü‰∏∫Â∑¶Ë°®ËøîÂõûÁ©∫ÂÄº„ÄÇ SQLiteÊîØÊåÅÂ∑¶Â§ñËøûÊé•LEFT OUTER JOINÔºå‰ΩÜ‰∏çÊîØÊåÅRIGHT OUTER JOIN Âíå FULL OUTER JOINËØ≠Ê≥ï„ÄÇ SELECT t.*, q.* FROM t LEFt JOIN q ON t.ID = q.ID; ‰∫§ÂèâËøûÊé•„ÄÇ‰∫§ÂèâËøûÊé•ËøîÂõûÂ∑¶Ë°®‰∏≠ÁöÑÊâÄÊúâË°åÔºåÂ∑¶Ë°®‰∏≠ÁöÑÊØè‰∏ÄË°å‰∏éÂè≥Ë°®‰∏≠ÁöÑÊâÄÊúâË°åÁªÑÂêà„ÄÇ‰∫§ÂèâËøûÊé•‰πüÁß∞‰ΩúÁ¨õÂç°Â∞îÁßØ„ÄÇ ÊÄªÁªì:Â∑¶Â§ñËøûÊé•ÊòæÁ§∫Â∑¶Ë°®ÊâÄÊúâË°å+ÂåπÈÖçË°åÂè≥Â§ñËøûÊé•ÊòæÁ§∫Âè≥Ë°®ÊâÄÊúâË°å+ÂåπÈÖçË°åÂÆåÊï¥Â§ñÈÉ®ËøûÊé•ÊòæÁ§∫Â∑¶Ë°®ÂíåÂè≥Ë°®‰∏≠ÁöÑÊâÄÊúâË°åÂÜÖËøûÊé•ÊòæÁ§∫Ê†πÊçÆÊØîËæÉËøêÁÆóÁ¨¶ÂåπÈÖç‰∏§‰∏™Ë°®‰∏≠ÁöÑË°åËá™ËøûÊé•ÈúÄË¶ÅÁöÑ‰∏§‰∏™Ë°®ÂÆûÈôÖ‰∏äÊòØÁõ∏ÂêåÁöÑË°®‰∫§ÂèâËøûÊé•ÊòæÁ§∫Â∑¶Ë°®ÊâÄÊúâË°å+Â∑¶Ë°®ÊØè‰∏ÄË°å‰∏éÂè≥Ë°®ÊâÄÊúâË°åÁöÑÁªÑÂêàËøûÊé•‰∏çÂåπÈÖçÊó∂ÊòæÁ§∫Á©∫ÂÄº 14.UNIONÂ∞ÜÁªìÊûúÁªÑÂêàÊàê‰∏Ä‰∏™ÁªìÊûúÈõÜ1.UNION‰∏≠ÁöÑÊØè‰∏™Êü•ËØ¢ÂøÖÈ°ªÂåÖÂê´Áõ∏ÂêåÁöÑÂàó„ÄÅË°®ËææÂºèÊàñËÅöÈõÜÂáΩÊï∞2.UNIONÂøÖÈ°ªÁî±‰∏§Êù°Êàñ‰∏§Êù°‰ª•‰∏äÁöÑSELECTËØ≠Âè•ÁªÑÊàêÔºåËØ≠Âè•‰πãÈó¥Áî®ÂÖ≥ÈîÆÂ≠óUNIONÂàÜÈöî3.ÂàóÊï∞ÊçÆÁ±ªÂûãÂøÖÈ°ªÂÖºÂÆπ SELECT name, age FROM t WHERE name LIKE 'Âº†%' UNION SELECT name, age FROM t WHERE age &gt; 22;-- Áõ∏ÂΩì‰∫é "Âπ∂"Âú®‰∏ÄËµ∑ 15.INSERTÊèíÂÖ•ËÆ∞ÂΩïINSERT INTO t VALUES(13, 'ÁôΩÈ™®Á≤æ', '1543', 1, NULL, 19, 1.68); INSERT INTOt(ID, name, phone, groupID, sex, age, height) VALUES(14, 'ÁôΩÈæôÈ©¨', '1323', 0, NULL, 20, 1.69); VALUESÂøÖÈ°ª‰ª•ÂÖ∂ÊåáÂÆöÁöÑÊ¨°Â∫èÂåπÈÖçÊåáÂÆöÁöÑÂàóÂêçÔºåÊõ¥Êé®ËçêËøôÁßçÊñπÂºè„ÄÇÁúÅÁï•ÂàóÔºöÂÖÅËÆ∏NULLÊàñËÄÖÊúâÈªòËÆ§ÂÄº 16.CREATE ASÂ§çÂà∂Ë°®CREATE TABLE c AS SELECT * FROM t; 17.UPDATEÊõ¥Êñ∞Ë°åUPDATE t SET height = 1.66 WHERE name = 'ÁôΩÈæôÈ©¨'; -- Âà†Èô§ÊüêÂàóÁöÑÂÄºUPDATE t SET height = NULL WHERE name = 'Èü¶Â∞èÂÆù'; Êõ¥Êñ∞Â§öÂàóÔºåÊ≥®ÊÑèÈÄóÂè∑UPDATE t SET height = 1.55, phone = '1888', groupID = 0 WHERE name = 'ÂîêÂÉß'; 18.DELETEÂà†Èô§Ë°åDELETE FROM t WHERE name = 'ÁôΩÈæôÈ©¨'; 19.CREATEÂàõÂª∫Ë°®CREATE TABLE d(ID INTEGER NOT NULL UNIQUE,name TEXT NOT NULL,sex INTEGER DEFAULT 0,height REAL CHECK(height &gt; 0), PRIMARY KEY('ID')FOREIGN KEY(name) REFERENCES q(name)); ‰∏ªÈîÆÂçïÁã¨Ê†áÊòé„ÄÇ 20.ALTERÁªôË°®Â¢ûÂä†‰∏ÄÂàó ALTER TABLE bADD place TEXT; ÈáçÂëΩÂêçË°® ALTER TABLE bRENAME TO bbb; Âú® SQLite ‰∏≠ÔºåÈô§‰∫ÜÈáçÂëΩÂêçË°®ÂíåÂú®Â∑≤ÊúâÁöÑË°®‰∏≠Ê∑ªÂä†ÂàóÔºåALTER TABLE ÂëΩ‰ª§‰∏çÊîØÊåÅÂÖ∂‰ªñÊìç‰Ωú,ÂåÖÊã¨Âà†Èô§Âàó,ÂÆö‰πâ‰∏ªÈîÆÂíåÂ§ñÈîÆÁ≠â. SQLite‰∏çÊîØÊåÅÂà†Èô§Âàó ALTER TABLE t DROP COLUMN vend_phone; 21.DROPÂà†Èô§Ë°®DROP TABLE t; 22.ËßÜÂõæÂàõÂª∫ËßÜÂõæCREATE VIEW view_b AS SELECT name, age FROM t; Êü•ÁúãËßÜÂõæ SELECT * FROM view_b; Âà†Èô§ËßÜÂõæDROP VIEW view_b; ÂèÇËÄÉÊÑüË∞¢ÔºöSQLiteÂ§ñÈîÆSQLiteÂ≠¶‰π†ÊâãÂÜåSQLite ËØ≠Ê≥ï]]></content>
      <tags>
        <tag>ÈòÖËØª</tag>
        <tag>Êï∞ÊçÆÂ∫ì</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØª„ÄäEffective Objective-C 2.0„Äã]]></title>
    <url>%2F2017%2F04%2F05%2F%E8%AF%BB%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B%2F</url>
    <content type="text"><![CDATA[ËÆ∏Â§öÂ∞èÊäÄÂ∑ß„ÄÇ ËØªÊÑü‰∏ÄÊôö‰∏äÂä†‰∏ÄÊó©‰∏äÊó∂Èó¥ËØª‰∫Ü‰∏ÄÈÅçÔºåÂæàÂ§öÊäÄÂ∑ßÈÉΩÂ±°ÊúâËÄ≥ÈóªÔºå‰∏çËøáËøòÊòØÊî∂Ëé∑ËÆ∏Â§ö„ÄÇËøôÈáåËÆ∞ÂΩï‰∏Ä‰∫õÊØîËæÉÂ•ΩÁé©ÁöÑÈóÆÈ¢ò„ÄÇ Èí©ÁéÑ Â∞ΩÂèØËÉΩÂú®.hÊñá‰ª∂‰∏≠‰ΩøÁî®@classÂ£∞ÊòéÁ±ªÔºå.mÊñá‰ª∂‰∏≠‰ΩøÁî®importÂØºÂÖ•ÂÖ∂‰ªñÂ§¥Êñá‰ª∂ÔºåËÄå‰∏çÊòØÂè™Âú®.hÊñá‰ª∂‰∏≠importÂ§¥Êñá‰ª∂„ÄÇ Â∏∏Èáè‰ΩøÁî®static constÔºåÂÖ∂‰ªñÊÉÖÂÜµ(Â¶Ç[NSNotificationCenter defaultCenter])‰ΩøÁî®ÂÆè„ÄÇ ‰∏çÈúÄË¶Å‰ΩçÊàñËøêÁÆóÁöÑÊûö‰∏æ‰ΩøÁî®NS_ENUMÔºåÈúÄË¶Å‰ΩøÁî®‰ΩçÊàñËøêÁÆóÁöÑÊûö‰∏æ‰ΩøÁî®NS_OPTIONSÔºåÈÅøÂÖçCËØ≠Ë®Ä‰∏≠ÁöÑenum„ÄÇ switchÁä∂ÊÄÅÊú∫‰∏ãÈÅøÂÖçdefaultÂàÜÊîØ(Á°Æ‰øùswitchÊ≠£Á°ÆÂ§ÑÁêÜÂ∑≤Áü•ÊÉÖÂÜµÔºåÂæÄÂêéÂ¢ûÂä†Êñ∞ÁöÑÁöÑÊûö‰∏æÂÄº‰ºöÊúâË≠¶Âëä)„ÄÇ ÈóÆÈ¢ò1.Â±ûÊÄßÂ£∞Êòé‰∏∫@dynamicÂêéËØ•ÊÄé‰πàÂÅöÊâãÂä®Ê∑ªÂä†getterÂíåsetterÂÆûÁé∞‰∏çË°®„ÄÇÂú®ËøêË°åÊó∂Ê∑ªÂä†Â±ûÊÄßÁöÑÂ≠òÂèñÊñπÊ≥ïÁöÑÊñπÂºèÂ¶Ç‰∏ãÔºö .hÊñá‰ª∂Êö¥Èú≤Â±ûÊÄßÔºö @property (nonatomic, copy) NSString *name; .mÊñá‰ª∂Âä®ÊÄÅÊ∑ªÂä†ÊñπÊ≥ïÔºö @interface YAHeader ()&#123; NSString *_name;&#125;@end@implementation YAHeader@dynamic name;// Ê∑ªÂä†setÊñπÊ≥ï,Ë¶Å‰º†ÂÖ•ÂèÇÊï∞void dynamicSetMethodIMP(YAHeader *self, SEL _cmd, NSString *prame) &#123; self-&gt;_name = prame;&#125;// Ê∑ªÂä†getÊñπÊ≥ï,Ë¶ÅËøîÂõûNSString *Á±ªÂûãNSString *dynamicGetMethodIMP(YAHeader *self, SEL _cmd) &#123; return self-&gt;_name;&#125;+ (BOOL)resolveInstanceMethod:(SEL)sel &#123; if (sel == @selector(setName:)) &#123; class_addMethod([self class], sel, (IMP)dynamicSetMethodIMP, "v@:@"); return YES; &#125; if (sel == @selector(name)) &#123; class_addMethod([self class], sel, (IMP)dynamicGetMethodIMP, "v@:"); return YES; &#125; return [super resolveInstanceMethod:sel];&#125;@end Ê≥®ÊÑè: ÊåâÁÖßÊú¨‰π¶ÊâÄËØ¥Ôºå‰ΩøÁî®@dynamicÂ∞Ü‰ªÖ‰ªÖÁîüÊàêgetter/setterÊñπÊ≥ïÁöÑÂ£∞ÊòéÔºå‰∏ç‰ºöÁîüÊàêgetter/setterÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºå‰πü‰∏ç‰ºöÂêàÊàêÊàêÂëòÂèòÈáè„ÄÇ Áî±‰∫éÊ≤°ÊúâÂêàÊàêÊàêÂëòÂèòÈáèÔºåÊâÄ‰ª•ÈúÄË¶ÅÊâãÂä®Ê∑ªÂä†„ÄÇ ‰ΩøÁî®@property‰ΩÜÊòØÂç¥Ê≤°ÊúâÂêàÊàêÊàêÂëòÂèòÈáèÁöÑÊÉÖÊôØÊúâÔºö ÂêåÊó∂‰ΩøÁî®@propertyÂíå@dynamicÔºõ setterÂíågetterÊñπÊ≥ïÂùáÊâãÂä®ÂÆûÁé∞Ôºõ ÂàÜÁ±ª‰∏≠ÁöÑ@propertyÔºõ ÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÔºåÂΩì‰ΩøÁî®@synthesize num;Êó∂ÔºåÂ∞Ü‰∏ç‰ºöÁîüÊàêÊàêÂëòÂèòÈáè_numÔºåËÄåÊòØÁîüÊàêÊàêÂëòÂèòÈáènum„ÄÇÁÆÄÂçïÊÄªÁªìÂ∞±ÊòØÔºåÂæà‰πÖ‰ª•ÂâçÔºö @property‰ºöÂú®@interface‰∏≠ÁîüÊàêgetterÂíåsetterÁöÑÊñπÊ≥ïÂ£∞ÊòéÔºõ @synthesize‰∏ÄËà¨‰ºöÂú®@implementation‰∏≠ÁîüÊàêgetterÂíåsetterÁöÑÊñπÊ≥ïÂÆûÁé∞ÂèäÁßÅÊúâÁöÑÊàêÂëòÂèòÈáè„ÄÇ @synthesize num = _num;ÔºåÊÑèÂë≥ÁùÄÂΩìÊàêÂëòÂèòÈáè _num ‰∏çÂ≠òÂú®Êó∂ÔºåËá™Âä®ÁîüÊàê‰∏Ä‰∏™ @privateÁöÑÊàêÂëòÂèòÈáè _numÔºõ @synthesize num;ÔºåÊÑèÂë≥ÁùÄÂΩìÊàêÂëòÂèòÈáè num ‰∏çÂ≠òÂú®Êó∂ÔºåËá™Âä®ÁîüÊàê‰∏Ä‰∏™ @privateÁöÑÊàêÂëòÂèòÈáè numÔºõ Ëã•ÊâãÂä®ÂÆûÁé∞ setter ÊñπÊ≥ïÔºåÂàôÂè™‰ºöËá™Âä®ÁîüÊàê getter ÊñπÊ≥ïÔºõ Ëã•ÊâãÂä®ÂÆûÁé∞ getter ÊñπÊ≥ïÔºåÂàôÂè™‰ºöËá™Âä®ÁîüÊàê setter ÊñπÊ≥ïÔºõ Ëã•ÂêåÊó∂ÊâãÂä®ÂÆûÁé∞ setter Âíå getter ÊñπÊ≥ïÔºåÂàô‰∏ç‰ºöËá™Âä®ÁîüÊàê‰∏çÂ≠òÂú®ÁöÑÊàêÂëòÂèòÈáè„ÄÇ ËÄåÁé∞Âú®Ôºå@propertyÂåÖÊèΩ‰∫Ü@synthesizeÁöÑÂäüËÉΩÔºåÈªòËÆ§ÁîüÊàê_ÂºÄÂ§¥ÁöÑÊàêÂëòÂèòÈáè„ÄÇ 2.ÂÖ≥ËÅîÂØπË±°‰∏≠‰∏∫‰ªÄ‰πà‰ΩøÁî®static‰øÆÈ•∞ÁöÑÊåáÈíàstaticÁöÑ‰ΩúÁî®‰πã‰∏Ä‰æøÊòØ‰ΩøÂèòÈáèÂú®ÂÜÖÂ≠ò‰∏≠Âè™Êúâ‰∏Ä‰ªΩÊã∑Ë¥ùÔºåÁî±‰∫éÈúÄË¶Åobjc_setAssociatedObjectÂíåobjc_getAssociatedObject‰∏≠ÁöÑ‰∏§‰∏™ÈîÆ(void *key)ÈúÄË¶ÅÂåπÈÖçÂêå‰∏Ä‰∏™ÂÄº(ÂÖ≥ËÅîÁöÑÂØπË±°)ÔºåÊâÄ‰ª•ÈúÄË¶Å‰∏§ËÄÖÊòØÂÆåÂÖ®Áõ∏ÂêåÁöÑÊåáÈíàÔºåÊïÖËÄå‰ΩøÁî®ÈùôÊÄÅÂÖ®Â±ÄÂèòÈáèÂÅöÈîÆ„ÄÇ 3.ÁÆÄËø∞Objective-CÂú®ÂèëÈÄÅÊ∂àÊÅØÊó∂ÁöÑÂä®ÊÄÅÊÄßÈùôÊÄÅÁªëÂÆöÔºöÂ∞ÜÂú®ËøêË°åÊúüÈó¥Ë∞ÉÁî®ÁöÑÂáΩÊï∞Âú®ÁºñËØëÊúüÈó¥Â∑≤ÁªèÁ°ÆÂÆöÔºõÂä®ÊÄÅÁªëÂÆöÔºöÂèëÈÄÅÁöÑÊ∂àÊÅØÈÉ®ÂàÜËΩ¨Âåñ‰∏∫objc_msgSendÂáΩÊï∞Ôºå‰º†ÂÖ•Â∞ÜË¶ÅË∞ÉÁî®ÂáΩÊï∞ÁöÑÂØπË±°„ÄÅÂ∞ÜË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞‰ª•ÂèäÂ∞ÜË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞ÁöÑÂèÇÊï∞ÔºåÂÖ∑‰ΩìË∞ÉÁî®Âì™‰∏™ÂáΩÊï∞ÔºåÈÄöËøáÂø´ÈÄüÊò†Â∞ÑË°®„ÄÅÊñπÊ≥ïÂàóË°®‰∫¶ÊàñÊòØÊ∂àÊÅØËΩ¨ÂèëÁ°ÆÂÆöÔºõobjc_msgSend_stretÔºöÊ∂àÊÅØËøîÂõûÁªìÊûÑ‰ΩìË∞ÉÁî®objc_msgSend_fpretÔºöÊ∂àÊÅØËøîÂõûÊµÆÁÇπÊï∞Ë∞ÉÁî®objc_msgSendSuperÔºöÁªôË∂ÖÁ±ªÂèëÈÄÅÊ∂àÊÅØË∞ÉÁî® 4.Â¶Ç‰ΩïËß£ÂÜ≥unrecognized selector send to instance‰ΩúËÄÖËøôÈáå‰∏ªË¶ÅÊåáÁöÑÊòØÂú®Ê∂àÊÅØËΩ¨ÂèëÈò∂ÊÆµÂ§ÑÁêÜÔºåËÄå‰∏çÊòØÁÆÄÂçïÂú∞Ê∑ªÂä†‰∏äÊñπÊ≥ïÂÆûÁé∞„ÄÇ Ê∂àÊÅØËΩ¨ÂèëÁöÑ‰∏â‰∏™ÊµÅÁ®ãÔºö ÂØπË±°Êî∂Âà∞Êó†Ê≥ïËØÜÂà´ÁöÑÊ∂àÊÅØÔºåÊ†πÊçÆÊòØÁ±ªÊñπÊ≥ïËøòÊòØÂØπË±°ÊñπÊ≥ïË∞ÉÁî®+ (BOOL)resolveInstanceMethod:(SEL)selectorÊàñËÄÖ+ (BOOL)resolveClassMethod:(SEL)selector„ÄÇÂâçÊèêÔºöÁõ∏ÂÖ≥ÊñπÊ≥ïÁöÑÂÆûÁé∞‰ª£Á†ÅÂ∑≤ÁªèÂÜôÂ•Ω„ÄÇ‰ΩøÁî®ÔºöÊ†πÊçÆÁ±ªÊñπÊ≥ïËøòÊòØÂØπË±°ÊñπÊ≥ïÔºåÂú®resolveMethod‰∏≠‰∏∫Êó†Ê≥ïÂìçÂ∫îÁöÑselectorÂä®ÊÄÅÊ∑ªÂä†ÊñπÊ≥ïÂÆûÁé∞(Êèê‰æõÂáΩÊï∞ÊåáÈíàIMP) class_addMethod(self, selector, (IMP)methodImplemention,"v@:@"); Ëã•Ê≤°ÊúâÂÅöÂá∫Â§ÑÁêÜÔºåËøîÂõûNO„ÄÇ ÂÄòËã•Ê≤°ÊúâÁõ∏ÂÖ≥ÊñπÊ≥ïÂÆûÁé∞ÔºåËøõÂÖ•- (id)forwardingTargetForSelector:(SEL)selectorÔºåÂ∞ÜÊ∂àÊÅØËΩ¨ÂèëÁªôÂÖ∂‰ªñÂØπË±°ÔºåËã•Êâæ‰∏çÂà∞ÔºåËøîÂõûnil„ÄÇ ÂÆåÊï¥ÁöÑÊ∂àÊÅØËΩ¨ÂèëÔºåË∞ÉÁî®ÂØπË±°ÊñπÊ≥ï- (void)forwardInvocation:(NSInvocation *)invocation„ÄÇÈ¶ñÂÖàÂèëÈÄÅ-methodSignatureForSelector:Ëé∑ÂèñÂáΩÊï∞ÁöÑÂèÇÊï∞ÂíåËøîÂõûÂÄºÁ±ªÂûãÔºåËã•ËøîÂõûnilÔºåÁõ¥Êé•ÊåÇÊéâÔºåÂê¶ÂàôruntimeÂàõÂª∫‰∏Ä‰∏™NSInvocationÂØπË±°ÔºåÂèëÈÄÅforwardInvocationÊ∂àÊÅØÁªôÁõÆÊ†áÂØπË±°„ÄÇ 5.Â¶Ç‰ΩïÂÆûÁé∞Â§öÈáçÁªßÊâøËÆ©CÁ±ª‰∫ßÁîüÁöÑÂØπË±°ÂêåÊó∂ÂÖ∑Â§áAÁ±ªÊñπÊ≥ïÂíåBÁ±ªÊñπÊ≥ïÁöÑËÉΩÂäõÔºö CÁ±ªÁªßÊâøËá™AÁ±ª„ÄÇ ‰ΩøCÁ±ªÂØπË±°‰∏≠Êã•ÊúâBÁ±ªÂØπË±°(ÁªÑÂêà)ÔºåÂú®CÁ±ªÂØπË±°‰∏≠ÂÆûÁé∞ÂØπË±°ÊñπÊ≥ïforwardingTargetForSelect:ÊñπÊ≥ïÔºåÂ∞ÜÂèëÈÄÅÊù•ÁöÑÂÖ≥‰∫éBÁ±ªÊñπÊ≥ïËΩ¨ÂèëÁªôÊâÄÊã•ÊúâÁöÑBÁ±ªÂØπË±°Â§ÑÁêÜ„ÄÇ 6.ÊÄé‰πàÂÆûÁé∞ÊñπÊ≥ïÂÆûÁé∞ÁöÑ‰∫§Êç¢‰∏ÄËà¨Âú®loadÊñπÊ≥ï‰∏≠ÂÆûÁé∞‰∫§Êç¢„ÄÇ+ (void)load &#123; Method lowercaseString = class_getInstanceMethod([NSString class], @selector(lowercaseString)); Method uppercaseString = class_getInstanceMethod([NSString class], @selector(uppercaseString)); method_exchangeImplementations(lowercaseString, uppercaseString);&#125; Ë°®Èù¢‰∏äÁúãÊòØÊ≠ªÂæ™ÁéØ: - (NSString *)lowercaseString &#123; return self.lowercaseString;&#125;- (NSString *)uppercaseString &#123; return self.uppercaseString;&#125; ‰ª•‰∏äÁõ¥Êé•‰∫§Êç¢ÁöÑÁ§∫‰æã‰ªÖÈôê‰∫é‰∏çÈúÄË¶ÅË∞ÉÁî®superÁöÑÂÆûÁé∞ÔºåÊõ¥ËØ¶ÁªÜËßÅ„ÄäÂÜçË∞àMethod-Swizzling„Äã„ÄÇ 7.ÁÆÄËø∞‰∏∫‰ª£Á†ÅÂä†ÈîÅÁöÑÊñπÂºèÂêåÊ≠•Âùó: @synchronized(self) {//...} Êª•Áî®@synchronized(self)ÂæàÂç±Èô©ÔºåÊâÄÊúâÁöÑÂùóÈÉΩ‰ºöÂΩºÊ≠§Êä¢Â§∫Âêå‰∏Ä‰∏™ÈîÅ„ÄÇ ÈîÅÂØπË±°:_lock = [[NSLock alloc] init];[_lock lock];// ...[_lock unlock]; 8.ÂéüÂ≠êÊÄß‰∏ÄÂÆöÂÆâÂÖ®ÂêóÔºåÂ¶Ç‰ΩïÁ°Æ‰øùÂ±ûÊÄßÁöÑÁ∫øÁ®ãÂÆâÂÖ®‰∏ç‰∏ÄÂÆö„ÄÇÂéüÂ≠êÊÄßËÉΩ‰øùËØÅÂ≠òÂèñÊñπÊ≥ïÁöÑÁ∫øÁ®ãÂÆâÂÖ®Ôºå‰πüÂç≥ËØªÊàñËÄÖÂÜôÊìç‰ΩúÊòØÂéüÂ≠êÊÄßÁöÑÔºåÂú®ËØªÊàñËÄÖÂÜôÂèëÁîüÁöÑÊó∂ÂÄôÔºåÂÖ∂‰ªñËØªÊàñËÄÖÂÜôÊìç‰ΩúÂøÖÈ°ªÁ≠âÂæÖ„ÄÇÁÑ∂ËÄåÂêå‰∏Ä‰∏™Á∫øÁ®ã‰∏äÂ§öÊ¨°Ë∞ÉÁî®getÊñπÊ≥ïÔºåÊØè‰∏ÄÊ¨°Ëé∑ÂèñÂà∞ÁöÑÂÄºÊú™ÂøÖÁõ∏ÂêåÔºåÂ§öÊ¨°ËÆøÈóÆÊúüÈó¥ÔºåÂÖ∂‰ªñÁ∫øÁ®ãÂèØËÉΩ‰ºöÂÜôÂÖ•Êñ∞ÁöÑÂÄº„ÄÇÊØîÂ¶ÇÂΩìAÁ∫øÁ®ãÁöÑÂÜôÊìç‰ΩúÁªìÊùüÂêéÔºåBÁ∫øÁ®ãËøõË°åÂÜôÊìç‰ΩúÔºåÁÑ∂ÂêéÂΩìAÁ∫øÁ®ãÈúÄË¶ÅËØªÊìç‰ΩúÊó∂ÔºåÂç¥Ëé∑Âæó‰∫ÜÂú®BÁ∫øÁ®ã‰∏≠ÁöÑÂÄºÔºåËøôÂ∞±Á†¥Âùè‰∫ÜÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ Á∫øÁ®ãÂÆâÂÖ®Ôºö‰∏ç‰ºöÂá∫Áé∞Êï∞ÊçÆ‰∏ç‰∏ÄËá¥ÊàñËÄÖÊï∞ÊçÆÊ±°ÊüìÔºå‰πüÂç≥Â§öÁ∫øÁ®ãËÆøÈóÆÊó∂Ê≤°ÊúâÂá∫Áé∞ÊÑèÊñô‰πãÂ§ñÁöÑÁªìÊûú„ÄÇ ÊØîÂ¶Ç‰ΩøÁî®atomic‰øÆÈ•∞ÁöÑageÂ±ûÊÄßÔºö@interface YACat : NSObject@property (atomic, assign) NSUInteger age;@end Âú®‰ΩøÁî®Êó∂Ôºö// thread Adispatch_async(dispatch_queue_create("A", DISPATCH_QUEUE_CONCURRENT), ^&#123; for (int i = 0; i &lt; 1000; i ++) &#123; gCat.age = gCat.age + 1; NSLog(@"Thread A: %ld\n", gCat.age); &#125;&#125;); // thread Bdispatch_async(dispatch_queue_create("B", DISPATCH_QUEUE_CONCURRENT), ^&#123; for (int i = 0; i &lt; 1000; i ++) &#123; gCat.age = gCat.age + 1; NSLog(@"Thread B: %ld\n", gCat.age); &#125;&#125;); ÁªìÊûúÂπ∂‰∏ç‰∏ÄÂÆöÊòØ1000ÔºåÂá∫Áé∞ÁöÑÁªìÊûú‰∏çÁ¨¶ÂêàÈ¢ÑÊúü„ÄÇÂéüÂõ†Âú®‰∫éÔºågCat.age = gCat.age + 1;Ëøô‰∏™ËØª„ÄÅÂä†‰∏Ä„ÄÅÂÜôÁöÑÊï¥‰ΩìÊìç‰ΩúÂπ∂‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇËøôÊó∂ÔºåÂèØ‰ª•ÈÄöËøáÂä†ÈîÅÊù•‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®Ôºö[_Lock lock];gCat.age = gCat.age + 1;[_Lock unlock]; 9.performSelectorÁöÑÂ±ÄÈôêÊÄßÊúâÂì™‰∫õ Áî±‰∫éÊó†Ê≥ïÁ°ÆÂÆöÂ∞ÜË¶ÅÊâßË°åÁöÑselectorÂÖ∑‰ΩìÊòØ‰ªÄ‰πàÔºåARCÊó†Ê≥ïÂ∞ÜÂÖ∂Á∫≥ÂÖ•ÂêàÈÄÇÁöÑÂÜÖÂ≠òÁÆ°ÁêÜÊñπÊ≥ï‰∏≠ÔºåÂèØËÉΩÊúâÂÜÖÂ≠òÊ≥ÑÊºè„ÄÇ selectorÁöÑËøîÂõûÂÄºÁ±ªÂûãÂíåÂèÇÊï∞‰∏™Êï∞„ÄÅÁ±ªÂûãÂèóÂà∞ÈôêÂà∂„ÄÇÂª∫ËÆÆ‰ΩøÁî®GCD‰∏≠ÁöÑdispatch_async/dispatch_afterÁ≠â‰ª£ÊõøÁõ∏Â∫îÁöÑperformSelector„ÄÇ - (void)fetchSelector:(NSInteger)condition &#123; SEL selector; if (condition == 0) &#123; selector = @selector(dismiss); &#125; else if (condition == 1)&#123; selector = @selector(miss:); &#125; else &#123; selector = @selector(love); &#125; [self performSelector:selector];&#125; ‰ºöÂá∫Áé∞Ë≠¶ÂëäÔºö/Users/chenyalun/Desktop/iOS/program/Demo170404/Demo170404/YAHeader.m:70:11: PerformSelector may cause a leak because its selector is unknown„ÄÇ Êõ¥Â§öperformSelectorÂÜÖÂÆπËßÅ„ÄäËØ¶Ëß£performSelector„Äã„ÄÇ 10.__bridge„ÄÅ__bridge_retained‰∏é__bridge_transferÁöÑÂå∫Âà´NSArray *array = @[@10, @11, @12];CFArrayRef cfarray = (__bridge CFArrayRef)array; CFArrayRef cfarray2 = (__bridge_retained CFArrayRef)array;CFRelease(cfarray2); NSArray *array2 = (__bridge_transfer NSArray *)cfarray; __bridgeÔºöË°®Á§∫ARC‰ªçÁÑ∂ÂÖ∑Â§áËØ•ÂØπË±°ÁöÑÊâÄÊúâÊùÉ„ÄÇ __bridge_retainedÔºöË°®Á§∫ARC‰∫§Âá∫ËØ•ÂØπË±°ÁöÑÊâÄÊúâÊùÉ(ÈúÄÊâãÂä®release)„ÄÇ __bridge_transferÔºöË°®Á§∫ÂèçÂêëËΩ¨Êç¢ÔºåÂêåÊó∂ARCËé∑ÂèñÂØπË±°ÊâÄÊúâÊùÉ„ÄÇ 11.NSCacheÁõ∏ËæÉNSDictionaryÁöÑ‰ºòÁÇπ Âú®Á≥ªÁªüÂèëÂá∫‰ΩéÂÜÖÂ≠òÈÄöÁü•Êó∂ÔºåNSCacheËá™Âä®Âà†ÂáèÁºìÂ≠òÔºåÂπ∂‰∏îÂÖàË°åÂà†ÂáèÊúÄ‰πÖÊú™‰ΩøÁî®ÁöÑÂØπË±°„ÄÇ Â¢ûÂä†ÈîÆÁöÑÂºïÁî®ËÆ°Êï∞ËÄå‰∏çÊòØÊã∑Ë¥ùÂÆÉ„ÄÇ NSCacheÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂèØ‰ª•Â§öÁ∫øÁ®ãËÆøÈóÆËÄå‰∏çÂá∫Èîô„ÄÇ NSPurgeableDataÊòØNSMutableDataÁöÑÂ≠êÁ±ªÔºåÂ∞ÜÂÆÉ‰∏éNSCacheÊê≠ÈÖç‰ΩøÁî®ÔºåÂΩìNSPurgeableDataÂØπË±°ÊâÄÂç†ÂÜÖÂ≠ò‰∏∫Á≥ªÁªüÊâÄ‰∏¢ÂºÉÊó∂ÔºåËØ•ÂØπË±°Ëá™Âä®‰ªéNSCacheÁºìÂ≠ò‰∏≠Ê∏ÖÈô§„ÄÇ NSPurgeableData‰ΩøÁî®Á§∫‰æãÔºö NSCache *cache = [[NSCache alloc] init]; NSPurgeableData *purgeableData = [NSPurgeableData dataWithBytes:@"ILOVEYOU" length:10];[cache setObject:purgeableData forKey:@00]; // ËÆøÈóÆNSPurgeableDataif (purgeableData) &#123; // ÂºÄÂßãËÆøÈóÆ,Áé∞Âú®Ëøò‰∏çÂ∫îËØ•‰∏¢ÂºÉËá™Â∑±ÊâÄÂç†Áî®ÁöÑÂÜÖÂ≠ò [purgeableData beginContentAccess]; [self useData:purgeableData]; // ÁªìÊùüËÆøÈóÆ,Áé∞Âú®ÂèØ‰ª•‰∏¢ÂºÉËá™Â∑±ÊâÄÂç†Áî®ÁöÑÂÜÖÂ≠òÂï¶ [purgeableData endContentAccess];&#125; ÂèÇËÄÉÂπ∂ÊÑüË∞¢Ôºö‰πûÂäõÈ©¨ÊâéÁΩóÁöÑÈõ™ÁöÑÂçöÂÆ¢]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>ÈòÖËØª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ªéC++Âà∞Ê±áÁºñ]]></title>
    <url>%2F2017%2F04%2F02%2F%E4%BB%8EC%2B%2B%E5%88%B0%E6%B1%87%E7%BC%96%2F</url>
    <content type="text"><![CDATA[2019.08.18 Ë°•ÂÖÖÊ±áÁºñÂÜÖÂÆπ C++„ÄÇ Êú¨ÊñáÊòØÂ§ç‰π†C++Êó∂ÁöÑÁ¨îËÆ∞Ôºå‰∏ªË¶ÅÊòØËØ≠Ê≥ïÊñπÈù¢ÁöÑÂÜÖÂÆπ„ÄÇ 1.ÂëΩÂêçÁ©∫Èó¥‰ΩúÁî®ÔºöÈò≤Ê≠¢Âá∫Áé∞ÂèòÈáèÊàñÂáΩÊï∞ÁöÑÂëΩÂêçÂÜ≤Á™Å„ÄÇ Âú® main() ÂáΩÊï∞‰∏≠Â£∞ÊòéÂëΩÂêçÁ©∫Èó¥ stdÔºåÂÆÉÁöÑ‰ΩúÁî®ËåÉÂõ¥Â∞±‰Ωç‰∫é main() ÂáΩÊï∞ÂÜÖÈÉ®ÔºåÂ¶ÇÊûúÂú®ÂÖ∂‰ªñÂáΩÊï∞‰∏≠ÂèàÁî®Âà∞‰∫Ü stdÔºåÂ∞±ÈúÄË¶ÅÈáçÊñ∞Â£∞Êòé„ÄÇÂ¶ÇÊûúÂ∏åÊúõÂú®ÊâÄÊúâÂáΩÊï∞‰∏≠ÈÉΩ‰ΩøÁî®ÂëΩÂêçÁ©∫Èó¥ stdÔºåÂèØ‰ª•Â∞ÜÂÆÉÂ£∞ÊòéÂú®ÂÖ®Â±ÄËåÉÂõ¥‰∏≠„ÄÇ // ÂÆö‰πânamespace YA &#123;int a;// ÂèòÈáè„ÄÅÁ±ª„ÄÅÂáΩÊï∞„ÄÅtypedef„ÄÅ#define Á≠âÈÉΩÂèØ‰ª•Âá∫Áé∞Âú®ÂëΩÂêçÁ©∫Èó¥‰∏≠&#125;// ‰ΩøÁî®ÊñπÂºè‰∏Ä:ÂüüËß£ÊûêÊìç‰ΩúÁ¨¶// :ÊòØÂüüËß£ÊûêÊìç‰ΩúÁ¨¶,ÊåáÊòéË¶Å‰ΩøÁî®ÁöÑÂëΩÂêçÁ©∫Èó¥YA :: a = 20;// ‰ΩøÁî®ÊñπÂºè‰∫å:ÈíàÂØπÂèòÈáè// Â¶ÇÊûú‰ª•ÂêéÂá∫Áé∞‰∫ÜÊú™ÊåáÊòéÂëΩÂêçÁ©∫Èó¥ÁöÑaÔºåÂ∞±‰ΩøÁî®YA :: ausing YA :: a;a = 20;// ‰ΩøÁî®ÊñπÂºè‰∏â:ÈíàÂØπÂëΩÂêçÁ©∫Èó¥using namespace YA; // Â£∞ÊòéÊï¥‰∏™ÂëΩÂêçÁ©∫Èó¥ ÂØπ‰∫é‰∏çÂ∏¶.hÁöÑÂ§¥Êñá‰ª∂ÔºåÊâÄÊúâÁöÑÁ¨¶Âè∑ÈÉΩ‰Ωç‰∫éÂëΩÂêçÁ©∫Èó¥ std ‰∏≠Ôºå‰ΩøÁî®Êó∂ÈúÄË¶ÅÂ£∞ÊòéÂëΩÂêçÁ©∫Èó¥stdÔºõÂØπ‰∫éÂ∏¶.hÁöÑÂ§¥Êñá‰ª∂ÔºåÊ≤°Êúâ‰ΩøÁî®‰ªª‰ΩïÂëΩÂêçÁ©∫Èó¥ÔºåÊâÄÊúâÁ¨¶Âè∑ÈÉΩ‰Ωç‰∫éÂÖ®Â±Ä‰ΩúÁî®Âüü„ÄÇ #include &lt;cstdio&gt;using namespace std;//... 2.C++Áé∞Ë°åÊ†áÂáÜÂ∫ìCËØ≠Ë®ÄÁöÑÂ§¥Êñá‰ª∂Âú® C++ ‰∏≠‰æùÁÑ∂Ë¢´ÊîØÊåÅÔºåC++ Êñ∞Â¢ûÁöÑÂ∫ìÊõ¥Âä†Âº∫Â§ßÂíåÁÅµÊ¥ªÔºå‰æãÂ¶Ç iostream„ÄÅfstream„ÄÅstring Á≠â„ÄÇ #include &lt;iostream&gt;#include &lt;string&gt;using namespace std;//... 3.cin‰∏écoutcout Âíå cin ÂàÜÂà´ÊòØ ostream Âíå istream Á±ªÁöÑÂØπË±°ÔºåËÄå‰∏çÊòØÂÖ≥ÈîÆÂ≠ó„ÄÇ‰ΩøÁî®Á§∫‰æãÔºöint a,b;cin &gt;&gt; a &gt;&gt; b;cout &lt;&lt; "aÊòØ" &lt;&lt; a &lt;&lt; endl;cout &lt;&lt; "bÊòØ" &lt;&lt; b &lt;&lt; endl; ÂÖ∂‰∏≠endlË°®Á§∫end of line„ÄÇ 4.const1.ÂÆö‰πâÂ∏∏Èáèconst int a = 10; // a‰∏çÂèØ‰øÆÊîπ 2.Á±ªÂûãÊ£ÄÊü•void f(const int i){} // ÂØπ‰º†ËøõÊù•ÁöÑÂèÇÊï∞ËøõË°åÁ±ªÂûãÊ£ÄÊü•,‰∏çÂåπÈÖçÂàôÊèêÁ§∫ 3.‰øùÊä§ÂèÇÊï∞void f(const int i){} // i‰∏çÂèØ‰øÆÊîπ 4.ËäÇÁúÅÁ©∫Èó¥// ÊõøÊç¢‰∏âÊ¨°,ÂàÜÈÖç‰∏âÊ¨°ÂÜÖÂ≠òÁ©∫Èó¥#define pi 3.14double a = pi;double b = pi;double c = pi;const double PI = 3.14// Âè™ÂàÜÈÖç‰∏ÄÊ¨°ÂÜÖÂ≠òÁ©∫Èó¥double d = PI;// ‰∏çÂÜçÂàÜÈÖçÂÜÖÂ≠òÁ©∫Èó¥double e = PI; Ê∑∑Ê∑ÜÁÇπ:ÊåáÈíàÊú¨Ë∫´ÊòØÂ∏∏Èáè‰∏çÂèØÂèòÔºå‰∏çÂèØ‰ª•ÊåáÂêëÂÖ∂‰ªñÔºö char* const pContent; ÊåáÈíàÊâÄÊåáÂêëÁöÑÂÜÖÂÆπÊòØÂ∏∏Èáè‰∏çÂèØÂèòÔºö const char *pContent; ‰∏§ËÄÖÈÉΩ‰∏çÂèØÂèòÔºö const char* const pContent; 5.Âä®ÊÄÅÂàÜÈÖçÂÜÖÂ≠òÂú®C‰∏≠ÂàÜÈÖç int *p = (int *)malloc(sizeof(int) * 10); ÈáäÊîæ free(p); Âú®C++‰∏≠ new[]ÂàÜÈÖç delete[]ÈáäÊîæ int *p = new int; delete p; int *p = new int[10]; //ÂàÜÈÖç10‰∏™intÂûãÁöÑÂÜÖÂ≠òÁ©∫Èó¥ delete[] p; new ÊòØÂú®Â†ÜÁ©∫Èó¥ÂàÜÈÖçÂÜÖÂ≠òÔºåÂøÖÈ°ªÊâãÂä®ÈáäÊîæÔºåÂê¶ÂàôÂè™ËÉΩÁ≠âÂà∞Á®ãÂ∫èËøêË°åÁªìÊùüÁî±Êìç‰ΩúÁ≥ªÁªüÂõûÊî∂„ÄÇÁî® new ÂàÜÈÖçÂÜÖÂ≠òÊó∂‰ºöË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞ÔºåÁî® delete ÈáäÊîæÂÜÖÂ≠òÊó∂‰ºöË∞ÉÁî®ÊûêÊûÑÂáΩÊï∞„ÄÇ 6.ÂáΩÊï∞Ë∞ÉÁî®ÁöÑÊµÅÁ®ãÂáΩÊï∞Ë∞ÉÁî®ÊòØÊúâÊó∂Èó¥ÂíåÁ©∫Èó¥ÂºÄÈîÄÁöÑ(ÈÄíÂΩíÊïàÁéá‰Ωé‰∏ã)„ÄÇÁ®ãÂ∫èÂú®ÊâßË°å‰∏Ä‰∏™ÂáΩÊï∞‰πãÂâçÈúÄË¶ÅÂÅö‰∏Ä‰∫õÂáÜÂ§áÂ∑•‰ΩúÔºåË¶ÅÂ∞ÜÂÆûÂèÇ„ÄÅÂ±ÄÈÉ®ÂèòÈáè„ÄÅËøîÂõûÂú∞ÂùÄ‰ª•ÂèäËã•Âπ≤ÂØÑÂ≠òÂô®ÈÉΩÂéãÂÖ•Ê†à‰∏≠ÔºåÁÑ∂ÂêéÊâçËÉΩÊâßË°åÂáΩÊï∞‰Ωì‰∏≠ÁöÑ‰ª£Á†ÅÔºõÂáΩÊï∞‰Ωì‰∏≠ÁöÑ‰ª£Á†ÅÊâßË°åÂÆåÊØïÂêéËøòË¶ÅÊ∏ÖÁêÜÁé∞Âú∫ÔºåÂ∞Ü‰πãÂâçÂéãÂÖ•Ê†à‰∏≠ÁöÑÊï∞ÊçÆÈÉΩÂá∫Ê†àÔºåÊâçËÉΩÊé•ÁùÄÊâßË°åÂáΩÊï∞Ë∞ÉÁî®‰ΩçÁΩÆ‰ª•ÂêéÁöÑ‰ª£Á†Å„ÄÇ 7.ÂÜÖËÅîÂáΩÊï∞‰ΩúÁî®:‰∏∫‰∫ÜÊ∂àÈô§ÂáΩÊï∞Ë∞ÉÁî®ÁöÑÊó∂Á©∫ÂºÄÈîÄÔºåÂú®ÁºñËØëÊó∂Â∞ÜÂáΩÊï∞Ë∞ÉÁî®Â§ÑÁî®ÂáΩÊï∞‰ΩìÊõøÊç¢ÔºåÁ±ª‰ºº‰∫éCËØ≠Ë®Ä‰∏≠ÁöÑÂÆèÂ±ïÂºÄ„ÄÇËøôÁßçÂú®ÂáΩÊï∞Ë∞ÉÁî®Â§ÑÁõ¥Êé•ÂµåÂÖ•ÂáΩÊï∞‰ΩìÁöÑÂáΩÊï∞Áß∞‰∏∫ÂÜÖËÅîÂáΩÊï∞. Âú®ÂáΩÊï∞ÂÆö‰πâÂ§ÑÊ∑ªÂä†inlineÂÖ≥ÈîÆÂ≠óÔºåÂ£∞ÊòéÂ§ÑÊ∑ªÂä†Êó†ÊïàÔºöinline p() &#123; printf("ÂÜÖËÅîÂáΩÊï∞");&#125; Ê≥®ÊÑè: ÂΩìÂáΩÊï∞ÊØîËæÉÂ§çÊùÇÊó∂ÔºåÂáΩÊï∞Ë∞ÉÁî®ÁöÑÊó∂Á©∫ÂºÄÈîÄÂèØ‰ª•ÂøΩÁï•ÔºåÂ§ßÈÉ®ÂàÜÁöÑ CPU Êó∂Èó¥ÈÉΩ‰ºöËä±Ë¥πÂú®ÊâßË°åÂáΩÊï∞‰Ωì‰ª£Á†Å‰∏äÔºåÊâÄ‰ª•‰∏ÄËà¨ÊòØÂ∞ÜÈùûÂ∏∏Áü≠Â∞èÁöÑÂáΩÊï∞Â£∞Êòé‰∏∫ÂÜÖËÅîÂáΩÊï∞„ÄÇ ÂØπÂáΩÊï∞‰Ωú inline Â£∞ÊòéÂè™ÊòØÁ®ãÂ∫èÂëòÂØπÁºñËØëÂô®ÊèêÂá∫ÁöÑ‰∏Ä‰∏™Âª∫ËÆÆÔºåËÄå‰∏çÊòØÂº∫Âà∂ÊÄßÁöÑ„ÄÇÁºñËØëÂô®ÊúâËá™Â∑±ÁöÑÂà§Êñ≠ËÉΩÂäõÔºåÂÆÉ‰ºöÊ†πÊçÆÂÖ∑‰ΩìÊÉÖÂÜµÂÜ≥ÂÆöÊòØÂê¶ËøôÊ†∑ÂÅö„ÄÇÂ¶Ç‰ΩïÂáΩÊï∞‰ΩìÈùûÂ∏∏Â§ßÔºåÈÇ£‰πàÁºñËØëÂô®Â∞ÜÂøΩÁï•ÂáΩÊï∞ÁöÑÂÜÖËÅîÂ£∞ÊòéÔºåËÄåÂ∞ÜÂÜÖËÅîÂáΩÊï∞‰Ωú‰∏∫ÊôÆÈÄöÂáΩÊï∞Â§ÑÁêÜ„ÄÇ Áº∫ÁÇπÔºöÁºñËØëÂêéÁöÑÁ®ãÂ∫è‰ºöÂ≠òÂú®Â§ö‰ªΩÁõ∏ÂêåÁöÑÂáΩÊï∞Êã∑Ë¥ùÔºåÂ¶ÇÊûúË¢´Â£∞Êòé‰∏∫ÂÜÖËÅîÂáΩÊï∞ÁöÑÂáΩÊï∞‰ΩìÈùûÂ∏∏Â§ßÔºåÈÇ£‰πàÁºñËØëÂêéÁöÑÁ®ãÂ∫è‰ΩìÁßØ‰πüÂ∞Ü‰ºöÂèòÂæóÂæàÂ§ß„ÄÇ ÊÄªÁªìÔºöÂ∞èËÄåÁü≠ÁöÑÂáΩÊï∞Â£∞Êòé‰∏∫ÂÜÖËÅîÂáΩÊï∞. ÂÜÖËÅîÂáΩÊï∞Êõø‰ª£ÂÆè#define sum(a,b) (a+b)inline int sum(int a, int b) &#123; return a+b;&#125; 8.ÂáΩÊï∞ÁöÑÈªòËÆ§ÂèÇÊï∞/ÈáçËΩΩÈªòËÆ§ÂèÇÊï∞Âè™ËÉΩÊîæÂú®ÂΩ¢ÂèÇÂàóË°®ÁöÑÊúÄÂêéÔºåËÄå‰∏î‰∏ÄÊó¶‰∏∫Êüê‰∏™ÂΩ¢ÂèÇÊåáÂÆö‰∫ÜÈªòËÆ§ÂÄºÔºåÈÇ£‰πàÂÆÉÂêéÈù¢ÁöÑÊâÄÊúâÂΩ¢ÂèÇÈÉΩÂøÖÈ°ªÊúâÈªòËÆ§ÂÄº„ÄÇvoid sum(int a, int b = 10) &#123;cout &lt;&lt; a+b &lt;&lt; endl;&#125;// Ë∞ÉÁî®sum(12,23);sum(12) ÈáçËΩΩÂ∞±ÊòØÂú®‰∏Ä‰∏™‰ΩúÁî®ËåÉÂõ¥ÂÜÖÔºàÂêå‰∏Ä‰∏™Á±ª„ÄÅÂêå‰∏Ä‰∏™ÂëΩÂêçÁ©∫Èó¥Á≠âÔºâÊúâÂ§ö‰∏™ÂêçÁß∞Áõ∏Âêå‰ΩÜÂèÇÊï∞‰∏çÂêåÁöÑÂáΩÊï∞„ÄÇÈáçËΩΩÁöÑÁªìÊûúÊòØËÆ©‰∏Ä‰∏™ÂáΩÊï∞ÂêçÊã•Êúâ‰∫ÜÂ§öÁßçÁî®ÈÄîÔºå‰ΩøÂæóÂëΩÂêçÊõ¥Âä†Êñπ‰æøÔºåË∞ÉÁî®Êõ¥Âä†ÁÅµÊ¥ª„ÄÇË¶ÅÊ±ÇÔºöÂáΩÊï∞ÂêçÁõ∏ÂêåÔºöÂèÇÊï∞ÂàóË°®‰∏çÂêåÔºå‰ªÖ‰ªÖËøîÂõûÁ±ªÂûã‰∏çÂêå‰∏çË∂≥‰ª•Êàê‰∏∫ÂáΩÊï∞ÁöÑÈáçËΩΩ„ÄÇ//‰∫§Êç¢ int ÂèòÈáèÁöÑÂÄºvoid swap(int *a, int *b)&#123; int temp = *a; *a = *b; *b = temp;&#125;//‰∫§Êç¢ float ÂèòÈáèÁöÑÂÄºvoid swap(float *a, float *b)&#123; float temp = *a; *a = *b; *b = temp;&#125; ÈáçËΩΩÁöÑÊú¨Ë¥®ÔºöÂú®ÁºñËØëÊó∂‰ºöÊ†πÊçÆÂèÇÊï∞ÂàóË°®ÂØπÂáΩÊï∞ËøõË°åÈáçÂëΩÂêçÔºåÂáΩÊï∞ÈáçËΩΩ‰ªÖ‰ªÖÊòØËØ≠Ê≥ïÂ±ÇÈù¢ÁöÑÔºåÊú¨Ë¥®‰∏äÂÆÉ‰ª¨ËøòÊòØ‰∏çÂêåÁöÑÂáΩÊï∞ÔºåÂç†Áî®‰∏çÂêåÁöÑÂÜÖÂ≠òÔºåÂÖ•Âè£Âú∞ÂùÄ‰πü‰∏ç‰∏ÄÊ†∑„ÄÇ 9.ÂØπË±°ÁöÑÂàõÂª∫Á±ªÂè™ÊòØ‰∏Ä‰∏™Ê®°ÊùøÔºàTemplateÔºâÔºåÁºñËØëÂêé‰∏çÂç†Áî®ÂÜÖÂ≠òÁ©∫Èó¥ÔºåÊâÄ‰ª•Âú®ÂÆö‰πâÁ±ªÊó∂‰∏çËÉΩÂØπÊàêÂëòÂèòÈáèËøõË°åÂàùÂßãÂåñÔºåÂõ†‰∏∫Ê≤°ÊúâÂú∞ÊñπÂ≠òÂÇ®Êï∞ÊçÆ„ÄÇÂè™ÊúâÂú®ÂàõÂª∫ÂØπË±°‰ª•ÂêéÊâç‰ºöÁªôÊàêÂëòÂèòÈáèÂàÜÈÖçÂÜÖÂ≠òÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØ‰ª•ËµãÂÄº‰∫Ü„ÄÇ ÊàêÂëòÂèòÈáèÂ§ßÈÉΩ‰ª•m_ÂºÄÂ§¥„ÄÇ Â≠òÂÇ®Âú®Ê†à‰∏äÁöÑÂØπË±° Student stu;Student *p = &amp;stu; Â≠òÂÇ®Âú®Â†Ü‰∏äÁöÑÂØπË±°Student *stu = new Student; ‰ΩøÁî® new Âú®Â†Ü‰∏äÂàõÂª∫Âá∫Êù•ÁöÑÂØπË±°ÊòØÂåøÂêçÁöÑÔºåÂøÖÈ°ªË¶ÅÁî®‰∏Ä‰∏™ÊåáÈíàÊåáÂêëÂÆÉÔºåÂÜçÂÄüÂä©ÊåáÈíàÊù•ËÆøÈóÆÂÆÉÁöÑÊàêÂëòÂèòÈáèÊàñÊàêÂëòÂáΩÊï∞„ÄÇ 10.ÊàêÂëòÂáΩÊï∞Âú®Á±ª‰Ωì‰∏≠ÂÆö‰πâÁöÑÊàêÂëòÂáΩÊï∞‰ºöËá™Âä®Êàê‰∏∫ÂÜÖËÅîÂáΩÊï∞ÔºåÂú®Á±ª‰ΩìÂ§ñÂÆö‰πâÁöÑ‰∏ç‰ºö„ÄÇÂÜÖËÅîÂáΩÊï∞‰∏ÄËà¨‰∏çÊòØÊàë‰ª¨ÊâÄÊúüÊúõÁöÑÔºåÂÆÉ‰ºöÂ∞ÜÂáΩÊï∞Ë∞ÉÁî®Â§ÑÁî®ÂáΩÊï∞‰ΩìÊõø‰ª£ÔºåÊâÄ‰ª•Âª∫ËÆÆÂú®Á±ª‰ΩìÂÜÖÈÉ®ÂØπÊàêÂëòÂáΩÊï∞‰ΩúÂ£∞ÊòéÔºåËÄåÂú®Á±ª‰ΩìÂ§ñÈÉ®ËøõË°åÂÆö‰πâ. ‰∏ç‰ΩøÁî®ÂÜÖËÅîÂáΩÊï∞:class Student&#123;public: int age; void say(); //ÂÜÖËÅîÂáΩÊï∞Â£∞Êòé&#125;; //ÂáΩÊï∞ÂÆö‰πâvoid Student::say()&#123; &#125; 11.ÊûÑÈÄ†ÂáΩÊï∞ÊûÑÈÄ†ÂáΩÊï∞ÂøÖÈ°ªÊòØ public Â±ûÊÄßÁöÑÔºåÂê¶ÂàôÂàõÂª∫ÂØπË±°Êó∂Êó†Ê≥ïË∞ÉÁî®„ÄÇÊûÑÈÄ†ÂáΩÊï∞ÁöÑË∞ÉÁî®ÊòØÂº∫Âà∂ÊÄßÁöÑÔºå‰∏ÄÊó¶Âú®Á±ª‰∏≠ÂÆö‰πâ‰∫ÜÊûÑÈÄ†ÂáΩÊï∞ÔºåÈÇ£‰πàÂàõÂª∫ÂØπË±°Êó∂Â∞±‰∏ÄÂÆöË¶ÅË∞ÉÁî®Ôºå‰∏çË∞ÉÁî®ÊòØÈîôËØØÁöÑ„ÄÇ‰∏Ä‰∏™Á±ªÂøÖÈ°ªÊúâÊûÑÈÄ†ÂáΩÊï∞ÔºåË¶Å‰πàÁî®Êà∑Ëá™Â∑±ÂÆö‰πâÔºåË¶Å‰πàÁºñËØëÂô®Ëá™Âä®ÁîüÊàê„ÄÇ‰∏ÄÊó¶Áî®Êà∑Ëá™Â∑±ÂÆö‰πâ‰∫ÜÊûÑÈÄ†ÂáΩÊï∞Ôºå‰∏çÁÆ°ÊúâÂá†‰∏™Ôºå‰πü‰∏çÁÆ°ÂΩ¢ÂèÇÂ¶Ç‰ΩïÔºåÁºñËØëÂô®ÈÉΩ‰∏çÂÜçËá™Âä®ÁîüÊàê„ÄÇ Ë∞ÉÁî®Ê≤°ÊúâÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞‰πüÂèØ‰ª•ÁúÅÁï•Êã¨Âè∑„ÄÇStudent stu();Student stu;Student *stu = new Student();Student *stu = new Student; ÂèÇÊï∞ÂàùÂßãÂåñË°®ÂèØ‰ª•Áî®‰∫éÂÖ®ÈÉ®ÊàêÂëòÂèòÈáèÔºå‰πüÂèØ‰ª•Âè™Áî®‰∫éÈÉ®ÂàÜÊàêÂëòÂèòÈáè„ÄÇÂèÇÊï∞ÂàùÂßãÂåñÈ°∫Â∫è‰∏éÂàùÂßãÂåñË°®ÂàóÂá∫ÁöÑÂèòÈáèÁöÑÈ°∫Â∫èÊó†ÂÖ≥ÔºåÂÆÉÂè™‰∏éÊàêÂëòÂèòÈáèÂú®Á±ª‰∏≠Â£∞ÊòéÁöÑÈ°∫Â∫èÊúâÂÖ≥„ÄÇ ÂàùÂßãÂåñ const ÊàêÂëòÂèòÈáèÁöÑÂîØ‰∏ÄÊñπÊ≥ïÂ∞±ÊòØ‰ΩøÁî®ÂèÇÊï∞ÂàùÂßãÂåñË°®Ôºö //ÈááÁî®ÂèÇÊï∞ÂàùÂßãÂåñË°®Student::Student(char *name, int age, float score): m_name(name), m_age(age), m_score(score)&#123; //TODO:&#125; 12.ÊûêÊûÑÂáΩÊï∞ÊûêÊûÑÂáΩÊï∞ÔºàDestructorÔºâ‰πüÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊàêÂëòÂáΩÊï∞ÔºåÊ≤°ÊúâËøîÂõûÂÄºÔºå‰∏çÈúÄË¶ÅÁ®ãÂ∫èÂëòÊòæÂºèË∞ÉÁî®ÔºàÁ®ãÂ∫èÂëò‰πüÊ≤°Ê≥ïÊòæÂºèË∞ÉÁî®ÔºâÔºåËÄåÊòØÂú®ÈîÄÊØÅÂØπË±°Êó∂Ëá™Âä®ÊâßË°å„ÄÇÊûÑÈÄ†ÂáΩÊï∞ÁöÑÂêçÂ≠óÂíåÁ±ªÂêçÁõ∏ÂêåÔºåËÄåÊûêÊûÑÂáΩÊï∞ÁöÑÂêçÂ≠óÊòØÂú®Á±ªÂêçÂâçÈù¢Âä†‰∏Ä‰∏™~Á¨¶Âè∑„ÄÇÊûêÊûÑÂáΩÊï∞Ê≤°ÊúâÂèÇÊï∞Ôºå‰∏çËÉΩË¢´ÈáçËΩΩÔºåÂõ†Ê≠§‰∏Ä‰∏™Á±ªÂè™ËÉΩÊúâ‰∏Ä‰∏™ÊûêÊûÑÂáΩÊï∞„ÄÇÂ¶ÇÊûúÁî®Êà∑Ê≤°ÊúâÂÆö‰πâÔºåÁºñËØëÂô®‰ºöËá™Âä®ÁîüÊàê‰∏Ä‰∏™ÈªòËÆ§ÁöÑÊûêÊûÑÂáΩÊï∞„ÄÇ 13.thisthis ÊòØ C++ ‰∏≠ÁöÑ‰∏Ä‰∏™ÂÖ≥ÈîÆÂ≠óÔºå‰πüÊòØ‰∏Ä‰∏™ const ÊåáÈíàÔºåÂÆÉÊåáÂêëÂΩìÂâçÂØπË±°ÔºåÈÄöËøáÂÆÉÂèØ‰ª•ËÆøÈóÆÂΩìÂâçÂØπË±°ÁöÑÊâÄÊúâÊàêÂëò„ÄÇ this ËôΩÁÑ∂Áî®Âú®Á±ªÁöÑÂÜÖÈÉ®Ôºå‰ΩÜÊòØÂè™ÊúâÂú®ÂØπË±°Ë¢´ÂàõÂª∫‰ª•ÂêéÊâç‰ºöÁªô this ËµãÂÄºÔºåÂπ∂‰∏îËøô‰∏™ËµãÂÄºÁöÑËøáÁ®ãÊòØÁºñËØëÂô®Ëá™Âä®ÂÆåÊàêÁöÑÔºå‰∏çÈúÄË¶ÅÁî®Êà∑Âπ≤È¢ÑÔºåÁî®Êà∑‰πü‰∏çËÉΩÊòæÂºèÂú∞Áªô this ËµãÂÄº„ÄÇ Êú¨Ë¥®Ôºöthis ÂÆûÈôÖ‰∏äÊòØÊàêÂëòÂáΩÊï∞ÁöÑ‰∏Ä‰∏™ÂΩ¢ÂèÇÔºåÂú®Ë∞ÉÁî®ÊàêÂëòÂáΩÊï∞Êó∂Â∞ÜÂØπË±°ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ÂÆûÂèÇ‰º†ÈÄíÁªô this„ÄÇ‰∏çËøá this Ëøô‰∏™ÂΩ¢ÂèÇÊòØÈöêÂºèÁöÑÔºåÂÆÉÂπ∂‰∏çÂá∫Áé∞Âú®‰ª£Á†Å‰∏≠ÔºåËÄåÊòØÂú®ÁºñËØëÈò∂ÊÆµÁî±ÁºñËØëÂô®ÈªòÈªòÂú∞Â∞ÜÂÆÉÊ∑ªÂä†Âà∞ÂèÇÊï∞ÂàóË°®‰∏≠„ÄÇthis ‰Ωú‰∏∫ÈöêÂºèÂΩ¢ÂèÇÔºåÊú¨Ë¥®‰∏äÊòØÊàêÂëòÂáΩÊï∞ÁöÑÂ±ÄÈÉ®ÂèòÈáèÔºåÊâÄ‰ª•Âè™ËÉΩÁî®Âú®ÊàêÂëòÂáΩÊï∞ÁöÑÂÜÖÈÉ®ÔºåÂπ∂‰∏îÂè™ÊúâÂú®ÈÄöËøáÂØπË±°Ë∞ÉÁî®ÊàêÂëòÂáΩÊï∞Êó∂ÊâçÁªô this ËµãÂÄº„ÄÇ 14.ÈùôÊÄÅÊàêÂëòÂèòÈáèstatic ÊàêÂëòÂèòÈáèÂ±û‰∫éÁ±ªÔºå‰∏çÂ±û‰∫éÊüê‰∏™ÂÖ∑‰ΩìÁöÑÂØπË±°ÔºåÂç≥‰ΩøÂàõÂª∫Â§ö‰∏™ÂØπË±°Ôºå‰πüÂè™ÂàÜÈÖç‰∏Ä‰ªΩÂÜÖÂ≠ò„ÄÇstatic ÊàêÂëòÂèòÈáèÁöÑÂÜÖÂ≠òÊó¢‰∏çÊòØÂú®Â£∞ÊòéÁ±ªÊó∂ÂàÜÈÖçÔºå‰πü‰∏çÊòØÂú®ÂàõÂª∫ÂØπË±°Êó∂ÂàÜÈÖçÔºåËÄåÊòØÂú®ÔºàÁ±ªÂ§ñÔºâÂàùÂßãÂåñÊó∂ÂàÜÈÖç„ÄÇÂèçËøáÊù•ËØ¥ÔºåÊ≤°ÊúâÂú®Á±ªÂ§ñÂàùÂßãÂåñÁöÑ static ÊàêÂëòÂèòÈáè‰∏çËÉΩ‰ΩøÁî®„ÄÇ static ÊàêÂëòÂèòÈáè‰∏çÂç†Áî®ÂØπË±°ÁöÑÂÜÖÂ≠òÔºåËÄåÊòØÂú®ÊâÄÊúâÂØπË±°‰πãÂ§ñÂºÄËæüÂÜÖÂ≠òÔºåÂç≥‰Ωø‰∏çÂàõÂª∫ÂØπË±°‰πüÂèØ‰ª•ËÆøÈóÆ„ÄÇ// Â∞Ü m_total Â£∞Êòé‰∏∫ÈùôÊÄÅÊàêÂëòÂèòÈáè//ÈÄöËøáÁ±ªÁ±ªËÆøÈóÆ static ÊàêÂëòÂèòÈáèStudent::m_total = 10; //ÈÄöËøáÂØπË±°Êù•ËÆøÈóÆ static ÊàêÂëòÂèòÈáèStudent stu("Â∞èÊòé", 15, 92.5f);stu.m_total = 20; //ÈÄöËøáÂØπË±°ÊåáÈíàÊù•ËÆøÈóÆ static ÊàêÂëòÂèòÈáèStudent *pstu = new Student("ÊùéÂçé", 16, 96);pstu -&gt; m_total = 20; ÈùôÊÄÅÊàêÂëòÂèòÈáèÂøÖÈ°ªÂàùÂßãÂåñÔºåËÄå‰∏îÂè™ËÉΩÂú®Á±ª‰ΩìÂ§ñËøõË°å„ÄÇ static ÊàêÂëòÂèòÈáèÂíåÊôÆÈÄö static ÂèòÈáè‰∏ÄÊ†∑ÔºåÈÉΩÂú®ÂÜÖÂ≠òÂàÜÂå∫‰∏≠ÁöÑÂÖ®Â±ÄÊï∞ÊçÆÂå∫ÂàÜÈÖçÂÜÖÂ≠òÔºåÂà∞Á®ãÂ∫èÁªìÊùüÊó∂ÊâçÈáäÊîæ„ÄÇËøôÂ∞±ÊÑèÂë≥ÁùÄÔºåstatic ÊàêÂëòÂèòÈáè‰∏çÈöèÂØπË±°ÁöÑÂàõÂª∫ËÄåÂàÜÈÖçÂÜÖÂ≠òÔºå‰πü‰∏çÈöèÂØπË±°ÁöÑÈîÄÊØÅËÄåÈáäÊîæÂÜÖÂ≠ò„ÄÇËÄåÊôÆÈÄöÊàêÂëòÂèòÈáèÂú®ÂØπË±°ÂàõÂª∫Êó∂ÂàÜÈÖçÂÜÖÂ≠òÔºåÂú®ÂØπË±°ÈîÄÊØÅÊó∂ÈáäÊîæÂÜÖÂ≠ò„ÄÇ 15.ÈùôÊÄÅÊàêÂëòÂáΩÊï∞ÊôÆÈÄöÊàêÂëòÂáΩÊï∞ÂèØ‰ª•ËÆøÈóÆÊâÄÊúâÊàêÂëòÔºàÂåÖÊã¨ÊàêÂëòÂèòÈáèÂíåÊàêÂëòÂáΩÊï∞ÔºâÔºåÈùôÊÄÅÊàêÂëòÂáΩÊï∞Âè™ËÉΩËÆøÈóÆÈùôÊÄÅÊàêÂëò„ÄÇÊôÆÈÄöÊàêÂëòÂèòÈáèÂç†Áî®ÂØπË±°ÁöÑÂÜÖÂ≠òÔºåÈùôÊÄÅÊàêÂëòÂáΩÊï∞Ê≤°Êúâ this ÊåáÈíàÔºå‰∏çÁü•ÈÅìÊåáÂêëÂì™‰∏™ÂØπË±°ÔºåÊó†Ê≥ïËÆøÈóÆÂØπË±°ÁöÑÊàêÂëòÂèòÈáèÔºå‰πüÂ∞±ÊòØËØ¥ÈùôÊÄÅÊàêÂëòÂáΩÊï∞‰∏çËÉΩËÆøÈóÆÊôÆÈÄöÊàêÂëòÂèòÈáèÔºåÂè™ËÉΩËÆøÈóÆÈùôÊÄÅÊàêÂëòÂèòÈáè„ÄÇÊôÆÈÄöÊàêÂëòÂáΩÊï∞ÂøÖÈ°ªÈÄöËøáÂØπË±°ÊâçËÉΩË∞ÉÁî®ÔºåËÄåÈùôÊÄÅÊàêÂëòÂáΩÊï∞Ê≤°Êúâ this ÊåáÈíàÔºåÊó†Ê≥ïÂú®ÂáΩÊï∞‰ΩìÂÜÖÈÉ®ËÆøÈóÆÊüê‰∏™ÂØπË±°ÔºåÊâÄ‰ª•‰∏çËÉΩË∞ÉÁî®ÊôÆÈÄöÊàêÂëòÂáΩÊï∞ÔºåÂè™ËÉΩË∞ÉÁî®ÈùôÊÄÅÊàêÂëòÂáΩÊï∞„ÄÇ ÈùôÊÄÅÊàêÂëòÂáΩÊï∞‰∏éÊôÆÈÄöÊàêÂëòÂáΩÊï∞ÁöÑÊ†πÊú¨Âå∫Âà´Âú®‰∫éÔºöÊôÆÈÄöÊàêÂëòÂáΩÊï∞Êúâ this ÊåáÈíàÔºåÂèØ‰ª•ËÆøÈóÆÁ±ª‰∏≠ÁöÑ‰ªªÊÑèÊàêÂëòÔºõËÄåÈùôÊÄÅÊàêÂëòÂáΩÊï∞Ê≤°Êúâ this ÊåáÈíàÔºåÂè™ËÉΩËÆøÈóÆÈùôÊÄÅÊàêÂëòÔºàÂåÖÊã¨ÈùôÊÄÅÊàêÂëòÂèòÈáèÂíåÈùôÊÄÅÊàêÂëòÂáΩÊï∞Ôºâ„ÄÇ 16.Â∏∏ÊàêÂëòÂáΩÊï∞const ÊàêÂëòÂáΩÊï∞ÂèØ‰ª•‰ΩøÁî®Á±ª‰∏≠ÁöÑÊâÄÊúâÊàêÂëòÂèòÈáèÔºå‰ΩÜÊòØ‰∏çËÉΩ‰øÆÊîπÂÆÉ‰ª¨ÁöÑÂÄºÔºåËøôÁßçÊé™ÊñΩ‰∏ªË¶ÅËøòÊòØ‰∏∫‰∫Ü‰øùÊä§Êï∞ÊçÆËÄåËÆæÁΩÆÁöÑ„ÄÇ Â∏∏ÊàêÂëòÂáΩÊï∞ÈúÄË¶ÅÂú®Â£∞ÊòéÂíåÂÆö‰πâÁöÑÊó∂ÂÄôÂú®ÂáΩÊï∞Â§¥ÈÉ®ÁöÑÁªìÂ∞æÂä†‰∏ä const ÂÖ≥ÈîÆÂ≠óÔºöclass Student&#123;public: //Â£∞ÊòéÂ∏∏ÊàêÂëòÂáΩÊï∞ int getage() const;private: int m_age;&#125;; //ÂÆö‰πâÂ∏∏ÊàêÂëòÂáΩÊï∞int Student::getage() const&#123; return m_age;&#125; 17.ÂèãÂÖÉÂáΩÊï∞‰∏éÂèãÂÖÉÁ±ªÂÄüÂä©ÂèãÂÖÉÔºàfriendÔºâÔºåÂèØ‰ª•‰ΩøÂæóÂÖ∂‰ªñÁ±ª‰∏≠ÁöÑÊàêÂëòÂáΩÊï∞‰ª•ÂèäÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑÂáΩÊï∞ËÆøÈóÆÂΩìÂâçÁ±ªÁöÑ private ÊàêÂëò„ÄÇÂú®ÂΩìÂâçÁ±ª‰ª•Â§ñÂÆö‰πâÁöÑ„ÄÅ‰∏çÂ±û‰∫éÂΩìÂâçÁ±ªÁöÑÂáΩÊï∞ÂèØ‰ª•Âú®Á±ª‰∏≠Â£∞ÊòéÔºå‰ΩÜË¶ÅÂú®ÂâçÈù¢Âä† friend ÂÖ≥ÈîÆÂ≠óÔºåËøôÊ†∑Â∞±ÊûÑÊàê‰∫ÜÂèãÂÖÉÂáΩÊï∞„ÄÇÂèãÂÖÉÂáΩÊï∞‰∏çÂêå‰∫éÁ±ªÁöÑÊàêÂëòÂáΩÊï∞ÔºåÂú®ÂèãÂÖÉÂáΩÊï∞‰∏≠‰∏çËÉΩÁõ¥Êé•ËÆøÈóÆÁ±ªÁöÑÊàêÂëòÔºåÂøÖÈ°ªË¶ÅÂÄüÂä©ÂØπË±°„ÄÇ ‰∏Ä‰∏™ÂáΩÊï∞ÂèØ‰ª•Ë¢´Â§ö‰∏™Á±ªÂ£∞Êòé‰∏∫ÂèãÂÖÉÂáΩÊï∞ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ËÆøÈóÆÂ§ö‰∏™Á±ª‰∏≠ÁöÑ private ÊàêÂëò„ÄÇpublic: // ÊûÑÈÄ†ÂáΩÊï∞ Address(char *province, char *city, char *district); //Â∞ÜStudentÁ±ª‰∏≠ÁöÑÊàêÂëòÂáΩÊï∞show()Â£∞Êòé‰∏∫ÂèãÂÖÉÂáΩÊï∞ friend void Student::show(Address *addr); ÂèãÂÖÉÁ±ª‰∏≠ÁöÑÊâÄÊúâÊàêÂëòÂáΩÊï∞ÈÉΩÊòØÂè¶Â§ñ‰∏Ä‰∏™Á±ªÁöÑÂèãÂÖÉÂáΩÊï∞„ÄÇpublic: // ÊûÑÈÄ†ÂáΩÊï∞ Address(char *province, char *city, char *district); public: //Â∞ÜStudentÁ±ªÂ£∞Êòé‰∏∫AddressÁ±ªÁöÑÂèãÂÖÉÁ±ª friend class Student; ÂèãÂÖÉÁöÑÂÖ≥Á≥ªÊòØÂçïÂêëÁöÑËÄå‰∏çÊòØÂèåÂêëÁöÑ„ÄÇÂ¶ÇÊûúÂ£∞Êòé‰∫ÜÁ±ª B ÊòØÁ±ª A ÁöÑÂèãÂÖÉÁ±ªÔºå‰∏çÁ≠â‰∫éÁ±ª A ÊòØÁ±ª B ÁöÑÂèãÂÖÉÁ±ªÔºåÁ±ª A ‰∏≠ÁöÑÊàêÂëòÂáΩÊï∞‰∏çËÉΩËÆøÈóÆÁ±ª B ‰∏≠ÁöÑ private ÊàêÂëò„ÄÇÂèãÂÖÉÁöÑÂÖ≥Á≥ª‰∏çËÉΩ‰º†ÈÄí„ÄÇÂ¶ÇÊûúÁ±ª B ÊòØÁ±ª A ÁöÑÂèãÂÖÉÁ±ªÔºåÁ±ª C ÊòØÁ±ª B ÁöÑÂèãÂÖÉÁ±ªÔºå‰∏çÁ≠â‰∫éÁ±ª C ÊòØÁ±ª A ÁöÑÂèãÂÖÉÁ±ª„ÄÇ 18.struct‰∏éclassÊØîËæÉ ‰ΩøÁî® class Êó∂ÔºåÁ±ª‰∏≠ÁöÑÊàêÂëòÈªòËÆ§ÈÉΩÊòØ private Â±ûÊÄßÁöÑÔºõËÄå‰ΩøÁî® struct Êó∂ÔºåÁªìÊûÑ‰Ωì‰∏≠ÁöÑÊàêÂëòÈªòËÆ§ÈÉΩÊòØ public Â±ûÊÄßÁöÑ class ÁªßÊâøÈªòËÆ§ÊòØ private ÁªßÊâøÔºåËÄå struct ÁªßÊâøÈªòËÆ§ÊòØ public ÁªßÊâø„ÄÇ class ÂèØ‰ª•‰ΩøÁî®Ê®°ÊùøÔºåËÄå struct ‰∏çËÉΩ„ÄÇ 19.stringÁöÑ‰ΩøÁî®ÂâçÊèê:#include &lt;string&gt; 1.ËæìÂÖ•ËæìÂá∫ string s;cin &gt;&gt; s;cou &lt;&lt; s &lt;&lt; endl; 2.ÈÄöËøá‰∏ãÊ†áËÆøÈóÆstring s = "qwert";s[3] = 'd';couy &lt;&lt; s[2]; 3.ÊãºÊé•string s = "i";char *s1 = "love";char s2[] = "you";char s3 = '!'; string rs = s + s1 + s2 + s3; 4.ÊèíÂÖ•string s = "sdf";s.insert(1,"sds"); // Á¥¢Âºï/ÂÜÖÂÆπ 5.Âà†Èô§s1 = s2 = s3 = "1234567890";s2.erase(5);s3.erase(5, 3); // ÈïøÂ∫¶‰∏∫3 6.ÊèêÂèñ s1.substr(6, 6); // ÈïøÂ∫¶‰∏∫6 7.Êü•Êâæ s.find(&quot;,&quot;,1); // ‰ªéÁ¥¢Âºï1ÂºÄÂßãÊü•ÊâæÈÄóÂè∑,ËøîÂõûÁ¥¢Âºï 20.ÊåáÈíà‰º†ÈÄí‰∏éÂºïÁî®‰º†ÈÄíÁöÑÊØîËæÉÂºïÁî®ÂèØ‰ª•ÁúãÂÅöÊòØÊï∞ÊçÆÁöÑ‰∏Ä‰∏™Âà´ÂêçÔºåÈÄöËøáËøô‰∏™Âà´ÂêçÂíåÂéüÊù•ÁöÑÂêçÂ≠óÈÉΩËÉΩÂ§üÊâæÂà∞Ëøô‰ªΩÊï∞ÊçÆ„ÄÇ ÂºïÁî®ÁöÑÂÆö‰πâÊñπÂºèÁ±ª‰ºº‰∫éÊåáÈíàÔºåÂè™ÊòØÁî®&amp;Âèñ‰ª£‰∫Ü*„ÄÇ type &amp;name = data; // ÊåáÈíà‰º†ÈÄí// ÊØîÂ¶Ç‰∫§Êç¢Êï∞ÊçÆswap(int *a, int *b) &#123;int temp = *a;*a = *b;*b = temp; &#125;// ‰ΩøÁî®swap(&amp;a, &amp;b);//ÂºïÁî®‰º†ÈÄíswap2(int &amp;a, int &amp;b) &#123;int temp = a;a = b;b = temp;&#125;// ‰ΩøÁî®swap2(a,b); ÂºïÁî®‰πüÂèØ‰ª•‰Ωú‰∏∫ÂáΩÊï∞ÁöÑËøîÂõûÂÄºÔºå‰∏çËøá‰∏çËÉΩËøîÂõûÂ±ÄÈÉ®ÂèòÈáèÁöÑÂºïÁî®ÔºåÂõ†‰∏∫Â±ÄÈÉ®ÂèòÈáèËøá‰∫Ü‰ΩúÁî®ÂüüÂ∞±ÈîÄÊØÅ‰∫Ü„ÄÇ 21.ÁªßÊâøÁªßÊâøÊñπÂºèÂåÖÊã¨ publicÔºàÂÖ¨ÊúâÁöÑÔºâ„ÄÅprivateÔºàÁßÅÊúâÁöÑÔºâÂíå protectedÔºàÂèó‰øùÊä§ÁöÑÔºâÔºåÊ≠§È°πÊòØÂèØÈÄâÁöÑÔºåÂ¶ÇÊûú‰∏çÂÜôÔºåÈÇ£‰πàÈªòËÆ§‰∏∫ private„ÄÇclass Ê¥æÁîüÁ±ªÂêç:ÔºªÁªßÊâøÊñπÂºèÔºΩ Âü∫Á±ªÂêç&#123; Ê¥æÁîüÁ±ªÊñ∞Â¢ûÂä†ÁöÑÊàêÂëò&#125;; ‰∏çÂêåÁöÑÁªßÊâøÊñπÂºè‰ºöÂΩ±ÂìçÂü∫Á±ªÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠ÁöÑËÆøÈóÆÊùÉÈôê„ÄÇ 1) publicÁªßÊâøÊñπÂºè Âü∫Á±ª‰∏≠ÊâÄÊúâ public ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏∫ public Â±ûÊÄßÔºõ Âü∫Á±ª‰∏≠ÊâÄÊúâ protected ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏∫ protected Â±ûÊÄßÔºõ Âü∫Á±ª‰∏≠ÊâÄÊúâ private ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏çËÉΩ‰ΩøÁî®„ÄÇ 2) protectedÁªßÊâøÊñπÂºè Âü∫Á±ª‰∏≠ÁöÑÊâÄÊúâ public ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏∫ protected Â±ûÊÄßÔºõ Âü∫Á±ª‰∏≠ÁöÑÊâÄÊúâ protected ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏∫ protected Â±ûÊÄßÔºõ Âü∫Á±ª‰∏≠ÁöÑÊâÄÊúâ private ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏çËÉΩ‰ΩøÁî®„ÄÇ 3) privateÁªßÊâøÊñπÂºè Âü∫Á±ª‰∏≠ÁöÑÊâÄÊúâ public ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠Âùá‰∏∫ private Â±ûÊÄßÔºõ Âü∫Á±ª‰∏≠ÁöÑÊâÄÊúâ protected ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠Âùá‰∏∫ private Â±ûÊÄßÔºõ Âü∫Á±ª‰∏≠ÁöÑÊâÄÊúâ private ÊàêÂëòÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏çËÉΩ‰ΩøÁî®„ÄÇ Âü∫Á±ªÁöÑ private ÊàêÂëòÊòØËÉΩÂ§üË¢´ÁªßÊâøÁöÑÔºåÂπ∂‰∏îÔºàÊàêÂëòÂèòÈáèÔºâ‰ºöÂç†Áî®Ê¥æÁîüÁ±ªÂØπË±°ÁöÑÂÜÖÂ≠òÔºåÂÆÉÂè™ÊòØÂú®Ê¥æÁîüÁ±ª‰∏≠‰∏çÂèØËßÅÔºåÂØºËá¥Êó†Ê≥ï‰ΩøÁî®ÁΩ¢‰∫Ü„ÄÇÂü∫Á±ªÊàêÂëòÂáΩÊï∞ÂíåÊ¥æÁîüÁ±ªÊàêÂëòÂáΩÊï∞‰∏ç‰ºöÊûÑÊàêÈáçËΩΩÔºåÂ¶ÇÊûúÊ¥æÁîüÁ±ªÊúâÂêåÂêçÂáΩÊï∞ÔºåÈÇ£‰πàÂ∞±‰ºöÈÅÆËîΩÂü∫Á±ª‰∏≠ÁöÑÊâÄÊúâÂêåÂêçÂáΩÊï∞Ôºå‰∏çÁÆ°ÂÆÉ‰ª¨ÁöÑÂèÇÊï∞ÊòØÂê¶‰∏ÄÊ†∑„ÄÇ Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞‰∏çËÉΩË¢´ÁªßÊâøÔºõ ÊûêÊûÑÂáΩÊï∞‰πü‰∏çËÉΩË¢´ÁªßÊâøÔºõ Ê¥æÁîüÁ±ªÊûÑÈÄ†ÂáΩÊï∞‰∏≠Âè™ËÉΩË∞ÉÁî®Áõ¥Êé•Âü∫Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞Ôºå‰∏çËÉΩË∞ÉÁî®Èó¥Êé•Âü∫Á±ªÁöÑ„ÄÇ 22.Â§öÈáçÁªßÊâøclass D: public A, private B, protected C&#123; //Á±ªDÊñ∞Â¢ûÂä†ÁöÑÊàêÂëò&#125; Âü∫Á±ªÊûÑÈÄ†ÂáΩÊï∞ÁöÑË∞ÉÁî®È°∫Â∫èÂíåÂíåÂÆÉ‰ª¨Âú®Ê¥æÁîüÁ±ªÊûÑÈÄ†ÂáΩÊï∞‰∏≠Âá∫Áé∞ÁöÑÈ°∫Â∫èÊó†ÂÖ≥ÔºåËÄåÊòØÂíåÂ£∞ÊòéÊ¥æÁîüÁ±ªÊó∂Âü∫Á±ªÂá∫Áé∞ÁöÑÈ°∫Â∫èÁõ∏Âêå„ÄÇ 23.ËôöÁªßÊâøÂÅáÂ¶ÇÁ±ª A Êúâ‰∏Ä‰∏™ÊàêÂëòÂèòÈáè aÔºåÈÇ£‰πàÂú®Á±ª D ‰∏≠Áõ¥Êé•ËÆøÈóÆ a Â∞±‰ºö‰∫ßÁîüÊ≠ß‰πâÔºåÁºñËØëÂô®‰∏çÁü•ÈÅìÂÆÉÁ©∂Á´üÊù•Ëá™ A ‚Äì&gt;B‚Äì&gt;D ËøôÊù°Ë∑ØÂæÑÔºåËøòÊòØÊù•Ëá™ A‚Äì&gt;C‚Äì&gt;D ËøôÊù°Ë∑ØÂæÑ„ÄÇÂõ†‰∏∫Á±ª B ÂíåÁ±ª C ‰∏≠ÈÉΩÊúâÊàêÂëòÂèòÈáè aÔºà‰ªé A Á±ªÁªßÊâøËÄåÊù•ÔºâÔºåÁºñËØëÂô®‰∏çÁü•ÈÅìÈÄâÁî®Âì™‰∏Ä‰∏™ÔºåÊâÄ‰ª•‰∫ßÁîü‰∫ÜÈîôËØØ„ÄÇ Ê∂àÈô§Ê≠ß‰πâÔºö‰ΩøÁî®ÂüüËß£ÊûêÊìç‰ΩúÁ¨¶„ÄÇ ‰∏∫‰∫ÜËß£ÂÜ≥Â§öÁªßÊâøÊó∂ÁöÑÂëΩÂêçÂÜ≤Á™ÅÂíåÂÜó‰ΩôÊï∞ÊçÆÈóÆÈ¢òÔºåC++ ÊèêÂá∫‰∫ÜËôöÁªßÊâøÔºå‰ΩøÂæóÂú®Ê¥æÁîüÁ±ª‰∏≠Âè™‰øùÁïô‰∏Ä‰ªΩÈó¥Êé•Âü∫Á±ªÁöÑÊàêÂëò„ÄÇÂú®ÁªßÊâøÊñπÂºèÂâçÈù¢Âä†‰∏ä virtual ÂÖ≥ÈîÆÂ≠óÂ∞±ÊòØËôöÁªßÊâøÔºö//Èó¥Êé•Âü∫Á±ªAclass A &#123;protected: int m_a;&#125;;//Áõ¥Êé•Âü∫Á±ªBclass B : virtual public A &#123; //ËôöÁªßÊâøprotected: int m_b;&#125;;//Áõ¥Êé•Âü∫Á±ªCclass C : virtual public A &#123; //ËôöÁªßÊâøprotected: int m_c;&#125;;//Ê¥æÁîüÁ±ªDclass D : public B, public C &#123;public: void seta(int a) &#123; m_a = a; &#125; //Ê≠£Á°Æ void setb(int b) &#123; m_b = b; &#125; //Ê≠£Á°Æ void setc(int c) &#123; m_c = c; &#125; //Ê≠£Á°Æ void setd(int d) &#123; m_d = d; &#125; //Ê≠£Á°Æprivate: int m_d;&#125;; ËôöÁªßÊâøÁöÑÁõÆÁöÑÊòØËÆ©Êüê‰∏™Á±ªÂÅöÂá∫Â£∞ÊòéÔºåÊâøËØ∫ÊÑøÊÑèÂÖ±‰∫´ÂÆÉÁöÑÂü∫Á±ª„ÄÇÂÖ∂‰∏≠ÔºåËøô‰∏™Ë¢´ÂÖ±‰∫´ÁöÑÂü∫Á±ªÂ∞±Áß∞‰∏∫ËôöÂü∫Á±ªÔºàVirtual Base ClassÔºâÔºåÊú¨‰æã‰∏≠ÁöÑ A Â∞±ÊòØ‰∏Ä‰∏™ËôöÂü∫Á±ª„ÄÇÂú®ËøôÁßçÊú∫Âà∂‰∏ãÔºå‰∏çËÆ∫ËôöÂü∫Á±ªÂú®ÁªßÊâø‰ΩìÁ≥ª‰∏≠Âá∫Áé∞‰∫ÜÂ§öÂ∞ëÊ¨°ÔºåÂú®Ê¥æÁîüÁ±ª‰∏≠ÈÉΩÂè™ÂåÖÂê´‰∏Ä‰ªΩËôöÂü∫Á±ªÁöÑÊàêÂëò„ÄÇ ËôöÊ¥æÁîüÂè™ÂΩ±Âìç‰ªéÊåáÂÆö‰∫ÜËôöÂü∫Á±ªÁöÑÊ¥æÁîüÁ±ª‰∏≠Ëøõ‰∏ÄÊ≠•Ê¥æÁîüÂá∫Êù•ÁöÑÁ±ªÔºåÂÆÉ‰∏ç‰ºöÂΩ±ÂìçÊ¥æÁîüÁ±ªÊú¨Ë∫´„ÄÇ Âú®ÊúÄÁªàÊ¥æÁîüÁ±ª D ÁöÑÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÔºåÈô§‰∫ÜË∞ÉÁî® B Âíå C ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåËøòË∞ÉÁî®‰∫Ü A ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåËøôËØ¥Êòé D ‰∏ç‰ΩÜË¶ÅË¥üË¥£ÂàùÂßãÂåñÁõ¥Êé•Âü∫Á±ª B Âíå CÔºåËøòË¶ÅË¥üË¥£ÂàùÂßãÂåñÈó¥Êé•Âü∫Á±ª A„ÄÇÁõ¥Êé•Ê¥æÁîüÁ±ª B Âíå C ÂØπ A ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÁöÑË∞ÉÁî®ÊòØÊó†ÊïàÁöÑ.ËÄåÂú®‰ª•ÂæÄÁöÑÊôÆÈÄöÁªßÊâø‰∏≠ÔºåÊ¥æÁîüÁ±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞Âè™Ë¥üË¥£ÂàùÂßãÂåñÂÆÉÁöÑÁõ¥Êé•Âü∫Á±ªÔºåÂÜçÁî±Áõ¥Êé•Âü∫Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÂàùÂßãÂåñÈó¥Êé•Âü∫Á±ªÔºåÁî®Êà∑Â∞ùËØïË∞ÉÁî®Èó¥Êé•Âü∫Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞Â∞ÜÂØºËá¥ÈîôËØØ„ÄÇ Âú®Á±ªË¢´ÊûÑÈÄ†ÁöÑÊó∂ÂÄôÔºåÂÖàÊâßË°åËôöÊãüÁªßÊâøÁöÑÁà∂Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁÑ∂Âêé‰ªéÂ∑¶Âà∞Âè≥ÊâßË°åÊôÆÈÄöÁªßÊâøÁöÑÁà∂Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁÑ∂ÂêéÊåâÁÖßÂÆö‰πâÁöÑÈ°∫Â∫èÊâßË°åÊï∞ÊçÆÊàêÂëòÁöÑÂàùÂßãÂåñÔºåÊúÄÂêéÊòØËá™Ë∫´ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÁöÑË∞ÉÁî®„ÄÇÊûêÊûÑÂáΩÊï∞‰∏é‰πãÂÆåÂÖ®Áõ∏ÂèçÔºå‰∫íÊàêÈïúÂÉè„ÄÇmore„ÄÇ 24.C++Âêë‰∏äËΩ¨ÂûãÁºñËØëÂô®ÈÄöËøáÊåáÈíàÊù•ËÆøÈóÆÊàêÂëòÂèòÈáèÔºåÊåáÈíàÊåáÂêëÂì™‰∏™ÂØπË±°Â∞±‰ΩøÁî®Âì™‰∏™ÂØπË±°ÁöÑÊï∞ÊçÆÔºõÁºñËØëÂô®ÈÄöËøáÊåáÈíàÁöÑÁ±ªÂûãÊù•ËÆøÈóÆÊàêÂëòÂáΩÊï∞ÔºåÊåáÈíàÂ±û‰∫éÂì™‰∏™Á±ªÁöÑÁ±ªÂûãÂ∞±‰ΩøÁî®Âì™‰∏™Á±ªÁöÑÂáΩÊï∞„ÄÇÂü∫Á±ªÊåáÈíàÂè™ËÉΩËÆøÈóÆÊ¥æÁîüÁ±ªÁöÑÊàêÂëòÂèòÈáèÔºå‰ΩÜÊòØ‰∏çËÉΩËÆøÈóÆÊ¥æÁîüÁ±ªÁöÑÊàêÂëòÂáΩÊï∞„ÄÇ 25.ËôöÂáΩÊï∞„ÄÅÁ∫ØËôöÂáΩÊï∞‰∏éÂ§öÊÄÅÁõÆÁöÑ:ËÆ©Âü∫Á±ªÊåáÈíàËÉΩÂ§üËÆøÈóÆÊ¥æÁîüÁ±ªÁöÑÊàêÂëòÂáΩÊï∞,Âè™ÈúÄË¶ÅÂú®ËØ•ÊàêÂëòÂáΩÊï∞Â£∞ÊòéÂâçÈù¢Â¢ûÂä† virtual ÂÖ≥ÈîÆÂ≠ó(Âü∫Á±ª\Ê¥æÁîüÁ±ªÈÉΩË¶ÅÊìç‰Ωú) Êúâ‰∫ÜËôöÂáΩÊï∞ÔºåÂü∫Á±ªÊåáÈíàÊåáÂêëÂü∫Á±ªÂØπË±°Êó∂Â∞±‰ΩøÁî®Âü∫Á±ªÁöÑÊàêÂëòÔºàÂåÖÊã¨ÊàêÂëòÂáΩÊï∞ÂíåÊàêÂëòÂèòÈáèÔºâÔºåÊåáÂêëÊ¥æÁîüÁ±ªÂØπË±°Êó∂Â∞±‰ΩøÁî®Ê¥æÁîüÁ±ªÁöÑÊàêÂëò„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂü∫Á±ªÊåáÈíàÂèØ‰ª•ÊåâÁÖßÂü∫Á±ªÁöÑÊñπÂºèÊù•ÂÅö‰∫ãÔºå‰πüÂèØ‰ª•ÊåâÁÖßÊ¥æÁîüÁ±ªÁöÑÊñπÂºèÊù•ÂÅö‰∫ãÔºåÂÆÉÊúâÂ§öÁßçÂΩ¢ÊÄÅÔºåÊàñËÄÖËØ¥ÊúâÂ§öÁßçË°®Áé∞ÊñπÂºèÔºåÊàë‰ª¨Â∞ÜËøôÁßçÁé∞Ë±°Áß∞‰∏∫Â§öÊÄÅÔºàPolymorphismÔºâ ËôöÂáΩÊï∞ÁöÑÂîØ‰∏ÄÁî®Â§ÑÂ∞±ÊòØÊûÑÊàêÂ§öÊÄÅÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ§öÊÄÅÔºåÊàë‰ª¨Âè™ËÉΩËÆøÈóÆÊàêÂëòÂèòÈáè„ÄÇ Âè™ÊúâÊ¥æÁîüÁ±ªÁöÑËôöÂáΩÊï∞ÈÅÆËîΩÂü∫Á±ªÁöÑËôöÂáΩÊï∞ÔºàÂáΩÊï∞ÂéüÂûãÁõ∏ÂêåÔºâÊâçËÉΩÊûÑÊàêÂ§öÊÄÅÔºàÈÄöËøáÂü∫Á±ªÊåáÈíàËÆøÈóÆÊ¥æÁîüÁ±ªÂáΩÊï∞Ôºâ„ÄÇÊûÑÈÄ†ÂáΩÊï∞‰∏çËÉΩÊòØËôöÂáΩÊï∞„ÄÇÂØπ‰∫éÂü∫Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂÆÉ‰ªÖ‰ªÖÊòØÂú®Ê¥æÁîüÁ±ªÊûÑÈÄ†ÂáΩÊï∞‰∏≠Ë¢´Ë∞ÉÁî®ÔºåËøôÁßçÊú∫Âà∂‰∏çÂêå‰∫éÁªßÊâø„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊ¥æÁîüÁ±ª‰∏çÁªßÊâøÂü∫Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂ∞ÜÊûÑÈÄ†ÂáΩÊï∞Â£∞Êòé‰∏∫ËôöÂáΩÊï∞Ê≤°Êúâ‰ªÄ‰πàÊÑè‰πâ„ÄÇÊûêÊûÑÂáΩÊï∞ÂèØ‰ª•Â£∞Êòé‰∏∫ËôöÂáΩÊï∞ÔºåËÄå‰∏îÊúâÊó∂ÂÄôÂøÖÈ°ªË¶ÅÂ£∞Êòé‰∏∫ËôöÂáΩÊï∞„ÄÇ Â∞ÜËôöÂáΩÊï∞Â£∞Êòé‰∏∫Á∫ØËôöÂáΩÊï∞ÔºåÁ∫ØËôöÂáΩÊï∞Ê≤°ÊúâÂáΩÊï∞‰ΩìÔºåÂè™ÊúâÂáΩÊï∞Â£∞ÊòéÔºåÂú®ËôöÂáΩÊï∞Â£∞ÊòéÁöÑÁªìÂ∞æÂä†‰∏ä=0ÔºåË°®ÊòéÊ≠§ÂáΩÊï∞‰∏∫Á∫ØËôöÂáΩÊï∞„ÄÇ ËØ≠Ê≥ïÊ†ºÂºè‰∏∫Ôºö virtual ËøîÂõûÂÄºÁ±ªÂûã ÂáΩÊï∞Âêç (ÂáΩÊï∞ÂèÇÊï∞) = 0; ÂåÖÂê´Á∫ØËôöÂáΩÊï∞ÁöÑÁ±ªÁß∞‰∏∫ÊäΩË±°Á±ªÔºàAbstract ClassÔºâ‰∏Ä‰∏™Á∫ØËôöÂáΩÊï∞Â∞±ÂèØ‰ª•‰ΩøÁ±ªÊàê‰∏∫ÊäΩË±°Âü∫Á±ªÔºå‰ΩÜÊòØÊäΩË±°Âü∫Á±ª‰∏≠Èô§‰∫ÜÂåÖÂê´Á∫ØËôöÂáΩÊï∞Â§ñÔºåËøòÂèØ‰ª•ÂåÖÂê´ÂÖ∂ÂÆÉÁöÑÊàêÂëòÂáΩÊï∞ÔºàËôöÂáΩÊï∞ÊàñÊôÆÈÄöÂáΩÊï∞ÔºâÂíåÊàêÂëòÂèòÈáè„ÄÇ 26.ËøêÁÆóÁ¨¶ÈáçËΩΩËøêÁÆóÁ¨¶ÈáçËΩΩÁöÑÊ†ºÂºè‰∏∫ÔºöËøîÂõûÂÄºÁ±ªÂûã operator ËøêÁÆóÁ¨¶ÂêçÁß∞ (ÂΩ¢ÂèÇË°®Âàó)&#123; //TODO:&#125; // Â¶Çcomplex operator+(const complex &amp;A) const; 27.Ê®°ÊùøÂáΩÊï∞Ê®°Êùøtemplate &lt;typename Á±ªÂûãÂèÇÊï∞1 , typename Á±ªÂûãÂèÇÊï∞2 , ...&gt; ËøîÂõûÂÄºÁ±ªÂûã ÂáΩÊï∞Âêç(ÂΩ¢ÂèÇÂàóË°®)&#123;//Âú®ÂáΩÊï∞‰Ωì‰∏≠ÂèØ‰ª•‰ΩøÁî®Á±ªÂûãÂèÇÊï∞&#125; typenameÂÖ≥ÈîÆÂ≠óÂèØ‰ΩøÁî®class‰ª£Êõø // Â¶Çtemplate&lt;class T&gt; void Swap(T &amp;a, T &amp;b)&#123; T temp = a; a = b; b = temp;&#125; ÂÖ≥ÈîÆÂú®‰∫éÂáΩÊï∞ÂÆö‰πâÂâçÈù¢Âä†‰∏ä template&lt;typename T, typename M&gt;„ÄÇ Á±ªÊ®°Êùøtemplate&lt;typename Á±ªÂûãÂèÇÊï∞1 , typename Á±ªÂûãÂèÇÊï∞2 , ‚Ä¶&gt; class Á±ªÂêç&#123; //TODO:&#125;;// template&lt;typename T1, typename T2&gt; // Á±ªÊ®°Êùø‰ΩøÁî®Êó∂ÈúÄË¶ÅÊåáÊòéÁ±ªÂûã,ÂáΩÊï∞Ê®°Êùø‰∏çÈúÄË¶ÅPoint&lt;float, float&gt; *p1 = new Point&lt;float, float&gt;(10.6, 109.3); ÂèÇËÄÉÂçöÂÆ¢ÔºöCËØ≠Ë®Ä‰∏≠ÊñáÁΩë]]></content>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊéíÂ∫èÁÆóÊ≥ïÂÆûÁé∞]]></title>
    <url>%2F2017%2F03%2F05%2F%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[2017.03.25 ‰øÆÊîπ2017.04.24 ‰øÆÊîπÈÉ®ÂàÜ‰ª£Á†Å ÊéíÂ∫èÁÆóÊ≥ï„ÄÇ ÂâçË®ÄÂõ†‰∏∫Á¨îËØï‰ΩøÁî®ÁöÑÁºñËØëÂô®ËØ≠Ë®Ä‰∏∫Python2.7ÔºåÊâÄ‰ª•‰ª•‰∏ã‰ª£Á†Å‰ΩøÁî®Python2ÂÆûÁé∞Âπ∂ËßÑÂÆö‰ªéÂ∞èÂà∞Â§ß‰∏∫ÁõÆÊ†áÈ°∫Â∫è„ÄÇ ÂÖ´Â§ßÊéíÂ∫èÔºöÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÔºåÂ∏åÂ∞îÊéíÂ∫èÔºåÁÆÄÂçïÈÄâÊã©ÊéíÂ∫èÔºåÂ†ÜÊéíÂ∫èÔºåÂÜíÊ≥°ÊéíÂ∫èÔºåÂø´ÈÄüÊéíÂ∫èÔºåÂΩíÂπ∂ÊéíÂ∫èÔºåÂü∫Êï∞ÊéíÂ∫è„ÄÇ ÊéíÂ∫èÁöÑÁ®≥ÂÆöÊÄßÂÅáÂÆön1 = n2ÔºåÊéíÂ∫èÂâçn1‰Ωç‰∫én2ÂâçÈù¢ÔºåÂ¶ÇÊûúÊéíÂ∫èÂêén1ÊâîÈ¢ÜÂÖà‰∫én2ÔºåÂàôÁß∞ÊéíÂ∫èÁÆóÊ≥ïÁ®≥ÂÆö„ÄÇ ÂÜÖÊéíÂ∫è‰∏éÂ§ñÊéíÂ∫èÂÜÖÊéíÂ∫èÔºöÊéíÂ∫èÁöÑÊï¥‰∏™ËøáÁ®ã‰∏≠ÔºåÂæÖÊéíÂ∫èÁöÑÊâÄÊúâËÆ∞ÂΩïÂÖ®ÈÉ®Ë¢´ÊîæÁΩÆÂú®ÂÜÖÂ≠ò‰∏≠„ÄÇÂ§ñÊéíÂ∫èÔºöÁî±‰∫éÊéíÂ∫èÁöÑËÆ∞ÂΩïÂ§™Â§öÔºåÊéíÂ∫èÁöÑËøáÁ®ã‰∏≠ÔºåÈúÄË¶ÅÂÜÖÂ§ñÂ≠ò‰πãÈó¥Â§öÊ¨°‰∫§Êç¢ÊâçËÉΩËøõË°å„ÄÇ ‰∏Ä„ÄÅÂÜíÊ≥°ÊéíÂ∫èÂéüÁêÜÔºöÈÄöËøáÁõ∏ÈÇªÂÖÉÁ¥†ÁöÑÊØîËæÉÂíå‰∫§Êç¢ÔºåÊääËæÉÂ§ßÁöÑÊï∞‰∫§Êç¢Âà∞ÂêéÈù¢ÔºåÁ±ª‰ººÊ∞¥Ê≥°Âêë‰∏äÈù¢(Êï∞ÁªÑÁöÑÂêéÈù¢ÔºåÊâÄ‰ª•ÊÄªÊòØÈù†ÂêéÁöÑÊï∞Â≠óÊúâÂ∫è)ÂçáÔºåÊïÖÁß∞‰∏∫ÂÜíÊ≥°ÊéíÂ∫è„ÄÇÂ¶ÇÊûú‰∏§Êï∞Áõ∏Á≠âÔºå‰∏ç‰∫§Êç¢ÔºåÊâÄ‰ª•Á®≥ÂÆö„ÄÇ ÊôÆÈÄöÊñπÂºè def bubbleSort(tempList): n = len(tempList) for x in xrange(n): for y in xrange(1, n - x):# Á¥¢Âºïn-x‰πãÂêéÁöÑÊï∞Â∑≤ÁªèÊéíÂ∫èÂ•Ω‰∫Ü if tempList[y - 1] &gt; tempList[y]: tempList[y], tempList[y - 1] = tempList[y - 1], tempList[y] return tempListprint bubbleSort([5,10,2,7,0,30]) ‰ºòÂåñ1ÔºöÊüê‰∏ÄË∂üÈÅçÂéÜÂ¶ÇÊûúÊ≤°ÊúâÊï∞ÊçÆ‰∫§Êç¢ÔºåÂàôËØ¥ÊòéÂ∑≤ÁªèÊéíÂ•ΩÂ∫è‰∫ÜÔºåÊó†ÈúÄÁªßÁª≠Ëø≠‰ª£„ÄÇ #‰∫§Êç¢ÊéíÂ∫è-ÂÜíÊ≥°ÊéíÂ∫è‰ºòÂåñ1def bubbleSort1(tempList): n = len(tempList) for x in xrange(n): #Ê†áÂøó‰Ωç,ÂÄòËã•Ê≤°Êúâ‰∫§Êç¢,ËØ¥ÊòéÂ∑≤ÁªèÊéíÂ∫èÂ•Ω‰∫Ü flag = True for y in xrange(1, n - x):# Á¥¢Âºïn-x‰πãÂêéÁöÑÊï∞Â∑≤ÁªèÊéíÂ∫èÂ•Ω‰∫Ü if tempList[y - 1] &gt; tempList[y]: tempList[y], tempList[y - 1] = tempList[y - 1], tempList[y] flag = False if flag: # ÂèëÁé∞Âπ∂Ê≤°ÊúâÂèëÁîü‰∫§Êç¢ return tempList return tempListprint bubbleSort1([5,10,2,7,0,30]) ‰ºòÂåñ2ÔºöËÆ∞ÂΩïÊúÄÂêéÂèëÁîü‰∫§Êç¢ÁöÑ‰ΩçÁΩÆÔºå‰ΩçÁΩÆ‰πãÂêéÁöÑÊï∞ÊçÆÂ∑≤Áªè‰∫ïÁÑ∂ÊúâÂ∫è„ÄÇ #‰∫§Êç¢ÊéíÂ∫è-ÂÜíÊ≥°ÊéíÂ∫è‰ºòÂåñ2def bubbleSort2(tempList): n = len(tempList) # Âæ™ÁéØËåÉÂõ¥ m = n for x in xrange(n): #Ê†áÂøó‰Ωç,ÂÄòËã•Ê≤°Êúâ‰∫§Êç¢,ËØ¥ÊòéÂ∑≤ÁªèÊéíÂ∫èÂ•Ω‰∫Ü flag = True for y in xrange(1, m):# Á¥¢Âºïm‰πãÂêéÁöÑÊï∞Â∑≤ÁªèÊéíÂ∫èÂ•Ω‰∫Ü if tempList[y - 1] &gt; tempList[y]: tempList[y], tempList[y - 1] = tempList[y - 1], tempList[y] m = y flag = False if flag: # ÂèëÁé∞Âπ∂Ê≤°ÊúâÂèëÁîü‰∫§Êç¢ return tempList return tempListprint bubbleSort2([5,10,2,7,0,30]) ÂàÜÊûêÊúÄÂ•ΩÊÉÖÂÜµ:Êï∞ÊçÆ‰∫ïÁÑ∂ÊúâÂ∫è,Ê†πÊçÆ‰ºòÂåñÂêéÁöÑ‰ª£Á†Å,Âè™ÈúÄË¶ÅËø≠‰ª£‰∏ÄÊ¨°,Âç≥n-1Ê¨°ÁöÑÊØîËæÉ,ÂàôÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n)ÊúÄÂùèÊÉÖÂÜµ:Êï∞ÊçÆÈÄÜÂ∫è,ÈúÄË¶ÅÊØîËæÉÁöÑÊ¨°Êï∞‰∏∫1+2+3+4+‚Ä¶+(n-1)=n(n-1)/2Ê¨°,Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n^2) ÂÅáÂÆöÊúâ4‰∏™Êï∞,ÂàÜÂà´‰∏∫4 3 2 1,ÊéíÂ∫èËøáÁ®ã‰∏∫:ÂéüÊï∞ÊçÆ: 4 3 2 1Á¨¨1Ê¨°: 3 4 2 1Á¨¨2Ê¨°: 3 2 4 1Á¨¨3Ê¨°: 3 2 1 4Á¨¨4Ê¨°: 2 3 1 4Á¨¨5Ê¨°: 2 1 3 4Á¨¨6Ê¨°: 1 2 3 4ÂΩíÁ∫≥Êé®ÁêÜ:n(n-1)/2Ê¨° ‰∫å„ÄÅÈÄâÊã©ÊéíÂ∫èÂú®Êú™ÊéíÂ∫èÂ∫èÂàó‰∏≠ÊâæÂà∞ÊúÄÂ∞èÂÖÉÁ¥†ÔºåÂ≠òÊîæÂà∞ÊéíÂ∫èÂ∫èÂàóÁöÑËµ∑Âßã‰ΩçÁΩÆ(‰∏éÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†‰∫§Êç¢‰ΩçÁΩÆ)ÔºåÁÑ∂ÂêéÔºåÂÜç‰ªéÂâ©‰ΩôÊú™ÊéíÂ∫èÂÖÉÁ¥†‰∏≠ÁªßÁª≠ÂØªÊâæÊúÄÂ∞èÂÖÉÁ¥†ÔºåÁÑ∂ÂêéÊîæÂà∞Â∑≤ÊéíÂ∫èÂ∫èÂàóÁöÑÊú´Â∞æ(‰∏éÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†‰∫§Êç¢‰ΩçÁΩÆ)„ÄÇ‰ª•Ê≠§Á±ªÊé®ÔºåÁõ¥Âà∞ÊâÄÊúâÂÖÉÁ¥†ÂùáÊéíÂ∫èÂÆåÊØï„ÄÇ ÈÄöËøán-iÊ¨°ÂÖ≥ÈîÆÂ≠óÈó¥ÁöÑÊØîËæÉ,‰ªén-i+1‰∏™ËÆ∞ÂΩï‰∏≠ÈÄâÂá∫ÊúÄÂ∞èÁöÑËÆ∞ÂΩï,Âπ∂ÂíåÁ¨¨i‰∏™ËÆ∞ÂΩï‰∫§Êç¢‰πã. ÈÄâÊã©ÊéíÂ∫èÁöÑ‰∫§Êç¢Êìç‰Ωú‰ªã‰∫é 0 Âíå ( n ‚àí 1 )Ê¨°‰πãÈó¥„ÄÇÈÄâÊã©ÊéíÂ∫èÁöÑÊØîËæÉÊìç‰Ωú‰∏∫ n ( n ‚àí 1 ) / 2Ê¨°‰πãÈó¥„ÄÇÈÄâÊã©ÊéíÂ∫èÁöÑËµãÂÄºÊìç‰Ωú‰ªã‰∫é 0 Âíå 3 ( n ‚àí 1 )Ê¨°‰πãÈó¥„ÄÇ ÂΩìÁ©∫Èó¥Â§çÊùÇÂ∫¶Ë¶ÅÊ±ÇËæÉÈ´òÊó∂ÔºåÂèØ‰ª•ËÄÉËôëÈÄâÊã©ÊéíÂ∫èÔºõÂÆûÈôÖÈÄÇÁî®ÁöÑÂú∫ÂêàÈùûÂ∏∏ÁΩïËßÅ„ÄÇ def selectionSort(tempList): n = len(tempList) for x in xrange(n): # ÂÅáÂÆöÁ¥¢ÂºïxÂØπÂ∫îÁöÑÊòØÊúÄÂ∞èÂÄº index = x for y in xrange(x + 1,n): # Â¶ÇÊûúÊâæÂà∞ÊØîÁ¥¢ÂºïindexÂØπÂ∫îÁöÑÂÄºËøòË¶ÅÂ∞èÁöÑÂÄº,‰∫§Êç¢‰∏§ËÄÖ‰ΩçÁΩÆ if tempList[index] &gt; tempList[y]: tempList[index], tempList[y] = tempList[y], tempList[index] return tempListprint selectionSort([5,10,2,7,0,30]) ÂàÜÊûêÁâπÁÇπ:‰∫§Êç¢ÁßªÂä®Êï∞ÊçÆÊ¨°Êï∞Áõ∏ÂΩìÂ∞ëÊúÄÂ•ΩÊÉÖÂÜµ‰∏éÊúÄÂùèÊÉÖÂÜµ:ÊØîËæÉÊ¨°Êï∞‰∏ÄÊ†∑Â§ö,‰∏∫n(n-1)/2Ê¨°,Êó∂Èó¥Â§çÊùÇÂ∫¶:O(n^2) ÂÅáÂÆöÊúâ4‰∏™Êï∞ÊçÆ,ÂàÜÂà´‰∏∫ 4 3 2 1ÂéüÊï∞ÊçÆ: 4 3 2 1Á¨¨1Ê¨°ÊØîËæÉ: 4 ‰∏é 3Á¨¨2Ê¨°ÊØîËæÉ: 4 ‰∏é 2Á¨¨3Ê¨°ÊØîËæÉ: 4 ‰∏é 1 (Ê≠§Êó∂Êï∞ÊçÆ‰∏∫1 3 2 4)Á¨¨4Ê¨°ÊØîËæÉ: 3 ‰∏é 2Á¨¨5Ê¨°ÊØîËæÉ: 3 ‰∏é 4 (Ê≠§Êó∂Êï∞ÊçÆ‰∏∫ 1 2 3 4)Á¨¨6Ê¨°ÊØîËæÉ: 3 ‰∏é 4ÊúÄÁªàÁªìÊûú: 1 2 3 4ÊØîËæÉÊ¨°Êï∞:6Ê¨° ÈÄâÊã©ÊéíÂ∫èÊòØ‰∏çÁ®≥ÂÆöÁöÑÊéíÂ∫èÁÆóÊ≥ï,ÊØîÂ¶Ç5 8 5 2 9,ÊòæÁÑ∂Á¨¨1‰∏™5ÊúÄÁªàËêΩÂà∞Á¨¨2‰∏™5ÁöÑÂêéÈù¢. ÂéüÊï∞ÊçÆ: 5' 8 5 2 9Á¨¨1Ê¨°‰∫§Êç¢: 2 8 5 5' 9Á¨¨2Ê¨°‰∫§Êç¢: 2 5 8 5' 9Á¨¨3Ê¨°‰∫§Êç¢: 2 5 5' 8 9Á¨¨4Ê¨°‰∫§Êç¢: 2 5 5' 8 9ÊúÄÁªà 5'Âú® 5 ÁöÑÂâçÈù¢. ‰∏â„ÄÅÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÂéüÁêÜ:Âú®‰∏Ä‰∏™Â∑≤ÁªèÊúâÂ∫èÁöÑÊï∞ÊçÆÂ∫èÂàó‰∏≠ÊèíÂÖ•‰∏Ä‰∏™Êï∞ÔºåÂú®ÊèíÂÖ•ÂêéÊ≠§Êï∞ÊçÆÂ∫èÂàó‰ªçÁÑ∂ÊúâÂ∫è„ÄÇÈªòËÆ§Ââç1‰∏™Êï∞ÊúâÂ∫èÔºåÁ¨¨‰∫å‰∏™Êï∞‰∏éÂâç‰∏Ä‰∏™Êï∞ÁªÑÊàêÁöÑÊúâÂ∫èÊï∞ÂàóÊØîËæÉÂπ∂ÊèíÂÖ•ÔºåÁ¨¨‰∏â‰∏™Êï∞‰∏éÂâç‰∏§‰∏™Êï∞ÁªÑÊàêÁöÑÊúâÂ∫èÊï∞ÂàóÊØîËæÉÂπ∂ÊèíÂÖ•‚Ä¶‚Ä¶ÊâÄ‰ª•ÊÄªÊòØÈù†ÂâçÁöÑÊï∞Â≠óÊúâÂ∫è„ÄÇ ÈÅáÂà∞Áõ∏Á≠âÁöÑÊï∞ÔºåÊèíÂÖ•Âà∞ËØ•Êï∞ÁöÑÂêéÈù¢ÔºåËÄå‰∏çÊòØÂâçÈù¢ÔºåÊâÄ‰ª•ÊòØÁ®≥ÂÆöÊéíÂ∫èÁÆóÊ≥ï„ÄÇ ÊúÄÂ•ΩÊÉÖÂÜµÔºöÂ∫èÂàóÂ∑≤ÁªèÊòØÂçáÂ∫èÊéíÂàó‰∫ÜÔºåÈúÄË¶ÅËøõË°åÁöÑÊØîËæÉÊìç‰ΩúÈúÄ(n-1)Ê¨°,Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n)„ÄÇÊúÄÂùèÊÉÖÂÜµÔºöÂ∫èÂàóÊòØÈôçÂ∫èÊéíÂàóÔºåÈÇ£‰πàÊ≠§Êó∂ÈúÄË¶ÅËøõË°åÁöÑÊØîËæÉÂÖ±Êúâ n ( n ‚àí 1 ) / 2 Ê¨°„ÄÇÊèíÂÖ•ÊéíÂ∫èÁöÑËµãÂÄºÊìç‰ΩúÊòØÊØîËæÉÊìç‰ΩúÁöÑÊ¨°Êï∞Âä†‰∏ä(n-1)Ê¨°„ÄÇÂπ≥ÂùáÊù•ËØ¥ÊèíÂÖ•ÊéíÂ∫èÁÆóÊ≥ïÂ§çÊùÇÂ∫¶‰∏∫ O ( n^2 )„ÄÇÊèíÂÖ•ÊéíÂ∫è‰∏çÈÄÇÂêàÂØπ‰∫éÊï∞ÊçÆÈáèÊØîËæÉÂ§ßÁöÑÊéíÂ∫èÂ∫îÁî®„ÄÇÁî®‰∫éÂ∞ëÈáèÂÖÉÁ¥†ÁöÑÊéíÂ∫èÔºàÈÄöÂ∏∏‰∏∫8‰∏™Êàñ‰ª•‰∏ãÔºâ„ÄÇ Áõ¥Êé•ÊèíÂÖ• def insertionSort(tempList): # Ëé∑ÂèñÂàóË°®ÁöÑÈïøÂ∫¶ n = len(tempList) for x in xrange(1,n): # ‰ªéÁ¨¨1‰∏™ÂÖÉÁ¥†ËÄåÈùûÁ¨¨0‰∏™ÂÖÉÁ¥†ÂºÄÂßãÈÅçÂéÜ for y in xrange(x, 0, -1): # Âú®Â∑≤ÁªèÊéíÂ•ΩÂ∫èÁöÑÂàóË°®‰∏≠ÈÄê‰∏™Êâ´Êèè if tempList[y - 1] &gt; tempList[y]: # Â¶ÇÊûúÂΩìÂâçÂÖÉÁ¥†ÊØîÂâçÈù¢ÁöÑÂ∞è tempList[y], tempList[y - 1] = tempList[y - 1], tempList[y] # ‰∏§ËÄÖ‰ΩçÁΩÆ‰∫íÊç¢ return tempList# print insertionSort([])# print insertionSort([8])# print insertionSort([5,2,7,0,1,5,9]) Âõõ„ÄÅ‰∫åÂàÜÊèíÂÖ•ÊéíÂ∫è‰∫åÂàÜÊü•ÊâæÊèíÂÖ•‰∏éÂ∏åÂ∞îÊéíÂ∫èÊòØÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÁöÑ‰ºòÂåñ„ÄÇ ‰∫åÂàÜÊü•ÊâæÊèíÂÖ• ‰ΩøÁî®PythonÊ®°ÂùóÂÆûÁé∞ # bisectÊ®°ÂùóÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ÁÆóÊ≥ï, Áî®‰∫éÂêë‰∏Ä‰∏™ÊúâÂ∫èÂàóË°®‰∏≠ÊèíÂÖ•‰∏Ä‰∏™ÂÖÉÁ¥†,‰∏çÊîπÂèòÂàóË°®ÁöÑÂ∫èÂàó# ‰ΩøÁî®Ëøô‰∏™Ê®°ÂùóÁöÑÂáΩÊï∞ÂâçÂÖàÁ°Æ‰øùÊìç‰ΩúÁöÑÂàóË°®ÊòØÂ∑≤ÊéíÂ∫èÁöÑ#import bisect def insertionSortBisect(tempList): for i in xrange(1, len(tempList)): bisect.insort(tempList, tempList.pop(i), 0, i) # ÊéíÂ∫èÂàóË°®,ÁßªÈô§Âπ∂ÊèíÂÖ•ÂÖÉÁ¥†,Âå∫Èó¥ÂºÄÂßã,Âå∫Èó¥ÁªìÊùü return tempList# print insertionSortBisect([])# print insertionSortBisect([8])# print insertionSortBisect([5,2,7,0,1,5,9]) ÊâãÂä®ÂÆûÁé∞ #‰∫åÂàÜÊü•ÊâæÁöÑÂâçÊèêÂøÖÈ°ªÂæÖÊü•ÊâæÁöÑÂ∫èÂàóÊúâÂ∫è# Âú®ÊúâÂ∫èÂàóË°®‰∏≠,ËøîÂõûÂÄºmÂ∫îËØ•ÊâÄÂú®ÁöÑÁ¥¢Âºïdef indexOfInsertionSort(tempList, m): # Ëé∑ÂèñÂàóË°®ÁöÑÈïøÂ∫¶ n = len(tempList) left, right = 0, n - 1 while left &lt;= right: middle = (left + right) / 2 if tempList[middle] &lt; m:# Âè≥ÂçäÈÉ®ÂàÜ left = middle + 1 else: #Â∑¶ÂçäÈÉ®ÂàÜ,Âê´Áõ∏ÂêåÂÖÉÁ¥† right = middle -1 return right +1 def insertionSortbin(tempList): # Ëé∑ÂèñÂàóË°®ÁöÑÈïøÂ∫¶ n = len(tempList) for x in xrange(0,n): # ‰ªéÂ§¥Ëá≥Â∞æÈÅçÂéÜÂàóË°®‰∏≠ÁöÑÂÖÉÁ¥† m = tempList[x] tempList.pop(x) index = indexOfInsertionSort(tempList[0:x],m) tempList.insert(index , m) #Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÁ¥¢Âºï,Á¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÊï∞ÂÄº return tempList #print insertionSortbin([12,12,16,8,5,10,7]) ‰∫î„ÄÅÂ∏åÂ∞îÊéíÂ∫èÂÖàÂ∞ÜÂæÖÊéíËÆ∞ÂΩïÂ∫èÂàóÂàÜÂâ≤‰∏∫Ëã•Âπ≤‰∏™Â≠êÂ∫èÂàóÔºåÂàÜÂà´ËøõË°åÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÔºåÂæÖÊï¥‰∏™Â∫èÂàóÂü∫Êú¨ÊúâÂ∫èÊó∂ÔºåÂÜçÂØπÂÖ®‰ΩìËÆ∞ÂΩïËøõË°å‰∏ÄÊ¨°Áõ¥Êé•ÊèíÂÖ•ÊéíÂ∫è„ÄÇ ÈááÁî®Ë∑≥Ë∑ÉÂàÜÂâ≤ÁöÑÁ≠ñÁï•:ÊääÁõ∏Ë∑ùÊüê‰∏™‚ÄùÂ¢ûÈáè‚ÄùÁöÑËÆ∞ÂΩïÁªÑÊàê‰∏Ä‰∏™Â∫èÂàóÔºå‰øùËØÅÂú®Â≠êÂ∫èÂàóÂÜÖÂàÜÂà´ËøõË°åÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÂêéÂæóÂà∞ÁöÑÁªìÊûúÊòØÂü∫Êú¨ÊúâÂ∫èÁöÑ„ÄÇ ÂéüÂßãÂ∫èÂàó 2 5 1 9 8 2 10 4 4Ê≠•ÈïøÔºåÂàÜÁªÑÔºåÊØèÂàóÊéíÂ∫è 2 5 1 98 2 10 4 ÊéíÂ∫èÂêé 2 2 1 48 5 10 9 ‰πüÂç≥ 2 2 1 4 8 5 10 9 2Ê≠•ÈïøÔºåÂÜçÂàÜÁªÑ 2 21 48 510 9 ÊéíÂ∫è 1 22 48 510 9 ‰πüÂç≥Ôºö 1 2 2 4 8 5 10 9 ÊúÄÂêé‰ª•1Ê≠•ÈïøËøõË°åÊéíÂ∫èÔºàËøòÊòØÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÔºâ„ÄÇ ‰∏ÄËà¨ÊèíÂÖ• def insertionSortShell(tempList): n = len(tempList) # Á°ÆÂÆöÂàÜÁªÑ,ÂÅáÂÆön = 6 group = n / 2 # Ê≠§Êó∂group = 3,ÂàÜÊàê3ÁªÑ,3ÁªÑÂÖÉÁ¥†Á¥¢ÂºïÂàÜÂà´‰∏∫3‰∏é3-3,4‰∏é4-3,5‰∏é5-3 while group &gt; 0: #x‰ªé3Âà∞5 for x in xrange(group,n): # ÊØèÁªÑÂÖÉÁ¥†:x,x-group,x-group-group ......ÊèíÂÖ•ÊéíÂ∫è temp = tempList[x] y = x # ËøôÈáå‰ΩøÁî®ÁÆÄÂçïÁöÑÊèíÂÖ•ÊéíÂ∫è while y &gt;= group and tempList[y - group] &gt; temp: tempList[y] = tempList[y - group] y -= group tempList[y] = temp group /= 2 return tempList ‰∫íÊç¢Ê≥ï def insertionSortShellExchange(tempList): n = len(tempList) # Á°ÆÂÆöÂàÜÁªÑ,ÂÅáÂÆön = 6 group = n / 2 # Ê≠§Êó∂group = 3,ÂàÜÊàê3ÁªÑ,3ÁªÑÂÖÉÁ¥†Á¥¢ÂºïÂàÜÂà´‰∏∫3‰∏é3-3,4‰∏é4-3,5‰∏é5-3 while group &gt; 0: #x‰ªé3Âà∞5 for x in xrange(group,n): # ÊØèÁªÑÂÖÉÁ¥†:x,x-group,x-group-group ......ÊèíÂÖ•ÊéíÂ∫è y = x m = tempList[x] while y &gt;= group and tempList[y - group] &gt; m: # ËøôÈáåÁõ¥Êé•‰∫§Êç¢‰ΩçÁΩÆ tempList[y], tempList[y - group] = tempList[y - group], tempList[y] y -= group group /= 2 return tempList#print insertionSortShell([1,8,10,2,4,0])#print insertionSortShellExchange([1,8,10,2,4,0]) Áî±‰∫éËÆ∞ÂΩïÊòØË∑≥Ë∑ÉÂºèÁöÑÔºåÂ∏åÂ∞îÊéíÂ∫èÊòØ‰∏çÁ®≥ÂÆöÁöÑÊéíÂ∫èÁÆóÊ≥ï„ÄÇ ÂÖ≠„ÄÅÂ†ÜÊéíÂ∫èÂ†ÜÊéíÂ∫èÊòØÂØπÁÆÄÂçïÈÄâÊã©ÊéíÂ∫èÁöÑÊîπËøõ„ÄÇ Â†ÜÊòØÂÖ∑Êúâ‰ª•‰∏ãÊÄßË¥®ÁöÑÂÆåÂÖ®‰∫åÂèâÊ†ë:ÊØè‰∏™ÁªìÁÇπÁöÑÂÄºÈÉΩÂ§ß‰∫éÊàñÁ≠â‰∫éÂÖ∂Â∑¶Âè≥Â≠©Â≠êÁªìÁÇπÁöÑÂÄºÔºåÁß∞‰∏∫Â§ßÈ°∂Â†Ü„ÄÇÊØè‰∏™ÁªìÁÇπÁöÑÂÄºÈÉΩÂ∞è‰∫éÊàñÁ≠â‰∫éÂÖ∂Â∑¶Âè≥Â≠©Â≠êÁªìÁÇπÁöÑÂÄºÔºåÁß∞‰∏∫Â∞èÈ°∂Â†Ü„ÄÇ ÊÄßË¥®:ÊåâÂ±ÇÈÅçÂéÜÁöÑÊñπÂºèÁªôÁªìÁÇπÁºñÂè∑ÔºåÂàôÊúâ: k(i) &gt;= k(2i) k(i) &gt;= k(2i+1) Êàñ k(i) &lt;= k(2i) k(i) &lt;= k(2i+1) Â†ÜÊéíÂ∫èÂ∞±ÊòØÂà©Áî®Â†ÜËøõË°åÊéíÂ∫èÁöÑÁÆóÊ≥ïÔºåÂü∫Êú¨ÊÄùÊÉ≥ÊòØ:Â∞ÜÂæÖÊéíÂ∫èÁöÑÂ∫èÂàóÊûÑÈÄ†Êàê‰∏Ä‰∏™Â§ßÈ°∂Â†ÜÔºåÊ≠§Êó∂Êï¥‰∏™Â∫èÂàóÁöÑÊúÄÂ§ßÂÄºÂ∞±ÊòØÂ†ÜÈ°∂ÁöÑÊ†πÁªìÁÇπ„ÄÇÊääÂÆÉÁßªËµ∞(ÂÖ∂ÂÆûÂ∞±ÊòØÂ∞ÜÂÖ∂‰∏éÂ†ÜÊï∞ÁªÑÁöÑÊú´Â∞æÂÖÉÁ¥†‰∫§Êç¢ÔºåÊ≠§Êó∂Êú´Â∞æÂÖÉÁ¥†Â∞±ÊòØÊúÄÂ§ßÂÄº)ÔºåÁÑ∂ÂêéÂ∞ÜÂâ©‰ΩôÁöÑn-1‰∏™ÂÄºÈáçÊñ∞ÊûÑÈÄ†Êàê‰∏Ä‰∏™Â†ÜÔºåËøôÊ†∑Â∞±‰ºöÂæóÂà∞n‰∏™ÂÖÉÁ¥†‰∏≠ÁöÑÊ¨°Â∞èÂÄºÔºåÂ¶ÇÊ≠§ÂèçÂ§çÊâßË°åÔºå‰æøËÉΩÂæóÂà∞‰∏Ä‰∏™ÊúâÂ∫èÂ∫èÂàó‰∫Ü„ÄÇ ÈúÄË¶ÅËß£ÂÜ≥ÁöÑ‰∏§‰∏™ÈóÆÈ¢ò:1. Â¶Ç‰ΩïÁî±‰∏Ä‰∏™Êó†Â∫èÂ∫èÂàóÊûÑÂª∫Êàê‰∏Ä‰∏™Â†Ü2. Â¶Ç‰ΩïÂú®Ëé∑ÂèñÂ†ÜÈ°∂ÂÖÉÁ¥†ÂêéÔºåË∞ÉÊï¥Ââ©‰ΩôÂÖÉÁ¥†Êàê‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑÂ†Ü ÊâÄË∞ìÁöÑÂ∞ÜÂæÖÊéíÂ∫èÁöÑÂ∫èÂàóÊûÑÂª∫Êàê‰∏Ä‰∏™Â§ßÈ°∂Â†ÜÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰ªé‰∏ãÂæÄ‰∏ä„ÄÅ‰ªéÂè≥ÂæÄÂ∑¶ÔºåÂ∞ÜÊØè‰∏™ÈùûÂè∂ÁªìÁÇπÂΩì‰ΩúÊ†πËäÇÁÇπÔºåÂ∞ÜÂÖ∂ÂíåÂÖ∂Â≠êÊ†ëË∞ÉÊï¥ÊàêÂ§ßÈ°∂Â†Ü„ÄÇ Âú®Ê≠£ÂºèÊéíÂ∫èÊó∂ÔºåÁ¨¨iÊ¨°ÂèñÂ†ÜÈ°∂ËÆ∞ÂΩïÈáçÂª∫ÈúÄË¶ÅO(logi)ÁöÑÊó∂Èó¥ÔºåÂπ∂‰∏îÈúÄË¶ÅÂèñn-1Ê¨°Â†ÜÈ°∂ËÆ∞ÂΩïÔºåÂõ†Ê≠§ÔºåÈáçÂª∫Â†ÜÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(nlogn)„ÄÇ Â†ÜÊéíÂ∫èÂØπÂéüÂßãÁä∂ÊÄÅÁöÑÊéíÂ∫è‰∏çÊïèÊÑüÔºåÊó†ËÆ∫ÊòØÊúÄÂ•ΩÊúÄÂùèËøòÊòØÂπ≥ÂùáÊÉÖÂÜµÊó∂Èó¥Â§çÊùÇÂ∫¶ÊÄªÊòØ‰∏∫O(nlogn)„ÄÇ Ê≥®ÊÑè:Áî±‰∫éÂàùÂßãÊûÑÂª∫Â†ÜÊâÄÈúÄÁöÑÊØîËæÉÊ¨°Êï∞ËæÉÂ§öÔºåÂõ†Ê≠§ÔºåÂÆÉÂπ∂‰∏çÈÄÇÂêàÂæÖÊéíÂ∫èÂ∫èÂàó‰∏™Êï∞ËæÉÂ∞ëÁöÑÊÉÖÂÜµ„ÄÇ ÂÆûÁé∞ # startÊòØÂΩìÂâçÈúÄË¶ÅË∞ÉÊï¥ÊúÄÂ∞èÂ†ÜÁöÑ‰ΩçÁΩÆ,endÊòØË∞ÉÊï¥ËæπÁïådef heapAdjust(tempList, start, end): root = start while True: child = root * 2 + 1 if child &gt; end: break if child + 1 &lt;= end and tempList[child] &lt; tempList[child + 1]: child += 1 if tempList[root] &lt; tempList[child]: tempList[root], tempList[child] = tempList[child], tempList[root] root = child else: break def heapSort(tempList): n = len(tempList) # ÊûÑÈÄ†Â∞èÈ°∂Â†Ü for i in xrange(n / 2, -1, -1): heapAdjust(tempList, i, n - 1) for i in xrange(n - 1, 0, -1): # Â∞ÜÂ†ÜÈ°∂ËÆ∞ÂΩïÂíåÂΩìÂâçÊú™ÊéíÂ∫èÂ≠êÂ∫èÂàóÁöÑÊúÄÂêé‰∏Ä‰∏™ËÆ∞ÂΩï‰∫§Êç¢ tempList[0], tempList[i] = tempList[i], tempList[0] # ÈáçÊñ∞Ë∞ÉÊï¥‰∏∫Â∞èÈ°∂Â†Ü heapAdjust(tempList, 0, i - 1) return tempListprint heapSort([2,4,3,1,6,7,4,2,8]) ‰∏É„ÄÅÂΩíÂπ∂ÊéíÂ∫èÂΩíÂπ∂ÊéíÂ∫èÂ∞±ÊòØÂà©Áî®ÂΩíÂπ∂ÁöÑÊÄùÊÉ≥ÂÆûÁé∞ÁöÑÊéíÂ∫èÁÆóÊ≥ï„ÄÇÂéüÁêÜÊòØ:ÂÅáËÆæÂàùÂßãÂ∫èÂàóÂê´Êúân‰∏™ËÆ∞ÂΩïÔºåÂàôÂèØ‰ª•ÁúãÊàêÊòØn‰∏™ÊúâÂ∫èÁöÑÂ≠êÂ∫èÂàóÔºåÊØè‰∏™Â≠êÂ∫èÂàóÁöÑÈïøÂ∫¶‰∏∫1ÔºåÁÑ∂Âêé‰∏§‰∏§ÂêàÂπ∂ÔºåÂæóÂà∞n/2ÁöÑÂêë‰∏äÂèñÊï¥‰∏™ÈïøÂ∫¶‰∏∫2ÊàñËÄÖ‰∏∫1ÁöÑÊúâÂ∫èÂ≠êÂ∫èÂàóÔºåÁÑ∂Âêé‰∏§‰∏§ÂêàÂπ∂ÔºåÂ¶ÇÊ≠§ÈáçÂ§çÔºåÁõ¥Âà∞ÂæóÂà∞‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫nÁöÑÊúâÂ∫èÂ∫èÂàó„ÄÇËØ•ÊñπÊ≥ï‰πüÁß∞‰∏∫2Ë∑ØÂΩíÂπ∂ÊéíÂ∫è„ÄÇ ÊØîËæÉÊìç‰ΩúÁöÑÊ¨°Êï∞‰ªã‰∫é ( nlogn ) / 2 Âíå nlogn ‚àí n + 1„ÄÇËµãÂÄºÊìç‰ΩúÁöÑÊ¨°Êï∞ÊòØ ( 2 nlogn )„ÄÇ #ÂΩíÂπ∂ÊéíÂ∫èdef mergeSort(tempList): length = len(tempList) if length &lt;= 1: return tempList # ‰∫åÂàÜÂàóË°® middle = length / 2 leftList = mergeSort(tempList[:middle]) rightList = mergeSort(tempList[middle:]) return merge(leftList,rightList)def merge(leftList,rightList): leftIndex,rightIndex = 0, 0 result = [] while leftIndex &lt; len(leftList) and rightIndex &lt; len(rightList): if leftList[leftIndex] &lt; rightList[rightIndex]: result.append(leftList[leftIndex]) leftIndex += 1 else: result.append(rightList[rightIndex]) rightIndex += 1 result += leftList[leftIndex:] result += rightList[rightIndex:] return resultprint mergeSort([2,5,1,2,0,6,3]) ‰∏ÄË∂üÂΩíÂπ∂ÈúÄË¶ÅËÄóË¥πO(n)Êó∂Èó¥ÔºåÁî±ÂÆåÂÖ®‰∫åÂèâÊ†ëÁöÑÊ∑±Â∫¶ÂèØÁü•ÔºåÊï¥‰∏™ÂΩíÂπ∂ÊéíÂ∫èÈúÄË¶ÅËøõË°ålognÊ¨°ÔºåÊïÖÔºåÊÄªÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(logn)ÔºåÂπ∂‰∏îÊúÄÂ•Ω/ÊúÄÂùè/Âπ≥ÂùáÊó∂Èó¥ÊÄßËÉΩÂùáÊòØÂ¶ÇÊ≠§„ÄÇ ÂΩíÂπ∂ÊéíÂ∫èÈúÄË¶Å‰∏§‰∏§ÊØîËæÉÔºå‰∏çÂ≠òÂú®Ë∑≥Ë∑ÉÔºåÂõ†Ê≠§Á®≥ÂÆö„ÄÇ ÂÖ´„ÄÅÂø´ÈÄüÊéíÂ∫è20‰∏ñÁ∫™ÂçÅÂ§ßÁÆóÊ≥ï‰πã‰∏Ä„ÄÇ ÂÖ≥ÈîÆËØç:Âü∫ÂáÜ ÂàÜÁªÑ ÈÄíÂΩí Âú®Âπ≥ÂùáÁä∂ÂÜµ‰∏ãÔºåÊéíÂ∫èn‰∏™È°πÁõÆË¶ÅŒü(n log n)Ê¨°ÊØîËæÉ„ÄÇÂú®ÊúÄÂùèÁä∂ÂÜµ‰∏ãÂàôÈúÄË¶ÅŒü(n2)Ê¨°ÊØîËæÉ„ÄÇ Âø´ÈÄüÊéíÂ∫è‰ΩøÁî®ÂàÜÊ≤ªÊ≥ïÁ≠ñÁï•Êù•Êää‰∏Ä‰∏™Â∫èÂàóÂàÜ‰∏∫‰∏§‰∏™Â≠êÂ∫èÂàó„ÄÇ Ê≠•È™§‰∏∫Ôºö ‰ªéÊï∞Âàó‰∏≠ÊåëÂá∫‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå‰Ωú‰∏∫Âü∫ÂáÜÊï∞Ôºå ÂàÜÂå∫ÔºöÊääÊØîÂü∫ÂáÜÂ§ßÁöÑÊîæÂú®Âè≥ËæπÔºåÊØîÂü∫ÂáÜÂ∞èÁöÑÊîæÂú®Â∑¶ËæπÔºåÁ≠â‰∫éÂü∫ÂáÜÁöÑÊîæÂú®Âü∫ÂáÜÂàóË°®‰∏≠„ÄÇ ÈÄíÂΩíÂú∞ÊääÂ∞è‰∫éÂü∫ÂáÜÂÄºÂÖÉÁ¥†ÁöÑÂ≠êÊï∞ÂàóÂíåÂ§ß‰∫éÂü∫ÂáÜÂÄºÂÖÉÁ¥†ÁöÑÂ≠êÊï∞ÂàóÊéíÂ∫è„ÄÇ def quickSort(tempList): if len(tempList) &lt;= 1: return tempList # Âü∫ÂáÜÂàóË°® pivotList = [] # ÊØîÂü∫ÂáÜÂ∞èÁöÑÂàóË°® lessList = [] # ÊØîÂü∫ÂáÜÂ§ßÁöÑÂàóË°® moreList = [] #Â∞ÜÁ¨¨‰∏Ä‰∏™ÂÄº‰Ωú‰∏∫Âü∫ÂáÜ pivot = tempList[0] # ÈÅçÂéÜtempList for x in tempList: # ÊØîÂü∫ÂáÜÂ§ß,ÊîæÂÖ•moreList if x &gt; pivot: moreList.append(x) # ÊØîÂü∫ÂáÜÂ∞è,ÊîæÂÖ•lessList elif x &lt; pivot: lessList.append(x) # ‰∏éÂü∫ÂáÜÁõ∏Á≠â,ÊîæÂÖ•Âü∫ÂáÜÂàóË°®‰∏≠ else: pivotList.append(x) # ÂØπlessListÂíåmoreListÈÄíÂΩíÊìç‰Ωú lessList = quickSort(lessList) moreList = quickSort(moreList) # ËøîÂõûÊéíÂ∫èÂ•ΩÁöÑÂàóË°® return lessList + pivotList + moreList ÁîöËá≥ÂèØ‰ª•Ëøô‰πàÂÜô def quickSort1(tempList): if len(tempList) &lt;= 1: return tempList else: pivot = tempList[0] return quickSort1([x for x in tempList[1:] if x &lt; pivot])\ + [pivot] + \ quickSort1([x for x in tempList[1:] if x &gt;= pivot])print quickSort1([5,7,8,2,6,8,0,5]) Âø´ÈÄüÊéíÂ∫èÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÂèñÂÜ≥‰∫éÂø´ÈÄüÊéíÂ∫èÈÄíÂΩíÁöÑÊ∑±Â∫¶ÔºåÂú®ÊúÄ‰ºòÊÉÖÂÜµ‰∏ãÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(logn)„ÄÇÊúÄÂùèÊÉÖÂÜµ‰∏ãÔºåÂæÖÊéíÂ∫è‰∏∫Ê≠£Â∫èÊàñËÄÖÈÄÜÂ∫èÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n^2) Áî±‰∫éÂÖ≥ÈîÆÂ≠óÁöÑÊØîËæÉÂíå‰∫§Êç¢ÊòØË∑≥Ë∑ÉËøõË°åÁöÑÔºåÂõ†Ê≠§Âø´ÈÄüÊéíÂ∫è‰∏çÁ®≥ÂÆö„ÄÇ Âø´ÈÄüÊéíÂ∫èÁöÑ‰ºòÂåñ: ‰ºòÂåñÈÄâÂèñÊû¢ËΩ¥‰∏âÊï∞Âèñ‰∏≠Ê≥ï:Âèñ‰∏â‰∏™ÂÖ≥ÈîÆÂ≠óÂÖàËøõË°åÊéíÂ∫èÔºåÂ∞Ü‰∏≠Èó¥Êï∞‰Ωú‰∏∫Êû¢ËΩ¥Ôºå‰∏ÄËà¨ÂèñÂ∑¶Á´Ø„ÄÅÂè≥Á´ØÂíå‰∏≠Èó¥‰∏â‰∏™Êï∞Ôºå‰πüÂèØ‰ª•ÈöèÊú∫ÈÄâÂèñÔºåËá≥Â∞ëÊû¢ËΩ¥‰∏çÊòØÊúÄÂ§ßÊàñËÄÖÊúÄÂ∞èÁöÑÊï∞„ÄÇ ‰πù„ÄÅËÆ°Êï∞ÊéíÂ∫èËÆ°Êï∞ÊéíÂ∫èÊòØÁî®Êù•ÊéíÂ∫è0Âà∞100‰πãÈó¥ÁöÑÊï∞Â≠óÁöÑÊúÄÂ•ΩÁöÑÁÆóÊ≥ï„ÄÇ Ê≠•È™§: ÊâæÂá∫ÂæÖÊéíÂ∫èÁöÑÊï∞ÁªÑ‰∏≠ÊúÄÂ§ßÂíåÊúÄÂ∞èÁöÑÂÖÉÁ¥†ÁªüËÆ°Êï∞ÁªÑ‰∏≠ÊØè‰∏™ÂÄº‰∏∫iÁöÑÂÖÉÁ¥†Âá∫Áé∞ÁöÑÊ¨°Êï∞ÔºåÂ≠òÂÖ•Êï∞ÁªÑ C ÁöÑÁ¨¨ i È°πÂØπÊâÄÊúâÁöÑËÆ°Êï∞Á¥ØÂä†Ôºà‰ªéC‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂºÄÂßãÔºåÊØè‰∏ÄÈ°πÂíåÂâç‰∏ÄÈ°πÁõ∏Âä†ÔºâÂèçÂêëÂ°´ÂÖÖÁõÆÊ†áÊï∞ÁªÑÔºöÂ∞ÜÊØè‰∏™ÂÖÉÁ¥†iÊîæÂú®Êñ∞Êï∞ÁªÑÁöÑÁ¨¨C(i)È°πÔºåÊØèÊîæ‰∏Ä‰∏™ÂÖÉÁ¥†Â∞±Â∞ÜC(i)ÂáèÂéª1 #ËÆ°Êï∞ÊéíÂ∫èdef countsort(tempList): if len(tempList) &lt;= 1: return tempList maxValue = max(tempList) minValue = min(tempList) # ÂàõÂª∫ËÆ°Êï∞ÂàóË°®countList countList = [0] * (maxValue - minValue + 1) # Ëé∑ÂèñÂÖÉÁ¥†Âá∫Áé∞Ê¨°Êï∞ for e in tempList: countList[e - minValue] += 1 index = 0 # Â°´ÂÄº for a in xrange(maxValue - minValue + 1): for c in xrange(countList[a]): tempList[index] = a + minValue index += 1 return tempList print countsort([1,6,3,2,3]) ÈÇ£‰πà,‰ª•1,6,3,2,3‰∏∫‰æãÊúÄÂÄºmaxValue = 6minValue = 1 ËÆ°Êï∞ÂàóË°®countList = [0, 0, 0, 0, 0, 0] ÂÖÉÁ¥†Âá∫Áé∞ÁöÑÊ¨°Êï∞countList = [1, 1, 2, 0, 0, 1] a countList[a] Âç≥ÈÅçÂéÜÊ¨°Êï∞ tempList[index] 0 1 tempList[0] = 1 1 1 tempList[1] = 2 2 2 tempList[2] = 3‰ª•ÂèätempList[3] = 3 3 0 4 0 5 1 tempList[4] = 6 ÊéíÂ∫èÊàêÂäü:1, 2, 3, 3, 6 ÂçÅ„ÄÅÊÄªÁªìÁÆóÊ≥ïÂàÜÊûêÔºö ‰ª£Á†Å‰øùÂ≠òÂú®GitHub‰∏ä„ÄÇ ÂèÇËÄÉËµÑÊñôÔºö„ÄäÂ§ßËØùÊï∞ÊçÆÁªìÊûÑ„ÄãÁª¥Âü∫ÁôæÁßësegmentfaultWuChongbubkoo]]></content>
      <tags>
        <tag>Python</tag>
        <tag>ÁÆóÊ≥ï</tag>
        <tag>ÊéíÂ∫è</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSËá™ÂÆö‰πâËΩ¨Âú∫ÊÄªÁªì]]></title>
    <url>%2F2017%2F02%2F26%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AC%E5%9C%BA%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[Ëá™ÂÆö‰πâËΩ¨Âú∫ÊÄªÁªì„ÄÇ ‰∏Ä„ÄÅÂãæÂº¶ËΩ¨Âú∫ÁöÑÊú¨Ë¥®ÊòØ‰∏ã‰∏ÄÂú∫ÊôØÁöÑËßÜÂõæÊõøÊç¢ÂΩìÂâçÂú∫ÊôØÁöÑËßÜÂõæ‰ª•ÂèäÁõ∏Â∫îÁöÑÊéßÂà∂Âô®ÁöÑÊõøÊç¢ÔºåË°®Áé∞‰∏∫ÂΩìÂâçËßÜÂõæÊ∂àÂ§±Âíå‰∏ã‰∏ÄËßÜÂõæÂá∫Áé∞„ÄÇÂÆπÂô®Á±ª VC ÁöÑËΩ¨Âú∫Èáå fromView Âíå toView ÊòØ containerView ÁöÑÂ≠êÂ±ÇÊ¨°ÁöÑËßÜÂõæÔºåËÄå Modal ËΩ¨Âú∫Èáå presentingView ‰∏éontainerView ÊòØÂêåÂ±ÇÊ¨°ÁöÑËßÜÂõæÔºåÂè™Êúâ presentedView ÊòØ containerView ÁöÑÂ≠êÂ±ÇÊ¨°ËßÜÂõæ„ÄÇCustom Ê®°Âºè‰∏ã Modal ËΩ¨Âú∫ÁªìÊùüÊó∂ fromView Âπ∂Êú™‰ªéËßÜÂõæÁªìÊûÑ‰∏≠ÁßªÈô§ÔºõFullScreen Ê®°ÂºèÁöÑ Modal ËΩ¨Âú∫ÁªìÊùüÂêé fromView ‰∏ªÂä®Ë¢´‰ªéËßÜÂõæÁªìÊûÑ‰∏≠ÁßªÈô§‰∫Ü„ÄÇCustom Ê®°Âºè‰∏ãÔºåÂú® dismiss ‰∏≠Ôºå‰∏çË¶ÅÂÉèÂÖ∂‰ªñËΩ¨Âú∫‰∏≠ÈÇ£Ê†∑Â∞Ü toViewÂä†ÂÖ• containerView ‰∏≠ÔºåÂê¶Âàô dismiss ÁªìÊùüÂêéÊú¨Êù•ÂèØËßÅÁöÑ presentingView Â∞Ü‰ºöÈöèÁùÄ containerView ‰∏ÄËµ∑Ë¢´ÁßªÈô§„ÄÇ Âú® Modal ËΩ¨Âú∫‰∏≠ÔºåpresentingView Âπ∂Èùû containerView ÁöÑÂ≠êËßÜÂõæÔºåËøôÊó∂ÈÄöËøáviewForKey:ÊñπÊ≥ïÊù•Ëé∑ÂèñpresentingView ÂæóÂà∞ÁöÑÊòØ nilÔºåÂøÖÈ°ªÈÄöËøáviewControllerForKey:ÂæóÂà∞presentingVC ÂêéÊù•Ëé∑Âèñ„ÄÇÂΩì UIViewController ÁöÑmodalPresentationStyleÂ±ûÊÄß‰∏∫.Custom Êàñ.FullScreenÊó∂ÔºåÂ∞±ÊúâÊú∫‰ºöÂÆöÂà∂ËΩ¨Âú∫ÊïàÊûúÔºåÊ≠§Êó∂modalTransitionStyleÊåáÂÆöÁöÑËΩ¨Âú∫Âä®ÁîªÂ∞Ü‰ºöË¢´ÂøΩÁï•„ÄÇ ÂÆπÂô® VC ÁöÑËΩ¨Âú∫ÁöÑ‰ª£ÁêÜÁî±ÂÆπÂô® VC Ëá™Ë∫´Êèê‰æõÔºåModal ËΩ¨Âú∫ÁöÑ‰ª£ÁêÜÁî± presentedVC(ÁõÆÊ†áÊéßÂà∂Âô®) Êèê‰æõ„ÄÇModal ËΩ¨Âú∫Âú® Custom Ê®°Âºè‰∏ãÂøÖÈ°ªÂå∫ÂàÜ presentation Âíå dismiss ËΩ¨Âú∫ÔºåËÄåÂú® FullScreen Ê®°Âºè‰∏ãÂèØ‰ª•‰∏çÁî®Ëøô‰πàÂÅöÔºåÂõ†‰∏∫ UIKit ‰ºöÂú® dismiss ËΩ¨Âú∫ÁªìÊùüÂêéËá™Âä®Â∞Ü presentingView ÊîæÁΩÆÂà∞ÂéüÊù•ÁöÑ‰ΩçÁΩÆ„ÄÇËΩ¨Âú∫‰ª£ÁêÜÔºàTransitioning DelegateÔºâÊ†πÊçÆ‰∏çÂêåÁöÑËΩ¨Âú∫Á±ªÂûãÊèê‰æõÂÖ∂ÊâÄÈúÄË¶ÅÁöÑÂä®ÁîªÊéßÂà∂Á±ªÂíå‰∫§‰∫íÊéßÂà∂Á±ª„ÄÇ Âä®ÁîªÊéßÂà∂Á±ª(Âô®)ÔºàAnimation ControllerÔºâÈÅµ‰ªéUIViewControllerAnimatedTransitioningÂçèËÆÆÔºåÂπ∂‰∏îË¥üË¥£ÊâßË°åÂÆûÈôÖÁöÑÂä®Áîª„ÄÇ‰∫§‰∫íÊéßÂà∂Á±ª(Âô®)ÔºàInteraction ControllerÔºâÈÅµ‰ªéUIViewControllerInteractiveTransitionÂçèËÆÆÊù•ÊéßÂà∂ÂèØ‰∫§‰∫íÁöÑËΩ¨Âú∫Âä®Áîª„ÄÇËΩ¨Âú∫‰∏ä‰∏ãÊñáÔºàTransitioning ContextÔºâÂÆö‰πâ‰∫ÜËΩ¨Âú∫Êó∂ÈúÄË¶ÅÁöÑÂÖÉÊï∞ÊçÆÔºàÊØîÂ¶ÇËΩ¨Âú∫ÊâÄÂèÇ‰∏é‰∫ÜÁöÑËßÜÂõæÊéßÂà∂Âô®ÂíåËßÜÂõæÁöÑÂ±ûÊÄßÔºâÔºåÂÖ∂ÈÅµ‰ªéUIViewControllerContextTransitioningÂçèËÆÆÔºåÂπ∂‰∏îËøôÊòØÁî±Á≥ªÁªüË¥üË¥£ÁîüÊàêÂíåÊèê‰æõ„ÄÇ ËΩ¨Âú∫ÂçèË∞ÉÂô®ÔºàTransition CoordinatorsÔºâÂèØ‰ª•Âú®ËøêË°åËΩ¨Âú∫Âä®ÁîªÊó∂ÔºåÂπ∂Ë°åÂú∞ËøêË°åÂÖ∂‰ªñÂä®Áîª„ÄÇËΩ¨Âú∫ÂçèË∞ÉÂô®ÈÅµ‰ªéUIViewControllerTransitionCoordinatorÂçèËÆÆ„ÄÇËΩ¨Âú∫Âä®Áîª‰∫§‰∫íÊñπÂºèÂàÜ‰∏§ÁßçÔºåÁ¨¨‰∏ÄÁßçÊòØÂ±û‰∫éÈùû‰∫§‰∫íÂºèÔºöÂøÖÈ°ªË¶ÅÂÆûÁé∞Âä®ÁîªÊéßÂà∂Á±ªÔºåÁ¨¨‰∫åÁßç‰∫§‰∫íÊñπÂºèÔºöÂøÖÈ°ªË¶ÅÂÆûÁé∞Âä®ÁîªÊéßÂà∂Á±ªÂíå‰∫§‰∫íÊéßÂà∂Á±ªÔºà‰æãÂ¶ÇÂèØ‰ª•ÈÄöËøáÊâãÂäøÁöÑÊªëÂä®Ë∑ùÁ¶ªÊù•ÊéßÂà∂ËΩ¨Âú∫Âä®ÁîªÁöÑ‰∏Ä‰∏™ËøõÂ∫¶Ôºå‰∏ÄËà¨Â∫îÁî®‰∏≠ÈÉΩÂèØ‰ª•ÈÄöËøáÊâãÂäøÁöÑÊªëÂä®Êù•Êé®Âá∫‰∏Ä‰∏™ËßÜÂõæÊéßÂà∂Âô®)„ÄÇ ‰∫å„ÄÅÁÆÄÂçïËΩ¨Âú∫Âü∫Êú¨Á±ªÂûã UIViewAnimationOptionLayoutSubviewsÔºöÂä®ÁîªËøáÁ®ã‰∏≠‰øùËØÅÂ≠êËßÜÂõæË∑üÈöèËøêÂä®„ÄÇUIViewAnimationOptionAllowUserInteractionÔºöÂä®ÁîªËøáÁ®ã‰∏≠ÂÖÅËÆ∏Áî®Êà∑‰∫§‰∫í„ÄÇUIViewAnimationOptionBeginFromCurrentStateÔºöÊâÄÊúâËßÜÂõæ‰ªéÂΩìÂâçÁä∂ÊÄÅÂºÄÂßãËøêË°å„ÄÇUIViewAnimationOptionRepeatÔºöÈáçÂ§çËøêË°åÂä®Áîª„ÄÇUIViewAnimationOptionAutoreverse ÔºöÂä®ÁîªËøêË°åÂà∞ÁªìÊùüÁÇπÂêé‰ªçÁÑ∂‰ª•Âä®ÁîªÊñπÂºèÂõûÂà∞ÂàùÂßãÁÇπ„ÄÇUIViewAnimationOptionOverrideInheritedDurationÔºöÂøΩÁï•ÂµåÂ•óÂä®ÁîªÊó∂Èó¥ËÆæÁΩÆ„ÄÇUIViewAnimationOptionOverrideInheritedCurveÔºöÂøΩÁï•ÂµåÂ•óÂä®ÁîªÈÄüÂ∫¶ËÆæÁΩÆ„ÄÇUIViewAnimationOptionAllowAnimatedContentÔºöÂä®ÁîªËøáÁ®ã‰∏≠ÈáçÁªòËßÜÂõæÔºàÊ≥®ÊÑè‰ªÖ‰ªÖÈÄÇÁî®‰∫éËΩ¨Âú∫Âä®ÁîªÔºâ„ÄÇ UIViewAnimationOptionShowHideTransitionViewsÔºöËßÜÂõæÂàáÊç¢Êó∂Áõ¥Êé•ÈöêËóèÊóßËßÜÂõæ„ÄÅÊòæÁ§∫Êñ∞ËßÜÂõæÔºåËÄå‰∏çÊòØÂ∞ÜÊóßËßÜÂõæ‰ªéÁà∂ËßÜÂõæÁßªÈô§Ôºà‰ªÖ‰ªÖÈÄÇÁî®‰∫éËΩ¨Âú∫Âä®ÁîªÔºâUIViewAnimationOptionOverrideInheritedOptions Ôºö‰∏çÁªßÊâøÁà∂Âä®ÁîªËÆæÁΩÆÊàñÂä®ÁîªÁ±ªÂûã„ÄÇ Âä®ÁîªÈÄüÂ∫¶ÊéßÂà∂ÔºàÂèØ‰ªéÂÖ∂‰∏≠ÈÄâÊã©‰∏Ä‰∏™ËÆæÁΩÆÔºâ UIViewAnimationOptionCurveEaseInOutÔºöÂä®ÁîªÂÖàÁºìÊÖ¢ÔºåÁÑ∂ÂêéÈÄêÊ∏êÂä†ÈÄü„ÄÇUIViewAnimationOptionCurveEaseIn ÔºöÂä®ÁîªÈÄêÊ∏êÂèòÊÖ¢„ÄÇUIViewAnimationOptionCurveEaseOutÔºöÂä®ÁîªÈÄêÊ∏êÂä†ÈÄü„ÄÇUIViewAnimationOptionCurveLinear ÔºöÂä®ÁîªÂåÄÈÄüÊâßË°åÔºåÈªòËÆ§ÂÄº„ÄÇ ËΩ¨Âú∫Á±ªÂûãÔºà‰ªÖÈÄÇÁî®‰∫éËΩ¨Âú∫Âä®ÁîªËÆæÁΩÆÔºåÂèØ‰ª•‰ªé‰∏≠ÈÄâÊã©‰∏Ä‰∏™ËøõË°åËÆæÁΩÆÔºåÂü∫Êú¨Âä®Áîª„ÄÅÂÖ≥ÈîÆÂ∏ßÂä®Áîª‰∏çÈúÄË¶ÅËÆæÁΩÆÔºâ UIViewAnimationOptionTransitionNoneÔºöÊ≤°ÊúâËΩ¨Âú∫Âä®ÁîªÊïàÊûú„ÄÇUIViewAnimationOptionTransitionFlipFromLeft Ôºö‰ªéÂ∑¶‰æßÁøªËΩ¨ÊïàÊûú„ÄÇUIViewAnimationOptionTransitionFlipFromRightÔºö‰ªéÂè≥‰æßÁøªËΩ¨ÊïàÊûú„ÄÇUIViewAnimationOptionTransitionCurlUpÔºöÂêëÂêéÁøªÈ°µÁöÑÂä®ÁîªËøáÊ∏°ÊïàÊûú„ÄÇUIViewAnimationOptionTransitionCurlDown ÔºöÂêëÂâçÁøªÈ°µÁöÑÂä®ÁîªËøáÊ∏°ÊïàÊûú„ÄÇUIViewAnimationOptionTransitionCrossDissolveÔºöÊóßËßÜÂõæÊ∫∂Ëß£Ê∂àÂ§±ÊòæÁ§∫‰∏ã‰∏Ä‰∏™Êñ∞ËßÜÂõæÁöÑÊïàÊûú„ÄÇUIViewAnimationOptionTransitionFlipFromTop Ôºö‰ªé‰∏äÊñπÁøªËΩ¨ÊïàÊûú„ÄÇUIViewAnimationOptionTransitionFlipFromBottomÔºö‰ªéÂ∫ïÈÉ®ÁøªËΩ¨ÊïàÊûú„ÄÇ ÁÆÄÂçï‰ΩøÁî®‰ΩúÁî®‰∫éfromViewÁöÑÁà∂ËßÜÂõæÔºåÂàáÊç¢‰∏§‰∏™viewÔºåÂ∞ÜformView‰ªéÂÖ∂Áà∂ËßÜÂõæ‰∏äÁßªÈô§ÔºåÂ∞ÜtoViewÈáçÊñ∞Á≤òÂú®ÂÖ∂Áà∂ËßÜÂõæ‰∏äÔºåÂ±ïÁé∞‰∏Ä‰∏™Âä®ÁîªÊïàÊûú„ÄÇ [UIView transitionFromView:self.view toView:redView duration:5.0 options: UIViewAnimationOptionCurveLinear completion:^(BOOL finished) &#123; kLog(@"ËΩ¨Âú∫Âä®ÁîªÂÆåÊàê");&#125;]; ÈáçÁªòViewËßÜÂõæÔºå‰ªª‰ΩïÂÖ∂Â≠êËßÜÂõæÁöÑÊîπÂèòÊàñËÄÖÂÖ∂Ëá™Ë∫´ÁöÑÊîπÂèòÈÉΩ‰ºöËß¶ÂèëËΩ¨Âú∫Âä®ÁîªÁöÑÊïàÊûú„ÄÇ [UIView transitionWithView:self.view duration:2.0 options: UIViewAnimationOptionCurveLinear animations:^&#123; self.view.alpha = 0.1;&#125; completion:^(BOOL finished) &#123; kLog(@"Âä®ÁîªÂÆåÊàê");&#125;]; ‰∏â„ÄÅÊ®°ÊÄÅËΩ¨Âú∫Ê∫êÊéßÂà∂Âô®A‚Äì&gt;ÁõÆÊ†áÊéßÂà∂Âô®B„ÄÇ (1) ÊèêË¶ÅÂèØ‰ª•Âè™‰ΩøÁî®‰∏Ä‰∏™Âä®ÁîªÊéßÂà∂Âô®AnimatorÔºå‰ΩÜÊòØË¶ÅÂØπPresent/DismissÂàÜÂà´ÂÆûÁé∞„ÄÇÊ®°ÊÄÅÁöÑÁ±ªÂûãÈªòËÆ§‰∏∫FullScreenÔºåÂç≥Âú®PresentÊó∂Ôºå‰ºöÁßªÈô§fromViewÔºåËÄåÁ±ªÂûãËÆæÁΩÆ‰∏∫CustomÊó∂ÔºåÂ∞±‰ºö‰ΩøfromView‰∏étoViewÂÖ±Â≠ò„ÄÇpresentÊó∂ÔºåË¶ÅÊäätoViewÂä†ÂÖ•Âà∞containerÁöÑËßÜÂõæÂ±ÇÁ∫ßÔºådismissÊó∂ÔºåË¶ÅÊääfromView‰ªécontainerÁöÑËßÜÂõæÂ±ÇÁ∫ß‰∏≠ÁßªÈô§„ÄÇÈùû‰∫§‰∫íÂºèËΩ¨Âú∫ÔºåÈúÄË¶ÅÂú®Âä®ÁîªÊâßË°åÂÆåÊØïÂ£∞Êòécomplete[transitionContext completeTransition:YES];‰∫§‰∫íÂºèËΩ¨Âú∫ÔºåÈúÄË¶ÅÂà§Êñ≠ËΩ¨Âú∫ÂÆåÊàêÊàñËÄÖÂèñÊ∂à„ÄÇ BOOL isCancelled = transitionContext.transitionWasCancelled;// ËÄÉËôëÂà∞ËΩ¨Âú∫‰∏≠ÈÄîÂèØËÉΩÂèñÊ∂àÁöÑÊÉÖÂÜµÔºåËΩ¨Âú∫ÁªìÊùüÂêéÔºåÊÅ¢Â§çËßÜÂõæÁä∂ÊÄÅ„ÄÇfromView.transform = CGAffineTransformIdentity;toView.transform = CGAffineTransformIdentity; Âú®Ê®°ÊÄÅ‰∏≠ÔºåËÆæÁΩÆÂ∞ÜË¶ÅË∑≥ËΩ¨Âà∞ÁöÑËßÜÂõæÊéßÂà∂Âô®(presentedViewController)ÁöÑtransitioningDelegate„ÄÇÂÖÖÂΩì‰ª£ÁêÜÁöÑÂØπË±°ÂèØ‰ª•ÊòØÊ∫êËßÜÂõæÊéßÂà∂Âô®(presentingViewController)Ôºå‰πüÂèØ‰ª•ÊòØËá™Â∑±ÂàõÂª∫ÁöÑÂØπË±°ÔºåÂÆÉÈúÄË¶Å‰∏∫ËΩ¨Âú∫Âä®ÁîªÊèê‰æõ‰∏Ä‰∏™animatorÂØπË±°„ÄÇanimatorÂØπË±°ÁöÑanimateTransitionÊòØÊï¥‰∏™Âä®ÁîªÁöÑÊ†∏ÂøÉÈÄªËæë„ÄÇ (2) Êó†‰∫§‰∫íËÆæÁΩÆÁõÆÊ†áÊéßÂà∂Âô®BÁöÑ‰ª£ÁêÜ(ÂèØ‰ª•ÊòØAÔºå‰πüÂèØ‰ª•ÊòØB)‰ª•ÂèäÊ®°ÊÄÅÂä®ÁîªÁ±ªÂûã(Â∏∏Áî®UIModalPresentationCustomÊàñUIModalPresentationFullScreen)„ÄÇ YAShareViewController *shareViewController = [[YAShareViewController alloc] init]; // ËÆæÁΩÆËΩ¨Âú∫‰ª£ÁêÜshareViewController.transitioningDelegate = self;// ËÆæÁΩÆËΩ¨Âú∫Âä®ÁîªÁ±ªÂûãshareViewController.modalPresentationStyle = UIModalPresentationCustom;[self presentViewController:shareViewController animated:YES completion:nil]; // ÁõÆÊ†áÊéßÂà∂Âô®ÁöÑ‰ª£ÁêÜÈÅµÂÆàUIViewControllerTransitioningDelegateÂçèËÆÆÂπ∂Áõ∏ÂÖ≥ÂÆûÁé∞ÊñπÊ≥ï#pragma mark - Transitioning Delegate// Êó†‰∫§‰∫íÂá∫Áé∞Âä®Áîª- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForPresentedController:(UIViewController *)presented presentingController:(UIViewController *)presenting sourceController:(UIViewController *)source &#123; YATransitionAnimator *animator = [YATransitionAnimator transitionAnimatorWithType:TransitionAnimatorPresent]; return animator;&#125; // Êó†‰∫§‰∫íÊ∂àÂ§±Âä®Áîª- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForDismissedController:(UIViewController *)dismissed &#123; YATransitionAnimator *animator = [YATransitionAnimator transitionAnimatorWithType:TransitionAnimatorDismiss]; return animator;&#125; ‰ª£ÁêÜÊñπÊ≥ï‰∏≠ÁöÑÂä®ÁîªÁÆ°ÁêÜËÄÖAnimatorÁã¨Á´ãÂ≠òÂú®ÔºåÂèØ‰ª•Êñ∞Âª∫‰∏ÄÁªßÊâøËá™NSObject‰∏îÈÅµÂÆàUIViewControllerAnimatedTransitioningÂçèËÆÆÁöÑÂØπË±°ÊãÖ‰ªª(‰ªÖ‰ªÖÈÅµÂÆàÂçèËÆÆÂÆûÁé∞ÊñπÊ≥ïÂç≥ÂèØÔºå‰∏çÈúÄËÆæÁΩÆ‰ª£ÁêÜ)„ÄÇ #pragma mark ‚Äì Life Cycle + (instancetype)transitionAnimatorWithType:(TransitionAnimatorType)transitionAnimatorType &#123; YATransitionAnimator *animator = [[YATransitionAnimator alloc] init]; animator.transitionAnimatorType = transitionAnimatorType; return animator;&#125; #pragma mark - AnimatedTransitioning delegate //ËøîÂõûÂä®ÁîªÊó∂Èó¥- (NSTimeInterval)transitionDuration:(nullable id &lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; return 5.0;&#125; //ÊâßË°åÂä®ÁîªÁöÑÂú∞Êñπ- (void)animateTransition:(id &lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; // 1.Ëé∑ÂèñÂä®ÁîªÂøÖË¶ÅÂÖÉÁ¥† UIView *containerView = [transitionContext containerView]; UIView *fromView = [transitionContext viewForKey:UITransitionContextFromViewKey]; UIView *toView = [transitionContext viewForKey:UITransitionContextToViewKey]; toView.origin = CGPointMake(0Ôºå kScreenHeight); // 2.Âä®Áîª // Âá∫Âú∫ if (self.transitionAnimatorType == TransitionAnimatorPresent) &#123; // 2.Ê∑ªÂä†toViewÔºå‰∏ç‰∏ÄÂÆöÊòØaddSubviewÊñπÂºè [containerView addSubview:toView]; [UIView animateWithDuration:2.5 animations:^&#123; toView.origin = CGPointMake(0Ôºå 0); &#125; completion:^(BOOL finished) &#123; // ÂÆåÊàê [transitionContext completeTransition:YES]; &#125;]; &#125; // Ê∂àÂ§± if (self.transitionAnimatorType == TransitionAnimatorDismiss) &#123; [UIView animateWithDuration:2.5 animations:^&#123; fromView.origin = CGPointMake(0Ôºå kScreenHeight); &#125; completion:^(BOOL finished) &#123; // 2.Ê∑ªÂä†toViewÔºå‰∏ç‰∏ÄÂÆöÊòØaddSubviewÊñπÂºè [fromView removeFromSuperview]; // ÂÆåÊàê [transitionContext completeTransition:YES]; &#125;]; &#125;&#125; (3) ‰∫§‰∫í(ÂùëÂ§öÔºåÊâÄ‰ª•‰∏ÄËà¨‰∏çÁî®‰∏ãÂàóÊñπÂºèÔºåÂèñËÄå‰ª£‰πã‰ΩøÁî®UIPresentationController„ÄÇ) Âú®ÁõÆÊ†áÊéßÂà∂Âô®ÁöÑ‰ª£ÁêÜÊñπÊ≥ï‰∏≠ÔºåÂÆûÁé∞‰∫§‰∫íÂºè‰ª£ÁêÜÊñπÊ≥ï: // 2.‰∫§‰∫íÂá∫Áé∞Âä®Áîª- (nullable id &lt;UIViewControllerInteractiveTransitioning&gt;)interactionControllerForPresentation:(id &lt;UIViewControllerAnimatedTransitioning&gt;)animator &#123; return [[YAInteractiveTransition alloc] init];&#125;// 2.‰∫§‰∫íÊ∂àÂ§±Âä®Áîª- (nullable id &lt;UIViewControllerInteractiveTransitioning&gt;)interactionControllerForDismissal:(id &lt;UIViewControllerAnimatedTransitioning&gt;)animator &#123; return [[YAInteractiveTransition alloc] init];&#125; Êñ∞Âª∫‰∏ÄÁªßÊâøËá™UIPercentDrivenInteractiveTransitionÁöÑ‰∫§‰∫íÁªÑ‰ª∂Á±ª(ÊúÄÂ•ΩËøô‰πàÂÅöÔºå‰πüÂèØ‰ª•Ëá™ÂÆö‰πâÁ±ªÈÅµÂÆàUIViewControllerInteractiveTransitioningÂçèËÆÆÔºå‰ΩÜÊûÅ‰∏çÊé®Ëçê)ÔºåÂÆûÁé∞ÂøÖÈ°ªÁöÑstartInteractiveTransitionÊñπÊ≥ï„ÄÇ - (void)startInteractiveTransition:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123;&#125; (4) UIPresentationControlleriOS8ÂêéÁöÑÊñ∞APIÔºåÊûÅÂÖ∂Êñπ‰æø„ÄÇÊääÁÆ°ÁêÜÊùÉÈôê‰∫§ÁªôUIPresentationController„ÄÇËÆæÁΩÆÊ®°ÊÄÅÂä®ÁîªÁ±ªÂûãÂêéÔºåÂè™ÈúÄË¶ÅÂú®ÁõÆÊ†áÊéßÂà∂Âô®ÁöÑ‰ª£ÁêÜÊñπÊ≥ï‰∏≠ÂÆûÁé∞: - (nullable UIPresentationController *)presentationControllerForPresentedViewController:(UIViewController *)presented presentingViewController:(nullable UIViewController *)presenting sourceViewController:(UIViewController *)source &#123; return [[YAPresentationController alloc] initWithPresentedViewController:presented presentingViewController:presenting];&#125; ÈÇ£‰πàÊâÄÊúâÁöÑÂ∑•‰ΩúÂ∞±Âú®YAPresentationControllerÊéßÂà∂Âô®‰∏≠‰∫Ü„ÄÇÂÆûÁé∞Áõ∏Â∫îÁöÑÊñπÊ≥ï: //Âú®ÂëàÁé∞ËøáÊ∏°Âç≥Â∞ÜÂºÄÂßãÁöÑÊó∂ÂÄôË¢´Ë∞ÉÁî®ÁöÑ- (void)presentationTransitionWillBegin&#123; // Ê∫êÊéßÂà∂Âô®ÁöÑView [self.containerView addSubview:self.presentingViewController.view]; // ËÉåÊôØView [self.containerView addSubview:self.backgroundView]; // ÁõÆÊ†áÊéßÂà∂Âô®View [self.containerView addSubview:self.presentedView]; &#125; //Âú®ÂëàÁé∞ËøáÊ∏°ÁªìÊùüÊó∂Ë¢´Ë∞ÉÁî®ÁöÑ- (void)presentationTransitionDidEnd:(BOOL)completed&#123; &#125; //Âú®ÈÄÄÂá∫ËøáÊ∏°Âç≥Â∞ÜÂºÄÂßãÁöÑÊó∂ÂÄôË¢´Ë∞ÉÁî®ÁöÑ- (void)dismissalTransitionWillBegin&#123; &#125; //Âú®ÈÄÄÂá∫ÁöÑËøáÊ∏°ÁªìÊùüÊó∂Ë¢´Ë∞ÉÁî®ÁöÑ- (void)dismissalTransitionDidEnd:(BOOL)completed&#123; &#125; // Ë∞ÉÊï¥ÂëàÁé∞ÁöÑViewÁöÑframe- (CGRect)frameOfPresentedViewInContainerView&#123; &#125; Âõõ„ÄÅNavigationControllerËΩ¨Âú∫ËÆæÁΩÆÊ∫êÊéßÂà∂Âô®ÁöÑÂØºËà™ÊéßÂà∂Âô®ÁöÑ‰ª£ÁêÜÔºåÈÅµÂÆàUINavigationControllerDelegateÂçèËÆÆÔºåÊ†πÊçÆ‰∫§‰∫íÂºèÊàñËÄÖÈùû‰∫§‰∫íÂºèÂÆûÁé∞Áõ∏Â∫îÊñπÊ≥ï.Âú®ÊñπÊ≥ï‰∏≠Ê†πÊçÆPushÊàñËÄÖPopËøîÂõûÁõ∏Â∫îÁöÑËá™ÂÆö‰πâÂä®ÁîªÊéßÂà∂Âô®(ÊàñËÄÖ‰∫§‰∫íÊéßÂà∂Âô®)„ÄÇ // ‰∫§‰∫íÂºè- (nullable id &lt;UIViewControllerInteractiveTransitioning&gt;)navigationController:(UINavigationController *)navigationController interactionControllerForAnimationController:(id &lt;UIViewControllerAnimatedTransitioning&gt;) animationController &#123; &#125; // Èùû‰∫§‰∫íÂºè- (nullable id &lt;UIViewControllerAnimatedTransitioning&gt;)navigationController:(UINavigationController *)navigationController animationControllerForOperation:(UINavigationControllerOperation)operation fromViewController:(UIViewController *)fromVC toViewController:(UIViewController *)toVC &#123; // PushÊÉÖÂÜµ‰∏ã if (operation == UINavigationControllerOperationPush) &#123; return [YATransitionAnimator transitionAnimatorWithType:TransitionAnimatorPush]; &#125; else if (operation == UINavigationControllerOperationPop) &#123; // PopÊÉÖÂÜµ‰∏ã return [YATransitionAnimator transitionAnimatorWithType:TransitionAnimatorPop]; &#125; else &#123; return nil; &#125; &#125; ‰∫î„ÄÅTabBarControllerËΩ¨Âú∫‰∏éÂØºËà™ÊéßÂà∂Âô®Á±ª‰ººÔºåËÆæÁΩÆÊ∫êÊéßÂà∂Âô®ÁöÑtabBarControllerÁöÑ‰ª£ÁêÜÔºåÈÅµÂæ™UITabBarControllerDelegateÔºåÂÆûÁé∞Áõ∏Â∫îÁöÑÊñπÊ≥ïÔºåÂè™‰∏çËøáÂÆÉÊó¢Ê≤°ÊúâÊ®°ÊÄÅÁöÑPresentÂíåDismissÔºå‰πüÊ≤°ÊúâÂØºËà™ÊéßÂà∂Âô®ÁöÑPushÂíåPopÔºåÂè™Êúâ‰∏ÄÁßçÊñπÂºèÔºåÊõ¥Âä†ÁÆÄÂçïÔºåÂêåÊ†∑ÔºåÂú®ÊñπÊ≥ï‰∏≠ËøîÂõûËá™ÂÆö‰πâÁöÑÂä®ÁîªÊéßÂà∂Âô®(ÊàñËÄÖ‰∫§‰∫íÊéßÂà∂Âô®)„ÄÇ - (id &lt;UIViewControllerInteractiveTransitioning&gt;)tabBarController:(UITabBarController *)tabBarController interactionControllerForAnimationController: (id &lt;UIViewControllerAnimatedTransitioning&gt;)animationController &#123;&#125; - (id &lt;UIViewControllerAnimatedTransitioning&gt;)tabBarController:(UITabBarController *)tabBarController animationControllerForTransitionFromViewController:(UIViewController *)fromVC toViewController:(UIViewController *)toVC &#123;&#125;]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Git/LLDB/LinuxÁ≠âÂ∏∏Áî®ÂëΩ‰ª§]]></title>
    <url>%2F2017%2F02%2F20%2FGit%3ALLDB%3ALinux%E7%AD%89%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[2017.4.3 Ë°•ÂÖÖClangÊåá‰ª§ Git/SVN/Linux/Vim/LLDBÁ≠âÂ∏∏Áî®„ÄÅÂø´ÂøòËÆ∞ÁöÑÂëΩ‰ª§ÊÄªÁªì„ÄÇ CocoaPodspod install --verbose --no-repo-update GitÊ∫ê‰ª£Á†ÅÁÆ°ÁêÜÂ∑•ÂÖ∑ËÉΩËøΩË∏™‰∏Ä‰∏™È°πÁõÆ‰ªéËØûÁîü‰∏ÄÁõ¥Âà∞ÂÆöÊ°àÁöÑËøáÁ®ãÔºåËÆ∞ÂΩï‰∏Ä‰∏™È°πÁõÆÁöÑÊâÄÊúâÂÜÖÂÆπÂèòÂåñÔºåÊñπ‰æøÂú∞Êü•ÈòÖÁâπÂÆöÁâàÊú¨ÁöÑ‰øÆËÆ¢ÊÉÖÂÜµ„ÄÇ Git‰∏éSVNÁöÑÂØπÊØî:1.GitÊòØÂàÜÂ∏ÉÂºèÔºåÊúâÊú¨Âú∞ÂàÜÊîØÔºåSVNÊòØÈõÜ‰∏≠ÂºèÔºåÊó†Êú¨Âú∞ÂàÜÊîØ„ÄÇ2.gitÂêàÂπ∂Êìç‰Ωú‰øùÁïôÂéüÊúâÁöÑÊèê‰∫§ËøáÁ®ãÔºàÂç≥‰øùÁïô‰∫ÜÂêàÂπ∂Êù•Ê∫êÁöÑ‰ΩúËÄÖ„ÄÅÊèê‰∫§Ê¨°Êï∞„ÄÅÂàÜÁ¶ªÊèê‰∫§ÁöÑÂÜÖÂÆπÔºâ„ÄÇsvnÂêàÂπ∂Êìç‰ΩúÊääÊù•Ê∫êÂ§ö‰∏™Êèê‰∫§ÂêàÂπ∂Êàê‰∫Ü‰∏Ä‰∏™ÂêàÂπ∂Êèê‰∫§„ÄÇ3.gitÔºöÂèØ‰ª•‰øÆÊ≠£Êèê‰∫§(Âú®Ëá™Â∑±ÁöÑÂàÜÊîØ)„ÄÇsvnÔºö‰∏ÄÊó¶Êèê‰∫§Â∞±Âà∞ÊúçÂä°Âô®‰∏äÔºåÂÆûÈôÖ‰ΩøÁî®‰∏≠Â∞±ÊòØ‰∏çËÉΩ‰øÆÊîπ„ÄÇ4.SVNÊ≤°ÊúâtagÂíåÁúüÊ≠£ÊÑè‰πâÁöÑÂàÜÊîØ(ÂÆÉÁöÑÂàÜÊîØÊòØ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÁõÆÂΩï„ÄÇ‰∏îËøô‰∏™ÁõÆÂΩïÊã•ÊúâÂÆåÊï¥ÁöÑÂÆûÈôÖÊñá‰ª∂)ÔºåGitÊîØÊåÅ„ÄÇ5.GitÊúâÊöÇÂ≠òÂå∫ÔºåÊèê‰∫§ÈÄüÂ∫¶Âø´„ÄÇ ÂºÄÂßã1.Ê∏ÖÈô§Êú¨Âú∞‰ª•ÂèäËøúÁ®ãÁöÑ.DS_StoreÊñá‰ª∂(‰øÆÂ§çÂêéÊ∑ªÂä†.gitignore) find . -name .DS_Store -print0 | xargs -0 git rm -f --ignore-unmatch 2.ÂÖãÈöÜ‰ªìÂ∫ìÂà∞Êú¨Âú∞ git clone https://github.com/ChenYalun/a.git 3.Ê∑ªÂä†ÂøΩÁï•Êñá‰ª∂ git add .gitignore 4.Êèê‰∫§‰øÆÊîπ git commit -m &quot;Ê≥®Èáä&quot; 5.Êé®ÈÄÅÂà∞ËøúÁ®ã‰ªìÂ∫ì git push YAKit(‰ªìÂ∫ìÂêçÁß∞) origin(ÂàÜÊîØÂêçÁß∞) ÂàùÊ≠•Âú®git‰∏≠ÔºåÁâàÊú¨Âè∑ÊòØ‰∏Ä‰∏™Áî±SHA1ÁîüÊàêÁöÑÂìàÂ∏åÂÄº„ÄÇ Êü•ÁúãgitÊâÄÊúâÂëΩ‰ª§ÁöÑÂ∏ÆÂä© $ git help Â≠êÂëΩ‰ª§ # Ë¶ÅÈÄÄÂá∫Â∏ÆÂä©‰ø°ÊÅØÔºåÊåâ&quot;q&quot; # ÁøªÁúã‰∏ãÈ°µÔºåÊåâ&quot;Á©∫Ê†º&quot; # ÁøªÁúã‰∏äÈ°µÔºåÊåâ&quot;CTRL+B&quot; # Ë¶ÅÊêúÁ¥¢Áõ∏ÂÖ≥ÊñáÂ≠óÔºåÊåâ&quot;/&quot;ÁÑ∂ÂêéËæìÂÖ•&quot;Áõ∏ÂÖ≥ÊñáÂ≠ó&quot; ÈÖçÁΩÆ‰ª•ÂèäÂÖ®Â±ÄÈÖçÁΩÆ git config user.name &quot;chenyalun&quot; git config user.email iChenYalun@gmail.com git config --global user.name &quot;chenyalun&quot; git config --global user.email iChenYalun@gmail.com Êü•ÁúãÂΩìÂâçÊâÄÊúâÈÖçÁΩÆ git config -l ÁºñËæë(ÂÖ®Â±Ä)ÈÖçÁΩÆÊñá‰ª∂ git config -e [--global] Âú®ÂΩìÂâçÁõÆÂΩï‰∏ãÂàùÂßãÂåñ‰ªìÂ∫ì git init Êñ∞Âª∫‰∏Ä‰∏™ÁõÆÂΩïÔºåÂ∞ÜÂÖ∂ÂàùÂßãÂåñ‰∏∫Git‰ª£Á†ÅÂ∫ì git init [ÁõÆÂΩï] Ê∑ªÂä†ÊâÄÊúâÁöÑÊñá‰ª∂/ÊåáÂÆöÁöÑÊñá‰ª∂Âà∞ÊöÇÂ≠òÂå∫ git add . git add a.hÔºåa.m Ê∑ªÂä†ÁõÆÂΩïÂà∞ÊöÇÂ≠òÂå∫ git add [dir] Âà†Èô§Â∑•‰ΩúÂå∫Êñá‰ª∂ git rm a.h a.m ÂÅúÊ≠¢ËøΩË∏™ÊåáÂÆöÊñá‰ª∂,‰ΩÜÊòØÊñá‰ª∂‰ºö‰øùÂ≠òÂú®Â∑•‰ΩúÂå∫ git rm --cached a.h ÊîπÂêç,Âπ∂‰∏îÂ∞ÜËøô‰∏™ÊîπÂêçÊîæÂÖ•ÊöÇÂ≠òÂå∫ git mv old.h new.h Êèê‰∫§Êñá‰ª∂ÔºåÊ∑ªÂä†Ê≥®ÈáäÔºåË¶Å‰ΩøÁî® -m ÂèÇÊï∞ÊåáÂÆö‰øÆÊîπÁöÑÂ§áÊ≥®‰ø°ÊÅØ git commit -m &quot;ÂàùÂßãÂåñ‰ªìÂ∫ì&quot; ‰ΩøÁî®gitÊó∂ÔºåÊØè‰∏ÄÊ¨°‰øÆÊîπÈÉΩÈúÄË¶ÅÊ∑ªÂä†(add)ÂÜçÊèê‰∫§(commit)ÔºåËøô‰∏ÄÁÇπÊòØ‰∏ésvn‰∏ç‰∏ÄÊ†∑ Êü•ËØ¢‰ª£Á†ÅÂ∫ìÂΩìÂâçÁä∂ÊÄÅ(Â∑≤Âä†ËΩΩÔºåÊú™Âä†ËΩΩÁ≠â) git status Êü•ÁúãÊâÄÊúâÁâàÊú¨Â∫ìÊó•Âøó git log Êü•ÁúãÊåáÂÆöÊñá‰ª∂(a.m)ÁöÑÁâàÊú¨Â∫ìÊó•Âøó git log a.m ËøΩÂä†Êèê‰∫§ git commit -m &apos;initial commit&apos; git add forgotten_file git commit --amend Êí§ÈîÄÊüêÊ¨°Êèê‰∫§ git revert commitId Êèê‰∫§Êó∂ÊòæÁ§∫ÊâÄÊúâdiff‰ø°ÊÅØ git commit -v ‰ΩøÁî®‰∏ÄÊ¨°Êñ∞ÁöÑcommitÔºåÊõø‰ª£‰∏ä‰∏ÄÊ¨°Êèê‰∫§Â¶ÇÊûú‰ª£Á†ÅÊ≤°Êúâ‰ªª‰ΩïÊñ∞ÂèòÂåñÔºåÂàôÁî®Êù•ÊîπÂÜô‰∏ä‰∏ÄÊ¨°commitÁöÑÊèê‰∫§‰ø°ÊÅØ git commit --amend -m [message] ÈáçÂÅö‰∏ä‰∏ÄÊ¨°commitÔºåÂπ∂ÂåÖÊã¨ÊåáÂÆöÊñá‰ª∂ÁöÑÊñ∞ÂèòÂåñ git commit --amend a.h a.m ÁâàÊú¨ÊÅ¢Â§çÊöÇÂ≠òÂå∫ÁöÑÊåáÂÆöÊñá‰ª∂Âà∞Â∑•‰ΩúÂå∫ git checkout a.h ÊÅ¢Â§çÊüê‰∏™commitÁöÑÊåáÂÆöÊñá‰ª∂Âà∞ÊöÇÂ≠òÂå∫ÂíåÂ∑•‰ΩúÂå∫ git checkout [commit] [file] ÊÅ¢Â§çÊöÇÂ≠òÂå∫ÁöÑÊâÄÊúâÊñá‰ª∂Âà∞Â∑•‰ΩúÂå∫ git checkout . ÈáçÁΩÆÊöÇÂ≠òÂå∫ÁöÑÊåáÂÆöÊñá‰ª∂Ôºå‰∏é‰∏ä‰∏ÄÊ¨°commit‰øùÊåÅ‰∏ÄËá¥Ôºå‰ΩÜÂ∑•‰ΩúÂå∫‰∏çÂèò git reset a.h ÈáçÁΩÆÊöÇÂ≠òÂå∫‰∏éÂ∑•‰ΩúÂå∫Ôºå‰∏é‰∏ä‰∏ÄÊ¨°commit‰øùÊåÅ‰∏ÄËá¥ git reset --hard ÈáçÁΩÆÂΩìÂâçÂàÜÊîØÁöÑÊåáÈíà‰∏∫ÊåáÂÆöcommitÔºåÂêåÊó∂ÈáçÁΩÆÊöÇÂ≠òÂå∫Ôºå‰ΩÜÂ∑•‰ΩúÂå∫‰∏çÂèò git reset [commit] ÈáçÁΩÆÂΩìÂâçÂàÜÊîØÁöÑHEAD‰∏∫ÊåáÂÆöcommitÔºåÂêåÊó∂ÈáçÁΩÆÊöÇÂ≠òÂå∫ÂíåÂ∑•‰ΩúÂå∫Ôºå‰∏éÊåáÂÆöcommit‰∏ÄËá¥ git reset --hard [commit] ÈáçÁΩÆÂΩìÂâçHEAD‰∏∫ÊåáÂÆöcommitÔºå‰ΩÜ‰øùÊåÅÊöÇÂ≠òÂå∫ÂíåÂ∑•‰ΩúÂå∫‰∏çÂèò git reset --keep [commit] Êñ∞Âª∫‰∏Ä‰∏™commitÔºåÁî®Êù•Êí§ÈîÄÊåáÂÆöcommitÂêéËÄÖÁöÑÊâÄÊúâÂèòÂåñÈÉΩÂ∞ÜË¢´ÂâçËÄÖÊäµÊ∂àÔºåÂπ∂‰∏îÂ∫îÁî®Âà∞ÂΩìÂâçÂàÜÊîØ git revert [commit] ÊöÇÊó∂Â∞ÜÊú™Êèê‰∫§ÁöÑÂèòÂåñÁßªÈô§ÔºåÁ®çÂêéÂÜçÁßªÂÖ• git stash git stash pop Êü•ÁúãgitÁöÑÊÄªÊèê‰∫§Ê¨°Êï∞ git rev-list head | sort | wc -l ÂàÜÊîØÂàóÂá∫ÊâÄÊúâÊú¨Âú∞ÂàÜÊîØ git branch ÂàóÂá∫ÊâÄÊúâËøúÁ®ãÂàÜÊîØ git branch -r ÂàóÂá∫ÊâÄÊúâÊú¨Âú∞ÂàÜÊîØÂíåËøúÁ®ãÂàÜÊîØ git branch -a Êñ∞Âª∫‰∏Ä‰∏™ÂàÜÊîØÔºå‰ΩÜ‰æùÁÑ∂ÂÅúÁïôÂú®ÂΩìÂâçÂàÜÊîØ git branch [branch-name] Êñ∞Âª∫‰∏Ä‰∏™ÂàÜÊîØÔºåÂπ∂ÂàáÊç¢Âà∞ËØ•ÂàÜÊîØ git checkout -b [branch] Êñ∞Âª∫‰∏Ä‰∏™ÂàÜÊîØÔºåÊåáÂêëÊåáÂÆöcommit git branch [branch] [commit] Êñ∞Âª∫‰∏Ä‰∏™ÂàÜÊîØÔºå‰∏éÊåáÂÆöÁöÑËøúÁ®ãÂàÜÊîØÂª∫Á´ãËøΩË∏™ÂÖ≥Á≥ª git branch --track [branch] [remote-branch] ÂàáÊç¢Âà∞ÊåáÂÆöÂàÜÊîØÔºåÂπ∂Êõ¥Êñ∞Â∑•‰ΩúÂå∫ git checkout [branch-name] ÂàáÊç¢Âà∞‰∏ä‰∏Ä‰∏™ÂàÜÊîØ git checkout - Âª∫Á´ãËøΩË∏™ÂÖ≥Á≥ªÔºåÂú®Áé∞ÊúâÂàÜÊîØ‰∏éÊåáÂÆöÁöÑËøúÁ®ãÂàÜÊîØ‰πãÈó¥ git branch --set-upstream [branch] [remote-branch] Â¶Ç:git branch --set-upstream dev remotes/origin/dev,ÂêçÂ≠ó‰øùÊåÅ‰∏ÄËá¥ ÂêàÂπ∂ÊåáÂÆöÂàÜÊîØÂà∞ÂΩìÂâçÂàÜÊîØ git merge [branch] // ÈÄöÂ∏∏‰ΩøÁî®‰∏ãÈù¢ËøôÊù°: git merge --no-ff [branch] ÈÄâÊã©‰∏Ä‰∏™commitÔºåÂêàÂπ∂ËøõÂΩìÂâçÂàÜÊîØ git cherry-pick [commit] Âà†Èô§ÂàÜÊîØ git branch -d [branch-name] Âà†Èô§ËøúÁ®ãÂàÜÊîØ git push origin --delete [branch-name] git branch -dr [remote/branch] ‰ªìÂ∫ìÊ∑ªÂä†Êñ∞ÁöÑËøúÁ®ã‰ªìÂ∫ì git remote add &lt;name&gt; &lt;url&gt; ÊãâÂèñËøúÁ®ã‰ªìÂ∫ìÁöÑÂÜÖÂÆπ git fetch &lt;name&gt; [branchName] //‰∏ç‰ºöÂêàÂπ∂ÔºåÂè™ÊãâÂèñ git pull &lt;name&gt; [branchName] //ÊãâÂèñÂπ∂‰∏îÂêàÂπ∂ ÁßªÈô§Êüê‰∏™ËøúÁ®ã‰ªìÂ∫ì git remote rm &lt;name&gt; ÈáçÂëΩÂêçËøúÁ®ã‰ªìÂ∫ì git remote rename oldShortName newShortName Êü•ÁúãËøúÁ®ã‰ªìÂ∫ìÁöÑurl git remote -v Ê†áÁ≠æÂàóÂá∫ÊâÄÊúâtag git tag Êñ∞Âª∫‰∏Ä‰∏™tagÂú®ÂΩìÂâçcommit git tag [tag] Êñ∞Âª∫‰∏Ä‰∏™tagÂú®ÊåáÂÆöcommit git tag [tag] [commit] Âà†Èô§Êú¨Âú∞tag git tag -d [tag] Âà†Èô§ËøúÁ®ãtag git push origin :refs/tags/[tagName] Êü•Áúãtag‰ø°ÊÅØ git show [tag] Êèê‰∫§ÊåáÂÆötag git push [remote] [tag] Êèê‰∫§ÊâÄÊúâtag git push [remote] --tags Êñ∞Âª∫‰∏Ä‰∏™ÂàÜÊîØÔºåÊåáÂêëÊüê‰∏™tag git checkout -b [branch] [tag] ËøúÁ®ã‰∏ãËΩΩËøúÁ®ã‰ªìÂ∫ìÁöÑÊâÄÊúâÂèòÂä® git fetch [remote] ÊòæÁ§∫ÊâÄÊúâËøúÁ®ã‰ªìÂ∫ì git remote -v ÊòæÁ§∫Êüê‰∏™ËøúÁ®ã‰ªìÂ∫ìÁöÑ‰ø°ÊÅØ git remote show [remote] Â¢ûÂä†‰∏Ä‰∏™Êñ∞ÁöÑËøúÁ®ã‰ªìÂ∫ìÔºåÂπ∂ÂëΩÂêç git remote add [shortname] [url] ÂèñÂõûËøúÁ®ã‰ªìÂ∫ìÁöÑÂèòÂåñÔºåÂπ∂‰∏éÊú¨Âú∞ÂàÜÊîØÂêàÂπ∂ git pull [remote] [branch] ‰∏ä‰º†Êú¨Âú∞ÊåáÂÆöÂàÜÊîØÂà∞ËøúÁ®ã‰ªìÂ∫ì git push [remote] [branch] Âº∫Ë°åÊé®ÈÄÅÂΩìÂâçÂàÜÊîØÂà∞ËøúÁ®ã‰ªìÂ∫ìÔºåÂç≥‰ΩøÊúâÂÜ≤Á™Å git push [remote] --force Êé®ÈÄÅÊâÄÊúâÂàÜÊîØÂà∞ËøúÁ®ã‰ªìÂ∫ì git push [remote] --all ÂÖ∂‰ªñËÆæÁΩÆgitÂà´Âêç git config --global alias.co checkout git config --global alias.br branch git config --global alias.ci commit git config --global alias.st status git config --global alias.unstage &apos;reset HEAD --&apos; Êñá‰ª∂ÊùÉÈôê‰∏çÁ∫≥ÂÖ•ÁâàÊú¨ÁÆ°ÁêÜ git config core.filemode false SVNÂàùÊ≠•checkoutÂ∞ÜÊúçÂä°Âô®‰∏äÊúÄÊñ∞ÁöÑ‰ª£Á†Å‰ªìÂ∫ì‰∏ãËΩΩÂà∞Êú¨Âú∞Ôºå‚ÄùÂè™ÈúÄË¶ÅÂÅö‰∏ÄÊ¨°‚Äù update‰ªéÊúçÂä°Âô®‰∏äÂ∞ÜÂÖ∂‰ªñ‰∫∫ÊâÄÂÅöÁöÑ‰øÆÊîπ‰∏ãËΩΩÂà∞Êú¨Âú∞ commitÂ∞ÜÂ∑•‰ΩúÊèê‰∫§Âà∞ÊúçÂä°Âô® Â∞ÜÊñá‰ª∂Ê∑ªÂä†Âà∞Êú¨Âú∞ÁâàÊú¨Â∫ì‰∏≠ svn add main.c Â∞ÜÊñá‰ª∂Êèê‰∫§Âà∞ÊúçÂä°Âô®ÁöÑÁâàÊú¨Â∫ì‰∏≠ svn ci -m &quot;Ê∑ªÂä†‰∫Ümain.cÊñá‰ª∂&quot; Âà†Èô§Êñá‰ª∂ svn rm Person.h Êèê‰∫§Âà†Èô§ svn ci -m &quot;Âà†Èô§‰∫ÜÊñá‰ª∂&quot; Ê≥®ÊÑèÔºö‰∏çË¶Å‰ΩøÁî®Êñá‰ª∂ÁÆ°ÁêÜÂô®Áõ¥Êé•Âà†Èô§Êñá‰ª∂ Êí§ÈîÄÊñá‰ª∂ÁöÑ‰øÆÊîπ svn revert Person.m ÊÅ¢Â§çÂà∞‰πãÂâçÁöÑÊüê‰∏™ÁâàÊú¨ svn update -r 5 svn up svn help (Êü•ÁúãsvnÊâÄÊúâÂëΩ‰ª§ÁöÑÂ∏ÆÂä©) checkoutsvn co http://192.168.1.188/svn/weibo --username=manager --password=manager checkout(co)‰πãÂêéÔºåÂëΩ‰ª§Ë°å‰ºöËÆ∞ÂΩïÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºåÂêéÁª≠Êìç‰Ωú‰∏çÁî®ÂÜçÂè¶Ë°åÊåáÂÆö Âü∫Êú¨ÂëΩ‰ª§Ë°åÊ†ºÂºèÔºö svn &lt;subcommand&gt; [options] [args] ËØ¥Êòé svn Â≠êÂëΩ‰ª§ [ÈÄâÈ°π] [ÂèÇÊï∞] ÊèêÁ§∫Ôºö [‰∏≠Êã¨Âè∑]‰∏≠ÂåÖÂê´ÁöÑÂÜÖÂÆπÊòØÂèØÈÄâÁöÑ (Â≠êÂëΩ‰ª§Áº©ÂÜô) Áä∂ÊÄÅÊü•ÁúãsvnÊó•Âøó svn log Êü•ÁúãÊüê‰∏Ä‰∏™Êñá‰ª∂ÁöÑÊó•Âøó svn log filename Êü•ÁúãÊüê‰∏Ä‰∏™Êñá‰ª∂Êüê‰∏™ÁâàÊú¨ÁöÑÊó•Âøó svn log filename@1 Êü•ÁúãÂ∑•‰ΩúÁõÆÂΩïÁä∂ÊÄÅ svn st SVN stÁä∂ÊÄÅËØ¥ÊòéÔºöÊèèËø∞Êñá‰ª∂Ë¢´Ê∑ªÂä†„ÄÅÂà†Èô§ÊàñÂÖ∂‰ªñ‰øÆÊîπ &apos; &apos; Ê≤°Êúâ‰øÆÊîπ &apos;A&apos; Ë¢´Ê∑ªÂä†Âà∞Êú¨Âú∞‰ª£Á†Å‰ªìÂ∫ì &apos;C&apos; ÂÜ≤Á™Å &apos;D&apos; Ë¢´Âà†Èô§ &apos;I&apos; Ë¢´ÂøΩÁï• &apos;M&apos; Ë¢´‰øÆÊîπ &apos;R&apos; Ë¢´ÊõøÊç¢ &apos;X&apos; Â§ñÈÉ®ÂÆö‰πâÂàõÂª∫ÁöÑÁâàÊú¨ÁõÆÂΩï &apos;?&apos; Êñá‰ª∂Ê≤°ÊúâË¢´Ê∑ªÂä†Âà∞Êú¨Âú∞ÁâàÊú¨Â∫ìÂÜÖÔºå‰∏çÂú®SVNÁöÑÁÆ°ÁêÜ‰πã‰∏ã &apos;!&apos; Êñá‰ª∂‰∏¢Â§±ÊàñËÄÖ‰∏çÂÆåÊï¥(‰∏çËØÜÂà´ËØ•Êñá‰ª∂) &apos;~&apos; ÂèóÊéßÊñá‰ª∂Ë¢´ÂÖ∂‰ªñÊñá‰ª∂ÈòªÈöî &apos;U&apos; Êõ¥Êñ∞ÊúÄÊñ∞ÁöÑ‰ª£Á†ÅÂà∞Êú¨Âú∞(Êú¨Âú∞ÊúâÊñá‰ª∂ÁöÑÊÉÖÂÜµ‰∏ã) &apos;G&apos; ‰∫ßÁîüÂÜ≤Á™ÅÂêéÔºåÊõ¥Êñ∞Êìç‰ΩúÂéªËß£ÂÜ≥ÂÜ≤Á™ÅÔºåÁõ∏ÂΩì‰∫éËøõË°åÂêàÂπ∂ ÁõÆÂΩïTrunkÁõÆÂâçÈ°πÁõÆÊ≠£Âú®ÂºÄÂèëÁöÑÁâàÊú¨ TagsÂ≠òÊîæÂ∑≤Áªè‰∏äÁ∫øÁöÑÈáçÂ§ßÁâàÊú¨ BranchesÂΩìÂèëÁîüÈáçÂ§ßbugÊàñËÄÖÊúâÊñ∞ÈúÄÊ±ÇÊó∂ LinuxÊñá‰ª∂ ËØªÊùÉÈôêÔºàrÔºâÂÜôÊùÉÈôêÔºàw) ÂèØÊâßË°åÊùÉÈôêÔºàxÔºâ„ÄÇ Á¨¨1‰∏™Â≠óÊØç‰ª£Ë°®Êñá‰ª∂ÁöÑÁ±ªÂûãÔºö‚Äúd‚Äù ‰ª£Ë°®Êñá‰ª∂Â§π„ÄÅ‚Äú-‚Äù ‰ª£Ë°®ÊôÆÈÄöÊñá‰ª∂„ÄÅ‚Äúc‚Äù ‰ª£Ë°®Á°¨‰ª∂Â≠óÁ¨¶ËÆæÂ§á„ÄÅ‚Äúb‚Äù ‰ª£Ë°®Á°¨‰ª∂ÂùóËÆæÂ§á„ÄÅ‚Äús‚ÄùË°®Á§∫ÁÆ°ÈÅìÊñá‰ª∂„ÄÅ‚Äúl‚Äù ‰ª£Ë°®ËΩØÈìæÊé•Êñá‰ª∂„ÄÇ Êñá‰ª∂Á±ªÂûã+ÊâÄÊúâËÄÖ+Áî®Êà∑ÁªÑ+ÂÖ∂‰ªñÁî®Êà∑„ÄÇ Á©∫Ê†º:‰∏ã‰∏ÄÂ±è ÂõûËΩ¶:‰∏ÄË°å q:ÈÄÄÂá∫ /word:ÊêúÁ¥¢word (‰ª•ÂèätabÁöÑËá™Âä®Ë°•ÂÖ®) ÂàùÊ≠•ÊúÄÂü∫Êú¨(‰∏çÈòêËø∞) cd clear pwd mkdir rmdir who whoami exit ping Êü•Áúã ls -a(ÊâÄÊúâ) -l(ÂàóË°®) -h(ÊòæÁ§∫Â§ßÂ∞è) ÈáçÂÆöÂêë(ÁªìÊûúÈáçÂÆöÂêëÂà∞‰∏Ä‰∏™Êñá‰ª∂Ôºå‰∏çÂ≠òÂú®ÂàõÂª∫ÔºåÂ≠òÂú®Ë¶ÜÁõñ) ls &gt; a.txt ÂàÜÂ±è more ÁÆ°ÈÅì(‰∏Ä‰∏™ÂëΩ‰ª§ÁöÑÁªìÊûú‰Ωú‰∏∫Âè¶‰∏Ä‰∏™ÂëΩ‰ª§ÁöÑËæìÂÖ•) ls -a | more Âà†Èô§ rm Dir/ -r ÈÄíÂΩíÂú∞Âà†Èô§ÔºåÂà†Èô§Êñá‰ª∂Â§πÂøÖÂ∏¶ rm a.txt -f Âº∫Âà∂Âà†Èô§ÔºåÂøΩÁï•‰∏çÂ≠òÂú®ÁöÑÊñá‰ª∂ÔºåÊó†ÈúÄÊèêÁ§∫ rm b -i ‰∫§‰∫íÂºè ÈìæÊé•ËΩØÈìæÊé•:ËΩØÈìæÊé•‰∏çÂç†Áî®Á£ÅÁõòÁ©∫Èó¥ÔºåÊ∫êÊñá‰ª∂Âà†Èô§ÂàôËΩØÈìæÊé•Â§±Êïà„ÄÇ(Âø´Êç∑ÊñπÂºè)Á°¨ÈìæÊé•:Á°¨ÈìæÊé•Âè™ËÉΩÈìæÊé•ÊôÆÈÄöÊñá‰ª∂Ôºå‰∏çËÉΩÈìæÊé•ÁõÆÂΩï„ÄÇ‰∏§‰∏™Êñá‰ª∂Âç†Áî®Áõ∏ÂêåÂ§ßÂ∞èÁöÑÁ°¨ÁõòÁ©∫Èó¥Ôºå‰∏çÂ∏∏Áî®„ÄÇ ln Ê∫êÊñá‰ª∂ ÈìæÊé•Êñá‰ª∂ (Á°¨ÈìæÊé•) ln -s Ê∫êÊñá‰ª∂ ÈìæÊé•Êñá‰ª∂ Êü•ÁúãÊàñÂêàÂπ∂ cat q.txt cat 1.txt 2.txt &gt; 3.txt (ÈáçÂÆöÂêë) ÊñáÊú¨ÊêúÁ¥¢ÂèØÊ≠£Âàô grep -v(ÈÄâÈ°π) &apos;app&apos;(ÂåπÈÖçÂ≠óÁ¨¶‰∏≤) a.txt(Êñá‰ª∂Âêç) -v ÊòæÁ§∫‰∏çÂåÖÂê´ÂåπÈÖçÊñáÊú¨ÁöÑÊâÄÊúâË°å -n ÊòæÁ§∫ÂåπÈÖçË°åÂèäË°åÂè∑ -i ÂøΩÁï•Â§ßÂ∞èÂÜô Êü•Êâæ find ./ -name a.txt find ./ -name &apos;*.txt&apos; find ./ -size +10M(Â§ß‰∫é10M) Êã∑Ë¥ù cp -a ËØ•ÈÄâÈ°πÈÄöÂ∏∏Âú®Â§çÂà∂ÁõÆÂΩïÊó∂‰ΩøÁî®ÔºåÂÆÉ‰øùÁïôÈìæÊé•„ÄÅÊñá‰ª∂Â±ûÊÄßÔºåÂπ∂ÈÄíÂΩíÂú∞Â§çÂà∂ÁõÆÂΩïÔºåÁÆÄÂçïËÄåË®ÄÔºå‰øùÊåÅÊñá‰ª∂ÂéüÊúâÂ±ûÊÄß„ÄÇ -f Âº∫Âà∂ -i ‰∫§‰∫í -r ÈÄíÂΩí -v ËøõÂ∫¶ ÁßªÂä®(ÈáçÂëΩÂêç) mv -f -v -i ÂΩíÊ°£‰∏éÂéãÁº© tar [ÂèÇÊï∞] ÊâìÂåÖÊñá‰ª∂Âêç Êñá‰ª∂ gzip [ÈÄâÈ°π] Ë¢´ÂéãÁº©Êñá‰ª∂ ÂàáÊç¢Áî®Êà∑ su ‰∏çÂàáÊç¢ÁõÆÂΩï su - ÂàáÊç¢ÁõÆÂΩï su root Âà∞root su -root Âà∞rootÔºåÂêåÊó∂Âà∞/rootÁõÆÂΩï Á≥ªÁªüÊó•ÂéÜ cal Êó∂Èó¥ date ÁΩëÂç° ifconfig ËøõÁ®ã ps -a ÊâÄÊúâ -u ËØ¶ÁªÜÁä∂ÊÄÅ -x ÊòæÁ§∫Ê≤°ÊúâÊéßÂà∂ÁªàÁ´ØÁöÑËøõÁ®ã -w ÊòæÁ§∫Âä†ÂÆΩ -r Ê≠£Âú®ËøêË°å Âä®ÊÄÅËøõÁ®ã top M ÂÜÖÂ≠ò‰ΩøÁî®Èáè ÊéíÂ∫è P CPUÂç†ÊúâÁéá ÊéíÂ∫è T ËøêË°åÊó∂Èó¥ ÊéíÂ∫è U ÂèØ‰ª•Ê†πÊçÆÂêéÈù¢ËæìÂÖ•ÁöÑÁî®Êà∑ÂêçÊù•Á≠õÈÄâËøõÁ®ã K ÂèØ‰ª•Ê†πÊçÆÂêéÈù¢ËæìÂÖ•ÁöÑPIDÊù•ÊùÄÊ≠ªËøõÁ®ã„ÄÇkill pid q ÈÄÄÂá∫ h Ëé∑ÂæóÂ∏ÆÂä© ÂÖ≥Êú∫ÈáçÂêØ reboot ÈáçÂêØ shutdown ‚Äìr now ÈáçÊñ∞ÂêØÂä® shutdown -h now Á´ãÂàªÂÖ≥Êú∫ shutdown -h 20:25 Âú®‰ªäÂ§©ÁöÑ20:25‰ºöÂÖ≥Êú∫ shutdown -h +10 ËøáÂçÅÂàÜÈíüÂêéËá™Âä®ÂÖ≥Êú∫ init 0 ÂÖ≥Êú∫ init 6 ÈáçÂêØ Á£ÅÁõòÁ©∫Èó¥ df -a ÊâÄÊúâ -m ‰ª•1024Â≠óËäÇ‰∏∫Âçï‰ΩçÊòæÁ§∫ -t ÊòæÁ§∫ÂêÑÊåáÂÆöÊñá‰ª∂Á≥ªÁªüÁöÑÁ£ÅÁõòÁ©∫Èó¥‰ΩøÁî®ÊÉÖÂÜµ -T ÊòæÁ§∫Êñá‰ª∂Á≥ªÁªü ÁõÆÂΩïÊâÄÂç†Á£ÅÁõòÁ©∫Èó¥ du -a ÈÄíÂΩí -s ÊòæÁ§∫ÊåáÂÆöÊñá‰ª∂ÊàñÁõÆÂΩïÂç†Áî®ÁöÑÊï∞ÊçÆÂùó -b ‰ª•Â≠óËäÇ‰∏∫Âçï‰ΩçÊòæÁ§∫Á£ÅÁõòÂç†Áî®ÊÉÖÂÜµ -l ËÆ°ÁÆóÊâÄÊúâÊñá‰ª∂Â§ßÂ∞èÔºåÂØπÁ°¨ÈìæÊé•Êñá‰ª∂ËÆ°ÁÆóÂ§öÊ¨° VimÂàùÊ≠•i: ÊèíÂÖ•ÂÖâÊ†áÂâç‰∏Ä‰∏™Â≠óÁ¨¶ I: ÊèíÂÖ•Ë°åÈ¶ñ a: ÊèíÂÖ•ÂÖâÊ†áÂêé‰∏Ä‰∏™Â≠óÁ¨¶ A: ÊèíÂÖ•Ë°åÊú™ o: Âêë‰∏ãÊñ∞ÂºÄ‰∏ÄË°åÔºåÊèíÂÖ•Ë°åÈ¶ñ O: Âêë‰∏äÊñ∞ÂºÄ‰∏ÄË°åÔºåÊèíÂÖ•Ë°åÈ¶ñ ESC:‰ªéÊèíÂÖ•Ê®°ÂºèÊàñÊú´Ë°åÊ®°ÂºèËøõÂÖ•ÂëΩ‰ª§Ê®°Âºè ÁßªÂä®ÂÖâÊ†á: h: Â∑¶Áßª j: ‰∏ãÁßª k: ‰∏äÁßª l: Âè≥Áßª M: ÂÖâÊ†áÁßªÂä®Âà∞‰∏≠Èó¥Ë°å L: ÂÖâÊ†áÁßªÂä®Âà∞Â±èÂπïÊúÄÂêé‰∏ÄË°åË°åÈ¶ñ G: ÁßªÂä®Âà∞ÊåáÂÆöË°åÔºåË°åÂè∑ -G w: ÂêëÂêé‰∏ÄÊ¨°ÁßªÂä®‰∏Ä‰∏™Â≠ó b: ÂêëÂâç‰∏ÄÊ¨°ÁßªÂä®‰∏Ä‰∏™Â≠ó {: ÊåâÊÆµÁßªÂä®Ôºå‰∏äÁßª }: ÊåâÊÆµÁßªÂä®Ôºå‰∏ãÁßª Ctr-d: Âêë‰∏ãÁøªÂçäÂ±è Ctr-u: Âêë‰∏äÁøªÂçäÂ±è Ctr-f: Âêë‰∏ãÁøª‰∏ÄÂ±è Ctr-b: Âêë‰∏äÁøª‰∏ÄÂ±è gg: ÂÖâÊ†áÁßªÂä®Êñá‰ª∂ÂºÄÂ§¥ G: ÂÖâÊ†áÁßªÂä®Âà∞Êñá‰ª∂Êú´Â∞æ Âà†Èô§ÂëΩ‰ª§: x: Âà†Èô§ÂÖâÊ†áÂêé‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÁõ∏ÂΩì‰∫é Del X: Âà†Èô§ÂÖâÊ†áÂâç‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÁõ∏ÂΩì‰∫é Backspace dd: Âà†Èô§ÂÖâÊ†áÊâÄÂú®Ë°åÔºån dd Âà†Èô§ÊåáÂÆöÁöÑË°åÊï∞ D: Âà†Èô§ÂÖâÊ†áÂêéÊú¨Ë°åÊâÄÊúâÂÜÖÂÆπÔºåÂåÖÂê´ÂÖâÊ†áÊâÄÂú®Â≠óÁ¨¶ d0: Âà†Èô§ÂÖâÊ†áÂâçÊú¨Ë°åÊâÄÊúâÂÜÖÂÆπÔºå‰∏çÂåÖÂê´ÂÖâÊ†áÊâÄÂú®Â≠óÁ¨¶ dw: Âà†Èô§ÂÖâÊ†áÂºÄÂßã‰ΩçÁΩÆÁöÑÂ≠óÔºåÂåÖÂê´ÂÖâÊ†áÊâÄÂú®Â≠óÁ¨¶ Êí§ÈîÄÂëΩ‰ª§: u: ‰∏ÄÊ≠•‰∏ÄÊ≠•Êí§ÈîÄ Ctr-r: ÂèçÊí§ÈîÄ ÈáçÂ§çÂëΩ‰ª§: .: ÈáçÂ§ç‰∏ä‰∏ÄÊ¨°Êìç‰ΩúÁöÑÂëΩ‰ª§ ÊñáÊú¨Ë°åÁßªÂä®: &gt;&gt;:ÊñáÊú¨Ë°åÂè≥ÁßªÂä® &lt;&lt;:ÊñáÊú¨Ë°åÂ∑¶ÁßªÂä® Â§çÂà∂Á≤òË¥¥: yy: Â§çÂà∂ÂΩìÂâçË°åÔºån yy Â§çÂà∂ n Ë°å p: Âú®ÂÖâÊ†áÊâÄÂú®‰ΩçÁΩÆÂêë‰∏ãÊñ∞ÂºÄËæü‰∏ÄË°åÔºåÁ≤òË¥¥ ÂèØËßÜÊ®°Âºè: v: ÊåâÂ≠óÁ¨¶ÁßªÂä®ÔºåÈÄâ‰∏≠ÊñáÊú¨ V: ÊåâË°åÁßªÂä®ÔºåÈÄâ‰∏≠ÊñáÊú¨ÂèØËßÜÊ®°ÂºèÂèØ‰ª•ÈÖçÂêà dÔºå yÔºå &gt;&gt;Ôºå &lt;&lt; ÂÆûÁé∞ÂØπÊñáÊú¨ÂùóÁöÑÂà†Èô§ÔºåÂ§çÂà∂ÔºåÂ∑¶Âè≥ÁßªÂä® ÊõøÊç¢Êìç‰Ωú: r: ÊõøÊç¢ÂΩìÂâçÂ≠óÁ¨¶ R: ÊõøÊç¢ÂΩìÂâçË°åÂÖâÊ†áÂêéÁöÑÂ≠óÁ¨¶ Êü•ÊâæÂëΩ‰ª§: /: strÊü•Êâæ n: ‰∏ã‰∏Ä‰∏™ NÔºö‰∏ä‰∏Ä‰∏™ ÊõøÊç¢ÂëΩ‰ª§Ôºö ÊääabcÂÖ®ÈÉ®ÊõøÊç¢Êàê123 Êú´Ë°åÊ®°Âºè‰∏ãÔºåÂ∞ÜÂÖâÊ†áÊâÄÂú®Ë°åÁöÑabcÊõøÊç¢Êàê123 :%s/abc/123/g Êú´Ë°åÊ®°Âºè‰∏ãÔºåÂ∞ÜÁ¨¨‰∏ÄË°åËá≥Á¨¨10Ë°å‰πãÈó¥ÁöÑabcÊõøÊç¢Êàê123 :1Ôºå 10s/abc/123/g vimÈáåÊâßË°å shell ‰∏ãÂëΩ‰ª§: Êú´Ë°åÊ®°ÂºèÈáåËæìÂÖ•!ÔºåÂêéÈù¢Ë∑üÂëΩ‰ª§ LLDBÂàùÊ≠•help ËæìÂá∫ p (int)self.view.subviews.count Âü∫Êú¨Á±ªÂûã po self.view ÂØπË±° ‰øÆÊîπ expr a = 3 expr int $c = 10 Â£∞Êòé‰∏Ä‰∏™Êñ∞ÂèòÈáè Ë∞ÉÁî® call self.view.backgroundColor = [UIColor redColor] ÊñπÊ≥ïÊó†ËøîÂõûÂÄºÊó∂‰ΩøÁî®call Â†ÜÊ†à bt Âä†allÂèØÊâìÂç∞ÊâÄÊúâthreadÁöÑÂ†ÜÊ†à ÂØªÂùÄ image lookup --address 0x0000000103aca1e1 ÂØªÊâæÊ†àÂú∞ÂùÄÂØπÂ∫îÁöÑ‰ª£Á†Å‰ΩçÁΩÆ ClangÂàùÊ≠• ÁºñËØëÂçï‰∏™cÊ∫êÊñá‰ª∂ÔºåÂπ∂‰∫ßÁîü‰∏Ä‰∏™ÁõÆÊ†áÊñá‰ª∂ cc -c one.c ÁºñËØëÂ§ö‰∏™cÊ∫êÊñá‰ª∂ÔºåÂπ∂‰∏∫ÊØè‰∏™Êñá‰ª∂‰∫ßÁîü‰∏Ä‰∏™ÁõÆÊ†áÊñá‰ª∂ cc -c one.c two.c three.c ÈìæÊé•Âçï‰∏™ÁõÆÊ†áÊñá‰ª∂‰∫ßÁîü‰∏Ä‰∏™Âêç‰∏∫a.outÁöÑÂèØÊâßË°åÊñá‰ª∂ cc one.o ÈìæÊé•Â§ö‰∏™ÁõÆÊ†áÊñá‰ª∂ cc one.o two.o three.o ÁºñËØëÂπ∂ÈìæÊé•‰∏Ä‰∏™cÊ∫êÊñá‰ª∂ cc one.c ÁºñËØëÂπ∂ÈìæÊé•Â§ö‰∏™cÊ∫êÊñá‰ª∂ cc one.c two.c three.c ÁºñËØë‰∏Ä‰∏™cÊ∫êÊñá‰ª∂ÔºåÂπ∂ÊääÂÆÉÂíåÁé∞Â≠òÁöÑÁõÆÊ†áÊñá‰ª∂ÈìæÊé•Âú®‰∏ÄËµ∑ cc one.o two.o three.c ÂèØÊâßË°åÊñá‰ª∂ÈáçÂëΩÂêçÂä†‰∏ä‚Äú-o name‚ÄùËøô‰∏™ÈÄâÈ°π cc -o abc one.c ÊâßË°åÂèØÊâßË°åÊñá‰ª∂ ./a.out ÁºñËØëC++Êñá‰ª∂ clang++ -Wall -g -std=c++11 -stdlib=libc++ fileName.cpp -o targetFileName]]></content>
      <tags>
        <tag>Git</tag>
        <tag>SVN</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSÂ∫îÁî®‰ºòÂåñTips]]></title>
    <url>%2F2017%2F02%2F14%2FiOS%E5%BA%94%E7%94%A8%E4%BC%98%E5%8C%96Tips%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÊÄªÁªì‰∫Ü‰∏Ä‰∫õ‰ºòÂåñÁöÑTipsÔºåÈöèÊó∂Êõ¥Êñ∞„ÄÇ ÂÜÖÂ≠ò UITableViewÈááÁî®Ê≥®ÂÜåÁöÑÊñπÂºè‰ΩøÁî®reuseIdentifierstatic NSString *CellIdentifier = @&quot;Cell&quot;;Â§çÁî® Cell ‰∏éÂêÑ‰∏™ Section ÁöÑ Header Âíå Footer„ÄÇÂ§çÁî® Cell Êó∂Ôºå storyboard ‰∏≠ÁöÑ cell ËÆæÁΩÆ reuseIdentifier ÂÆåÊØïÂç≥ÂèØÔºåÊó†ÈúÄÊ≥®ÂÜåÔºåxib ‰∏é class Ëá™ÂÆö‰πâÁöÑcell ÈúÄË¶ÅËÆæÁΩÆ reuseIdentifier ËÄå‰∏îË¶ÅÊ≥®ÂÜå„ÄÇ ‰ΩøÁî®UITableView+FDTemplateLayoutCell‰ºòÁÇπ:È¢ÑÁºìÂ≠òÊú∫Âà∂/Ëá™Âä®ÁöÑÁºìÂ≠òÂ§±ÊïàÊú∫Âà∂/Ê†πÊçÆ autolayout Á∫¶ÊùüËá™Âä®ËÆ°ÁÆóÈ´òÂ∫¶„ÄÇÊ≥®ÊÑè:cacheByKeyÊØîcacheByIndexPath Êõ¥‰∏∫È´òÊïà„ÄÇ return [tableView fd_heightForCellWithIdentifier:reuseIdentifier cacheByIndexPath:indexPath configuration:^(YACommentTableViewCell *cell) &#123; cell.comment = self.comments[indexPath.section][indexPath.row]; &#125;]; ‰ΩøÁî® // ‰∏çÁºìÂ≠òÈ´òÂ∫¶return [tableView fd_heightForCellWithIdentifier:reuseIdentifier configuration:^(YACommentTableViewCell *cell)&#123; cell.comment = self.comments[indexPath.section][indexPath.row]; &#125;]; // Êõ¥È´òÊïàÔºå‰ΩÜÊòØÂΩìÈ´òÂ∫¶ÂèòÂåñÊó∂ÔºåÈúÄË¶ÅÊâãÂä®Ê∏ÖÈô§ÁºìÂ≠òYACommentModel *model = self.comments[indexPath.section][indexPath.row];return [tableView fd_heightForCellWithIdentifier:reuseIdentifier cacheByKey:model.ID configuration:^(id cell) &#123; cell.comment = self.comments[indexPath.section][indexPath.row];&#125;]; // ÁßªÈô§ key ÂØπÂ∫îÁöÑÈ´òÂ∫¶ÁºìÂ≠ò[tableView.fd_keyedHeightCache invalidateHeightForKey:key];// ÁßªÈô§ÊâÄÊúâÈ´òÂ∫¶ÁºìÂ≠ò[tableView.fd_keyedHeightCache invalidateAllHeightCache]; ËÆæÁΩÆ opaque ‰∏∫YESÔºåÂ∞ΩÈáèÊää view ËÆæÁΩÆ‰∏∫ÈÄèÊòé„ÄÇ Â∞ΩÈáè‰∏ç‰ΩøÁî®cellForRowAtIndexPath:ÔºåÁî®‰∏ÄÊ¨°ÁÑ∂ÂêéÁºìÂ≠òÁªìÊûú„ÄÇ Â∞ùËØïÁºìÂ≠ò„ÄÇ ‰øùËØÅXIBÊñá‰ª∂ÁöÑÂ∞èÂ∑ßÁÅµÊ¥ª„ÄÇ È¢ÑÂ§ÑÁêÜÊáíÂä†ËΩΩ„ÄÇ Â§ÑÁêÜÂÜÖÂ≠òË≠¶Âëä„ÄÇ Âçï‰∏ÄÂõ∫ÂÆöÁöÑÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî®rowHeightÔºå sectionFooterHeightÂíå sectionHeaderHeightÊù•ËÆæÂÆöÂõ∫ÂÆöÁöÑÈ´òÔºåËÄå‰∏çÊòØËØ∑Ê±Çdelegate„ÄÇ ‰ΩøÁî® shadowPathÔºåview.layer.shadowPath = [[UIBezierPath bezierPathWithRect:view.bounds] CGPath]; // ËÄå‰∏çÊòØ: view.layer.shadowOffset = CGSizeMake(-1Ôºå 1); view.layer.shadowRadius = 1.0f; view.layer.shadowOpacity = 0.1; ‰ºòÂåñ ÂêàÁêÜÂºÄÁ∫øÁ®ãÔºå‰∏ªÁ∫øÁ®ãÂç†1MÔºåÂ≠êÁ∫øÁ®ãÂç†512K„ÄÇUI Êìç‰ΩúÂíå DataSource ÁöÑÊìç‰Ωú‰∏ÄÂÆöÂú®‰∏ªÁ∫øÁ®ã„ÄÇDB Êìç‰Ωú„ÄÅÊó•ÂøóËÆ∞ÂΩï„ÄÅÁΩëÁªúÂõûË∞ÉÈÉΩÂú®ÂêÑËá™ÁöÑÂõ∫ÂÆöÁ∫øÁ®ã„ÄÇ ÈÄâÊã©ÂêàÈÄÇÁöÑÂÆπÂô®ÔºåÂáèÂ∞ësubviewsÁöÑÊï∞Èáè„ÄÇNSArrayi:ÊúâÂ∫èÁöÑ„ÄÇËÉΩÊêûÊåâÁÖßÁ¥¢ÂºïÂø´ÈÄüÊü•ÊâæÂÖÉÁ¥†„ÄÇÊåâÁÖßÂÄºÊü•ÊâæÂæàÊÖ¢ÔºåÊèíÂÖ•ÂíåÂà†Èô§ÂæàÊÖ¢„ÄÇNSDictionary:Êó†Â∫èÁöÑ„ÄÇÈîÆÂÄºÂØπÂ≠òÂÇ®„ÄÇÊåâÁÖßkeyÂèØ‰ª•Âø´ÈÄüÊü•Êâæ„ÄÇNSSet: Êó†Â∫èÁöÑ„ÄÇÊåâÁÖßÂÄºÂèØ‰ª•Âø´ÈÄüÊü•ÊâæÔºåÊèíÂÖ•ÂíåÂà†Èô§ÂæàÂø´„ÄÇ Ê≠£Á°Æ‰ΩøÁî® imageNamed: ‰∏é imageWithContentsOfFile:ÔºåimageNamed:ÁöÑ‰ºòÁÇπÊòØÂΩìÂä†ËΩΩÊó∂‰ºöÁºìÂ≠òÂõæÁâáÔºåÊâÄ‰ª•ÂΩìÂõæÁâá‰ºöÈ¢ëÁπÅÁöÑ‰ΩøÁî®Êó∂ÔºåÁî®imageNamed:„ÄÇimageWithContentsOfFileÔºö‰ªÖÂä†ËΩΩÂõæÁâáÔºåÂõæÂÉèÊï∞ÊçÆ‰∏ç‰ºöÁºìÂ≠òÔºåÂØπ‰∫éËæÉÂ§ßÁöÑÂõæÁâá‰ª•Âèä‰ΩøÁî®ÊÉÖÂÜµËæÉÂ∞ëÊó∂ÔºåÂ∞±ÂèØ‰ª•Áî®ËØ•ÊñπÊ≥ïÔºåÈôç‰ΩéÂÜÖÂ≠òÊ∂àËÄó„ÄÇ ÊÖéÁî® NSDateFormatterÂíåNSCalendarÔºåÁºìÂ≠ò NSDateFormatter ÁöÑÁªìÊûú„ÄÇCreating a date formatter is not a cheap operation. If you are likely to use a formatter frequentlyÔºå it is typically more efficient to cache a single instance than to create and dispose of multiple instances. One approach is to use a static variable. Âú®iOS 7„ÄÅmacOS 10.9Âèä‰ª•‰∏äÁ≥ªÁªüÁâàÊú¨ÔºåNSDateFormatterÈÉΩÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ @property (nonatomicÔºå strong) NSDateFormatter *formatter; - (NSDateFormatter *)formatter &#123; static NSDateFormatter *formatter; static dispatch_once_t onceToken; dispatch_once(&amp;onceTokenÔºå ^&#123; _formatter = [[NSDateFormatter alloc] init]; _formatter.dateFormat = @"EEE MMM dd HH:mm:ss Z yyyy"; // twitter date format &#125;); return formatter;&#125; ÂØªÊâæ (NSDate *)dateFromString:(NSString )string ÁöÑÊõøÊç¢ÂìÅ„ÄÇ‰∏ãÈù¢ÊòØISO8601 ËΩ¨Êàê NSDate ÁöÑ NSDateFormatter ÁöÑÊúÄËëóÂêçÊõø‰ª£ÂìÅÔºå‰πüÂèØ‰ª•‰ΩøÁî®ÂºÄÊ∫ê‰ΩúÂìÅ:NSDate+SSToolkitAdditions„ÄÇ //#include &lt;time.h&gt;time_t t;struct tm tm;strptime([iso8601String cStringUsingEncoding:NSUTF8StringEncoding]Ôºå "%Y-%m-%dT%H:%M:%S%z"Ôºå &amp;tm);tm.tm_isdst = -1;t = mktime(&amp;tm);[NSDate dateWithTimeIntervalSince1970:t + [[NSTimeZone localTimeZone] secondsFromGMT]]; ‰∏çË¶ÅÈöèÊÑè‰ΩøÁî® NSLog()„ÄÇ #ifdef DEBUG// Only log when attached to the debugger# define DLog(...) NSLog(__VA_ARGS__)#else# define DLog(...) /* */#endif// Always logÔºå even in production#define ALog(...) NSLog(__VA_ARGS__) ÂΩìËØïÂõæËé∑ÂèñÁ£ÅÁõò‰∏≠‰∏Ä‰∏™Êñá‰ª∂ÁöÑÂ±ûÊÄß‰ø°ÊÅØÊó∂Ôºå‰ΩøÁî® [NSFileManager attributesOfItemAtPath:error:]‰ºöÊµ™Ë¥πÂ§ßÈáèÊó∂Èó¥ËØªÂèñÂèØËÉΩÊ†πÊú¨‰∏çÈúÄË¶ÅÁöÑÈôÑÂä†Â±ûÊÄß„ÄÇËøôÊó∂ÂèØ‰ª•‰ΩøÁî® stat ‰ª£Êõø NSFileManagerÔºåÁõ¥Êé•Ëé∑ÂèñÊñá‰ª∂Â±ûÊÄßÔºö #import &lt;sys/stat.h&gt; struct stat statbuf; const char *cpath = [filePath fileSystemRepresentation]; if (cpath &amp;&amp; stat(cpathÔºå &amp;statbuf) == 0) &#123; NSNumber *fileSize = [NSNumber numberWithUnsignedLongLong:statbuf.st_size]; NSDate *modificationDate = [NSDate dateWithTimeIntervalSince1970:statbuf.st_mtime]; NSDate *creationDate = [NSDate dateWithTimeIntervalSince1970:statbuf.st_ctime]; // etc &#125; MLeakFinder ËÉΩÂú®ÂºÄÂèëÈò∂ÊÆµÔºåÊääÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢òÊö¥Èú≤Êó†ÈÅóÔºåÂáèÂ∞ë‰∫ÜÂæàÂ§öÊΩúÂú®ÁöÑÊÄßËÉΩÈóÆÈ¢ò. ÂéüÁêÜ:Âú®‰∏Ä‰∏™ ViewController Ë¢´ pop Êàñ dismiss ‰∏ÄÂ∞èÊÆµÊó∂Èó¥ÂêéÔºåÁúãÁúãËØ• UIViewControllerÔºåÂÆÉÁöÑ viewÔºåview ÁöÑ subviews Á≠âÁ≠âÊòØÂê¶ËøòÂ≠òÂú®„ÄÇ Êé•ÂÖ•bugly„ÄÇ ÂàõÈÄ†ÂúÜÂΩ¢ÂõæÁâáÈÅøÂÖç‰ΩøÁî®‰ª•‰∏ãÊñπÂºè(‰ºöÈÄ†ÊàêÁ¶ªÂ±èÊ∏≤Êüì): view.layer.cornerRadius = view.width * 0.5; view.layer.masksToBounds = true ÂúÜÂΩ¢ÂõæÁâá UIBezierPath *clipPath = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(0Ôºå 0Ôºå image.size.widthÔºå image.size.height)] ; [clipPath addClip] ; [image drawAtPoint:CGPointZero] ; image = UIGraphicsGetImageFromCurrentImageContext() ; UIGraphicsEndImageContext() ; return image ; ËÆæÁΩÆLabelÁöÑÂúÜËßí„ÄÇ // ‰∏çË¶ÅËøô‰πàÂÅöÔºölabel.backgroundColor = aColor // ‰ª•Âèä‰∏çË¶ÅÂú® IB Èáå‰∏∫ label ËÆæÁΩÆËÉåÊôØËâ≤label.layer.backgroundColor = aColorlabel.layer.cornerRadius = 5 ÊåáÂÆöÂõæÁâáÁöÑÂÆΩÈ´ò‰∏∫Êï¥Êï∞ÔºåÂê¶ÂàôÈÄ†ÊàêÁ¶ªÂ±èÊ∏≤Êüì„ÄÇ cellÂΩì‰∏≠‰∏çË¶ÅÂä®ÊÄÅÁöÑÊ∑ªÂä†Â≠êÊéß‰ª∂ÔºåÈÄâ‰∏≠ÈÄÇÊó∂Âú∞ÊòæÁ§∫‰∏éÈöêËóè„ÄÇ ÂΩìÊéß‰ª∂ÈùûÂ∏∏Â§öÊó∂ÔºåÊää‰∏çÈúÄË¶Å‰∏éÁî®Êà∑ËøõË°å‰∫§‰∫íÁöÑÊéß‰ª∂.ÈÄöËøáÂºÇÊ≠•ÁªòÂà∂Êàê‰∏ÄÂº†ÂõæÁâáÔºåÊääÂõæÁâáÊ∑ªÂä†Âà∞cellÂΩì‰∏≠„ÄÇ Â∞Ü UIView ÁöÑÂ±ûÊÄß clearsContextBeforeDrawing ËÆæÁΩÆ‰∏∫ NO Âú®Â§öÊï∞ÊÉÖÂÜµ‰∏ãÂèØ‰ª•ÊèêÈ´òÁªòÂà∂ÊÄßËÉΩÔºåÂ∞§ÂÖ∂ÊòØÂú®Áî®ÁªòÂà∂‰ª£Á†ÅÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ÂÆöÂà∂ view ÁöÑÊó∂ÂÄô„ÄÇ ËÆæÁΩÆÈò¥ÂΩ±„ÄÇ view.layer.shadowPath = [[UIBezierPath bezierPathWithRect:view.bounds] CGPath]; // ËÄå‰∏çÊòØview.layer.shadowOffset = CGSizeMake(-1.0fÔºå 1.0f);view.layer.shadowRadius = 5.0f;view.layer.shadowOpacity = 0.6; ÈÄöÂ∏∏ÂõæÂ±ÇÁöÑ‰ª•‰∏ãÂ±ûÊÄßÂ∞Ü‰ºöËß¶ÂèëÁ¶ªÂ±èÊ∏≤ÊüìÔºö Èò¥ÂΩ±ÔºàUIView.layer.shadowOffset/shadowRadius/‚Ä¶ÔºâÂúÜËßíÔºàÂΩì UIView.layer.cornerRadius Âíå UIView.layer.maskToBounds ‰∏ÄËµ∑‰ΩøÁî®Êó∂ÔºâÂõæÂ±ÇËíôÊùø ‰ΩøÁî® Autorelease PoolÔºåÂΩìÈúÄË¶ÅÂú®‰ª£Á†Å‰∏≠ÂàõÂª∫ËÆ∏Â§ö‰∏¥Êó∂ÂØπË±°Êó∂ÔºåÂèØ‰ª•ÊòæÂºèÁöÑ‰ΩøÁî® Autorelease Pool„ÄÇ ‰ΩøÁî®IMP„ÄÇ]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
        <tag>‰ºòÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python3ÂÖ•Èó®Á¨îËÆ∞]]></title>
    <url>%2F2016%2F12%2F20%2FPython3%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[2017.1.11‰øÆÊîπ ‰∫∫ÁîüËã¶Áü≠ÔºåÊàëÁî®Python„ÄÇ Èí©ÁéÑ ËÆ©PythonÊâìÂç∞Âá∫ÊåáÂÆöÁöÑÊñáÂ≠óÔºåÂèØ‰ª•Áî®print()ÂáΩÊï∞ÔºåÁÑ∂ÂêéÊääÂ∏åÊúõÊâìÂç∞ÁöÑÊñáÂ≠óÁî®ÂçïÂºïÂè∑ÊàñËÄÖÂèåÂºïÂè∑Êã¨Ëµ∑Êù•Ôºå‰ΩÜ‰∏çËÉΩÊ∑∑Áî®ÂçïÂºïÂè∑ÂíåÂèåÂºïÂè∑„ÄÇ Âú®Python‰∫§‰∫íÂºèÂëΩ‰ª§Ë°å‰∏ãÔºåÂèØ‰ª•Áõ¥Êé•ËæìÂÖ•‰ª£Á†ÅÔºåÁÑ∂ÂêéÊâßË°åÔºåÂπ∂Á´ãÂàªÂæóÂà∞ÁªìÊûú„ÄÇÁî®exit()ÈÄÄÂá∫‰∫§‰∫íÊ®°Âºè„ÄÇ Áõ¥Êé•ËæìÂÖ•PythonËøõÂÖ•‰∫§‰∫íÊ®°ÂºèÔºåÁõ∏ÂΩì‰∫éÂêØÂä®‰∫ÜPythonËß£ÈáäÂô®Ôºå‰ΩÜÊòØÁ≠âÂæÖ‰Ω†‰∏ÄË°å‰∏ÄË°åÂú∞ËæìÂÖ•Ê∫ê‰ª£Á†ÅÔºåÊØèËæìÂÖ•‰∏ÄË°åÂ∞±ÊâßË°å‰∏ÄË°å„ÄÇÁõ¥Êé•ËøêË°å.pyÊñá‰ª∂Áõ∏ÂΩì‰∫éÂêØÂä®‰∫ÜPythonËß£ÈáäÂô®ÔºåÁÑ∂Âêé‰∏ÄÊ¨°ÊÄßÊää.pyÊñá‰ª∂ÁöÑÊ∫ê‰ª£Á†ÅÁªôÊâßË°å‰∫ÜÔºå‰Ω†ÊòØÊ≤°ÊúâÊú∫‰ºö‰ª•‰∫§‰∫íÁöÑÊñπÂºèËæìÂÖ•Ê∫ê‰ª£Á†ÅÁöÑ„ÄÇ print()ÂáΩÊï∞‰πüÂèØ‰ª•Êé•ÂèóÂ§ö‰∏™Â≠óÁ¨¶‰∏≤ÔºåÁî®ÈÄóÂè∑,ÈöîÂºÄÔºåÂ∞±ÂèØ‰ª•ËøûÊàê‰∏Ä‰∏≤ËæìÂá∫Ôºå‰ºö‰æùÊ¨°ÊâìÂç∞ÊØè‰∏™Â≠óÁ¨¶‰∏≤ÔºåÈÅáÂà∞ÈÄóÂè∑,‰ºöËæìÂá∫‰∏Ä‰∏™Á©∫Ê†º„ÄÇ PythonÊèê‰æõ‰∫Ü‰∏Ä‰∏™input(&quot;ÊèêÁ§∫ÊñáÊú¨ÔºåÂèØ‰ª•‰∏∫Á©∫&quot;)ÂáΩÊï∞ÔºåÂèØ‰ª•ËÆ©Áî®Êà∑ËæìÂÖ•Â≠óÁ¨¶‰∏≤ÔºåÂπ∂Â≠òÊîæÂà∞‰∏Ä‰∏™ÂèòÈáèÈáå„ÄÇ ‰ª•#ÂºÄÂ§¥ÁöÑËØ≠Âè•ÊòØÊ≥®ÈáäÔºåPythonÁ®ãÂ∫èÊòØÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑ„ÄÇ #!/usr/bin/env python3# -*- coding: utf-8 -*-# Á¨¨‰∏ÄË°åÊ≥®ÈáäÊòØ‰∏∫‰∫ÜÂëäËØâLinux/OS XÁ≥ªÁªüÔºåËøôÊòØ‰∏Ä‰∏™PythonÂèØÊâßË°åÁ®ãÂ∫èÔºåWindowsÁ≥ªÁªü‰ºöÂøΩÁï•Ëøô‰∏™Ê≥®ÈáäÔºõ# Á¨¨‰∫åË°åÊ≥®ÈáäÊòØ‰∏∫‰∫ÜÂëäËØâPythonËß£ÈáäÂô®ÔºåÊåâÁÖßUTF-8ÁºñÁ†ÅËØªÂèñÊ∫ê‰ª£Á†ÅÔºåÂê¶ÂàôÔºå‰Ω†Âú®Ê∫ê‰ª£Á†Å‰∏≠ÂÜôÁöÑ‰∏≠ÊñáËæìÂá∫ÂèØËÉΩ‰ºöÊúâ‰π±Á†Å„ÄÇ ÂΩìËØ≠Âè•‰ª•ÂÜíÂè∑:ÁªìÂ∞æÊó∂ÔºåÁº©ËøõÁöÑËØ≠Âè•ËßÜ‰∏∫‰ª£Á†ÅÂùó„ÄÇPython‰ΩøÁî®Áº©ËøõÊù•ÁªÑÁªá‰ª£Á†ÅÂùóÔºåËØ∑Âä°ÂøÖÈÅµÂÆàÁ∫¶ÂÆö‰øóÊàêÁöÑ‰π†ÊÉØÔºåÂùöÊåÅ‰ΩøÁî®4‰∏™Á©∫Ê†ºÁöÑÁº©Ëøõ„ÄÇÂú®ÊñáÊú¨ÁºñËæëÂô®‰∏≠ÔºåÈúÄË¶ÅËÆæÁΩÆÊääTabËá™Âä®ËΩ¨Êç¢‰∏∫4‰∏™Á©∫Ê†ºÔºåÁ°Æ‰øù‰∏çÊ∑∑Áî®TabÂíåÁ©∫Ê†º„ÄÇ ‰∏Ä‰∏™Â∏ÉÂ∞îÂÄºÂè™ÊúâTrue„ÄÅFalse‰∏§ÁßçÂÄº„ÄÇÂ∏ÉÂ∞îÂÄºÂèØ‰ª•Áî®and„ÄÅorÂíånotËøêÁÆó„ÄÇ Á©∫ÂÄºÊòØPythonÈáå‰∏Ä‰∏™ÁâπÊÆäÁöÑÂÄºÔºåÁî®NoneË°®Á§∫„ÄÇNone‰∏çËÉΩÁêÜËß£‰∏∫0ÔºåÂõ†‰∏∫0ÊòØÊúâÊÑè‰πâÁöÑÔºåËÄåNoneÊòØ‰∏Ä‰∏™ÁâπÊÆäÁöÑÁ©∫ÂÄº„ÄÇ Âú®Python‰∏≠ÔºåÈÄöÂ∏∏Áî®ÂÖ®ÈÉ®Â§ßÂÜôÁöÑÂèòÈáèÂêçË°®Á§∫Â∏∏ÈáèÔºå‰∫ãÂÆû‰∏ä‰ªçÁÑ∂ÊòØ‰∏Ä‰∏™ÂèòÈáèÔºåPythonÊ†πÊú¨Ê≤°Êúâ‰ªª‰ΩïÊú∫Âà∂‰øùËØÅ‰∏ç‰ºöË¢´ÊîπÂèò„ÄÇ /Èô§Ê≥ïËÆ°ÁÆóÁªìÊûúÊòØÊµÆÁÇπÊï∞ÔºåÂç≥‰ΩøÊòØ‰∏§‰∏™Êï¥Êï∞ÊÅ∞Â•ΩÊï¥Èô§ÔºåÁªìÊûú‰πüÊòØÊµÆÁÇπÊï∞ÔºàÁß∞‰∏∫Âú∞ÊùøÈô§Ôºå‰∏§‰∏™Êï¥Êï∞ÁöÑÈô§Ê≥ï‰ªçÁÑ∂ÊòØÊï¥Êï∞Ôºâ„ÄÇ PythonÁöÑÊï¥Êï∞Ê≤°ÊúâÂ§ßÂ∞èÈôêÂà∂ÔºåËÄåÊüê‰∫õËØ≠Ë®ÄÁöÑÊï¥Êï∞Ê†πÊçÆÂÖ∂Â≠òÂÇ®ÈïøÂ∫¶ÊòØÊúâÂ§ßÂ∞èÈôêÂà∂ÁöÑÔºåPythonÁöÑÊµÆÁÇπÊï∞‰πüÊ≤°ÊúâÂ§ßÂ∞èÈôêÂà∂Ôºå‰ΩÜÊòØË∂ÖÂá∫‰∏ÄÂÆöËåÉÂõ¥Â∞±Áõ¥Êé•Ë°®Á§∫‰∏∫infÔºàÊó†ÈôêÂ§ßÔºâ„ÄÇ ASCIIÁºñÁ†ÅÊòØ1‰∏™Â≠óËäÇÔºåËÄåUnicodeÁºñÁ†ÅÈÄöÂ∏∏ÊòØ2‰∏™Â≠óËäÇ„ÄÇUTF-8ÁºñÁ†ÅÊää‰∏Ä‰∏™UnicodeÂ≠óÁ¨¶Ê†πÊçÆ‰∏çÂêåÁöÑÊï∞Â≠óÂ§ßÂ∞èÁºñÁ†ÅÊàê1-6‰∏™Â≠óËäÇÔºåÂ∏∏Áî®ÁöÑËã±ÊñáÂ≠óÊØçË¢´ÁºñÁ†ÅÊàê1‰∏™Â≠óËäÇÔºåÊ±âÂ≠óÈÄöÂ∏∏ÊòØ3‰∏™Â≠óËäÇÔºåÂè™ÊúâÂæàÁîüÂÉªÁöÑÂ≠óÁ¨¶Êâç‰ºöË¢´ÁºñÁ†ÅÊàê4-6‰∏™Â≠óËäÇ„ÄÇ Âú®ËÆ°ÁÆóÊú∫ÂÜÖÂ≠ò‰∏≠ÔºåÁªü‰∏Ä‰ΩøÁî®UnicodeÁºñÁ†ÅÔºåÂΩìÈúÄË¶Å‰øùÂ≠òÂà∞Á°¨ÁõòÊàñËÄÖÈúÄË¶Å‰º†ËæìÁöÑÊó∂ÂÄôÔºåÂ∞±ËΩ¨Êç¢‰∏∫UTF-8ÁºñÁ†Å„ÄÇÊúÄÊñ∞ÁöÑPython 3ÁâàÊú¨‰∏≠ÔºåÂ≠óÁ¨¶‰∏≤ÊòØ‰ª•UnicodeÁºñÁ†ÅÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÔºåPythonÁöÑÂ≠óÁ¨¶‰∏≤ÊîØÊåÅÂ§öËØ≠Ë®Ä„ÄÇ ÂØπ‰∫éÂçï‰∏™Â≠óÁ¨¶ÁöÑÁºñÁ†ÅÔºåPythonÊèê‰æõ‰∫Üord()ÂáΩÊï∞Ëé∑ÂèñÂ≠óÁ¨¶ÁöÑÊï¥Êï∞Ë°®Á§∫Ôºåchr()ÂáΩÊï∞ÊääÁºñÁ†ÅËΩ¨Êç¢‰∏∫ÂØπÂ∫îÁöÑÂ≠óÁ¨¶„ÄÇ Áî±‰∫éPythonÁöÑÂ≠óÁ¨¶‰∏≤Á±ªÂûãÊòØstrÔºåÂú®ÂÜÖÂ≠ò‰∏≠‰ª•UnicodeË°®Á§∫Ôºå‰∏Ä‰∏™Â≠óÁ¨¶ÂØπÂ∫îËã•Âπ≤‰∏™Â≠óËäÇ„ÄÇÂ¶ÇÊûúË¶ÅÂú®ÁΩëÁªú‰∏ä‰º†ËæìÔºåÊàñËÄÖ‰øùÂ≠òÂà∞Á£ÅÁõò‰∏äÔºåÂ∞±ÈúÄË¶ÅÊäästrÂèò‰∏∫‰ª•Â≠óËäÇ‰∏∫Âçï‰ΩçÁöÑbytes„ÄÇPythonÂØπbytesÁ±ªÂûãÁöÑÊï∞ÊçÆÁî®Â∏¶bÂâçÁºÄÁöÑÂçïÂºïÂè∑ÊàñÂèåÂºïÂè∑Ë°®Á§∫x = b&#39;ABC&#39;„ÄÇ bytesÁöÑÊØè‰∏™Â≠óÁ¨¶ÈÉΩÂè™Âç†Áî®‰∏Ä‰∏™Â≠óËäÇÔºå‰ª•UnicodeË°®Á§∫ÁöÑstrÈÄöËøáencode()ÊñπÊ≥ïÂèØ‰ª•ÁºñÁ†Å‰∏∫ÊåáÂÆöÁöÑbytesÔºå&#39;‰∏≠Êñá&#39;.encode(&#39;utf-8&#39;)ÔºåÂê´Êúâ‰∏≠ÊñáÁöÑstrÊó†Ê≥ïÁî®ASCIIÁºñÁ†ÅÔºåÂõ†‰∏∫‰∏≠ÊñáÁºñÁ†ÅÁöÑËåÉÂõ¥Ë∂ÖËøá‰∫ÜASCIIÁºñÁ†ÅÁöÑËåÉÂõ¥ÔºåPython‰ºöÊä•Èîô„ÄÇ Â¶ÇÊûúÊàë‰ª¨‰ªéÁΩëÁªúÊàñÁ£ÅÁõò‰∏äËØªÂèñ‰∫ÜÂ≠óËäÇÊµÅÔºåÈÇ£‰πàËØªÂà∞ÁöÑÊï∞ÊçÆÂ∞±ÊòØbytes„ÄÇË¶ÅÊääbytesÂèò‰∏∫strÔºåÂ∞±ÈúÄË¶ÅÁî®decode()ÊñπÊ≥ï„ÄÇ ËÆ°ÁÆóstrÂåÖÂê´Â§öÂ∞ë‰∏™Â≠óÁ¨¶ÔºåÂèØ‰ª•Áî®len()ÂáΩÊï∞Ôºålen()ÂáΩÊï∞ËÆ°ÁÆóÁöÑÊòØstrÁöÑÂ≠óÁ¨¶Êï∞ÔºåÂ¶ÇÊûúÊç¢ÊàêbytesÔºålen()ÂáΩÊï∞Â∞±ËÆ°ÁÆóÂ≠óËäÇÊï∞Ôºålen(&#39;‰∏≠Êñá&#39;)„ÄÇ Â≠óÁ¨¶‰∏≤ÈáåÈù¢ÁöÑ%ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÂ≠óÁ¨¶ÊÄé‰πàÂäûÔºüËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅËΩ¨‰πâÔºåÁî®%%Êù•Ë°®Á§∫‰∏Ä‰∏™%„ÄÇ ÂÆûÁªÉ1.‰ª£Á†Å‰∏≠Êúâ‰∏≠ÊñáÂøÖÈ°ªËÆæÁΩÆutf-8ÂçïË°åÊ≥®ÈáäÔºå‰ª•#ÂºÄÂ§¥„ÄÇÂ§öË°åÊ≥®Èáä‰ΩøÁî®3‰∏™ÂçïÂºïÂè∑„ÄÇ#coding=utf-8 2.ÂØºÂÖ•Ê®°Âùóimport time #ÂºïÂÖ•Êó∂Èó¥Ê®°Âùóimport randomimport calendar,osimport mathimport urllib.request # Áà¨ÂèñÊï∞ÊçÆfrom math import sqrt # ÊåáÂÆömathÊ®°Âùó‰∏≠ÁöÑsqrtÂáΩÊï∞ ÂΩìÂØºÂÖ•‰∏Ä‰∏™Ê®°ÂùóÔºåPythonËß£ÊûêÂô®ÂØπÊ®°Âùó‰ΩçÁΩÆÁöÑÊêúÁ¥¢È°∫Â∫èÊòØÔºö 1.ÂΩìÂâçÁõÆÂΩï„ÄÇ2.Â¶ÇÊûú‰∏çÂú®ÂΩìÂâçÁõÆÂΩïÔºåPythonÂàôÊêúÁ¥¢Âú®shellÂèòÈáèPYTHONPATH‰∏ãÁöÑÊØè‰∏™ÁõÆÂΩï„ÄÇ3.Â¶ÇÊûúÈÉΩÊâæ‰∏çÂà∞ÔºåPython‰ºöÊü•ÁúãÈªòËÆ§Ë∑ØÂæÑ„ÄÇUNIX‰∏ãÔºåÈªòËÆ§Ë∑ØÂæÑ‰∏ÄËà¨‰∏∫/usr/local/lib/python/„ÄÇ4.Ê®°ÂùóÊêúÁ¥¢Ë∑ØÂæÑÂ≠òÂÇ®Âú®systemÊ®°ÂùóÁöÑsys.pathÂèòÈáè‰∏≠„ÄÇÂèòÈáèÈáåÂåÖÂê´ÂΩìÂâçÁõÆÂΩïÔºåPYTHONPATHÂíåÁî±ÂÆâË£ÖËøáÁ®ãÂÜ≥ÂÆöÁöÑÈªòËÆ§ÁõÆÂΩï„ÄÇ Âú®Python‰∏≠ÔºåÊØè‰∏™PythonÊñá‰ª∂ÈÉΩÂèØ‰ª•‰Ωú‰∏∫‰∏Ä‰∏™Ê®°ÂùóÔºåÊ®°ÂùóÁöÑÂêçÂ≠óÂ∞±ÊòØÊñá‰ª∂ÁöÑÂêçÂ≠ó„ÄÇÂàõÂª∫text.pyÊñá‰ª∂ÔºåÂÆö‰πâÁõ∏ÂÖ≥ÂáΩÊï∞Ôºåimport text Âç≥ÂèØÂºïÁî®Ëá™Â∑±ÁöÑÊ®°Âùó„ÄÇÊ≥®ÊÑèÔºöÂÄòËã•Âú®text.py‰∏≠ÂÆö‰πâÂπ∂ÊâßË°åÁõ∏ÂÖ≥ÂáΩÊï∞ÔºåÂÖ∂‰ªñÊñá‰ª∂ÂºïÁî®‰πãÂêéÔºåÂπ∂‰∏ç‰ºöÊâßË°å„ÄÇÂáΩÊï∞‰ª£Á†ÅÔºåÂ∫îËØ•ÊòØÂçïÁã¨ÊâßË°åtext.pyÊñá‰ª∂Êó∂Êâç‰ºöÊâßË°å„ÄÇ from math import * 3.Âå∫ÂàÜÊñá‰ª∂ÊòØ‰∏ªÂä®ÊâßË°åÁöÑÔºåËøòÊòØË¢´Ë∞ÉÁî®ÊâßË°åÁöÑ„ÄÇÊ†πÊçÆ__name__ÂèòÈáèÁöÑÁªìÊûúËÉΩÂ§üÂà§Êñ≠Âá∫ÔºåÊòØÁõ¥Êé•ÊâßË°åÁöÑPythonËÑöÊú¨ËøòÊòØË¢´ÂºïÂÖ•ÊâßË°åÁöÑÔºå‰ªéËÄåËÉΩÂ§üÊúâÈÄâÊã©ÊÄßÁöÑÊâßË°åÊµãËØï‰ª£Á†Å„ÄÇÂ¶ÇÊûúÂΩìÂâçÊñá‰ª∂ÊòØ‰∏ªÂä®ÊâßË°åÁöÑÔºå__name__ ÂèòÈáèÁöÑÂÄºÂ∞±ÊòØÔºö__main__ÔºåÂ¶ÇÊûúÊòØË¢´ÂØºÂÖ•ÊâßË°åÁöÑÔºåÂàôÊòØË¢´ÂØºÂÖ•ÁöÑÊñá‰ª∂Âêç„ÄÇ if __name__ == "__main__": print("ÊòØÁõ¥Êé•ÊâßË°åÁöÑpyËÑöÊú¨, ËÄåÈùûÂºïÂÖ•") 4.‰ΩøÁî®printÂáΩÊï∞ËøõË°åÂ≠óÁ¨¶‰∏≤Ê†ºÂºèÂåñÊ†ºÂºèÊúâÔºö%c„ÄÅ%s„ÄÅ%i„ÄÅ%d„ÄÅ%uÔºàÊó†Á¨¶Âè∑ÂçÅËøõÂà∂Êï¥Êï∞Ôºâ„ÄÅ%o„ÄÅ%xÔºàÂçÅÂÖ≠ËøõÂà∂Â∞èÂÜôÔºâ„ÄÅ%XÔºàÂçÅÂÖ≠ËøõÂà∂Â§ßÂÜô Ôºâ„ÄÅ%fÁ≠â„ÄÇ print("hello world")a = 12b = 58c = "swe"print("hello %s ËøôÂ≠©Â≠ê %s ÂïäÂïäÂïä %s"%(a,b,c))print("sss",a) 5.ËæìÂÖ•inputs = input("ËØ∑ËæìÂÖ•Êï∞Â≠ó")print("ÊÇ®ÁöÑÊï∞Â≠óÊòØ:%s"%inputs)if inputs == 12: print("ÂìàÂìàÂìàÂìà") print("ÂòªÂòªÂòªÂòª")if inputs != 12: print("Âì¶Âì¶Âì¶Âì¶") 5.Êï∞ÊçÆÁ±ªÂûãÂú®python‰∏≠ÔºåÂè™Ë¶ÅÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂèòÈáèÔºåËÄå‰∏îÂÆÉÊúâÊï∞ÊçÆÔºåÈÇ£‰πàÂÆÉÁöÑÁ±ªÂûãÂ∞±Â∑≤ÁªèÁ°ÆÂÆö‰∫Ü„ÄÇÂèØ‰ª•‰ΩøÁî®type(ÂèòÈáèÁöÑÂêçÂ≠ó)Êù•Êü•ÁúãÂèòÈáèÁöÑÁ±ªÂûãÔºåÊØîÂ¶ÇÔºötype(a)„ÄÇ Â∏∏Áî®ÁöÑÊï∞ÊçÆÁ±ªÂûã: Numbers(ÂåÖÊã¨int long float complex) Â∏ÉÂ∞î True/False String List Tuple(ÂÖÉÁªÑ) Dictionary‚Ä¶ 6.Ê†áËØÜÁ¨¶Ê†áËØÜÁ¨¶Áî±Â≠óÁ¨¶Êï∞Â≠ó‰∏ãÂàíÁ∫øÁªÑÊàêÔºåÊ≤°ÊúâÁæéÂÖÉÁ¨¶Âè∑Ôºå‰∏îÂå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇÂëΩÂêçËßÑÂàôÔºöÈ©ºÂ≥∞ÂºèÊàñËÄÖ‰∏ãÂàíÁ∫øËøûÊé•„ÄÇ 7.ËøêÁÆóÁ¨¶ % Âèñ‰ΩôÔºåÊØîÂ¶Ç 3%2„ÄÇ ** ÂπÇÔºåÊØîÂ¶Ç3**2Ë°®Á§∫3ÁöÑ2Ê¨°Êñπ„ÄÇ // ÂèñÊï¥Èô§„ÄÇ / Ê≠£Â∏∏Èô§Ê≥ïÔºåÂèØÊúâ‰ΩôÊï∞„ÄÇ 8.ÈÄªËæëËøêÁÆó and or not ‰∏éif inputs == 15 and a == 12: print("and") Êàñif inputs == 15 or b == 58: print("or") Èùûif not a == 12: print("not") 9.Â§öÈáçÂà§Êñ≠ if ‰∏é elifscore = 99if score &lt; 60: print("‰∏çÂèäÊ†º")elif score &lt;80: print("ËâØÂ•Ω")elif score &lt; 90: print("‰∏çÈîô")else: print("‰ºòÁßÄ") 10.ifÂµåÂ•óa = 14if a &gt; 12 and a &lt; 18: if a &gt; 12: print("a&gt;12") else: print("a&lt;18")else: print("a&lt;=12, a&gt;=18") 11.whileÂæ™ÁéØ‰∏éÂæ™ÁéØÂµåÂ•ówhile a == 12: print("‰Ω†‰∏çÂ•Ω") a = 13while b == 58: print("ÂìàÂìàÂìàÂìà") b = 59 12.forÂæ™ÁéØ:i‰ªé0ÂºÄÂßã,ÊØèÊ¨°Ëá™Â¢û1for i in range(12): if i == 5: continue#Ë∑≥Ëøái==5ËøôÊ¨° print('i=%s'%i) if i == 10: print("ÂÅúÊ≠¢break") break 13.ÂÆö‰πâÂáΩÊï∞ print1def print1(): print("ÂáΩÊï∞")#Ë∞ÉÁî®ÂáΩÊï∞print1print1() 14.Â∏∏Áî®ÂáΩÊï∞#Êó∂Èó¥ÂáΩÊï∞import timet = time.time()#ÂèñÂá∫ÂΩìÂâçÊó∂Èó¥,‰ª•Áßí‰∏∫Âçï‰ΩçÁöÑÊµÆÁÇπÂ∞èÊï∞t2 = time.localtime(t)#ÂèñÂá∫Êú¨Âú∞Êó∂Èó¥t3 = time.asctime(t2) #Ê†áÂáÜÊ†ºÂºèFri Jun 10 10:58:53 2016print(t3)#Êó•ÂéÜÂáΩÊï∞ import calendarcal = calendar.month(2016,8)print(cal) #ÊâìÂç∞Êó•ÂéÜ#ÈöèÊú∫Êï∞ÂáΩÊï∞ import randomr = random.randint(1,3)#‰ªé1Âà∞3ËåÉÂõ¥ÂÜÖÁöÑÊï¥Êï∞,ÂåÖÊã¨1Âíå3print(r)r2 = random.randrange(1,25,5)#‰ªé1ÂºÄÂßãÂà∞25ÁªìÊùüÈÄíÂ¢ûÂü∫Êï∞‰∏∫5print(r2)r3 = random.uniform(1,5) #ÊúÄÂ∞èÂÄº1ÊúÄÂ§ßÂÄº5,ËøîÂõûÊµÆÁÇπÊï∞print(r3)random.random() #ÁîüÊàê0&lt;=n&lt;=1ÁöÑÊµÆÁÇπÊï∞ 15.Â≠óÁ¨¶‰∏≤#Áõ∏ÂΩì‰∫éÂ≠óÁ¨¶Êï∞ÁªÑ,ÂèØ‰ª•ÈÄöËøá‰∏ãÊ†áÂèñÂá∫Â≠óÁ¨¶,ss = "qwertyu"print(ss[1])#ÂèñÂá∫‰∏ãÊ†á‰ªé1Âà∞3 ÁöÑÂ≠óÁ¨¶,ÂåÖÊã¨‰∏äËæπÁïå,‰∏çÂåÖÊã¨‰∏ãËæπÁïåprint(ss[1:3])#‰ªé‰∏ãÊ†á2ÂºÄÂßã ÂèñÂà∞ÊúÄÂêéprint(ss[2:])#‰ªé‰∏ãÊ†á2ÂºÄÂßãÂà∞‰∏ãÊ†á-2,‰∏çÂåÖÊã¨‰∏ãÊ†á-2print(ss[2:-2])#ÂèñÂá∫ÊúÄÂêé4‰∏™Â≠óÁ¨¶print(ss[-4:]) 16.Â≠óÁ¨¶‰∏≤Â∏∏ËßÅÊìç‰Ωúsub = "my"s = "itismyapple"#Êü•Êâæ:Ê£ÄÊµãsubÊòØÂê¶Âú®s‰∏≠:s.find(sub, start=0, end=len(mystr))#Êü•ÊâæÊàêÂäüËøîÂõûÂºÄÂßãÁöÑÁ¥¢Âºï,Âê¶ÂàôËøîÂõû-1s.find(sub)re = s.find(sub,1,8)#‰ªé‰∏ãÊ†á1ÂºÄÂßãÊü•Êâæ,Âà∞‰∏ãÊ†á‰∏∫8ÁªìÊùüprint(re)s.index(sub)#‰∏éfindÁõ∏Âêå,Âè™‰∏çËøáÊ≤°ÊúâÊâæÂà∞‰ºöÊäõÂá∫ÂºÇÂ∏∏#ËøîÂõû Âú®startÂíåend‰πãÈó¥(ÂåÖÊã¨) Âú® sÈáåÈù¢Âá∫Áé∞ÁöÑÊ¨°Êï∞c = s.count("i", 0,8)print(c)#Êää s ‰∏≠ÁöÑ str1 ÊõøÊç¢Êàê str2,Â¶ÇÊûú count ÊåáÂÆöÔºåÂàôÊõøÊç¢‰∏çË∂ÖËøá count Ê¨°.s.replace("t","d",2)#‰ª• " " ‰∏∫ÂàÜÈöîÁ¨¶ÂàáÁâá sÔºåÂ¶ÇÊûú maxsplitÊúâÊåáÂÆöÂÄºÔºåÂàô‰ªÖÂàÜÈöî maxsplit ‰∏™Â≠êÂ≠óÁ¨¶‰∏≤s.split(" ",5)#ÊääÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶Â§ßÂÜôs.capitalize()#Ê£ÄÊü•Â≠óÁ¨¶‰∏≤ÊòØÂê¶ÊòØ‰ª• obj ÂºÄÂ§¥, ÊòØÂàôËøîÂõû TrueÔºåÂê¶ÂàôËøîÂõû Falses.startswith("i")#Ê£ÄÊü•Â≠óÁ¨¶‰∏≤ÊòØÂê¶‰ª•objÁªìÊùüÔºåÂ¶ÇÊûúÊòØËøîÂõûTrue,Âê¶ÂàôËøîÂõû False.s.endswith("d")#ËΩ¨Êç¢ s ‰∏≠ÊâÄÊúâÂ§ßÂÜôÂ≠óÁ¨¶‰∏∫Â∞èÂÜôs.lower()#ËΩ¨Êç¢ s ‰∏≠ÁöÑÂ∞èÂÜôÂ≠óÊØç‰∏∫Â§ßÂÜôs.upper()#ËøîÂõû‰∏Ä‰∏™ÂéüÂ≠óÁ¨¶‰∏≤Â∑¶ÂØπÈΩê,Âπ∂‰ΩøÁî®Á©∫Ê†ºÂ°´ÂÖÖËá≥ÈïøÂ∫¶ width ÁöÑÊñ∞Â≠óÁ¨¶‰∏≤s.ljust(5) #ËøîÂõû "itismyapple "#ËøîÂõû‰∏Ä‰∏™ÂéüÂ≠óÁ¨¶‰∏≤Âè≥ÂØπÈΩê,Âπ∂‰ΩøÁî®Á©∫Ê†ºÂ°´ÂÖÖËá≥ÈïøÂ∫¶ width ÁöÑÊñ∞Â≠óÁ¨¶‰∏≤s.rjust(5) #ËøîÂõû" itismyapple"#ËøîÂõû‰∏Ä‰∏™ÂéüÂ≠óÁ¨¶‰∏≤Â±Ö‰∏≠,Âπ∂‰ΩøÁî®Á©∫Ê†ºÂ°´ÂÖÖËá≥ÈïøÂ∫¶ width ÁöÑÊñ∞Â≠óÁ¨¶‰∏≤"s".center(10) #" s "#Âà†Èô§ s Â∑¶ËæπÁöÑÁ©∫Ê†ºs.lstrip()#Âà†Èô§ s Â≠óÁ¨¶‰∏≤Êú´Â∞æÁöÑÁ©∫Ê†ºs.rstrip()#Á±ª‰ºº‰∫é find()ÂáΩÊï∞Ôºå‰∏çËøáÊòØ‰ªéÂè≥ËæπÂºÄÂßãÊü•Êâæ."sieiess".rfind("ie") #ËøîÂõû3# Á±ª‰ºº‰∫é index()Ôºå‰∏çËøáÊòØ‰ªéÂè≥ËæπÂºÄÂßã.s.rindex("s")#Êää"asdeeeads"‰ª•strÂàÜÂâ≤Êàê‰∏âÈÉ®ÂàÜ,strÂâçÔºåstrÂíåstrÂêé"asdeeeads".partition("eee")#Á±ª‰ºº‰∫é partition()ÂáΩÊï∞,‰∏çËøáÊòØ‰ªéÂè≥ËæπÂºÄÂßã."asdeeeads".rpartition("eee")#ÊåâÁÖßË°åÂàÜÈöîÔºåËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÂêÑË°å‰Ωú‰∏∫ÂÖÉÁ¥†ÁöÑÂàóË°®"asas\nds".splitlines()#Â¶ÇÊûú mystr ÊâÄÊúâÂ≠óÁ¨¶ÈÉΩÊòØÂ≠óÊØçÊàñÊï∞Â≠óÂàôËøîÂõû True,Âê¶ÂàôËøîÂõû False"ssd".isalnum()#Â¶ÇÊûú mystr ÊâÄÊúâÂ≠óÁ¨¶ÈÉΩÊòØÂ≠óÊØç ÂàôËøîÂõû True,Âê¶ÂàôËøîÂõû False"ssd".isalpha()#Â¶ÇÊûú mystr Âè™ÂåÖÂê´Êï∞Â≠óÂàôËøîÂõû True Âê¶ÂàôËøîÂõû False."232".isdigit()#Â¶ÇÊûú mystr ‰∏≠Âè™ÂåÖÂê´Á©∫Ê†ºÔºåÂàôËøîÂõû TrueÔºåÂê¶ÂàôËøîÂõû False." ".isspace()#Â¶ÇÊûú mystr ÊâÄÊúâÂ≠óÁ¨¶ÈÉΩÊòØÂ§ßÂÜôÔºåÂàôËøîÂõû TrueÔºåÂê¶ÂàôËøîÂõû False"sd".isupper()#mystr ‰∏≠ÊØè‰∏™Â≠óÁ¨¶ÂêéÈù¢ÊèíÂÖ•str,ÊûÑÈÄ†Âá∫‰∏Ä‰∏™Êñ∞ÁöÑÂ≠óÁ¨¶‰∏≤"sasd".join("s") 17.ÂàóË°®A = ["ds3s","ds4s","a4sd"]print(A[0])for a in A: print(a)#ÊâìÂç∞ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†# ÂàóË°®Â¢ûÂä†ÂÖÉÁ¥†A.append("asasdad")for a in A: print(a)#ÊâìÂç∞ÊØè‰∏Ä‰∏™ÂÖÉÁ¥†# ‰øÆÊîπA[0] = "1"# Êü•Êâæif "1" in A: print("1Â≠òÂú®‰∫éa‰∏≠")if "1" not in A: print("1‰∏çÂ≠òÂú®‰∏éa‰∏≠")# Âà†Èô§ÂÖÉÁ¥†#delÔºöÊ†πÊçÆ‰∏ãÊ†áËøõË°åÂà†Èô§#popÔºöÂà†Èô§ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†#removeÔºöÊ†πÊçÆÂÖÉÁ¥†ÁöÑÂÄºËøõË°åÂà†Èô§del A[0]A.pop()A.remove("ds4s")for a in A: print(a)#ÊâìÂç∞ÊØè‰∏Ä‰∏™ÂÖÉÁ¥† 18.ÁªüËÆ°Â≠óÁ¨¶‰∏™Êï∞cstr = input("ËØ∑ËæìÂÖ•Â≠óÁ¨¶")for c in cstr: print("%c:%d"%(c,cstr.count(c))) 19.Â≠óÂÖ∏info = &#123;"name":"zhangsan","age":12&#125;print(info["name"])#Â¢ûÂä†ÈîÆÂÄºÂØπinfo["sex"] = "man"#Âà†Èô§ÂÖÉÁ¥†del info["age"]#Ê∏ÖÁ©∫Â≠óÂÖ∏info.clear()#Âà†Èô§Êï¥‰∏™Â≠óÂÖ∏del info#Ê≥®ÊÑèÂà†Èô§Â≠óÂÖ∏ÂíåÊ∏ÖÁ©∫Â≠óÂÖ∏ÁöÑÂå∫Âà´#Â≠óÂÖ∏Â∏∏Áî®Êìç‰Ωúinfo2 = &#123;"name":"zhangsan","age":12&#125;#ÊµãÈáèÂ≠óÂÖ∏‰∏≠ÔºåÈîÆÂÄºÂØπÁöÑ‰∏™Êï∞len(info2)#ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´Â≠óÂÖ∏ÊâÄÊúâKEYÁöÑÂàóË°®info2.keys()#ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´Â≠óÂÖ∏ÊâÄÊúâvalueÁöÑÂàóË°®info2.values()#ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâÔºàÈîÆÔºåÂÄºÔºâÂÖÉÁªÑÁöÑÂàóË°®info2.items()#if "name" in info2Â¶ÇÊûúkeyÂú®Â≠óÂÖ∏‰∏≠ÔºåËøîÂõûTrueÔºåÂê¶ÂàôËøîÂõûFalseif "name" in info2: print("Â≠òÂú®")#ÈÅçÂéÜÈîÆ/ÂÄº/ÈîÆÂÄºÂØπfor key,value in info2.items(): print(key,value) 20.ÂÖÉÁªÑPythonÁöÑÂÖÉÁªÑ‰∏éÂàóË°®Á±ª‰ººÔºå‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÂÖÉÁªÑÁöÑÂÖÉÁ¥†‰∏çËÉΩ‰øÆÊîπ„ÄÇ‰πüÂèØËøõË°åÂàÜÁâáÂíåËøûÊé•Êìç‰Ωú„ÄÇÂÖÉÁªÑ‰ΩøÁî®Â∞èÊã¨Âè∑ÔºåÂàóË°®‰ΩøÁî®ÊñπÊã¨Âè∑„ÄÇ atuple = ("as",121,True,False,0)atuple2 = ("a",121,True,False,40)print(atuple[1])#ÂêàÊàêÊñ∞ÂÖÉÁªÑatuple3 = atuple + atuple2#Âà†Èô§ÂÖÉÁ¥†#ÂÖÉÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†ÂÄºÊòØ‰∏çÂÖÅËÆ∏Âà†Èô§ÁöÑÔºå‰ΩÜÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®delËØ≠Âè•Êù•Âà†Èô§Êï¥‰∏™ÂÖÉÁªÑdel atuple3 21.ÂÖÉÁªÑËøêÁÆóÁ¨¶‰∏éÂ≠óÁ¨¶‰∏≤‰∏ÄÊ†∑ÔºåÂÖÉÁªÑ‰πãÈó¥ÂèØ‰ª•‰ΩøÁî® + Âè∑Âíå * Âè∑ËøõË°åËøêÁÆó„ÄÇËøôÂ∞±ÊÑèÂë≥ÁùÄ‰ªñ‰ª¨ÂèØ‰ª•ÁªÑÂêàÂíåÂ§çÂà∂ÔºåËøêÁÆóÂêé‰ºöÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑÂÖÉÁªÑ„ÄÇ(1, 2, 3) + (4, 5, 6)['Hi!'] * 4 #['Hi!', 'Hi!', 'Hi!', 'Hi!']3 in (1, 2, 3) #True 22.ÂÖÉÁªÑÁ¥¢ÂºïÊà™ÂèñÂõ†‰∏∫ÂÖÉÁªÑ‰πüÊòØ‰∏Ä‰∏™Â∫èÂàóÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ËÆøÈóÆÂÖÉÁªÑ‰∏≠ÁöÑÊåáÂÆö‰ΩçÁΩÆÁöÑÂÖÉÁ¥†Ôºå‰πüÂèØ‰ª•Êà™ÂèñÁ¥¢Âºï‰∏≠ÁöÑ‰∏ÄÊÆµÂÖÉÁ¥†ÊØîËæÉ‰∏§‰∏™ÂÖÉÁªÑÂÖÉÁ¥†„ÄÇ#cmp(tuple1, tuple2)tuple2 = (12,234,546,56)tuple2s = [12,23]#ËÆ°ÁÆóÂÖÉÁªÑÂÖÉÁ¥†‰∏™Êï∞„ÄÇlen(tuple2)#ËøîÂõûÂÖÉÁªÑ‰∏≠ÂÖÉÁ¥†ÊúÄÂ§ßÂÄº„ÄÇmax(tuple2)#ËøîÂõûÂÖÉÁªÑ‰∏≠ÂÖÉÁ¥†ÊúÄÂ∞èÂÄº„ÄÇmin(tuple2)#Â∞ÜÂàóË°®ËΩ¨Êç¢‰∏∫ÂÖÉÁªÑ„ÄÇtuple(tuple2s) 23.Â§öÁª¥ÂÖÉÁªÑtuple3 = [(2,4,5,4),(2,5,6)]tuple3[1] #(2,5,6)tuple3[1][0] #2 24.ÂáΩÊï∞Â∏¶ÊúâÂèÇÊï∞ÂíåÊúâËøîÂõûÂÄºÁöÑÂáΩÊï∞def sum(a,b): return a+bprint(sum(45,1)) Áº∫ÁúÅÂáΩÊï∞def sum2(a,b = 25): return a+bprint(sum2(232))print(sum2(232,1)) ‰∏çÂÆöÈïøÂèÇÊï∞Âä†‰∫ÜÊòüÂè∑Ôºà*ÔºâÁöÑÂèòÈáèÂêç‰ºöÂ≠òÊîæÊâÄÊúâÊú™ÂëΩÂêçÁöÑÂèòÈáèÂèÇÊï∞„ÄÇÂèÇÊï∞‰ª•‰∏Ä‰∏™*Âè∑ÂºÄÂ§¥ÁöÑ‰ª£Ë°®ÁùÄ‰∏Ä‰∏™‰ªªÊÑèÈïøÂ∫¶ÁöÑÂÖÉÁªÑ(tuple)ÔºåÂèØ‰ª•Êé•Êî∂ËøûÁª≠‰∏Ä‰∏≤ÂèÇÊï∞„ÄÇdef printinfo(a,b,*cs): print(a,b) for c in cs: print(c)printinfo(23,3,34,4,6,2) ÂáΩÊï∞ÁöÑÂµåÂ•ó‰ΩøÁî®def print3(a,b): print(a,b) print(sum(a,b))print3(2,23) ÊâìÂç∞ÊåáÂÆöÊù°Ê®™Á∫ødef printline(): print("-"*20)def printlinewithnum(a): for i in range(a): printline() print("\n")printlinewithnum(5) 25.ÂèòÈáèÂ±ÄÈÉ®ÂèòÈáèÔºåÊòØÂú®ÂáΩÊï∞ÂÜÖÈÉ®ÂÆö‰πâÁöÑÂèòÈáè„ÄÇÂÖ®Â±ÄÂèòÈáèÔºåËÉΩÂú®Êüê‰∏ÄÂáΩÊï∞‰∏≠‰ΩøÁî®Ôºå‰πüËÉΩÂú®ÂÖ∂‰ªñÂáΩÊï∞‰∏≠‰ΩøÁî®„ÄÇÂÖ®Â±ÄÂèòÈáèËÉΩÂ§üÂú®ÊâÄÊúâÁöÑÂáΩÊï∞‰∏≠ËøõË°åËÆøÈóÆ„ÄÇÂ¶ÇÊûúÂú®ÂáΩÊï∞‰∏≠‰øÆÊîπÂÖ®Â±ÄÂèòÈáèÔºåÈÇ£‰πàÂ∞±ÈúÄË¶Å‰ΩøÁî®globalËøõË°åÂ£∞ÊòéÔºåÂê¶ÂàôÂá∫Èîô„ÄÇ gol = 12def chnum(): global gol #Â£∞ÊòéÊ≠§Â§ÑÁöÑgolÊòØÁâπÊåáÂÖ®Â±ÄÂèòÈáè,ËÄåÈùûÈáçÂêçÁöÑÂ±ÄÈÉ®ÂèòÈáè gol = 13 print(gol)chnum()print(gol) 26.ÈÄíÂΩíÂáΩÊï∞Á§∫‰æã:ËÆ°ÁÆónÁöÑÈò∂‰πòdef calnum(n): i = 1 result = 1 while i &lt;= n: result *= i i += 1 return resultprint(calnum(1))print(calnum(0))def calnum2(n): if n &gt;= 1: return n * calnum2(n-1) else: return 1print(calnum2(1))print(calnum2(0)) 27.ÂåøÂêçÂáΩÊï∞Áî®lambdaÂÖ≥ÈîÆËØçËÉΩÂàõÂª∫Â∞èÂûãÂåøÂêçÂáΩÊï∞„ÄÇLambdaÂáΩÊï∞ËÉΩÊé•Êî∂‰ªª‰ΩïÊï∞ÈáèÁöÑÂèÇÊï∞‰ΩÜÂè™ËÉΩËøîÂõû‰∏Ä‰∏™Ë°®ËææÂºèÁöÑÂÄº„ÄÇÂåøÂêçÂáΩÊï∞‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî®printÔºåÂõ†‰∏∫lambdaÈúÄË¶Å‰∏Ä‰∏™Ë°®ËææÂºè„ÄÇsum4 = lambda a,b,c,d:a + b + c + dprint(sum4(1,3,4,6)) 28.‰ΩçËøêÁÆó:Áõ¥Êé•Êìç‰Ωú‰∫åËøõÂà∂Êï∞&amp; Êåâ‰Ωç‰∏é Âè™ÊúâÂØπÂ∫îÁöÑ‰∏§‰∏™‰∫åËøõ‰ΩçÂùá‰∏∫1Êó∂,ÁªìÊûú‰ΩçÊâç‰∏∫1| Êåâ‰ΩçÊàñ Âè™Ë¶ÅÂØπÂ∫îÁöÑ‰∫å‰∏™‰∫åËøõ‰ΩçÊúâ‰∏Ä‰∏™‰∏∫1Êó∂,ÁªìÊûú‰ΩçÂ∞±‰∏∫1,Âê¶Âàô‰∏∫0^ Êåâ‰ΩçÂºÇÊàñ ‰∏çÂêå‰∏∫1 ÂΩìÂØπÂ∫îÁöÑ‰∫åËøõ‰ΩçÁõ∏ÂºÇ(‰∏çÁõ∏Âêå)Êó∂,ÁªìÊûú‰∏∫1,Âê¶Âàô‰∏∫0~ Êåâ‰ΩçÂèñÂèç&lt;&lt; Êåâ‰ΩçÂ∑¶Áßª:Â∑¶Áßª‰∏Ä‰ΩçÂç≥‰πò‰ª•2,ÂèØËÉΩÊîπÂèò‰∏Ä‰∏™Êï∞ÁöÑÊ≠£Ë¥ü&gt;&gt; Êåâ‰ΩçÂè≥Áßª::Âè≥Áßª‰∏Ä‰ΩçÂç≥Èô§‰ª•20b1011 &amp; 0b10010101100b1000110 | 0b100100b11101 ^ 0b110000011~132print(12&lt;&lt;3)print(1024&gt;&gt;4) ËøõÂà∂‰π¶ÂÜô0o377 #ÂÖ´ËøõÂà∂0xFF #ÂçÅÂÖ≠ËøõÂà∂0b010010110 #‰∫åËøõÂà∂ ËøõÂà∂ËΩ¨Êç¢print(type(oct(25))) #ËΩ¨ÂÖ´ËøõÂà∂Â≠óÁ¨¶‰∏≤hex(25) #ËΩ¨ÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤bin(25) #ËΩ¨‰∫åËøõÂà∂Â≠óÁ¨¶‰∏≤ 29.Êï∞ÊçÆÁ±ªÂûãËΩ¨Êç¢int("123") #Â≠óÁ¨¶‰∏≤ËΩ¨Êï∞ÂÄºfloat("2324.3") #Â∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ÊµÆÁÇπÊï∞print(complex(1.2,3.2)) #ÂàõÂª∫‰∏Ä‰∏™Â§çÊï∞,Âú® Python ‰∏≠ÔºåÂ§çÊï∞ÁöÑËôöÈÉ®Ë¢´Ë°®Á§∫‰∏∫ jprint(3.2+1.4j)print(str(23)) #Â∞Ü23ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤print(repr(124)) #ËΩ¨Êç¢‰∏∫Ë°®ËææÂºèÂ≠óÁ¨¶‰∏≤tuple([23,3])list((23,234))chr(2)ord("d") ÂÆûÁé∞‰πòÊ≥ïË°®def print6(): i = 1 while i &lt;= 9: j = i while j &lt;= 9: print("%d*%d=%d"%(i,j,i*j)) j += 1 i += 1print6() 30.ÊâìÂºÄÊñá‰ª∂‰ΩøÁî®openÂáΩÊï∞ÔºåÂèØ‰ª•ÊâìÂºÄ‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÊñá‰ª∂ÔºåÊàñËÄÖÂàõÂª∫‰∏Ä‰∏™Êñ∞Êñá‰ª∂„ÄÇopen(Êñá‰ª∂ÂêçÔºåËÆøÈóÆÊ®°Âºè) ËøîÂõûÊñá‰ª∂Âè•ÊüÑ„ÄÇ f = open("s.txt","w")f.close()#ÂÖ≥Èó≠Êñá‰ª∂ Á¨¶Âè∑ Èáä‰πâ r ‰ª•Âè™ËØªÊñπÂºèÊâìÂºÄÊñá‰ª∂„ÄÇÊñá‰ª∂ÁöÑÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÂºÄÂ§¥„ÄÇËøôÊòØÈªòËÆ§Ê®°Âºè„ÄÇ w ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Âè™Áî®‰∫éÂÜôÂÖ•„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÂàôÂ∞ÜÂÖ∂Ë¶ÜÁõñ„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Êñ∞Êñá‰ª∂„ÄÇ rb ‰ª•‰∫åËøõÂà∂Ê†ºÂºèÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éÂè™ËØª„ÄÇÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÂºÄÂ§¥„ÄÇËøôÊòØÈªòËÆ§Ê®°Âºè„ÄÇ wb ‰ª•‰∫åËøõÂà∂Ê†ºÂºèÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Âè™Áî®‰∫éÂÜôÂÖ•„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÂàôÂ∞ÜÂÖ∂Ë¶ÜÁõñ„ÄÇ ab ‰ª•‰∫åËøõÂà∂Ê†ºÂºèÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËøΩÂä†„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÔºåÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÁªìÂ∞æ„ÄÇ r+ ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËØªÂÜô„ÄÇÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÂºÄÂ§¥„ÄÇ w+ ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËØªÂÜô„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÂàôÂ∞ÜÂÖ∂Ë¶ÜÁõñ„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Êñ∞Êñá‰ª∂„ÄÇ a+ ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËØªÂÜô„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÔºåÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÁªìÂ∞æ„ÄÇ a ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËøΩÂä†„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÔºåÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÁªìÂ∞æ„ÄÇÊñá‰ª∂ÊâìÂºÄÊó∂‰ºöÊòØËøΩÂä†Ê®°Âºè„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Êñ∞Êñá‰ª∂Áî®‰∫éËØªÂÜô„ÄÇ rb+ ‰ª•‰∫åËøõÂà∂Ê†ºÂºèÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËØªÂÜô„ÄÇÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÂºÄÂ§¥„ÄÇ wb+ ‰ª•‰∫åËøõÂà∂Ê†ºÂºèÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËØªÂÜô„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÂàôÂ∞ÜÂÖ∂Ë¶ÜÁõñ„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Êñ∞Êñá‰ª∂„ÄÇ ab+ ‰ª•‰∫åËøõÂà∂Ê†ºÂºèÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Áî®‰∫éËøΩÂä†„ÄÇÂ¶ÇÊûúËØ•Êñá‰ª∂Â∑≤Â≠òÂú®ÔºåÊñá‰ª∂ÊåáÈíàÂ∞Ü‰ºöÊîæÂú®Êñá‰ª∂ÁöÑÁªìÂ∞æ„ÄÇ ÂÜôÊï∞ÊçÆÂà∞Êñá‰ª∂f = open("s1","w")f.write("hello world")f.close() ËØªÊï∞ÊçÆf = open("s1")content = f.read(5) #ËØªÂèñÊï∞ÊçÆÈïøÂ∫¶,Â≠óËäÇ‰∏∫Âçï‰Ωçprint(content)f.close() readlinesÊåâÁÖßË°åÁöÑÊñπÂºèÊääÊï¥‰∏™Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπËøõË°å‰∏ÄÊ¨°ÊÄßËØªÂèñÔºåËøîÂõûÁöÑÊòØ‰∏Ä‰∏™ÂàóË°®ÔºåÊØè‰∏ÄË°åÁöÑÊï∞ÊçÆ‰∏∫‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÇf = open("s")content2 = f.readlines()print(content2[2])f.close() Ëé∑ÂèñÂΩìÂâçËØªÂÜôÁöÑ‰ΩçÁΩÆf = open("222.txt", "r+")f.write("123243454566")str12 = f.read(3)print("ËØªÂèñÁöÑÊï∞ÊçÆÊòØ : ",str12) Êü•ÊâæÂΩìÂâç‰ΩçÁΩÆposition = f.tell()print("ÂΩìÂâçÊñá‰ª∂‰ΩçÁΩÆ : ", position)f.close() Â¶ÇÊûúÂú®ËØªÂÜôÊñá‰ª∂ÁöÑËøáÁ®ã‰∏≠ÔºåÈúÄË¶Å‰ªéÂè¶Â§ñ‰∏Ä‰∏™‰ΩçÁΩÆËøõË°åÊìç‰ΩúÁöÑËØùÔºåÂèØ‰ª•‰ΩøÁî®seek()Ôºåseek(offset, from)Êúâ2‰∏™ÂèÇÊï∞Ôºö offset:ÂÅèÁßªÈáè from:ÊñπÂêë 0:Ë°®Á§∫Êñá‰ª∂ÂºÄÂ§¥ 1:Ë°®Á§∫ÂΩìÂâç‰ΩçÁΩÆ 2:Ë°®Á§∫Êñá‰ª∂Êú´Â∞æ f = open("s", "r")str33 = f.read(30)print("ËØªÂèñÁöÑÊï∞ÊçÆÊòØ : ", str33)# Êü•ÊâæÂΩìÂâç‰ΩçÁΩÆposition = f.tell()print("ÂΩìÂâçÊñá‰ª∂‰ΩçÁΩÆ : ", position)# ÈáçÊñ∞ËÆæÁΩÆ‰ΩçÁΩÆf.seek(5,0)f.close() 31.Êñá‰ª∂Êìç‰ΩúÊñá‰ª∂ÈáçÂëΩÂêçÈúÄË¶Åimport osÔºåosÊ®°Âùó‰∏≠ÁöÑrename()ÂèØ‰ª•ÂÆåÊàêÂØπÊñá‰ª∂ÁöÑÈáçÂëΩÂêçÊìç‰Ωú„ÄÇos.rename(&quot;s1&quot;,&quot;s111&quot;) Âà†Èô§Êñá‰ª∂os.remove(&quot;s111&quot;) ÂàõÂª∫Êñá‰ª∂Â§πos.mkdir(&quot;haha&quot;) Ëé∑ÂèñÂΩìÂâçÁõÆÂΩïprint(os.getcwd()) ÊîπÂèòÈªòËÆ§ÁõÆÂΩïos.chdir(&quot;../&quot;) Ëé∑ÂèñÁõÆÂΩï‰∏≠ÂÜÖÂÆπÂàóË°®,ËøîÂõûÊï∞ÁªÑos.listdir(&quot;./&quot;) Âà†Èô§Êñá‰ª∂Â§πos.rmdir(&quot;haha&quot;) Âà§Êñ≠ÊòØÂê¶ÊòØÁõÆÂΩïos.path.isdir(&quot;./react&quot;) Âà§Êñ≠ÊòØÂê¶ÊòØÊñá‰ª∂os.path.isfile(&quot;./s&quot;) 32.ÊçïËé∑ÂºÇÂ∏∏try: open("ssss","r")#ÊåáÂÆöÂºÇÂ∏∏Á±ªÂûã ÂÆö‰πâÂºÇÂ∏∏ÂèòÈáèexcept IOError as errmsg: print("ÊçïËé∑Âà∞ÂºÇÂ∏∏",errmsg) print("-"*10)#Â§ö‰∏™ÂºÇÂ∏∏try: open("ssss","r")#ÊåáÂÆöÂºÇÂ∏∏Á±ªÂûã ÂÆö‰πâÂºÇÂ∏∏ÂèòÈáèexcept (IOError,NameError) as errmsg: print("ÊçïËé∑Âà∞ÂºÇÂ∏∏",errmsg) print("-"*10)#‰∏çÊåáÂÆöÂºÇÂ∏∏try: open("ssss","r")#ÊåáÂÆöÂºÇÂ∏∏Á±ªÂûã ÂÆö‰πâÂºÇÂ∏∏ÂèòÈáèexcept : print("ÊçïËé∑Âà∞ÂºÇÂ∏∏") print("-"*10) Â∏∏ËßÅÂºÇÂ∏∏Ôºö ÂêçÁß∞ Ëß£Èáä Exception ÊâÄÊúâÂºÇÂ∏∏ÁöÑÂü∫Á±ª AttributeError ÁâπÊÄßÂ∫îÁî®ÊàñËµãÂÄºÂ§±Ë¥•Êó∂ÂºïÂèë IOError ËØïÂõæÊâìÂºÄ‰∏çÂ≠òÂú®ÁöÑÊñá‰ª∂Êó∂ÂºïÂèë IndexError Âú®‰ΩøÁî®Â∫èÂàó‰∏≠‰∏çÂ≠òÂú®ÁöÑÁ¥¢ÂºïÊó∂ÂºïÂèë KeyError Âú®‰ΩøÁî®Êò†Â∞Ñ‰∏çÂ≠òÂú®ÁöÑÈîÆÊó∂ÂºïÂèë NameError Âú®Êâæ‰∏çÂà∞ÂêçÂ≠óÔºàÂèòÈáèÔºâÊó∂ÂºïÂèë SyntaxError Âú®‰ª£Á†Å‰∏∫ÈîôËØØÂΩ¢ÂºèÊó∂ÂºïÂèë TypeError Âú®ÂÜÖÂª∫Êìç‰ΩúÊàñËÄÖÂáΩÊï∞Â∫îÁî®‰∫éÈîôËØØÁ±ªÂûãÁöÑÂØπË±°ÊòØÂºïÂèë SyntaxError Âú®ÂÜÖÂª∫Êìç‰ΩúÊàñËÄÖÂáΩÊï∞Â∫îÁî®‰∫éÊ≠£Á°ÆÁ±ªÂûãÁöÑÂØπË±°Ôºå‰ΩÜÊòØËØ•ÂØπË±°‰ΩøÁî®‰∏çÂêàÈÄÇÁöÑÂÄºÊó∂ÂºïÂèë ZeroDivisionError Âú®Èô§Ê≥ïÊàñËÄÖÊ®°Èô§Êìç‰ΩúÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫0Êó∂ÂºïÂèë finallyËØ≠Âè•try: open("ssss","r") ÊåáÂÆöÂºÇÂ∏∏Á±ªÂûã ÂÆö‰πâÂºÇÂ∏∏ÂèòÈáèexcept : print("ÊçïËé∑Âà∞ÂºÇÂ∏∏") print("-"*10)finally: print("‰∏ÄÂÆöÊâßË°åÁöÑËØ≠Âè•") elseÂ∫îÁî®try: num = 100 print(num)except NameError as errorMsg: print('‰∫ßÁîüÈîôËØØ‰∫Ü:%s'%errorMsg)else: print('Ê≤°ÊúâÊçïËé∑Âà∞ÂºÇÂ∏∏ÔºåÁúüÈ´òÂÖ¥')finally: print('Êàë‰∏ÄÂÆö‰ºöÊâßË°åÁöÑÂì¶') 33.Á±ªclass Person: #Â±ûÊÄßÂàóË°® #ÂÖ¨ÊúâÂ±ûÊÄß name = "AB" #ÁßÅÊúâÂ±ûÊÄß,ÁßÅÊúâÂ±ûÊÄßÊòØ‰∏çËÉΩÂ§üÂú®Á±ªÂ§ñÈÄöËøáÂØπË±°ÂêçÊù•ËøõË°åËÆøÈóÆÁöÑ __age = 20 #Âú®Á±ª‰∏≠ÂÆö‰πâÁöÑÊñπÊ≥ïËá≥Â∞ë‰ºöÊúâ‰∏Ä‰∏™ÂèÇÊï∞ÔºåÔºå‰∏ÄËà¨‰ª•Âêç‰∏∫selfÁöÑÂèòÈáè‰Ωú‰∏∫ËØ•ÂèÇÊï∞ÔºåËÄå‰∏îÈúÄË¶Å‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞„ÄÇ #ÂÖ¨ÊúâÊñπÊ≥ïÂàóË°® def getName(self): print(self.name) #ÁßÅÊúâÊñπÊ≥ï def __getAge(self): print(self.__age) #def get():Êä•Èîô #print("Êó†ÂèÇÊï∞ÊñπÊ≥ï") #ÊûÑÈÄ†Âô®ÊñπÊ≥ï:Âú®ÂàõÂª∫ÂØπË±°ÂêéÊâßË°å #def __init__(): #self.name = "QWE" #‰º†ÈÄíÂèÇÊï∞ÁöÑÊûÑÈÄ†Âô®ÊñπÊ≥ï def __init__(self,name): self.name = name #ÊûêÊûÑÊñπÊ≥ï def __del__(self): print("ÊûêÊûÑÊñπÊ≥ïË¢´Ë∞ÉÁî®")#ÂàõÂª∫ÂØπË±°p = Person("zhangsan")print(p.name)p.getName() 34.ÁªßÊâøclass Student(Person): def setName(self,name): self.name = name def print(self): print("Â≠¶ÁîüÁöÑÂßìÂêçÊòØ",self.name)stu = Student("zhangsan")stu.setName("ÊùéÂõõ")stu.print() python‰∏≠ÊòØÂèØ‰ª•Â§öÁªßÊâøÁöÑ„ÄÇÁà∂Á±ª‰∏≠ÁöÑÊñπÊ≥ï„ÄÅÂ±ûÊÄßÔºåÂ≠êÁ±ª‰ºöÁªßÊâø„ÄÇÂ§öÁªßÊâø:class HighStudent(Student,Worker)ÂÅáËÆæA,B‰∏≠ÈÉΩÊúâÊñπÊ≥ïtest()Ëã•CÁªßÊâøA‰∏éBÔºåclass C(A,B)ÔºåÂàôË∞ÉÁî®A‰∏≠ÁöÑÊñπÊ≥ï„ÄÇËã•CÁªßÊâøA‰∏éBÔºåclass C(B,A)ÔºåÂàôË∞ÉÁî®B‰∏≠ÁöÑÊñπÊ≥ï„ÄÇËã•CÁªßÊâøA‰∏éBÔºåclass C(A,B)Ôºå‰∏îC‰∏≠‰πüÊúâtest()ÊñπÊ≥ïÔºåÂàôË∞ÉÁî®C‰∏≠ÈáçÂÜôÁöÑÊñπÊ≥ï„ÄÇ 35.ÈáçÂÜôclass Ani: def print(self): print("Ë∞ÉÁî®AniÁöÑÊñπÊ≥ï")class Dog(Ani): def print(self): print("Ë∞ÉÁî®DogÁöÑÊñπÊ≥ï") dog = Dog()dog.print() #Ë∞ÉÁî®Ëá™Â∑±ÁöÑÊñπÊ≥ï 36.Â§öÊÄÅclass A: passclass A1(A): def show(self): print("A1")class A2(A): def show(self): print("A2")a1 = A1()a2 = A2()def showFunc(a): a.show() showFunc(a1)showFunc(a2) 37.Á±ªÂ±ûÊÄßÁ±ªÂ±ûÊÄßÂ∞±ÊòØÁ±ªÂØπË±°ÊâÄÊã•ÊúâÁöÑÂ±ûÊÄßÔºåÂÆÉË¢´ÊâÄÊúâÁ±ªÂØπË±°ÁöÑÂÆû‰æãÂØπË±°ÊâÄÂÖ±ÊúâÔºåÂÜÖÂ≠ò‰∏≠Âè™Â≠òÂú®‰∏Ä‰∏™ÂâØÊú¨ÔºåÂØπ‰∫éÂÖ¨ÊúâÁöÑÁ±ªÂ±ûÊÄßÔºåÂú®Á±ªÂ§ñÂèØ‰ª•ÈÄöËøáÁ±ªÂØπË±°ÂíåÂÆû‰æãÂØπË±°ËÆøÈóÆ„ÄÇ class object: name = "object"obj1 = object()obj2 = object()print(obj1.name) #ÂÆû‰æãÊ≤°Êúâname,‰ºöÊü•ÊâæÁ±ªÁöÑname,ÁªìÊûú:objectobject.name = "lisi"print(obj2.name) #ÊòæÁ§∫ lisiprint(obj1.name) #ÊòæÁ§∫ lisi ÁªôÂÆû‰æãobj1Â¢ûÂä†ÂÆû‰æãÂ±ûÊÄßobj1.name = "ads"print(obj1.name) #Â±èËîΩÊéâÁ±ªÂ±ûÊÄß,ÊòæÁ§∫adsprint(object.name) #ÊòæÁ§∫ lisi ÁªìËÆ∫:Áõ∏ÂêåÂêçÁß∞ÁöÑÂÆû‰æãÂ±ûÊÄßÂ∞ÜÂ±èËîΩÊéâÁ±ªÂ±ûÊÄß„ÄÇ‰ΩÜÊòØÂΩì‰Ω†Âà†Èô§ÂÆû‰æãÂ±ûÊÄßÂêéÔºåÂÜç‰ΩøÁî®Áõ∏ÂêåÁöÑÂêçÁß∞ÔºåËÆøÈóÆÂà∞ÁöÑÂ∞ÜÊòØÁ±ªÂ±ûÊÄß„ÄÇPythonÊòØÂä®ÊÄÅËØ≠Ë®ÄÔºåÂèØ‰ª•Âä®ÊÄÅÂ¢ûÂä†Â±ûÊÄß„ÄÇÊÉ≥Ë¶Å‰øÆÊîπÁ±ªÂ±ûÊÄßÔºåÂ¶ÇÊûúÂú®Á±ªÂ§ñÔºåÂèØ‰ª•ÈÄöËøáÁ±ªÂØπË±°‰øÆÊîπÔºåÂ¶ÇÊûúÂú®Á±ªÈáåÈù¢ÔºåÂè™ÊúâÂú®Á±ªÊñπÊ≥ï‰∏≠ËøõË°å‰øÆÊîπ„ÄÇ 38.Á±ªÊñπÊ≥ïÊòØÁ±ªÂØπË±°ÊâÄÊã•ÊúâÁöÑÊñπÊ≥ïÔºåÈúÄË¶ÅÁî®‰øÆÈ•∞Âô®@classmethodÊù•Ê†áËØÜÂÖ∂‰∏∫Á±ªÊñπÊ≥ïÂØπ‰∫éÁ±ªÊñπÊ≥ïÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂøÖÈ°ªÊòØÁ±ªÂØπË±°Ôºå‰∏ÄËà¨‰ª•cls‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞„ÄÇÂΩìÁÑ∂ÂèØ‰ª•Áî®ÂÖ∂‰ªñÂêçÁß∞ÁöÑÂèòÈáè‰Ωú‰∏∫ÂÖ∂Á¨¨‰∏Ä‰∏™ÂèÇÊï∞„ÄÇ‰ΩÜÊòØÂ§ßÈÉ®ÂàÜ‰∫∫ÈÉΩ‰π†ÊÉØ‰ª•‚Äôcls‚Äô‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂêçÂ≠óÔºåÂ∞±ÊúÄÂ•ΩÁî®‚Äôcls‚Äô‰∫ÜÔºåËÉΩÂ§üÈÄöËøáÂÆû‰æãÂØπË±°ÂíåÁ±ªÂØπË±°ÂéªËÆøÈóÆ„ÄÇclass people: country = 'china' #Á±ªÊñπÊ≥ïÔºåÁî®classmethodÊù•ËøõË°å‰øÆÈ•∞ @classmethod def getCountry(cls): return cls.countryclass Car: #Á±ªÂ±ûÊÄß price = "1000" #Á±ªÊñπÊ≥ï @classmethod def getPrice(cls,price): cls.price = price return cls.pricecar1 = Car()print(car1.getPrice(200)) 39.ÈùôÊÄÅÊñπÊ≥ïÈÄöËøá‰øÆÈ•∞Âô®@staticmethodÊù•ËøõË°å‰øÆÈ•∞ÔºåÈùôÊÄÅÊñπÊ≥ï‰∏çÈúÄË¶ÅÂ§öÂÆö‰πâÂèÇÊï∞„ÄÇclass Cat: name = "Tom" @staticmethod #ÈùôÊÄÅÊñπÊ≥ï def getName(): print(Cat.name)Cat.getName() 40.Áà¨ÂèñÊï∞ÊçÆresponse = urllib.request.urlopen("http://acm.hit.edu.cn")html = response.read()#‰∏≠ÊñáËΩ¨Á†ÅhtmlC = html.decode("utf-8")print(htmlC)#Â∞ÜÁΩëÈ°µÂ≠òÂÖ•ÊñáÊú¨f = open("t.html","wb")#pythonÊòØtypesÊ†ºÂºèÔºåÂæóÁî®‰∫åËøõÂà∂ËØªÂÜô. f.write(html) #ÂÜôÂÖ•ÂéüÂßãÊñá‰ª∂,‰∏çÈúÄË¶ÅËß£Á†Åf.close() getÂèÇÊï∞ÊãºÊé•query = &#123;&#125;query["key"] = "python3"queryURL = urllib.parse.urlencode(query) #ÂæóÂà∞key=python3url = "http://chenyalun.com/s?" + queryURLprint(url) 40.‰ΩøÁî®BeautifulSouphtml = """&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt; &lt;body&gt; &lt;p class="title" name="dromouse"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt; &lt;p class="story"&gt;Once upon a time there were three little sisters; and their names were &lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;, &lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and &lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;; and they lived at the bottom of a well.&lt;/p&gt; &lt;p class="story"&gt;...&lt;/p&gt; """from bs4 import BeautifulSoupsoup = BeautifulSoup(html)print(soup.prettify())#ÊâìÂç∞Ê†áÁ≠æprint("Ê†áÈ¢òÊòØ:",soup.title)print("Â§¥ÈÉ®ÊòØ",soup.head)print("Á¨¨‰∏Ä‰∏™aÊ†áÁ≠æ",soup.a)print("Á¨¨‰∏Ä‰∏™pÊ†áÁ≠æ",soup.p)#ÂÆÉÊü•ÊâæÁöÑÊòØÂú®ÊâÄÊúâÂÜÖÂÆπ‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™Á¨¶ÂêàË¶ÅÊ±ÇÁöÑÊ†áÁ≠æ#Ê†áÁ≠æÁöÑ‰∏§‰∏™ÈáçË¶ÅÁöÑÂ±ûÊÄß:name Âíå attrsprint(soup.a.name)print(soup.p.attrs)#Â±ûÊÄßÁöÑÂÄºprint("Â±ûÊÄßÁöÑÂÄº",soup.p.attrs["name"]) print("Â±ûÊÄßÁöÑÂÄº",soup.p["name"])#attrsÂèØ‰ª•ÁúÅÁï•#Áî® .stringËé∑ÂèñÊñáÂ≠óprint(soup.p.string)#Âà©Áî®"CSSÈÄâÊã©Âô®"Êü•ÊâæÊ†áÁ≠æ#ÈÄöËøáÊ†áÁ≠æÂêçÊü•Êâæprint(soup.select("title"))#ÈÄöËøáÁ±ªÂêçÊü•Êâæprint(soup.select(".sister"))#ÈÄöËøáidÊü•Êâæprint(soup.select("#link1"))#ÁªÑÂêàÊü•Êâæprint(soup.select("p #link1")) #Ê†ºÂºèÂêåCSS#Áõ¥Êé•Â≠êÊ†áÁ≠æÊü•Êâæprint(soup.select("head &gt; title"))#Â±ûÊÄßÊü•Êâæ#Â±ûÊÄßÈúÄË¶ÅÁî®‰∏≠Êã¨Âè∑Êã¨Ëµ∑Êù•ÔºåÊ≥®ÊÑèÂ±ûÊÄßÂíåÊ†áÁ≠æÂ±û‰∫éÂêå‰∏ÄËäÇÁÇπÔºåÊâÄ‰ª•‰∏≠Èó¥‰∏çËÉΩÂä†Á©∫Ê†ºprint(soup.select('a[class="sister"]'))print(soup.select('a[href="http://example.com/elsie"]'))print(soup.select('p a[href="http://example.com/elsie"]'))# select ÊñπÊ≥ïËøîÂõûÁöÑÁªìÊûúÈÉΩÊòØÂàóË°®ÂΩ¢ÂºèÔºåÂèØ‰ª•ÈÅçÂéÜÂΩ¢ÂºèËæìÂá∫ÔºåÁÑ∂ÂêéÁî® get_text() ÊñπÊ≥ïÊù•Ëé∑ÂèñÂÆÉÁöÑÂÜÖÂÆπfor title in soup.select("title"): print(title.get_text)]]></content>
      <tags>
        <tag>Python</tag>
        <tag>Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê≥õËØªÂçöÂÆ¢Á¨îËÆ∞]]></title>
    <url>%2F2016%2F10%2F28%2F%E6%B3%9B%E8%AF%BB%E5%8D%9A%E5%AE%A2%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[2017.04.03 ‰øÆÊîπ2016.12.04 ‰øÆÊîπ2019.08.15 ÂÆåÂñÑ CËØ≠Ë®ÄÂíåObjective-CËØ≠Ë®Ä„ÄÇ ËØªÊÑü‰∏ÄÂè£Ê∞îÊääÂâçËæàÂçöÂÆ¢ÈáåÈù¢ÁöÑÊâÄÊúâÊñáÁ´†ÈÉΩËØªÂÆå‰∫ÜÔºåÊñáÁ´†Ë¥®ÈáèÈÉΩÁâπÂà´È´òÔºåÂú®Ê≠§ÂÅö‰∏™ËÆ∞ÂΩï„ÄÇ Èí©ÁéÑ1.CËØ≠Ë®Ä‰∏≠ÊÄé‰πàÊéßÂà∂ËæìÂÖ•‰∏éËæìÂá∫Ê†ºÂºèprintf("My height is %8.1f", 179.95f);// Â∑¶ÂØπÈΩê,Â∞èÊï∞ÁÇπÂêé1‰Ωç printf("My height is %-4d", 60); // Â∑¶ÂØπÈΩêÔºåÂè≥ËæπÂ°´Á©∫Ê†ºscanf("%d-%d-%d", &amp;a, &amp;b, &amp;c);scanf("%d %d %d", &amp;a, &amp;b, &amp;c); // putchar‰∏ÄÊ¨°Âè™ËÉΩËæìÂá∫‰∏Ä‰∏™Â≠óÁ¨¶ÔºåËÄåprintfÂèØ‰ª•ÂêåÊó∂ËæìÂá∫Â§ö‰∏™Â≠óÁ¨¶int a = 65;putchar(a); 2.getchar/scanf/getsÁöÑÂå∫Âà´ getsÂíågetcharÂáΩÊï∞ÂèØ‰ª•ËØªÂÖ•Á©∫Ê†º„ÄÅTABÔºåÁõ¥Âà∞ÈÅáÂà∞ÂõûËΩ¶‰∏∫Ê≠¢„ÄÇscanf‰∏çËÉΩËØªÂÖ•Á©∫Ê†ºÂíåTAB„ÄÇ gets‰∏ÄÊ¨°Âè™ËÉΩËØªÂèñ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºågetchar‰∏ÄÊ¨°Âè™ËÉΩËØªÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶„ÄÇscanfÂàôÂèØ‰ª•ÂêåÊó∂Êé•Êî∂Â§ö‰∏™Â≠óÁ¨¶„ÄÇ getcharËøòËÉΩËØªÂÖ•ÂõûËΩ¶Êç¢Ë°åÁ¨¶ÔºåËøôÊó∂ÂÄôË¶ÅÊï≤2Ê¨°ÂõûËΩ¶ÈîÆ„ÄÇÁ¨¨1Ê¨°Êï≤ÁöÑÂõûËΩ¶Êç¢Ë°åÁ¨¶Ë¢´getcharËØªÂÖ•ÔºåÁ¨¨2Ê¨°Êï≤ÁöÑÂõûËΩ¶ÈîÆ‰ª£Ë°®ËæìÂÖ•ÁªìÊùü„ÄÇ 3.puts/prints/putcharÁöÑÂå∫Âà´ putchar‰∏ÄÊ¨°Âè™ËÉΩËæìÂá∫‰∏Ä‰∏™Â≠óÁ¨¶ÔºåputsÂáΩÊï∞‰∏ÄÊ¨°Âè™ËÉΩËæìÂá∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåprintfÂáΩÊï∞ÂàôÂèØ‰ª•ÂêåÊó∂ËæìÂá∫Â§ö‰∏™Â≠óÁ¨¶‰∏≤„ÄÇ printf‰∏éputsÂáΩÊï∞‰ºöÈ¶ñÂú∞ÂùÄÂºÄÂßãËæìÂá∫Â≠óÁ¨¶Ôºå‰∏ÄÁõ¥Âà∞\0Â≠óÁ¨¶‰∏∫Ê≠¢„ÄÇ 4.‰ªãÁªçÊåáÈíà ËÆ°ÁÆóÊú∫‰∏≠ÁöÑÂÜÖÂ≠òÊòØ‰ª•Â≠óËäÇ‰∏∫Âçï‰ΩçÁöÑÂ≠òÂÇ®Á©∫Èó¥ÔºåÂÜÖÂ≠òÁöÑÊØè‰∏Ä‰∏™Â≠óËäÇÈÉΩÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÁºñÂè∑ÔºåËøô‰∏™ÁºñÂè∑Â∞±Áß∞‰∏∫Âú∞ÂùÄ„ÄÇ Âá°Â≠òÊîæÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÁ®ãÂ∫èÂíåÊï∞ÊçÆÈÉΩÊúâ‰∏Ä‰∏™Âú∞ÂùÄÔºå‰πüÂ∞±ÊòØËØ¥Ôºå‰∏Ä‰∏™ÂáΩÊï∞‰πüÊúâËá™Â∑±ÁöÑÂÜÖÂ≠òÂú∞ÂùÄ„ÄÇÂèòÈáèÂ≠òÂÇ®ÂçïÂÖÉÁöÑÁ¨¨‰∏Ä‰∏™Â≠óËäÇÁöÑÂú∞ÂùÄÂ∞±ÊòØËØ•ÂèòÈáèÁöÑÂú∞ÂùÄ„ÄÇ ÈÄöËøáÂèòÈáèÂêçÂºïÁî®ÂèòÈáèÔºåÁî±Á≥ªÁªüËá™Âä®ÂÆåÊàêÂèòÈáèÂêçÂíåÂÖ∂Â≠òÂÇ®Âú∞ÂùÄ‰πãÈó¥ÁöÑËΩ¨Êç¢ÔºåÁß∞‰∏∫ÂèòÈáèÁöÑ‚ÄúÁõ¥Êé•ÂºïÁî®‚ÄùÊñπÂºè„ÄÇÈ¶ñÂÖàÂ∞ÜÂèòÈáèaÁöÑÂú∞ÂùÄÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™ÂèòÈáè‰∏≠ÔºåÊØîÂ¶ÇÂ≠òÊîæÂú®ÂèòÈáèb‰∏≠ÔºåÁÑ∂ÂêéÈÄöËøáÂèòÈáèbÊù•Èó¥Êé•ÂºïÁî®ÂèòÈáèaÔºåÈó¥Êé•ËØªÂÜôÂèòÈáèaÁöÑÂÄº„ÄÇËøôÂ∞±ÊòØ‚ÄúÈó¥Êé•ÂºïÁî®‚Äù„ÄÇ Âú®ÊåáÈíàÂèòÈáèÊ≤°ÊúâÊåáÂêëÁ°ÆÂÆöÂú∞ÂùÄ‰πãÂâçÔºå‰∏çË¶ÅÂØπÂÆÉÊâÄÊåáÁöÑÂÜÖÂÆπËµãÂÄº„ÄÇ int *p; *p = 10; //ËøôÊòØÈîôËØØÁöÑ // Ê≠£Á°ÆÂÅöÊ≥ïint a = 10; // ‰πüÂèØ‰ª•int *b = &amp;a;int *b; //bÊòØÊåáÈíàÂèòÈáèb = &amp;a; // ÈÄöËøá*bÈó¥Êé•‰øÆÊîπaÁöÑÂÄº*b = 15; // Ê†πÊçÆbÂú∞ÂùÄËÆøÈóÆÂØπÂ∫îÁöÑÂ≠òÂÇ®ÂÄº ÊåáÈíàÊìç‰Ωú‰∏≠ÔºåÊï∞ÁªÑÂêçaÊòØ‰∏™Â∏∏ÈáèÔºå‰∏çËÉΩËøõË°åËµãÂÄºËøêÁÆó char s[10];s = "mj";// ÈîôËØØ! sÊòØÂ∏∏Èáè 5.Â∏∏ËßÅÂ≠óÁ¨¶‰∏≤Â§ÑÁêÜÂáΩÊï∞ÁöÑÁî®Ê≥ïÂåÖÂê´string.hÂ§¥Êñá‰ª∂ÂêéÔºåstrlen\strcpy\strcat\strcmpÂáΩÊï∞ÁöÑÁî®Ê≥ï// ÊµãÈáèÂ≠óÁ¨¶‰∏≤ÁöÑÂ≠óÁ¨¶‰∏™Êï∞Ôºå‰∏çÂåÖÊã¨\0// ÈïøÂ∫¶‰∏∫7int size = strlen("abcdefg");// ÈïøÂ∫¶‰∏∫2char s[] = &#123;'a', 'b', '\0','c'&#125;; // Âè≥ËæπÊã∑Ë¥ùÂà∞Â∑¶Ëæπ,char s[10];strcpy(s, "abcdefg");// ÈÅáÂà∞\0Êà™Êñ≠char c[] = &#123;'a', 'b', '\0','c'&#125;;strcpy(s,c);// ÁªìÊûúab// Âè≥ËæπÊãºÊé•Âà∞Â∑¶Ëæπ,ÈÅáÂà∞\0Êà™Êñ≠char s1[30] = &#123;'a', 'b', '\0', 'd'&#125;;strcat(s1, "OC");// ÁªìÊûúabOC // Â∑¶ÂáèÂè≥,ÈÄêÂ≠óÁ¨¶ÊØîËæÉASCIIÁ†ÅÂ∑ÆÂÄº,Áõ¥Âà∞Â≠óÁ¨¶‰∏çÁõ∏ÂêåÊàñËÄÖÈÅáËßÅ'\0'‰∏∫Ê≠¢strcmp(s1, s2); Ê≥®ÊÑè:strcpy‰∏≠Ëã•Êï∞ÁªÑÈïøÂ∫¶‰∏çË∂≥‰ª•ÂÆπÁ∫≥Êï¥‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂàôÁ®ãÂ∫èËøêË°åÂ¥©Ê∫É„ÄÇ 6.Â¶Ç‰Ωï‰Ωø‰∏Ä‰∏™ÂáΩÊï∞ÊúâÂ§ö‰∏™ËøîÂõûÂÄºint test(int a, int b,int *c) &#123; // ËµãÂÄºÁªôÊåáÈíàÊåáÂêëÁöÑÂèòÈáè *c = a + b; return a * b;&#125; int main(int argc, const char * argv[]) &#123; int m = 2,n = 4,s1,s2; s1 = test(m, n, &amp;s2); printf("%d---%d",s1,s2); return 0;&#125; 7.Â≠óÁ¨¶‰∏≤Â∏∏Èáè‰∏éÂ≠óÁ¨¶‰∏≤ÂèòÈáèchar *s = "mj";*s = "like"; ‰∏§‰∏™ÈîôËØØ: sÊåáÂêëÁöÑÊòØ‚Äúmj‚ÄùÁöÑÈ¶ñÂ≠óÁ¨¶‚Äúm‚ÄùÔºåÂè™Êúâ‰∏Ä‰∏™Â≠óËäÇÔºåË¶Å‚Äúlike‚ÄùÂ≠òËøõ1‰∏™Â≠óËäÇÁöÑÁ©∫Èó¥ÂÜÖÔºåËÇØÂÆöÂÜÖÂ≠òÊ∫¢Âá∫„ÄÇ sÊåáÂêëÁöÑÊòØÂ≠óÁ¨¶‰∏≤Â∏∏Èáè‚Äúmj‚ÄùÔºå‰∏çËÉΩÂÜçÈÄöËøáÊåáÈíàÊù•‰øÆÊîπÂ≠óÁ¨¶‰∏≤ÂÜÖÂÆπ(Â≠óÁ¨¶Êï∞ÁªÑÂèØ‰ª•‰øÆÊîπ)„ÄÇ char a[] = "lmj"; // ÂÆö‰πâÁöÑÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂèòÈáèchar *p2 = "lmj"; // ÂÆö‰πâÁöÑÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Â∏∏Èáè 8.ËøîÂõûÊåáÈíàÁöÑÂáΩÊï∞// Â∞ÜÂ≠óÁ¨¶‰∏≤str‰∏≠ÁöÑÂ∞èÂÜôÂ≠óÊØçÂèòÊàêÂ§ßÂÜôÂ≠óÊØçÔºåÂπ∂ËøîÂõûÊîπÂèòÂêéÁöÑÂ≠óÁ¨¶‰∏≤// Ê≥®ÊÑèÁöÑÊòØÔºöËøôÈáåÁöÑÂèÇÊï∞Ë¶Å‰º†Â≠óÁ¨¶‰∏≤ÂèòÈáèÔºå‰∏çËÉΩ‰º†Â≠óÁ¨¶‰∏≤Â∏∏Èáèchar * upper(char *str) &#123; // ÂÖà‰øùÁïôÊúÄÂàùÁöÑÂú∞ÂùÄ„ÄÇÂõ†‰∏∫Á≠â‰ºöstrÊåáÂêëÁöÑ‰ΩçÁΩÆ‰ºöÂèòÊù•ÂèòÂéªÁöÑ„ÄÇ char *dest = str; // Â¶ÇÊûúËøò‰∏çÊòØÁ©∫Â≠óÁ¨¶ while (*str != '\0') &#123; // Â¶ÇÊûúÊòØÂ∞èÂÜôÂ≠óÊØç if (*str &gt;= 'a' &amp;&amp; *str &lt;= 'z') &#123; // Âèò‰∏∫Â§ßÂÜôÂ≠óÊØç„ÄÇÂ∞èÂÜôÂíåÂ§ßÂÜôÂ≠óÊØçÁöÑASCIIÂÄºÊúâ‰∏™Âõ∫ÂÆöÁöÑÂ∑ÆÂÄº *str -= 'a' - 'A'; &#125; // ÈÅçÂéÜ‰∏ã‰∏Ä‰∏™Â≠óÁ¨¶ str++; &#125; // ËøîÂõûÂ≠óÁ¨¶‰∏≤ return dest;&#125; // Ë∞ÉÁî®:int main() &#123; // ÂÆö‰πâ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂèòÈáè char str[] = "lmj"; // Ë∞ÉÁî®ÂáΩÊï∞ char *dest = upper(str); printf("%s", dest); return 0;&#125; 9.ÊåáÂêëÂáΩÊï∞ÁöÑÊåáÈíàÂáΩÊï∞ÂêçÁöÑÊú¨Ë¥®Â∞±ÊòØÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇÂÅáÂÆöÂáΩÊï∞ÁöÑÂêçÁß∞‰∏∫funcÔºåËøîÂõûÁ±ªÂûãÊòØÊï¥Âûã„ÄÇÂàôÔºåint *a = func; // ÊåáÈíàa‰∏éÊåáÈíàfunc‰∏ÄËá¥ Ë∞ÉÁî®ÁöÑ‰∏âÁßçÊñπÂºè:func(); // ÂéüÂÖàÁöÑË∞ÉÁî®ÊñπÂºè:ÈÄöËøáÊåáÈíàfuncË∞ÉÁî®*a(); // *aÊåáÂêëÂáΩÊï∞Êú¨Ë∫´a(); // Áõ∏ÂΩì‰∫éfunc(); ÂÆû‰æã: int sum(int a, int b) &#123; return a + b;&#125; int main()&#123;// ÂÆö‰πâ‰∏Ä‰∏™ÊåáÈíàÂèòÈáèpÔºåÊåáÂêësumÂáΩÊï∞// ÊääÂáΩÊï∞ÂêçÊõøÊç¢‰∏∫(*p)Âç≥ÂèØ,*pÂ∞±Áõ∏ÂΩì‰∫ésumint (*p)(int a, int b) = sum; // ÊàñËÄÖ int (*p)(int, int) = sum; // ÊàñËÄÖ int (*p)() = sum; // *pÂ∞±Áõ∏ÂΩì‰∫ésum int result = (*p)(1, 3); // ÊàñËÄÖ int result = p(1, 3); printf("%d", result); return 0;&#125; 10.Â∞ÜÂáΩÊï∞‰Ωú‰∏∫ÂèÇÊï∞Âú®ÂáΩÊï∞Èó¥‰º†ÈÄí// ÂáèÊ≥ïËøêÁÆóint minus(int a, int b) &#123; return a - b;&#125; // Âä†Ê≥ïËøêÁÆóint sum(int a, int b) &#123; return a + b;&#125; // Ëøô‰∏™countingÂáΩÊï∞ÊòØÁî®Êù•ÂÅöaÂíåb‰πãÈó¥ÁöÑËÆ°ÁÆóÔºåËá≥‰∫éÂÅöÂä†Ê≥ïËøòÊòØÂáèÊ≥ïËøêÁÆóÔºåÁî±ÂáΩÊï∞ÁöÑÁ¨¨1‰∏™ÂèÇÊï∞ÂÜ≥ÂÆövoid counting(int (*p)(int, int) , int a, int b) &#123; int result = p(a, b); printf("ËÆ°ÁÆóÁªìÊûú‰∏∫Ôºö%d\n", result);&#125; int main()&#123; // ËøõË°åÂä†Ê≥ïËøêÁÆó,‰º†ËøõÊù•ÂáΩÊï∞ÊåáÈíàsum counting(sum, 6, 4); // ËøõË°åÂáèÊ≥ïËøêÁÆó counting(minus, 6, 4); return 0;&#125; 11.ÂÆèÁöÑ‰ΩøÁî® ÊâÄÊúâÈ¢ÑÂ§ÑÁêÜÊåá‰ª§ÈÉΩ‰ª•Á¨¶Âè∑‚Äú#‚ÄùÂºÄÂ§¥ÔºåÂπ∂‰∏îÁªìÂ∞æ‰∏çÁî®ÂàÜÂè∑Ôºå‰ΩúÁî®ËåÉÂõ¥ÊòØ‰ªéÂÆÉÂá∫Áé∞ÁöÑ‰ΩçÁΩÆÂà∞Êñá‰ª∂Â∞æÔºå‰∏ªË¶ÅÊúâÔºöÂÆèÂÆö‰πâ„ÄÅÊñá‰ª∂ÂåÖÂê´„ÄÅÊù°‰ª∂ÁºñËØëÁ≠â„ÄÇ ‰ΩøÁî®Â∏¶ÂèÇÊï∞ÁöÑÂÆèÂÆö‰πâÔºåÊúÄÂ•ΩÂ∞ÜÂèÇÊï∞ÂíåÁªìÊûúÈÉΩÁî®Êã¨Âè∑Êã¨Ëµ∑Êù•„ÄÇ ÂÆèÂÆö‰πâ‰∏çÊ∂âÂèäÂ≠òÂÇ®Á©∫Èó¥ÁöÑÂàÜÈÖç„ÄÅÂèÇÊï∞Á±ªÂûãÂåπÈÖç„ÄÅÂèÇÊï∞‰º†ÈÄí„ÄÅËøîÂõûÂÄºÈóÆÈ¢òÔºåÂÆèÊõøÊç¢Âè™Âú®ÁºñËØëÈ¢ÑÂ§ÑÁêÜÈò∂ÊÆµËøõË°åÔºåÂ∏¶ÂèÇÊï∞ÁöÑÂÆèÊØîÂáΩÊï∞ÂÖ∑ÊúâÊõ¥È´òÁöÑÊâßË°åÊïàÁéá„ÄÇ Êù°‰ª∂ÁºñËØë #if Êù°‰ª∂1...code1...#elif Êù°‰ª∂2...code2...#else...code3...#endif#if defined(MAX) ...code...#endif #if !defined(MAX) ...code...#endif 12.include‰∏≠&lt;&gt;‰∏é‚Äú‚ÄùÁöÑÂå∫Âà´#include &lt;Êñá‰ª∂Âêç&gt;Âà∞CËØ≠Ë®ÄÂ∫ìÂáΩÊï∞Â§¥Êñá‰ª∂ÊâÄÂú®ÁöÑÁõÆÂΩï‰∏≠ÂØªÊâæÊñá‰ª∂„ÄÇ#include &quot;Êñá‰ª∂Âêç&quot;Á≥ªÁªü‰ºöÂÖàÂú®Ê∫êÁ®ãÂ∫èÂΩìÂâçÁõÆÂΩï‰∏ãÂØªÊâæÔºåËã•Êâæ‰∏çÂà∞ÔºåÂÜçÂà∞Êìç‰ΩúÁ≥ªÁªüÁöÑpathË∑ØÂæÑ‰∏≠Êü•ÊâæÔºåÊúÄÂêéÊâçÂà∞CËØ≠Ë®ÄÂ∫ìÂáΩÊï∞Â§¥Êñá‰ª∂ÊâÄÂú®ÁõÆÂΩï‰∏≠Êü•Êâæ„ÄÇ 13.Â¶Ç‰ΩïÈÅøÂÖç#includeÈáçÂ§çÂåÖÂê´Âêå‰∏Ä‰∏™Â§¥Êñá‰ª∂‰ΩøÁî®Êù°‰ª∂ÁºñËØë#ifndef _ONE_H_#define _ONE_H_ void one(); #endif 14.ÂèòÈáèÁöÑ‰ΩúÁî®Âüü Âú®ÂáΩÊï∞ÂÜÖÈÉ®ÂÆö‰πâÁöÑÂèòÈáèÔºåÁß∞‰∏∫Â±ÄÈÉ®ÂèòÈáè„ÄÇÂΩ¢ÂºèÂèÇÊï∞‰πüÂ±û‰∫éÂ±ÄÈÉ®ÂèòÈáèÔºåÂú®ÊâÄÊúâÂáΩÊï∞Â§ñÈÉ®ÂÆö‰πâÁöÑÂèòÈáèÔºåÁß∞‰∏∫ÂÖ®Â±ÄÂèòÈáè„ÄÇ ÊâÄÊúâÁöÑÂ±ÄÈÉ®ÂèòÈáèÂú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÈÉΩÊòØËá™Âä®ÂèòÈáèÔºåÊòØÂ≠òÂÇ®Âú®Â†ÜÊ†à‰∏≠ÁöÑ„ÄÇÊâÄÊúâÁöÑÂÖ®Â±ÄÂèòÈáèÂíåË¢´ÂÖ≥ÈîÆÂ≠óstatic‰øÆÈ•∞ÁöÑÂ±ÄÈÉ®ÂèòÈáèÈÉΩÊòØÈùôÊÄÅÂèòÈáèÔºåÊòØÂ≠òÂÇ®Âú®ÈùôÊÄÅÂÜÖÂ≠ò‰∏≠ÁöÑÔºå‰πüÂ∞±ÊòØ‰∏çÂ±û‰∫éÂ†ÜÊ†à„ÄÇ ÈùôÊÄÅÂèòÈáèÂú®Á®ãÂ∫èËøêË°å‰πãÂâçÂàõÂª∫ÔºåÂú®Á®ãÂ∫èÁöÑÊï¥‰∏™ËøêË°åÊúüÈó¥ÂßãÁªàÂ≠òÂú®ÔºåÁõ¥Âà∞Á®ãÂ∫èÁªìÊùü„ÄÇÂú®Á®ãÂ∫èÊâßË°åÂà∞Â£∞ÊòéËá™Âä®ÂèòÈáèÁöÑ‰ª£Á†ÅÂùó(ÂáΩÊï∞)Êó∂ÔºåËá™Âä®ÂèòÈáèÊâçË¢´ÂàõÂª∫ÔºõÂΩìËá™Âä®ÂèòÈáèÊâÄÂú®ÁöÑ‰ª£Á†ÅÂùó(ÂáΩÊï∞)ÊâßË°åÂÆåÊØïÂêéÔºåËøô‰∫õËá™Âä®ÂèòÈáèÂ∞±‰ºöËá™Ë°åÈîÄÊØÅ„ÄÇ Ë¢´ÂÖ≥ÈîÆÂ≠óregister‰øÆÈ•∞ÁöÑËá™Âä®ÂèòÈáèÈÉΩÊòØÂØÑÂ≠òÂô®ÂèòÈáèÔºåÊòØÂ≠òÂÇ®Âú®Á°¨‰ª∂ÂØÑÂ≠òÂô®‰∏≠ÁöÑÔºåÂÖ∂ÁîüÂëΩÂë®ÊúüÂç≥ÊòØËá™Âä®ÂèòÈáèÁöÑÁîüÂëΩÂë®Êúü„ÄÇÂØÑÂ≠òÂô®ÂèòÈáèÂè™Èôê‰∫éint„ÄÅcharÂíåÊåáÈíàÁ±ªÂûãÂèòÈáè‰ΩøÁî®ÔºåÂ∞Ü‰∏Ä‰∫õÈ¢ëÁπÅ‰ΩøÁî®ÁöÑËá™Âä®ÂèòÈáèÂÆö‰πâ‰∏∫ÂØÑÂ≠òÂô®ÂèòÈáèÔºåËøôÊ†∑Á®ãÂ∫èÂ∞ΩÂèØËÉΩÂú∞‰∏∫ÂÆÉÂàÜÈÖçÂØÑÂ≠òÂô®Â≠òÊîæÔºåËÄå‰∏çÁî®ÂÜÖÂ≠ò„ÄÇ register int a;register char b;register int *c; 15.ÁºñËØëÈìæÊé•ÊµÅÁ®ã Â¶ÇÊûú‰∏Ä‰∏™Á®ãÂ∫è‰∏≠ÊúâÂ§ö‰∏™Ê∫êÊñá‰ª∂(.c)ÔºåÁºñËØëÊàêÂäü‰ºöÁîüÊàêÂØπÂ∫îÁöÑÂ§ö‰∏™ÁõÆÊ†áÊñá‰ª∂(.obj)ÔºåËøô‰∫õÁõÆÊ†áÊñá‰ª∂‰∏çËÉΩÂçïÁã¨ËøêË°åÔºåÂõ†‰∏∫Ëøô‰∫õÁõÆÊ†áÊñá‰ª∂‰πãÈó¥ÂèØËÉΩ‰ºöÊúâÂÖ≥ËÅî„ÄÇÂ∞ÜËøô‰∫õÁõ∏ÂÖ≥ËÅîÁöÑÁõÆÊ†áÊñá‰ª∂ÈìæÊé•Âú®‰∏ÄËµ∑ÂêéÊâçËÉΩÁîüÊàêÂèØÊâßË°åÊñá‰ª∂„ÄÇ ÊâÄË∞ìÁºñËØëÔºåÂ∞±ÊòØÂçïÁã¨Ê£ÄÊü•ÊØè‰∏™Ê∫êÊñá‰ª∂ÁöÑËØ≠Ê≥ïÊòØÂê¶ÂêàÁêÜÔºåÂπ∂‰∏ç‰ºöÊ£ÄÊü•ÊØè‰∏™Ê∫êÊñá‰ª∂‰πãÈó¥ÁöÑÂÖ≥ËÅîÂÖ≥Á≥ªÔºå‰∏Ä‰∏™Ê∫êÊñá‰ª∂ÁºñËØëÊàêÂäüÂ∞±ÁîüÊàê‰∏Ä‰∏™ÁõÆÊ†áÊñá‰ª∂„ÄÇÊâÄË∞ìÈìæÊé•ÔºåÂ∞±ÊòØÊ£ÄÊü•ÁõÆÊ†áÊñá‰ª∂ÁöÑÂÖ≥ËÅîÂÖ≥Á≥ªÔºåÂ∞ÜÁõ∏ÂÖ≥ËÅîÁöÑÁõÆÊ†áÊñá‰ª∂ÁªÑÂêàÂú®‰∏ÄËµ∑ÔºåÁîüÊàêÂèØÊâßË°åÊñá‰ª∂„ÄÇ Ê†πÊçÆÂú®ÂΩìÂâçÊñá‰ª∂‰∏≠ÂÆö‰πâÁöÑÂáΩÊï∞ÊòØÂê¶ÂÖÅËÆ∏ÂÖ∂‰ªñÊñá‰ª∂ËÆøÈóÆÔºåÂèØÂ∞ÜÂáΩÊï∞ÂàÜ‰∏∫ÂÜÖÈÉ®ÂáΩÊï∞ÂíåÂ§ñÈÉ®ÂáΩÊï∞„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊâÄÊúâÁöÑÂáΩÊï∞ÈÉΩÊòØÂ§ñÈÉ®ÂáΩÊï∞„ÄÇ‰∏çÂÖÅËÆ∏ÈáçÂ§çÂÆö‰πâÂêå‰∏Ä‰∏™Â§ñÈÉ®ÂáΩÊï∞„ÄÇ 16.extern‰∏éstaticÂÖ≥ÈîÆÂ≠óÁöÑ‰ΩúÁî®‰ΩøÁî®externÂÖ≥ÈîÆÂ≠óÔºåË°®Á§∫ÂºïÁî®ÂÖ∂‰ªñÊñá‰ª∂ÁöÑ‚ÄúÂ§ñÈÉ®ÂáΩÊï∞‚Äù: extern void test();ÔºåÁÑ∂ËÄåexternÂèØ‰ª•ÁúÅÁï•ÔºåÊïÖÁõ¥Êé•Â£∞ÊòéÂç≥ÂèØ„ÄÇÊ≠£ËßÑÁöÑÈ°πÁõÆÈáåÈù¢ÔºåÊää‚ÄúÂ§ñÈÉ®ÂáΩÊï∞‚ÄùÁöÑÂ£∞ÊòéÂè¶ÂÜôÂà∞‰∏Ä‰∏™Â§¥Êñá‰ª∂‰∏≠Ôºå‰ΩøÁî®Êó∂Áõ¥Êé•ÂåÖÂê´Â§¥Êñá‰ª∂Âç≥ÂèØ„ÄÇ Âú®ÂÆö‰πâÂáΩÊï∞Êó∂ÔºåÂú®ÂáΩÊï∞ÁöÑÊúÄÂ∑¶ËæπÂä†‰∏ästaticÂèØ‰ª•ÊääËØ•ÂáΩÊï∞Â£∞Êòé‰∏∫ÂÜÖÈÉ®ÂáΩÊï∞(ÂèàÂè´ÈùôÊÄÅÂáΩÊï∞)Ôºå‰∏çÂÖÅËÆ∏ÂÖ∂‰ªñÊñá‰ª∂ËÆøÈóÆ„ÄÇ‰∏çÂêåÁöÑÊñá‰ª∂‰∏≠ÊúâÂêåÂêçÁöÑÂÜÖÈÉ®ÂáΩÊï∞ÔºåÂàô‰∫í‰∏çÂπ≤Êâ∞„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™ÂáΩÊï∞‰∏çÂèØ‰ª•ËÆøÈóÆÂú®ÂÆÉÂêéÈù¢ÂÆö‰πâÁöÑÂÖ®Â±ÄÂèòÈáè„ÄÇ‰∏çÂêåÊ∫êÊñá‰ª∂‰∏≠ÁöÑÂêåÂêçÂÖ®Â±ÄÂèòÈáè‰ª£Ë°®ÁùÄÂêå‰∏Ä‰∏™ÂèòÈáè„ÄÇ // aÊñá‰ª∂int ss =10; // bÊñá‰ª∂extern int ss ;printf("%d", ss);// ÊòØ10 Âú®ÂÆö‰πâÂÖ®Â±ÄÂèòÈáèÁöÑÊó∂ÂÄôÂä†‰∏ästaticÂÖ≥ÈîÆÂ≠óÔºåÊ≠§Êó∂staticÁöÑ‰ΩúÁî®Âú®‰∫éÈôêÂà∂ËØ•ÂÖ®Â±ÄÂèòÈáèÁöÑ‰ΩúÁî®ÂüüÔºåÂè™ËÉΩÂú®ÂÆö‰πâËØ•ÂÖ®Â±ÄÂèòÈáèÁöÑÊñá‰ª∂‰∏≠ÊâçËÉΩ‰ΩøÁî®ÔºåË∑üÂÖ∂‰ªñÊ∫êÊñá‰ª∂‰∏≠ÁöÑÂêåÂêçÂèòÈáè‰∫í‰∏çÂπ≤Êâ∞„ÄÇ 17.Â¶Ç‰ΩïÂÆö‰πâÁªìÊûÑ‰ΩìÂÆö‰πâÁªìÊûÑ‰ΩìÁöÑ‰∏âÁßçÂΩ¢Âºè(Êûö‰∏æÂèòÈáèÁöÑÂÆö‰πâ‰∏é‰πãÁ±ª‰ºº) struct Student &#123; char *name; int age;&#125;;// Âà©Áî®‰∏äÈù¢ÁªìÊûÑ‰ΩìÂÆö‰πâÁªìÊûÑ‰ΩìÂèòÈáèstustruct Student stu; // Áõ¥Êé•ÂÆö‰πâÁªìÊûÑ‰ΩìÂèòÈáèstustruct Student &#123; char *name; int age;&#125; stu; // ÂÆö‰πâÁªìÊûÑ‰ΩìÂèòÈáèstuÂêé,Ê≠§ÁªìÊûÑ‰ΩìÊ∞∏‰∏çÂÜçÁî®struct &#123; char *name; int age;&#125; stu; // ÁâπÊÆä:structÂâçÊîæÁΩÆtypedefË°®Á§∫Â£∞ÊòéÊ≠§"ÂåøÂêç"ÁªìÊûÑ‰ΩìÁöÑÂêçÂ≠ó‰∏∫Studenttypedef struct &#123; char *name; int age;&#125; Student; Ê≥®ÊÑè: ÂÆö‰πâÁªìÊûÑ‰ΩìÁ±ªÂûãÔºåÂè™ÊòØËØ¥Êòé‰∫ÜËØ•Á±ªÂûãÁöÑÁªÑÊàêÊÉÖÂÜµÔºåÂπ∂Ê≤°ÊúâÁªôÂÆÉÂàÜÈÖçÂ≠òÂÇ®Á©∫Èó¥„ÄÇ Â∞ÜÁªìÊûÑ‰ΩìÂèòÈáè‰Ωú‰∏∫ÂáΩÊï∞ÂèÇÊï∞ËøõË°å‰º†ÈÄíÊó∂ÔºåÂÖ∂ÂÆû‰º†ÈÄíÁöÑÊòØÂÖ®ÈÉ®ÊàêÂëòÁöÑÂÄºÔºå‰πüÂ∞±ÊòØÂ∞ÜÂÆûÂèÇ‰∏≠ÊàêÂëòÁöÑÂÄº‰∏Ä‰∏ÄËµãÂÄºÁªôÂØπÂ∫îÁöÑÂΩ¢ÂèÇÊàêÂëò„ÄÇÂõ†Ê≠§ÔºåÂΩ¢ÂèÇÁöÑÊîπÂèò‰∏ç‰ºöÂΩ±ÂìçÂà∞ÂÆûÂèÇ„ÄÇ 18.ÁªìÊûÑ‰ΩìÊåáÈíàÁöÑ‰ΩøÁî®ÁªìÊûÑ‰ΩìÊåáÈíàÂèòÈáèÁöÑÂÆö‰πâÂΩ¢ÂºèÔºöstruct ÁªìÊûÑ‰ΩìÂêçÁß∞ *ÊåáÈíàÂèòÈáèÂêçÔºå‰∏âÁßçËÆøÈóÆÊñπÂºè: ÁªìÊûÑ‰ΩìÂèòÈáèÂêç.ÊàêÂëòÂêç(*ÊåáÈíàÂèòÈáèÂêç).ÊàêÂëòÂêçÊåáÈíàÂèòÈáèÂêç-&gt;ÊàêÂëòÂêç 19.typedefÁöÑ‰∏ªË¶Å‰ΩøÁî® typedefÁªôÊåáÈíàËµ∑Âà´Âêç // Áõ∏ÂΩì‰∫échar *str = "This is a string!";String str = "This is a string!"; typedefÁªôÁªìÊûÑ‰ΩìËµ∑Âà´Âêç struct CGRect &#123; CGPoint origin; CGSize size;&#125;;typedef struct CGRect CGRect;// ‰∏∫ struct CGRect Ëµ∑Âà´ÂêçÂè´‰Ωú CGRect typedefÁªôÊåáÂêëÁªìÊûÑ‰ΩìÁöÑÊåáÈíàËµ∑Âà´Âêç #include &lt;stdio.h&gt; // ÂÆö‰πâ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÂπ∂Ëµ∑Âà´Âêçtypedef struct &#123; float x; float y;&#125; Point; // ÁªôPoint *Ëµ∑Âà´ÂêçPPtypedef Point *PP; int main(int argc, const char * argv[]) &#123; // ÂÆö‰πâÁªìÊûÑ‰ΩìÂèòÈáè Point point = &#123;10, 20&#125;; // ÂÆö‰πâÊåáÈíàÂèòÈáèPoint *p = &amp;point; PP p = &amp;point; // Âà©Áî®ÊåáÈíàÂèòÈáèËÆøÈóÆÁªìÊûÑ‰ΩìÊàêÂëò printf("x=%fÔºåy=%f", p-&gt;x, p-&gt;y); return 0;&#125; typedef‰∏éÊûö‰∏æÁ±ªÂûã // ÂÆö‰πâÊûö‰∏æÁ±ªÂûãenum Season &#123;spring, summer, autumn, winter&#125;;// ÁªôÊûö‰∏æÁ±ªÂûãenum SeasonËµ∑Âà´Âêç‰∏∫Seasontypedef enum Season Season; int main(int argc, const char * argv[]) &#123; // ÂÆö‰πâÊûö‰∏æÂèòÈáè Season s = spring; return 0;&#125; typedefÁªôÊåáÂêëÂáΩÊï∞ÁöÑÊåáÈíàÁ±ªÂûãËµ∑Âà´Âêç #include &lt;stdio.h&gt;// ÂÆö‰πâ‰∏Ä‰∏™sumÂáΩÊï∞ÔºåËÆ°ÁÆóaË∑übÁöÑÂíåint sum(int a, int b) &#123; int c = a + b; printf("%d + %d = %d", a, b, c); return c;&#125;typedef int (*MySum)(int, int);int main(int argc, const char * argv[]) &#123; // ÂÆö‰πâ‰∏Ä‰∏™ÊåáÂêësumÂáΩÊï∞ÁöÑÊåáÈíàÂèòÈáèp MySum p = sum; // Âà©Áî®ÊåáÈíàÂèòÈáèpË∞ÉÁî®sumÂáΩÊï∞ (*p)(4, 5); return 0; &#125; typedef‰∏é#defineÔºåÁªôÁ±ªÂûãËµ∑Âà´ÂêçÔºåÊúÄÂ•Ω‰ΩøÁî®typedefÔºåËÄå‰∏çÊòØ‰ΩøÁî®#define typedef char *String1;#define String2 char * // Áõ∏ÂΩì‰∫échar *str1;char *str2;String1 str1, str2;// Áõ∏ÂΩì‰∫échar *str3;char str4;‰∫ßÁîüËØØ‰ºöString2 str3, str4; 20.import‰∏éincludeÁöÑÂå∫Âà´ #importÊòØ‰∏Ä‰∏™È¢ÑÂ§ÑÁêÜÊåá‰ª§Ôºå‰ΩúÁî®Ë∑üCËØ≠Ë®ÄÁöÑ#includeÁ±ª‰ººÔºåÈÉΩÊòØ ÂåÖÂê´(Êã∑Ë¥ù)Êüê‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπ Âà∞ È¢ÑÂ§ÑÁêÜÊåá‰ª§ÊâÄÂú®ÁöÑ‰ΩçÁΩÆ„ÄÇÂú®Objective-C‰∏≠Ôºå‰ΩøÁî®#importÊù•ÂåÖÂê´Â§¥Êñá‰ª∂ÔºåÂèØ‰ª•Ëá™Âä®Èò≤Ê≠¢Âêå‰∏Ä‰∏™Â§¥Êñá‰ª∂Ë¢´ÂåÖÂê´Â§öÊ¨°„ÄÇ#import &lt;...&gt;Ë°®Á§∫ÂåÖÂê´Á≥ªÁªüËá™Â∏¶ÁöÑÊñá‰ª∂Ôºå#import &quot;...&quot;Ë°®Á§∫ÂåÖÂê´ÂºÄÂèë‰∫∫ÂëòËá™Â∑±ÂàõÂª∫ÁöÑÊñá‰ª∂„ÄÇ 21.UIViewÊòæÁ§∫ÁöÑËøáÁ®ãUIView‰πãÊâÄ‰ª•ËÉΩÊòæÁ§∫Âú®Â±èÂπï‰∏äÔºåÂÆåÂÖ®ÊòØÂõ†‰∏∫ÂÆÉÂÜÖÈÉ®ÁöÑ‰∏Ä‰∏™Â±Ç(CALayerÂØπË±°)„ÄÇÂΩìUIViewÈúÄË¶ÅÊòæÁ§∫Âà∞Â±èÂπï‰∏äÊó∂Ôºå‰ºöË∞ÉÁî®drawRect:ÊñπÊ≥ïËøõË°åÁªòÂõæÔºåÂπ∂‰∏î‰ºöÂ∞ÜÊâÄÊúâÂÜÖÂÆπÁªòÂà∂Âú®Ëá™Â∑±ÁöÑÂ±Ç‰∏äÔºåÁªòÂõæÂÆåÊØïÂêéÔºåÁ≥ªÁªü‰ºöÂ∞ÜÂ±ÇÊã∑Ë¥ùÂà∞Â±èÂπï‰∏äÔºå‰∫éÊòØÂ∞±ÂÆåÊàê‰∫ÜUIViewÁöÑÊòæÁ§∫„ÄÇÂΩìUIViewÈúÄË¶ÅÊòæÁ§∫Êó∂ÔºåÂÆÉÂÜÖÈÉ®ÁöÑÂ±Ç‰ºöÂáÜÂ§áÂ•Ω‰∏Ä‰∏™CGContextRef(ÂõæÂΩ¢‰∏ä‰∏ãÊñá)ÔºåÁÑ∂ÂêéË∞ÉÁî®delegate(ËøôÈáåÂ∞±ÊòØUIView)ÁöÑdrawLayer:inContext:ÊñπÊ≥ïÔºåÂπ∂‰∏î‰º†ÂÖ•Â∑≤ÁªèÂáÜÂ§áÂ•ΩÁöÑCGContextRefÂØπË±°„ÄÇËÄåUIViewÂú®drawLayer:inContext:ÊñπÊ≥ï‰∏≠Âèà‰ºöË∞ÉÁî®Ëá™Â∑±ÁöÑdrawRect:ÊñπÊ≥ï„ÄÇ 22.position‰∏éanchorPointpositionÂèØ‰ª•Áî®Êù•ËÆæÁΩÆCALayerÂú®Áà∂Â±Ç‰∏≠ÁöÑ‰ΩçÁΩÆÔºåÂÆÉÊòØ‰ª•Áà∂Â±ÇÁöÑÂ∑¶‰∏äËßí‰∏∫ÂùêÊ†áÂéüÁÇπ(0, 0);anchorPointÁß∞‰∏∫‚ÄúÂÆö‰ΩçÁÇπ‚ÄùÔºåÂÆÉÂÜ≥ÂÆöÁùÄCALayerË∫´‰∏äÁöÑÂì™‰∏™ÁÇπ‰ºöÂú®positionÂ±ûÊÄßÊâÄÊåáÁöÑ‰ΩçÁΩÆ„ÄÇÂÆÉÁöÑx„ÄÅyÂèñÂÄºËåÉÂõ¥ÈÉΩÊòØ0~1ÔºåÈªòËÆ§ÂÄº‰∏∫(0.5, 0.5)„ÄÇ 23.Core Animation‰ºöÈòªÂ°û‰∏ªÁ∫øÁ®ãÂêóCore AnimationÁöÑÂä®ÁîªÊâßË°åËøáÁ®ãÈÉΩÊòØÂú®ÂêéÂè∞Êìç‰ΩúÁöÑÔºå‰∏ç‰ºöÈòªÂ°û‰∏ªÁ∫øÁ®ãÔºåËÄå‰∏îÊòØÁõ¥Êé•‰ΩúÁî®Âú®CALayer‰∏äÁöÑÔºåÂπ∂ÈùûUIView„ÄÇ 24.Á©∫ÊåáÈíàÊ≤°ÊúâÂ≠òÂÇ®‰ªª‰ΩïÂÜÖÂ≠òÂú∞ÂùÄÁöÑÊåáÈíàÂ∞±Áß∞‰∏∫Á©∫ÊåáÈíà(NULLÊåáÈíàÔºåÊåáÂêënil)ÔºåÁ©∫ÊåáÈíàÂ∞±ÊòØË¢´ËµãÂÄº‰∏∫0ÁöÑÊåáÈíàÔºåÂú®Ê≤°ÊúâË¢´ÂÖ∑‰ΩìÂàùÂßãÂåñ‰πãÂâçÔºåÂÖ∂ÂÄº‰∏∫0„ÄÇÂèØ‰ª•ÁªôÁ©∫ÊåáÈíàÂèëÈÄÅÊ∂àÊÅØÔºå‰ΩÜÊ∂àÊÅØÂèëÈÄÅ‰∏çÂá∫Âéª„ÄÇ‚ÄúÈáéÊåáÈíà‚Äù‰∏çÊòØNULLÊåáÈíàÔºåÊòØÊåáÂêë‚ÄúÂûÉÂúæ‚ÄùÂÜÖÂ≠òÔºà‰∏çÂèØÁî®ÂÜÖÂ≠òÔºâÁöÑÊåáÈíà„ÄÇ 25.‰∏çÂêåÁºñËØëÂô®‰∏ãÂêÑÁ±ªÂûãÊâÄÂç†Â≠óËäÇ 26.self‰∏ésuperself ÊòØÊñπÊ≥ïÁöÑÈöêËóèÁöÑÂèÇÊï∞ÔºåÊåáÂêëÂΩìÂâçË∞ÉÁî®ÊñπÊ≥ïÁöÑÂØπË±°ÔºåÂè¶‰∏Ä‰∏™ÈöêËóèÂèÇÊï∞ÊòØ _cmdÔºå‰ª£Ë°®ÂΩìÂâçÊñπÊ≥ïÁöÑ selector„ÄÇsuper Âè™ÊòØ‰∏Ä‰∏™‚ÄúÁºñËØëÂô®ÊåáÁ§∫Á¨¶‚Äù(ÁºñËØëÂô®ÁâπÊÄß)ÔºåÂÆÉÂíå self ÊåáÂêëÁöÑÊòØÁõ∏ÂêåÁöÑÊ∂àÊÅØÊé•Êî∂ËÄÖ„ÄÇ‰∏çÂêåÁöÑÊòØÔºåsuper ÂëäËØâÁºñËØëÂô®ÔºåË¶ÅÂÖàÂéªË∞ÉÁî®Áà∂Á±ªÁöÑÊñπÊ≥ïÔºåËÄå‰∏çÊòØÊú¨Á±ªÈáåÁöÑ„ÄÇÂΩì‰ΩøÁî® self Ë∞ÉÁî®ÊñπÊ≥ïÊó∂Ôºå‰ºö‰ªéÂΩìÂâçÁ±ªÁöÑÊñπÊ≥ïÂàóË°®‰∏≠ÂºÄÂßãÊâæÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂ∞±‰ªéÁà∂Á±ª‰∏≠ÂÜçÊâæÔºõËÄåÂΩì‰ΩøÁî® super Êó∂ÔºåÂàôÂÖà‰ªéÁà∂Á±ªÁöÑÊñπÊ≥ïÂàóË°®‰∏≠ÂºÄÂßãÊâæÔºåÁÑ∂ÂêéË∞ÉÁî®Áà∂Á±ªÁöÑËøô‰∏™ÊñπÊ≥ï„ÄÇ 27.Ê∂àÊÅØÂèëÈÄÅid objc_msgSend(id theReceiver, SEL theSelector, ...) ‰ª•[self setName:] ‰∏∫‰æãÔºåÁºñËØëÂô®‰ºöÊõøÊç¢ÊàêË∞ÉÁî®objc_msgSend ÁöÑÂáΩÊï∞Ë∞ÉÁî®ÔºåÂÖ∂‰∏≠ theReceiver ÊòØ selfÔºåtheSelector ÊòØ @selector(setName:)ÔºåËøô‰∏™ selector ÊòØ‰ªéÂΩìÂâç self ÁöÑ class ÁöÑÊñπÊ≥ïÂàóË°®ÂºÄÂßãÊâæÁöÑ setNameÔºåÂΩìÊâæÂà∞ÂêéÊääÂØπÂ∫îÁöÑ selector ‰º†ÈÄíËøáÂéª„ÄÇid objc_msgSendSuper(struct objc_super *super, SEL op, ...)struct objc_super &#123; id receiver; Class superClass;&#125;; ËÄåÂΩì‰ΩøÁî®[super setName] Ë∞ÉÁî®Êó∂Ôºå‰ºö‰ΩøÁî® objc_msgSendSuper ÂáΩÊï∞ÔºåÁªìÊûÑ‰ΩìÂåÖÂê´‰∫Ü‰∏§‰∏™ÊàêÂëòÔºå‰∏Ä‰∏™ÊòØ receiverÔºåËøô‰∏™Á±ª‰ººobjc_msgSend ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ receiverÔºåÁ¨¨‰∫å‰∏™ÊàêÂëòÊòØËÆ∞ÂΩïÊâÄË∞ìÁöÑ‚ÄúÁà∂Á±ª‚Äù„ÄÇ‰ªé objc_super ÁªìÊûÑ‰ΩìÊåáÂêëÁöÑ superClass ÁöÑÊñπÊ≥ïÂàóË°®ÂºÄÂßãÊâæ setName ÁöÑ selectorÔºåÊâæÂà∞ÂêéÂÜç‰ª• objc_super-&gt;receiver ÂéªË∞ÉÁî®Ëøô‰∏™ selector„ÄÇ 28.ÈÄöÁü•NSNotification‰ΩøÁî®ÁöÑÊòØÂêåÊ≠•Êìç‰ΩúÔºåÂ¶ÇÊûúÊÉ≥ËÆ©NSNotificationÁöÑpostÂ§ÑÂíåobserverÂ§ÑÂºÇÊ≠•ÊâßË°åÔºåÂèØ‰ª•ÈÄöËøáNSNotificationQueueÂÆûÁé∞„ÄÇÂØπ‰∫éÂêå‰∏Ä‰∏™ÈÄöÁü•ÔºåÂ¶ÇÊûúÊ≥®ÂÜå‰∫ÜÂ§ö‰∏™ËßÇÂØüËÄÖÔºåÂàôËøôÂ§ö‰∏™ËßÇÂØüËÄÖÁöÑÊâßË°åÈ°∫Â∫èÂíå‰ªñ‰ª¨ÁöÑÊ≥®ÂÜåÈ°∫Â∫èÊòØ‰øùÊåÅ‰∏ÄËá¥ÁöÑ„ÄÇobserverÁöÑÂõûË∞ÉÊñπÊ≥ïÊâßË°åÁ∫øÁ®ãÂíåpostÁöÑÁ∫øÁ®ã‰øùÊåÅ‰∏ÄËá¥ÔºåÂ¶ÇÊûúÊÉ≥ËÆ©postÁöÑÁ∫øÁ®ãÂíåËΩ¨ÂèëÁöÑÁ∫øÁ®ã‰∏çÂêåÔºåÂèØ‰ª•ÈÄöËøáNSNotificationÈáçÂÆöÂêëÊäÄÊúØÂÆûÁé∞„ÄÇaddObserverÂíåremoveObserverÂøÖÈ°ªÊàêÂØπÂá∫Áé∞ÔºåÊàñËÄÖËØ¥Ê∑ªÂä†‰∫ÜObserverÂøÖÈ°ªÈÄÇÊó∂ÁßªÈô§Observer„ÄÇÂõ†‰∏∫ÈÄöÁü•‰∏≠ÂøÉÂπ∂‰∏çretain ObserverÔºåËã•‰∏çÁßªÈô§Ôºå‰ºöÊûÅÊòìÈÄ†ÊàêÁªôÈáäÊîæÁöÑÂØπË±°ÂèëÈÄÅÊ∂àÊÅØÔºåÂá∫Áé∞ÂùèÂÜÖÂ≠òËÆøÈóÆ„ÄÇ 29.Â±èÂπïÊôÆÂ±è‰∏≠1ÁÇπ = 1ÂÉèÁ¥†ÔºåRetinaÂ±èÔºö1ÁÇπ = 2ÂÉèÁ¥†„ÄÇ‰∫∫ÊâãÊåáÁöÑÊúÄÂ∞èÁÇπÂáªËåÉÂõ¥ÊòØ44pixelsÔºåÊâÄ‰ª•Âú®iPhoneÁöÑÂæàÂ§öÁªÜËäÇ‰∏äÈÉΩÊòØ44 pixels„ÄÇ‰ΩøÁî®ÂõæÁâáËµÑÊ∫êÊó∂ÔºåÊñπÊ≥ïÔºö[UIImage imageNamed:@&quot;adflower.png&quot;]]ÔºåÂú®ÂÆûÈôÖËøêË°åÊó∂ÔºåÂ¶ÇÊûúÂèëÁé∞ÂΩìÂâçÁöÑËÆæÂ§áÊòØRetinaÂ±èÔºå‰ºöËá™Âä®ÂØªÊâæÂõæÁâáÂêç‰∏∫adflower@ 2x.pngÁöÑÂõæÁâá„ÄÇ [UIScreen mainScreen].applicationFrameËé∑ÂèñappÂ∞∫ÂØ∏(ÂéªÊéâÁä∂ÊÄÅÊ†è)Ôºå[UIScreen mainScreen].boundsËé∑ÂèñÂ±èÂπïÂ∞∫ÂØ∏Ôºå[[UIApplicationsharedApplication] statusBarFrame]Ëé∑ÂèñÁä∂ÊÄÅÊ†èÂ∞∫ÂØ∏„ÄÇ 30.Á®ãÂ∫èÂêØÂä®Âú®Á®ãÂ∫èÂêØÂä®ÁöÑÊó∂ÂÄô‰ªª‰ΩïÁ±ªÂÆö‰πâÈÉΩÂØπÂ∫î‰∫é‰∏ÄÂùóÂÜÖÂ≠ò„ÄÇÂú®ÁºñËØëÁöÑÊó∂ÂÄôÔºåÁºñËØëÂô®‰ºöÁªôÊØè‰∏Ä‰∏™Á±ªÁîüÊàê‰∏Ä‰∏™‰∏îÂè™ÁîüÊàê‰∏Ä‰∏™‚ÄúÊèèËø∞ÂÖ∂ÂÆö‰πâÁöÑÂØπË±°‚ÄùÔºå‰πüÂ∞±ÊòØÁ±ªÂØπË±°(class object)ÔºåÂÆÉÊòØ‰∏Ä‰∏™Âçï‰æã(singleton)ÔºåËøô‰∏™Á±ªÂØπË±°(class object)Â∞±ÊòØËøêË°åÊó∂Â∫ìÁî®Êù•ÂàõÂª∫ÂÆû‰æãÂØπË±°(instance object)ÁöÑ‰æùÊçÆ„ÄÇ‰ªª‰ΩïÁõ¥Êé•ÊàñÈó¥Êé•ÁªßÊâø‰∫ÜNSObjectÁöÑÁ±ªÔºåÂÆÉÁöÑÂÆû‰æãÂØπË±°(instance objec)‰∏≠ÈÉΩÊúâ‰∏Ä‰∏™isaÊåáÈíàÔºåÊåáÂêëÂÆÉÁöÑÁ±ªÂØπË±°(class object)„ÄÇËøô‰∏™Á±ªÂØπË±°(class object)‰∏≠Â≠òÂÇ®‰∫ÜÂÖ≥‰∫éËøô‰∏™ ÂÆû‰æãÂØπË±°(instace object) ÊâÄÂ±ûÁöÑÁ±ªÁöÑÂÆö‰πâÁöÑ‰∏ÄÂàáÔºöÂåÖÊã¨ÂèòÈáè„ÄÅÊñπÊ≥ï„ÄÅÈÅµÂÆàÁöÑÂçèËÆÆÁ≠âÁ≠â„ÄÇ Á±ªÂØπË±°Âπ∂‰∏çÊòØÁ±ªÁöÑÂÆû‰æãÊú¨Ë∫´„ÄÇÂÆÉÊ≤°ÊúâËá™Â∑±ÁöÑÂÆû‰æãÂèòÈáèÔºå‰πü‰∏çËÉΩÊâßË°åÁ±ªÁöÑÂÆû‰æãÁöÑÊñπÊ≥ï„ÄÇÁ±ªÂØπË±°ÊòØ‰∏Ä‰∏™ÂäüËÉΩÂÆåÊï¥ÁöÑÂØπË±°Ôºå‰πüËÉΩË¢´Âä®ÊÄÅËØÜÂà´Ôºàdynamically typedÔºâÔºåÊé•Êî∂Ê∂àÊÅØÔºå‰ªéÂÖ∂‰ªñÁ±ªÁªßÊâøÊñπÊ≥ï„ÄÇÁâπÊÆä‰πãÂ§ÑÂú®‰∫éÂÆÉ‰ª¨ÊòØÁî±ÁºñËØëÂô®ÂàõÂª∫ÁöÑÔºåÁº∫Â∞ëÂÆÉ‰ª¨Ëá™Â∑±ÁöÑÊï∞ÊçÆÁªìÊûÑ(ÂÆû‰æãÂèòÈáèÔºâÔºåÂè™ÊòØÂú®ËøêË°åÊó∂‰∫ßÁîüÂÆû‰æãÁöÑ‰ª£ÁêÜ„ÄÇÁ±ªÂØπË±°ÊòØÂÖÉÁ±ªÂØπË±°ÁöÑ‰∏Ä‰∏™ÂÆû‰æãÔºåÂÖÉÁ±ªÊòØÊ†πÂÖÉÁ±ª(root class‚Äôs metaclass)ÁöÑÂÆû‰æãÔºåËÄåÊ†πÂÖÉÁ±ªÊòØÂÖ∂Ëá™Ë∫´ÁöÑÂÆû‰æãÔºåÂç≥Ê†πÂÖÉÁ±ªÁöÑisaÊåáÈíàÊåáÂêëËá™Ë∫´„ÄÇ ‰∏Ä‰∏™Ê∂àÊÅØÂèëÈÄÅÁªô‰ªª‰Ωï‰∏Ä‰∏™ÂØπË±°Ôºå ÊñπÊ≥ïÁöÑÊ£ÄÊü• ‰ªéÂØπË±°ÁöÑ isa ÊåáÈíàÂºÄÂßãÔºåÁÑ∂ÂêéÊòØÁà∂Á±ª„ÄÇÂÆû‰æãÊñπÊ≥ïÂú®Á±ª‰∏≠ÂÆö‰πâÔºå Á±ªÊñπÊ≥ï Âú®ÂÖÉÁ±ªÂíåÊ†πÁ±ª‰∏≠ÂÆö‰πâ„ÄÇÔºàÊ†πÁ±ªÁöÑÂÖÉÁ±ªÂ∞±ÊòØÊ†πÁ±ªËá™Â∑±Ôºâ„ÄÇÁ±ªÂØπË±°(class object)‰∏≠ÂåÖÂê´‰∫ÜÁ±ªÁöÑÂÆû‰æãÂèòÈáè„ÄÅÂÆû‰æãÊñπÊ≥ïÁöÑÂÆö‰πâÔºåËÄåÂÖÉÁ±ªÂØπË±°(metaclass object)‰∏≠ÂåÖÊã¨‰∫ÜÁ±ªÁöÑÁ±ªÊñπÊ≥ïÁöÑÂÆö‰πâ„ÄÇÁ±ªÂØπË±°Â≠òÁöÑÊòØÂÖ≥‰∫éÂÆû‰æãÂØπË±°ÁöÑ‰ø°ÊÅØ(ÂèòÈáèÔºåÂÆû‰æãÊñπÊ≥ïÁ≠â)ÔºåËÄåÂÖÉÁ±ªÂØπË±°(metaclass object)‰∏≠Â≠òÂÇ®ÁöÑÊòØÂÖ≥‰∫éÁ±ªÁöÑ‰ø°ÊÅØ(Á±ªÁöÑÁâàÊú¨ÔºåÂêçÂ≠óÔºåÁ±ªÊñπÊ≥ïÁ≠â)„ÄÇ ‚ë†object_getClassË∑üÈöèÂÆû‰æãÁöÑisaÊåáÈíàÔºåËøîÂõûÊ≠§ÂÆû‰æãÊâÄÂ±ûÁöÑÁ±ªÔºåÂØπ‰∫éÂÆû‰æãÂØπË±°(instance)ËøîÂõûÁöÑÊòØÁ±ª(class)ÔºåÂØπ‰∫éÁ±ª(class)ÂàôËøîÂõûÁöÑÊòØÂÖÉÁ±ª(metaclass)„ÄÇ‚ë°- classÊñπÊ≥ïÂØπ‰∫éÂÆû‰æãÂØπË±°(instance)‰ºöËøîÂõûÁ±ª(class)Ôºå‰ΩÜÂØπ‰∫éÁ±ª(class)Âàô‰∏ç‰ºöËøîÂõûÂÖÉÁ±ª(metaclass)ÔºåËÄåÂè™‰ºöËøîÂõûÁ±ªÊú¨Ë∫´„ÄÇ‚ë¢class_isMetaClassÂèØÂà§Êñ≠ÊüêÁ±ªÊòØÂê¶‰∏∫ÂÖÉÁ±ª„ÄÇ‚ë£‰ΩøÁî®objc_allocateClassPairÂèØÂú®ËøêË°åÊó∂ÂàõÂª∫Êñ∞ÁöÑÁ±ª‰∏éÂÖÉÁ±ªÂØπÔºå‰ΩøÁî®class_addMethodÂíåclass_addIvarÂèØÂêëÁ±ª‰∏≠Â¢ûÂä†ÊñπÊ≥ïÂíåÂÆû‰æãÂèòÈáèÔºåÊúÄÂêé‰ΩøÁî®objc_registerClassPairÊ≥®ÂÜåÂêéÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®Ê≠§Á±ª‰∫Ü„ÄÇ 31.allocÊñπÊ≥ïÈÄöËøáallocÊàñallocWithZoneÊñπÊ≥ïÂàõÂª∫ÂØπË±°Êó∂Ôºå cocoa‰ºöÈÅçÂéÜËØ•ÂØπË±°ÊâÄÊúâÁöÑÊàêÂëòÂèòÈáèÔºåÈÄöËøáÊàêÂëòÂèòÈáèÁöÑÁ±ªÂûãÊù•ËÆ°ÁÆóÊâÄÈúÄÂç†Áî®ÁöÑÂÜÖÂ≠òËøîÂõû‰∏Ä‰∏™Êú™‚ÄúÂàù‰ΩøÂåñ‚ÄùËøáÁöÑÂØπË±°„ÄÇ Â∞ÜËØ•Êñ∞ÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞(Retain Count)ËÆæÁΩÆÊàê1„ÄÇ ËØ•Êñ∞ÂØπË±°ÁöÑisaÊàêÂëòÂèòÈáèÊåáÂêëÂÆÉÁöÑÁ±ªÂØπË±°„ÄÇ Â∞ÜËØ•Êñ∞ÂØπË±°ÁöÑÊâÄÊúâÂÖ∂ÂÆÉÊàêÂëòÂèòÈáèÁöÑÂÄºËÆæÁΩÆÊàêÈõ∂„ÄÇÔºàÊ†πÊçÆÊàêÂëòÂèòÈáèÁ±ªÂûãÁöÑ‰∏çÂêåÔºåÈõ∂ÊúâÂèØËÉΩÊòØÊåánilÊàñ0Ôºâ ËøîÂõûÊåáÂêëËØ•ÂØπË±°ÁöÑ‰∏Ä‰∏™ÊåáÈíà„ÄÇ 32.initÊñπÊ≥ïÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈÉΩ‰∏çÂ∏åÊúõÊâÄÊúâÊàêÂëòÂèòÈáèÈÉΩÊòØÈõ∂ÔºåÊâÄ‰ª•‚ë†initÊñπÊ≥ïÂÅöÂàù‰ΩøÂåñÂ∑•‰ΩúÔºåËÆ©ÂØπË±°ÁöÑÊàêÂëòÂèòÈáèÁöÑÂÄºÁ¨¶ÂêàÊàë‰ª¨Á®ãÂ∫èÈÄªËæë‰∏≠ÁöÑÂàùÂßãÂåñÁä∂ÊÄÅ„ÄÇ‚ë°ËøîÂõûÁúüÊ≠£ÂèØ‰ª•‰ΩøÁî®ÁöÑÊåáÂêëËØ•ÂØπË±°ÁöÑÊåáÈíàÊüê‰∫õÊÉÖÂÜµ‰∏ãÔºåinit‰ºöÈÄ†ÊàêallocÁöÑÂéüÊú¨Á©∫Èó¥‰∏çÂ§üÁî®ÔºåËÄåËøõË°åÁ¨¨‰∫åÊ¨°ÂàÜÈÖçÂÜÖÂ≠òÁ©∫Èó¥„ÄÇÊâÄ‰ª•‰∏ãÈù¢ÁöÑÂÜôÊ≥ïÊòØÈîôÁöÑÔºöNSString *s = [NSString alloc];[s init];// ËøôÂÑøinitËøîÂõûÁöÑÂú∞ÂùÄÂèØËÉΩ‰ºöÂèò„ÄÇsÂéüÊú¨ÁöÑÊåáÈíàÂú∞ÂùÄÂèØËÉΩÊòØÊó†ÊïàÁöÑÂú∞ÂùÄ„ÄÇ Ê≠£Á°ÆÁöÑÂÜôÊ≥ïÊòØNSString *s = [[NSString alloc] init];newÁÆÄÂçïÂú∞Á≠â‰ª∑‰∫é alloc + initÔºå‰ΩÜ‰∏çËÉΩÊåáÂÆöinitÁöÑÂèÇÊï∞ÔºåÂæàÂ∞ëÁî®„ÄÇNSIntegerÊòØ‰∏Ä‰∏™ÊúâÁ¨¶Âè∑ÂûãintÔºåÂÆÉ‰∏éintÁöÑÂå∫Âà´Â∞±Âú®‰∫éNSIntegerÂèØ‰ª•Ëá™Âä®ËØÜÂà´Êú∫Âô®ÊòØ32‰ΩçËøòÊòØ64‰Ωç„ÄÇNSIntegerÁöÑÊó†Á¨¶Âè∑ÁâàÊú¨ÊòØNSUInteger„ÄÇ 33.ËøêË°åÊó∂Ê∂àÊÅØÂè™ÊúâÂà∞ËøêË°åÊó∂Êâç‰ºöÂíåÂáΩÊï∞ÂÆûÁé∞ÁªëÂÆöËµ∑Êù•ÔºåËÄå‰∏çÊòØÊåâÁÖßÁºñËØëÂ•ΩÁöÑÈÄªËæë‰∏ÄÊàê‰∏çÂèòÁöÑÊâßË°å„ÄÇÁºñËØëÈò∂ÊÆµÂè™ÊòØÁ°ÆÂÆö‰∫ÜË¶ÅÂéªÂêëreceiverÂØπË±°ÂèëÈÄÅmessageÊ∂àÊÅØÔºå‰ΩÜÊòØÂç¥Ê≤°ÊúâÂèëÈÄÅÔºåÁúüÊ≠£ÂèëÈÄÅÊòØÁ≠âÂà∞ËøêË°åÁöÑÊó∂ÂÄôËøõË°å„ÄÇNSObject Á±ªÂÆö‰πâ‰∫ÜdescriptionÊñπÊ≥ïÔºåËøîÂõûËØ•Á±ªÂÜÖÂÆπÁöÑÂ≠óÁ¨¶‰∏≤Ë°®Á§∫„ÄÇÊüê‰∫õ NSObject ÁöÑÊñπÊ≥ïÂè™ÊòØÁÆÄÂçïÂú∞‰ªéËøêË°åÊó∂Á≥ªÁªü‰∏≠Ëé∑Âæó‰ø°ÊÅØÔºå‰ªéËÄåÂÖÅËÆ∏ÂØπË±°ËøõË°å‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑËá™ÊàëÊ£ÄÊü•„ÄÇ ‰æãÂ¶ÇÔºåclass ËøîÂõûÂØπË±°ÁöÑÁ±ª;isKindOfClass:Âíå isMemberOfClass:ÂàôÊ£ÄÊü•ÂØπË±°ÊòØÂê¶Âú®ÊåáÂÆöÁöÑ Á±ªÁªßÊâø‰ΩìÁ≥ª‰∏≠;respondsToSelector:Ê£ÄÊü•ÂØπË±°ËÉΩÂê¶ÂìçÂ∫îÊåáÂÆöÁöÑÊ∂àÊÅØ;conformsToProtocol: Ê£ÄÊü•ÂØπË±°ÊòØÂê¶ÂÆûÁé∞‰∫ÜÊåáÂÆöÂçèËÆÆÁ±ªÁöÑÊñπÊ≥ï;methodForSelector:ÂàôËøîÂõûÊåáÂÆöÊñπÊ≥ïÂÆûÁé∞ÁöÑÂú∞ÂùÄ„ÄÇ ‚ë†messageÔºàÊ∂àÊÅØÔºâmessage ÊòØ‰∏ÄÁßçÊäΩË±°ÔºåÂåÖÊã¨‰∫ÜÂáΩÊï∞Âêç+ÂèÇÊï∞ÂàóË°®ÔºåÂπ∂Ê≤°ÊúâÂÆûÈôÖÁöÑÂÆû‰ΩìÂ≠òÂú®„ÄÇ‚ë°methodÔºàÊñπÊ≥ïÔºâmethodÊòØÁúüÊ≠£ÁöÑÂ≠òÂú®ÁöÑ‰ª£Á†Å„ÄÇÂ¶ÇÔºö- (int)meaning { return 42; }‚ë¢selectorÔºàÊñπÊ≥ïÈÄâÊã©Âô®Ôºâselector ÈÄöËøáSELÁ±ªÂûãÂ≠òÂú®ÔºåÊèèËø∞‰∏Ä‰∏™ÁâπÂÆöÁöÑmethod ÊàñËÄÖËØ¥ message„ÄÇÂú®ÂÆûÈôÖÁºñÁ®ã‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáselectorËøõË°åÊ£ÄÁ¥¢ÊñπÊ≥ïÁ≠âÊìç‰Ωú„ÄÇ 34.ÊñπÊ≥ïÈÄâÊã©Âô®ÂÆÉÊòØ‰∏Ä‰∏™char *ÊåáÈíàÔºå‰ªÖ‰ªÖË°®Á§∫ÂÆÉÊâÄ‰ª£Ë°®ÁöÑÊñπÊ≥ïÂêçÂ≠ó„ÄÇtypedef struct objc_selector *SEL; SEL selector = @selector(message); // @selector‰∏çÊòØÂáΩÊï∞Ë∞ÉÁî®ÔºåÂè™ÊòØÁªôÁºñËØëÂô®ÁöÑ‰∏Ä‰∏™ÊèêÁ§∫ NSLog (@"%s", (char *)selector); //print message Objective-CÂú®ÁºñËØëÁöÑÊó∂ÂÄôÔºå‰ºöÊ†πÊçÆÊñπÊ≥ïÁöÑÂêçÂ≠óÔºåÁîüÊàê‰∏Ä‰∏™Áî®Êù•Âå∫ÂàÜËøô‰∏™ÊñπÊ≥ïÁöÑÂîØ‰∏ÄÁöÑ‰∏Ä‰∏™IDÔºåËøô‰∏™IDÂ∞±ÊòØSELÁ±ªÂûãÁöÑÔºàÁîüÊàêÂîØ‰∏ÄÁöÑSELÔºâ„ÄÇÂè™Ë¶ÅÊñπÊ≥ïÁöÑÂêçÂ≠óÁõ∏ÂêåÔºåÈÇ£‰πàÂÆÉ‰ª¨ÁöÑIDÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇÁºñËØëÂô®‰ºöÊ†πÊçÆÔºåËøô‰∏™SetÁÆÄÂçïÁöÑËØ¥Â∞±ÊòØ‰∏Ä‰∏™ÁªèËøá‰∫Ü‰ºòÂåñËøáÁöÑhashË°®„ÄÇSELÂÆûÈôÖ‰∏äÂ∞±ÊòØÊ†πÊçÆÊñπÊ≥ïÂêçhashÂåñ‰∫ÜÁöÑ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåËÄåÂØπ‰∫éÂ≠óÁ¨¶‰∏≤ÁöÑÊØîËæÉ‰ªÖ‰ªÖÈúÄË¶ÅÊØîËæÉ‰ªñ‰ª¨ÁöÑÂú∞ÂùÄÂ∞±ÂèØ‰ª•‰∫ÜÔºå‰ªéËÄåÂä†Âø´ÊñπÊ≥ïÁöÑÊü•ËØ¢ÈÄüÂ∫¶„ÄÇ 35.IMPtypedef id (*IMP)(id, SEL, ...);Áî±‰∫éÊØè‰∏™ÊñπÊ≥ïÈÉΩÂØπÂ∫îÂîØ‰∏ÄÁöÑSELÔºåÂèØ‰ª•ÈÄöËøáSELÊñπ‰æø„ÄÅÂø´ÈÄü„ÄÅÂáÜÁ°ÆÁöÑËé∑ÂæóÂÆÉÊâÄÂØπÂ∫îÁöÑIMPÔºà‰πüÂ∞±ÊòØÂáΩÊï∞ÊåáÈíàÔºâÔºåËÄåÂú®ÂèñÂæó‰∫ÜÂáΩÊï∞ÊåáÈíà‰πãÂêéÔºå‰πüÂ∞±ÊÑèÂë≥ÁùÄÂèñÂæó‰∫ÜÊâßË°åËøôÊÆµÊñπÊ≥ïÁöÑ‰ª£Á†ÅÁöÑÂÖ•Âè£ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂÉèÊôÆÈÄöÁöÑCËØ≠Ë®ÄÂáΩÊï∞Ë∞ÉÁî®‰∏ÄÊ†∑‰ΩøÁî®Ëøô‰∏™ÂáΩÊï∞ÊåáÈíà„ÄÇ void (*performMessage)(id,SEL); //ÂÆö‰πâ‰∏Ä‰∏™IMPÔºàÂáΩÊï∞ÊåáÈíàÔºâ performMessage = (void (*)(id,SEL))// ÈÄöËøámethodForSelectorÊñπÊ≥ïÊ†πÊçÆSELËé∑ÂèñÂØπÂ∫îÁöÑÂáΩÊï∞ÊåáÈíà [self methodForSelector:@selector(message)];//ÈÄöËøáÂèñÂà∞ÁöÑIMPÔºàÂáΩÊï∞ÊåáÈíàÔºâË∑≥ËøáruntimeÊ∂àÊÅØ‰º†ÈÄíÊú∫Âà∂ÔºåÁõ¥Êé•ÊâßË°åmessageÊñπÊ≥ï„ÄÇperformMessage(self,@selector(message)); Áî®IMP ÁöÑÊñπÂºèÔºåÁúÅÂéª‰∫ÜruntimeÊ∂àÊÅØ‰º†ÈÄíËøáÁ®ã‰∏≠ÊâÄÂÅöÁöÑ‰∏ÄÁ≥ªÂàóÂä®‰ΩúÔºåÊØîÁõ¥Êé•ÂêëÂØπË±°ÂèëÈÄÅÊ∂àÊÅØÈ´òÊïà‰∏Ä‰∫õ„ÄÇ 36.Ê∂àÊÅØË∞ÉÁî®ÊµÅÁ®ãÊ∂àÊÅØË°®ËææÂºè[receiver message]Âú®Ë¢´ËΩ¨Êç¢Êàêobjc_msgSend(receiver, SEL)ÂêéÔºåÂú®ËøêË°åÊó∂Ôºåruntime system‰ºöÂÅö‰ª•‰∏ã‰∫ãÊÉÖÔºö 1„ÄÅÊ£ÄÊü•ÂøΩÁï•ÁöÑselectorÔºàÊØîÂ¶ÇÂ∞Ü‰ºöÂøΩÁï•retainÂíåreleaseÊ∂àÊÅØÔºâ„ÄÇ 2„ÄÅÊ£ÄÊü•receiverÊòØÂê¶‰∏∫nil„ÄÇÔºàÂ¶ÇÊûúreceiver‰∏∫Á©∫ÔºåÂàô‰ºöÂ∞Ü selector‰πüËÆæÁΩÆ‰∏∫Á©∫ÔºåÂπ∂‰∏îÁõ¥Êé•ËøîÂõûÂà∞Ê∂àÊÅØË∞ÉÁî®ÁöÑÂú∞Êñπ„ÄÇÔºâÂ¶ÇÊûúÂØπË±°ÈùûÁ©∫ÔºåÂ∞±ÁªßÁª≠‰∏ã‰∏ÄÊ≠•„ÄÇ 3„ÄÅÊ†πÊçÆSELÂà∞ÂΩìÂâçÁ±ª‰∏≠Êü•ÊâæÂØπÂ∫îÁöÑIMPÔºåÈ¶ñÂÖà‰ºöÂú®cache‰∏≠Ê£ÄÁ¥¢ÂÆÉÔºåÂ¶ÇÊûúÊâæÂà∞‰∫ÜÂ∞±Ê†πÊçÆÂáΩÊï∞ÊåáÈíàË∑≥ËΩ¨Âà∞Ëøô‰∏™ÂáΩÊï∞ÊâßË°åÔºåÂê¶ÂàôËøõË°å‰∏ã‰∏ÄÊ≠•„ÄÇ 4„ÄÅÊ£ÄÁ¥¢ÂΩìÂâçÁ±ªÂØπË±°‰∏≠ÁöÑÊñπÊ≥ïË°®Ôºàmethod listÔºâÔºåÂ¶ÇÊûúÊâæÂà∞‰∫ÜÔºåÂä†ÂÖ•cache‰∏≠ÔºåÂπ∂‰∏îÂ∞±Ë∑≥ËΩ¨Âà∞Ëøô‰∏™ÂáΩÊï∞ÊâßË°åÔºåÂê¶ÂàôËøõË°å‰∏ã‰∏ÄÊ≠•„ÄÇ 5„ÄÅ‰ªéÁà∂Á±ª‰∏≠ÂØªÊâæÔºåÁõ¥Âà∞Ê†πÁ±ªÔºöNSObjectÁ±ª„ÄÇÊâæÂà∞‰∫ÜÂ∞±Â∞ÜÊñπÊ≥ïÂä†ÂÖ•ÂØπÂ∫îÁ±ªÁöÑcacheË°®‰∏≠ÔºåÂ¶ÇÊûú‰ªçÊú™ÊâæÂà∞ÔºåÂàôË¶ÅËøõÂÖ•Âä®ÊÄÅÊñπÊ≥ïÂÜ≥ËÆÆ„ÄÇ 6„ÄÅÂ¶ÇÊûúÂä®ÊÄÅÊñπÊ≥ïÂÜ≥ËÆÆ‰ªç‰∏çËÉΩËß£ÂÜ≥ÈóÆÈ¢òÔºåÂè™ËÉΩËøõË°åÊúÄÂêé‰∏ÄÊ¨°Â∞ùËØïÔºåËøõÂÖ•Ê∂àÊÅØËΩ¨ÂèëÊµÅÁ®ã„ÄÇ Ê≥®ÊÑèÔºöcacheÁöÑÂéüÂàôÂ∞±ÊòØÁºìÂ≠òÈÇ£‰∫õÂèØËÉΩË¶ÅÊâßË°åÁöÑÂáΩÊï∞Âú∞ÂùÄÔºå‰∏ãÊ¨°Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÈÄüÂ∫¶Â∞±ÂèØ‰ª•Âø´ÈÄüÂæàÂ§ö„ÄÇ Á±ªÊñπÊ≥ïÂíåÂÆû‰æãÊñπÊ≥ï‰∏≠ÔºåÈÉΩÂèØ‰ª•ËÆøÈóÆselfÂíå_cmdËøô‰∏§‰∏™Â±ûÊÄßÔºåÂõ†‰∏∫ÂÆÉ‰ª¨ÈÉΩ‰∏çÂ±û‰∫éÁ±ªÁöÑÂÆû‰æãÂèòÈáèÔºåËÄåÊòØÂΩ¢ÂèÇ„ÄÇobjc_msgSendÊâæÂà∞ÊñπÊ≥ïÂØπÂ∫îÁöÑÂÆûÁé∞Êó∂ÔºåÂ∞ÜÁõ¥Êé•Ë∞ÉÁî®ËØ•ÊñπÊ≥ïÂÆûÁé∞ÔºåÂπ∂Â∞ÜÊ∂àÊÅØ‰∏≠ÊâÄÊúâÁöÑÂèÇÊï∞ÈÉΩ‰º†ÈÄíÁªôÊñπÊ≥ïÂÆûÁé∞ÔºåÂêåÊó∂ÔºåÂÆÉËøòÂ∞Ü‰º†ÈÄí‰∏§‰∏™ÈöêËóèÁöÑÂèÇÊï∞:Êé•Êî∂Ê∂àÊÅØÁöÑÂØπË±°Ôºà‰πüÂ∞±ÊòØselfÊåáÂêëÁöÑÂÜÖÂÆπÔºâÔºåÊñπÊ≥ïÈÄâÊ†áÔºà_cmdÊåáÂêëÁöÑÂÜÖÂÆπÔºâ ÈöêËóèÔºöÂõ†‰∏∫ÂÆÉ‰ª¨Âπ∂Ê≤°ÊúâÂú®ÂÆö‰πâÊñπÊ≥ïÁöÑÊ∫ê‰ª£Á†Å‰∏≠Â£∞ÊòéÔºåËÄåÊòØÂú®‰ª£Á†ÅÁºñËØëÊó∂ÊòØÊèíÂÖ•ÊñπÊ≥ïÁöÑÂÆûÁé∞‰∏≠ÁöÑ„ÄÇÂú®ÊñπÊ≥ï‰∏≠ÂèØ‰ª•ÈÄöËøá self Êù•ÂºïÁî®Ê∂àÊÅØÊé•Êî∂ËÄÖÂØπË±°ÔºåÈÄöËøáÈÄâÊ†á_cmdÊù•ÂºïÁî®ÊñπÊ≥ïÊú¨Ë∫´„ÄÇ- (void)message &#123; self.name = @"James";//ÈÄöËøáselfÂÖ≥ÈîÆÂ≠óÁªôÂΩìÂâçÂØπË±°ÁöÑÂ±ûÊÄßËµãÂÄº SEL currentSel = _cmd;//ÈÄöËøá_cmdÂÖ≥ÈîÆÂ≠óÂèñÂà∞ÂΩìÂâçÂáΩÊï∞ÂØπÂ∫îÁöÑSEL NSLog(@"currentSel is :%s",(char *)currentSel); &#125; ÂΩìË¢´Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÂÆûÁé∞ÈÉ®ÂàÜÊ≤°ÊúâÊâæÂà∞ÔºåËÄåÊ∂àÊÅØËΩ¨ÂèëÊú∫Âà∂ÂêØÂä®‰πãÂâçÁöÑËøô‰∏™‰∏≠Èó¥Êó∂Âàª(Âä®ÊÄÅÊ∑ªÂä†ÊñπÊ≥ï)„ÄÇ+(BOOL) resolveInstanceMethod:(SEL) selÂ∞ÜË¢´Ë∞ÉÁî®„ÄÇËøôÊòØNSObjectÊ†πÁ±ªÊèê‰æõÁöÑÁ±ªÊñπÊ≥ï„ÄÇ void dynamicMethodIMP(id self, SEL _cmd) &#123; // implementation .... &#125; + (BOOL)resolveInstanceMethod:(SEL)sel &#123; NSLog(@"sel is %@", NSStringFromSelector(sel)); if (sel == @selector(setName:)) &#123; class_addMethod([self class],sel,(IMP)dynamicMethodIMP,"v@:"); return YES; &#125; return [super resolveInstanceMethod:sel]; &#125; @dynamicÂÖ≥ÈîÆÂ≠óÁöÑ‰ΩúÁî®:‚ë†ÂëäËØâÁºñËØëÂô®‰∏çË¶ÅÂàõÂª∫ÂÆûÁé∞Â±ûÊÄßÊâÄÁî®ÁöÑÂÆû‰æãÂèòÈáèÔºõ‚ë°ÂëäËØâÁºñËØëÂô®‰∏çË¶ÅÂàõÂª∫ËØ•Â±ûÊÄßÁöÑgetÂíåsetterÊñπÊ≥ï„ÄÇËÆ©ÁºñËØëÂô®Áõ∏‰ø°Â≠òÂèñÊñπÊ≥ï‰ºöÂú®ËøêË°åÊó∂ÊâæÂà∞„ÄÇ// Â£∞ÊòéÊñá‰ª∂‰∏≠@property(nonatomic, copy) NSString *name; // ÂÆûÁé∞Êñá‰ª∂‰∏≠@dynamic name; 37.@synthesizeÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁºñËØëÂô®‰ºö‰∏∫ÂΩìÂâçÁ±ªËá™Âä®ÁîüÊàê‰∏Ä‰∏™NSString *_nameÁöÑÂÆû‰æãÂèòÈáèÔºàÂ¶ÇÊûúÊÉ≥ÊîπÂèòÂÆû‰æãÂèòÈáèÁöÑÂêçÁß∞ÂèØ‰ª•Áî®@synthesizeÂÖ≥ÈîÆÂ≠óÔºâÔºåÂêåÊó∂‰ºöÁîüÊàê‰∏§‰∏™Âêç‰∏∫- (NSString *)nameÂíå- (void)setName:(NSString *)aNameÁöÑÂ≠òÂèñÊñπÊ≥ï„ÄÇ 38.Ê∂àÊÅØËΩ¨ÂèëÂ§ñÈÉ®Ë∞ÉÁî®ÁöÑÊüê‰∏™ÊñπÊ≥ïÂØπË±°Ê≤°ÊúâÂÆûÁé∞ÔºåËÄå‰∏îresolveInstanceMethodÊñπÊ≥ï‰∏≠‰πüÊ≤°ÊúâÂÅöÈáçÂÆöÂêëÂ§ÑÁêÜÊó∂ÔºåÂ∞±‰ºöËß¶Âèë- (void)forwardInvocation:(NSInvocation *)anInvocationÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÈÄöÂ∏∏Áî®Êù•Â∞Ü‰∏çËÉΩÂ§ÑÁêÜÁöÑÊ∂àÊÅØËΩ¨ÂèëÁªôÂÖ∂ÂÆÉÁöÑÂØπË±°„ÄÇ - (void)forwardInvocation:(NSInvocation *)invocation &#123; SEL invSEL = invocation.selector; if ([someOtherObject respondsToSelector:invSEL]) [anInvocation invokeWithTarget:someOtherObject]; &#125; else &#123; [self doesNotRecognizeSelector:invSEL]; &#125; &#125; 39.CocoaÂÆÉÊòØ‰∏Ä‰∏™Èù¢ÂêëÂØπË±°ÁöÑËΩØ‰ª∂ÁªÑ‰ª∂‚Äî‚ÄîÁ±ªÁöÑÈõÜÊàêÂ•ó‰ª∂ÔºåÂÆÉ‰ΩøÂºÄÂèëËÄÖÂèØ‰ª•Âø´ÈÄüÂàõÂª∫Âº∫Â£ÆÂíåÂÖ®ÂäüËÉΩÁöÑ Mac OS X ÔºàiOSÔºâÂ∫îÁî®Á®ãÂ∫è„ÄÇCocoaÂåÖÂê´‰∫ÜÂæàÂ§öÊ°ÜÊû∂ÔºåÂÖ∂‰∏≠ÊúÄÊúÄÊ†∏ÂøÉÁöÑÊòØFoundationÊ°ÜÊû∂ÂíåApplication KitÔºàAppKitÔºâÊ°ÜÊû∂ÔºàCocoa Touch‰∏≠Âè´UIKitÊ°ÜÊû∂Ôºâ„ÄÇ 40.RunloopÂÆÉÊòØ‰∏∫‰∫ÜÁ∫øÁ®ãËÄåÁîüÔºåÊòØÁ∫øÁ®ãÁöÑÂü∫Á°ÄÊû∂ÊûÑÈÉ®ÂàÜÔºåÊØè‰∏™Á∫øÁ®ãÔºåÂåÖÊã¨Á®ãÂ∫èÁöÑ‰∏ªÁ∫øÁ®ãÔºàmain threadÔºâÈÉΩÊúâ‰∏é‰πãÁõ∏Â∫îÁöÑrun loopÂØπË±°„ÄÇ‰∏ªÁ∫øÁ®ãÁöÑrun loopÈªòËÆ§ÊòØÂêØÂä®ÁöÑ„ÄÇUIApplicationMain()ÂáΩÊï∞Ôºå‰ºö‰∏∫main threadËÆæÁΩÆ‰∏Ä‰∏™NSRunLoopÂØπË±°„ÄÇNSRunLoopÁ±ªÂπ∂‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºå‰∏çËÉΩÂú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ÂéªÊìç‰ΩúÂè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÁöÑrun loopÂØπË±°ÔºåCFRunLoopRefÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇËé∑ÂèñÂà∞ÂΩìÂâçÁ∫øÁ®ãÁöÑrun loop:[NSRunLoop currentRunLoop];Ëé∑ÂèñÂØπÂ∫îÁöÑCFRunLoopRefÁ±ªÔºö- (CFRunLoopRef)getCFRunLoop; ‰∏Ä‰∏™run loopÂ∞±ÊòØ‰∏Ä‰∏™‰∫ã‰ª∂Â§ÑÁêÜÂæ™ÁéØÔºåÁî®Êù•‰∏çÂÅúÁöÑÁõëÂê¨ÂíåÂ§ÑÁêÜËæìÂÖ•‰∫ã‰ª∂Âπ∂Â∞ÜÂÖ∂ÂàÜÈÖçÂà∞ÂØπÂ∫îÁöÑÁõÆÊ†á‰∏äËøõË°åÂ§ÑÁêÜ„ÄÇÂØπÊ∂àÊÅØÂ§ÑÁêÜËøáÁ®ãËøõË°å‰∫ÜÊõ¥Â•ΩÁöÑÊäΩË±°ÂíåÂ∞ÅË£ÖÔºåÂú®NSRunLoop‰∏≠ÊØè‰∏Ä‰∏™Ê∂àÊÅØÂ∞±Ë¢´ÊâìÂåÖÂú®input sourceÊàñËÄÖÊòØtimer source‰∏≠‰∫Ü„ÄÇ‰ΩøÁî®run loopÂèØ‰ª•‰ΩøÁ∫øÁ®ãÂú®ÊúâÂ∑•‰ΩúÁöÑÊó∂ÂÄôÂ∑•‰ΩúÔºåÊ≤°ÊúâÂ∑•‰ΩúÁöÑÊó∂ÂÄô‰ºëÁú†ÔºåËøôÂèØ‰ª•Â§ßÂ§ßËäÇÁúÅÁ≥ªÁªüËµÑÊ∫ê„ÄÇÂàõÂª∫ËæìÂÖ•Ê∫êÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂ∞ÜÂÖ∂ÂàÜÈÖçÁªôrun loop‰∏≠ÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Ê®°Âºè„ÄÇÂÆöÊó∂Ê∫êÂú®È¢ÑËÆæÁöÑÊó∂Èó¥ÁÇπÂêåÊ≠•ÊñπÂºè‰º†ÈÄíÊ∂àÊÅØÔºåËøô‰∫õÊ∂àÊÅØÈÉΩ‰ºöÂèëÁîüÂú®ÁâπÂÆöÊó∂Èó¥ÊàñËÄÖÈáçÂ§çÁöÑÊó∂Èó¥Èó¥Èöî„ÄÇÂÆöÊó∂Ê∫êÂàôÁõ¥Êé•‰º†ÈÄíÊ∂àÊÅØÁªôÂ§ÑÁêÜ‰æãÁ®ãÔºå‰∏ç‰ºöÁ´ãÂç≥ÈÄÄÂá∫run loop„ÄÇ 41.ÂàõÂª∫NSTimer// ÊñπÂºè‰∏Ä:Ëá™Âä®ÊäätimerÂä†ÂÖ•MainRunloopÁöÑNSDefaultRunLoopMode‰∏≠NSTimer *timer = [NSTimer scheduledTimerWithTimeInteral:1.0 target:self selector:@selector(action:) userInfo:ni] repeat:NO]; // ÂÅúÊ≠¢[timer invalidate];// ÊñπÂºè‰∫å(ÈúÄÊâãÂä®Âä†Âà∞run loop‰∏≠)NSTimer *timer = [NSTimer timerWithTimeInterval:5 target:self seletor:@selector(timerAction) userInfo:nil repeats:YES];[[NSRunloop mainRunloop] addTimer:timer forMode:NSDefaultRunloopMode]; Ë∞ÉÁî®ÂàõÂª∫ÊñπÊ≥ïÂêéÔºåtargetÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞‰ºö+1ÔºåÁõ¥Âà∞ÊâßË°åÂÆåÊØïÔºåËá™Âä®-1„ÄÇÂ¶ÇÊûúRunLoopÊ≠£Âú®ÊâßË°å‰∏Ä‰∏™ËøûÁª≠ÁöÑËøêÁÆóÔºåtimerÂ∞±‰ºöË¢´Âª∂ËøüËß¶Âèë„ÄÇ 42.ÂìçÂ∫îËÄÖÂØπË±°ÔºàResponder ObjectÔºâÊåáÁöÑÊòØÊúâÂìçÂ∫îÂíåÂ§ÑÁêÜ‰∫ã‰ª∂ËÉΩÂäõÁöÑÂØπË±°„ÄÇÂìçÂ∫îËÄÖÈìæÂ∞±ÊòØÁî±‰∏ÄÁ≥ªÂàóÁöÑÂìçÂ∫îËÄÖÂØπË±°ÊûÑÊàêÁöÑ‰∏Ä‰∏™Â±ÇÊ¨°ÁªìÊûÑ„ÄÇUIResponderÊòØÊâÄÊúâÂìçÂ∫îÂØπË±°ÁöÑÂü∫Á±ªÔºåÂú®UIResponderÁ±ª‰∏≠ÂÆö‰πâ‰∫ÜÂ§ÑÁêÜ‰∏äËø∞ÂêÑÁßç‰∫ã‰ª∂ÁöÑÊé•Âè£„ÄÇ 43.ÂìçÂ∫îËÄÖÈìæÈÄöÂ∏∏ÊòØÁî±ËßÜÂõæÔºàUIViewÔºâÊûÑÊàêÁöÑ„ÄÇ ‰∏Ä‰∏™ËßÜÂõæÁöÑ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖÊòØÂÆÉËßÜÂõæÊéßÂà∂Âô®ÔºàUIViewControllerÔºâÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâÔºåÁÑ∂ÂêéÂÜçËΩ¨ÁªôÂÆÉÁöÑÁà∂ËßÜÂõæÔºàSuper ViewÔºâ„ÄÇ ËßÜÂõæÊéßÂà∂Âô®ÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâÁöÑ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖ‰∏∫ÂÖ∂ÁÆ°ÁêÜÁöÑËßÜÂõæÁöÑÁà∂ËßÜÂõæ„ÄÇ Âçï‰æãÁöÑÁ™óÂè£ÔºàUIWindowÔºâÁöÑÂÜÖÂÆπËßÜÂõæÂ∞ÜÊåáÂêëÁ™óÂè£Êú¨Ë∫´‰Ωú‰∏∫ÂÆÉÁöÑ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖ„ÄÇ Âçï‰æãÁöÑÂ∫îÁî®ÔºàUIApplicationÔºâÊòØ‰∏Ä‰∏™ÂìçÂ∫îËÄÖÈìæÁöÑÁªàÁÇπÔºåÂÆÉÁöÑ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖÊåáÂêënilÔºå‰ª•ÁªìÊùüÊï¥‰∏™Âæ™ÁéØ„ÄÇ Á¨¨‰∏ÄÂìçÂ∫îËÄÖÔºàFirst responderÔºâÊåáÁöÑÊòØÂΩìÂâçÊé•ÂèóËß¶Êë∏ÁöÑÂìçÂ∫îËÄÖÂØπË±°ÔºàÈÄöÂ∏∏ÊòØ‰∏Ä‰∏™UIViewÂØπË±°ÔºâÔºåÂç≥Ë°®Á§∫ÂΩìÂâçËØ•ÂØπË±°Ê≠£Âú®‰∏éÁî®Êà∑‰∫§‰∫íÔºåÂÆÉÊòØÂìçÂ∫îËÄÖÈìæÁöÑÂºÄÁ´Ø„ÄÇUIWindowÂØπË±°‰ª•Ê∂àÊÅØÁöÑÂΩ¢ÂºèÂ∞Ü‰∫ã‰ª∂ÂèëÈÄÅÁªôÁ¨¨‰∏ÄÂìçÂ∫îËÄÖÔºå‰ΩøÂÖ∂ÊúâÊú∫‰ºöÈ¶ñÂÖàÂ§ÑÁêÜ‰∫ã‰ª∂„ÄÇÂ¶ÇÊûúÁ¨¨‰∏ÄÂìçÂ∫îËÄÖÊ≤°ÊúâËøõË°åÂ§ÑÁêÜÔºåÁ≥ªÁªüÂ∞±Â∞Ü‰∫ã‰ª∂ÔºàÈÄöËøáÊ∂àÊÅØÔºâ‰º†ÈÄíÁªôÂìçÂ∫îËÄÖÈìæ‰∏≠ÁöÑ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖÔºåÁúãÁúãÂÆÉÊòØÂê¶ÂèØ‰ª•ËøõË°åÂ§ÑÁêÜ„ÄÇUIWindowÂÆû‰æãÂØπË±°‰ºöÈ¶ñÂÖàÂú®ÂÆÉÁöÑÂÜÖÂÆπËßÜÂõæ‰∏äË∞ÉÁî®hitTest:withEvent:ÔºåÊ≠§ÊñπÊ≥ï‰ºöÂú®ÂÖ∂ËßÜÂõæÂ±ÇÁ∫ßÁªìÊûÑ‰∏≠ÁöÑÊØè‰∏™ËßÜÂõæ‰∏äË∞ÉÁî®pointInside:withEvent:„ÄÇ 44.ÂìçÂ∫îËÄÖÈìæÊñπÊ≥ïÁöÑÂ§ÑÁêÜÊµÅÁ®ãÈ¶ñÂÖàË∞ÉÁî®ÂΩìÂâçËßÜÂõæÁöÑpointInside:withEvent:ÊñπÊ≥ïÂà§Êñ≠Ëß¶Êë∏ÁÇπÊòØÂê¶Âú®ÂΩìÂâçËßÜÂõæÂÜÖÔºõËã•ËøîÂõûNOÔºåÂàôhitTest:withEvent:ËøîÂõûnil;Ëã•ËøîÂõûYESÔºåÂàôÂêëÂΩìÂâçËßÜÂõæÁöÑÊâÄÊúâÂ≠êËßÜÂõæ(subviews)ÂèëÈÄÅhitTest:withEvent:Ê∂àÊÅØÔºåÊâÄÊúâÂ≠êËßÜÂõæÁöÑÈÅçÂéÜÈ°∫Â∫èÊòØ‰ªéÊúÄÈ°∂Â±ÇËßÜÂõæ‰∏ÄÁõ¥Âà∞Âà∞ÊúÄÂ∫ïÂ±ÇËßÜÂõæÔºåÂç≥‰ªésubviewsÊï∞ÁªÑÁöÑÊú´Â∞æÂêëÂâçÈÅçÂéÜÔºåÁõ¥Âà∞ÊúâÂ≠êËßÜÂõæËøîÂõûÈùûÁ©∫ÂØπË±°ÊàñËÄÖÂÖ®ÈÉ®Â≠êËßÜÂõæÈÅçÂéÜÂÆåÊØïÔºõËã•Á¨¨‰∏ÄÊ¨°ÊúâÂ≠êËßÜÂõæËøîÂõûÈùûÁ©∫ÂØπË±°ÔºåÂàôhitTest:withEvent:ÊñπÊ≥ïËøîÂõûÊ≠§ÂØπË±°ÔºåÂ§ÑÁêÜÁªìÊùüÔºõÂ¶ÇÊâÄÊúâÂ≠êËßÜÂõæÈÉΩËøîÂõûÁ©∫ÂØπË±°ÔºåÂàôhitTest:withEvent:ÊñπÊ≥ïËøîÂõûËá™Ë∫´(self)„ÄÇ 45.Á±ªÂà´‰∏éÁ±ªÊâ©Â±ïÁöÑÂå∫Âà´Ôºö‚ë†Á±ªÂà´‰∏≠Âè™ËÉΩÂ¢ûÂä†ÊñπÊ≥ï„ÄÇ‚ë°Á±ªÊâ©Â±ï‰∏ç‰ªÖÂèØ‰ª•Â¢ûÂä†ÊñπÊ≥ïÔºåËøòÂèØ‰ª•Â¢ûÂä†ÂÆû‰æãÂèòÈáèÔºàÊàñËÄÖÂêàÊàêÂ±ûÊÄßÔºâÔºåÂè™ÊòØËØ•ÂÆû‰æãÂèòÈáèÈªòËÆ§ÊòØ@privateÁ±ªÂûãÁöÑ„ÄÇ‚ë¢Á±ªÊâ©Â±ï‰∏≠Â£∞ÊòéÁöÑÊñπÊ≥ïÊ≤°Ë¢´ÂÆûÁé∞ÔºåÁºñËØëÂô®‰ºöË≠¶ÂëäÔºå‰ΩÜÊòØÁ±ªÂà´‰∏≠ÁöÑÊñπÊ≥ïÊ≤°Ë¢´ÂÆûÁé∞ÁºñËØëÂô®ÊòØ‰∏ç‰ºöÊúâ‰ªª‰ΩïË≠¶ÂëäÁöÑ„ÄÇËøôÊòØÂõ†‰∏∫Á±ªÊâ©Â±ïÊòØÂú®ÁºñËØëÈò∂ÊÆµË¢´Ê∑ªÂä†Âà∞Á±ª‰∏≠ÔºåËÄåÁ±ªÂà´ÊòØÂú®ËøêË°åÊó∂Ê∑ªÂä†Âà∞Á±ª‰∏≠„ÄÇ‚ë£Á±ªÊâ©Â±ïÊâÄÂ£∞ÊòéÁöÑÊñπÊ≥ïÂøÖÈ°ª‰æùÊâòÂØπÂ∫îÁ±ªÁöÑÂÆûÁé∞ÈÉ®ÂàÜÊù•ÂÆûÁé∞„ÄÇ‚ë§ÂÆö‰πâÂú® .m Êñá‰ª∂‰∏≠ÁöÑÁ±ªÊâ©Â±ïÊñπÊ≥ï‰∏∫ÁßÅÊúâÁöÑÔºåÂÆö‰πâÂú® .h Êñá‰ª∂ÔºàÂ§¥Êñá‰ª∂Ôºâ‰∏≠ÁöÑÁ±ªÊâ©Â±ïÊñπÊ≥ï‰∏∫ÂÖ¨ÊúâÁöÑ„ÄÇ 46.KVCÂÖ®Áß∞ÊòØKey-value codingÔºåÁøªËØëÊàêÈîÆÂÄºÁºñÁ†Å„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßç‰ΩøÁî®Â≠óÁ¨¶‰∏≤ËÄå‰∏çÊòØËÆøÈóÆÂô®ÊñπÊ≥ïÂéªËÆøÈóÆ‰∏Ä‰∏™ÂØπË±°ÂÆû‰æãÂèòÈáèÁöÑÊú∫Âà∂„ÄÇKVOÂÖ®Áß∞ÊòØKey-value observingÔºåÁøªËØëÊàêÈîÆÂÄºËßÇÂØü„ÄÇÊèê‰æõ‰∫Ü‰∏ÄÁßçÂΩìÂÖ∂ÂÆÉÂØπË±°Â±ûÊÄßË¢´‰øÆÊîπÁöÑÊó∂ÂÄôËÉΩÈÄöÁü•ÂΩìÂâçÂØπË±°ÁöÑÊú∫Âà∂„ÄÇKVOÊú∫Âà∂ÂæàÈÄÇÂêàÂÆûÁé∞modelÂíåcontrollerÁ±ª‰πãÈó¥ÁöÑÈÄöËÆØ„ÄÇKVCÊòØ‰∏ç‰ºöËá™Âä®Ë∞ÉÁî®ÈîÆÂÄºÈ™åËØÅÊñπÊ≥ïÁöÑÔºåÊàë‰ª¨ÈúÄË¶ÅÊâãÂä®È™åËØÅÔºö- (BOOL)validateValue:(inout id *)ioValue forKey:(NSString *)inKey error:(out NSError **)outError;KVCÂèØ‰ª•Ëá™Âä®ÁöÑÂ∞ÜÊï∞ÂÄºÊàñÁªìÊûÑ‰ΩìÂûãÁöÑÊï∞ÊçÆÊâìÂåÖÊàñËß£ÂåÖÊàêNSNumberÊàñNSValueÂØπË±°Ôºå‰ª•ËææÂà∞ÈÄÇÈÖçÁöÑÁõÆÁöÑ„ÄÇ 47.ÂÜÖÂ≠òÁÆ°ÁêÜËßÑÂàôARCÁöÑËã±ÊñáÂÖ®ÂêçÊòØÔºöAutomatic Reference CountingÔºåÊòØÁºñËØëÂô®Êèê‰æõÁöÑÁÆ°ÁêÜObjective-CÂØπË±°ÂÜÖÂ≠òÁöÑ‰∏Ä‰∏™Êú∫Âà∂„ÄÇÂÆÉÂπ∂‰∏çÊòØÂÉèÂûÉÂúæÂõûÊî∂Êú∫Âà∂ÈÇ£Ê†∑ÔºåÊúâ‰∏Ä‰∏™Ë¥üË¥£ÂÜÖÂ≠òÂõûÊî∂ÁöÑÁ≥ªÁªüÔºåËÄåÊòØ‰ªçÁÑ∂‰ª•ÂºïÁî®ËÆ°Êï∞‰∏∫Âü∫Á°ÄÔºöÂú®ÁºñËØëÈò∂ÊÆµÔºåÁºñËØëÂô®‰ºöÂú®ÈúÄË¶ÅretainÊàñreleaseÂØπË±°ÁöÑÂú∞ÊñπËá™Âä®‰∏∫Êàë‰ª¨Âä†‰∏äÂØπÂ∫îÁöÑ‰ª£Á†Å„ÄÇ‰∏Ä‰∏™ÂØπË±°Â≠òÂú®strongÁ±ªÂûãÁöÑÊåáÈíàÊåáÂêëÊó∂ÔºåËØ•ÂØπË±°Â∞±‰∏ç‰ºöË¢´ÈáäÊîæ„ÄÇ ÈááÁî®Êï£ÂàóË°®Êù•ÁÆ°ÁêÜÂºïÁî®ËÆ°Êï∞ÔºåÁªü‰∏ÄÂ≠òÂÇ®ÊâÄÊúâÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞Ôºå‰∏çÁî®ËÄÉËôëÊØè‰∏™ÂØπË±°ÂÜÖÂ≠òÂùó‰∏≠ÂºïÁî®ËÆ°Êï∞ÊâÄÂç†ÁöÑÂÜÖÂ≠òÔºåÂú®ÂºïÁî®ËÆ°Êï∞Ë°®‰∏≠Â≠òÂÇ®ÂêÑ‰∏™ÂØπË±°ÁöÑÂÜÖÂ≠òÂú∞ÂùÄ„ÄÇ ‚ë†strongËØ•Â±ûÊÄßÂÄºÂØπÂ∫î __strongÂÖ≥ÈîÆÂ≠óÔºåÂç≥ËØ•Â±ûÊÄßÊâÄÂ£∞ÊòéÁöÑÊåáÈíàÂèòÈáèÂ∞ÜÊàê‰∏∫ÂØπË±°ÁöÑÊåÅÊúâËÄÖ„ÄÇstrongÊòØÊåáÂêëÂØπË±°ÊåáÈíàÁöÑÈªòËÆ§Â±ûÊÄß„ÄÇ‚ë°weakËØ•Â±ûÊÄßÂØπÂ∫î__weakÂÖ≥ÈîÆÂ≠óÔºå‰∏é__weakÂÆö‰πâÁöÑÂèòÈáè‰∏ÄËá¥ÔºåËØ•Â±ûÊÄßÊâÄÂ£∞ÊòéÁöÑÂèòÈáèÂ∞ÜÊ≤°ÊúâÂØπË±°ÁöÑÊâÄÊúâÊùÉÔºåÂπ∂‰∏îÂΩìÂØπË±°Ë¢´Á†¥ÂºÉ‰πãÂêéÔºåÊåáÈíàÂ∞ÜË¢´Ëá™Âä®ËµãÂÄºnil„ÄÇ‚ë£copy‰πüÊòØÂØπË±°ÁöÑÊâÄÊúâËÄÖÔºå‰∏éstrongÁöÑÂå∫Âà´ÊòØÂ£∞ÊòéÁöÑÊåáÈíàÂèòÈáèÊòØÊã∑Ë¥ùÂØπË±°ÁöÑÊåÅÊúâËÄÖ„ÄÇ‚ë§assign‰∏ÄËà¨Êï∞ÂÄºÂûãÂèòÈáèÁî®ËØ•Â±ûÊÄßÂ£∞ÊòéÔºåÊØîÂ¶ÇÔºåint„ÄÅBOOLÔºå‰ΩÜÊó†ÈúÄÊòæÁ§∫ÂÜôÂá∫ÔºåÂõ†‰∏∫Êï∞ÂÄºÂûãÂèòÈáèÁöÑÈªòËÆ§Â±ûÊÄßÁ±ªÂûãÂ∞±ÊòØassign„ÄÇ ‰ΩøÁî®ÂÖ≥ÈîÆÂ≠óÂ£∞ÊòéÊåáÈíàÁ±ªÂûãËßÑËåÉÂÜôÊ≥ï://ËßÑËåÉÁöÑÂÜôÊ≥ïMyClass * __weak myWeakReference; 48.weakÂíåassignÁöÑÂºÇÂêåÁõ∏ÂêåÁÇπÔºöÊåáÂêëÁöÑÂØπË±°ÈÉΩÊòØÈöèÊó∂ÊúâÂèØËÉΩË¢´ÈáäÊîæÔºåÂç≥‰∏çÊã•ÊúâÊåáÂêëÁöÑÂØπË±°„ÄÇ‰∏çÂêåÁÇπÔºö‚ë†weakÂè™ËÉΩÁî®Êù•‰øÆÈ•∞ÂØπË±°ÔºåassignÊó¢ÂèØ‰ª•Áî®Êù•Â£∞ÊòéÂØπË±°Ôºå‰πüÂèØ‰ª•Áî®Êù•Â£∞ÊòéÊï∞ÂÄºÂûãÂèòÈáèÔºõ‚ë°ÂæàÂÖ≥ÈîÆÁöÑ‰∏ÄÁÇπÂå∫Âà´ÔºåÂΩì‰∏Ä‰∏™weakÂÖ≥ÈîÆÂ≠óÂ£∞ÊòéÁöÑÊåáÈíàÊåáÂêëÁöÑÂØπË±°Ë¢´ÈáäÊîæÊéâÂæóÊó∂ÂÄôÔºåËØ•ÊåáÈíà‰ºöËá™Âä®ÁöÑË¢´ÊåáÂêënilÔºåËÄåassign‰∏çÂ≠òÂú®ËØ•ÁâπÊÄß„ÄÇ ‰ΩøÁî®@propertyÂ£∞ÊòéÊàñ‰Ωú‰∏∫ÊôÆÈÄöÂÆû‰æãÂèòÈáèÂ£∞ÊòéÁöÑÊåáÂêëÂØπË±°ÁöÑÊåáÈíàÂ±ûÊÄßÈªòËÆ§ÈÉΩÊòØstrongÔºõËÄå‰ΩøÁî®@propertyÂ£∞ÊòéÁöÑÊï∞ÂÄºÂûãÂèòÈáèÂ±ûÊÄßÈªòËÆ§ÁöÑÊòØassign„ÄÇ Â±ûÊÄß ÂÖ≥ÈîÆÂ≠ó ÊâÄÊúâÊùÉ strong __strong Êúâ copy __strong Êúâ retain __strong Êúâ weak __weak Êó† assign __unsafe_unretained Êó† unsafe_unretained __unsafe_unretained Êó† 49.‰ΩøÁî®ARCÈúÄË¶ÅÈÅµÂÆàÁöÑÊñ∞ËßÑÂàô‚ë†‰∏çË¶ÅÂú®deallocÊñπÊ≥ï‰∏≠Ë∞ÉÁî®[super dealloc];„ÄÇ‚ë°‰∏çËÉΩ‰ΩøÁî® retain/release/retainCount/autorelease‚ë¢‰∏çËÉΩ‰ΩøÁî® NSAllocateObject/NSDeallocateObject‚ë£‰∏çËÉΩ‰ΩøÁî® NSZone‚ë§ÂØπË±°‰∏çËÉΩ‰Ωú‰∏∫CËØ≠Ë®ÄÁªìÊûÑ‰ΩìÔºàstruct/unionÔºâÁöÑÊàêÂëò 50.instancetypeË°®Á§∫Êüê‰∏™ÊñπÊ≥ïËøîÂõûÁöÑÊüêÁßçÁ±ªÂûãÁöÑÂØπË±°ÔºåinstancetypeÁöÑ‰ΩúÁî®ÔºåÂ∞±ÊòØ‰ΩøÈÇ£‰∫õÈùûÂÖ≥ËÅîËøîÂõûÁ±ªÂûãÁöÑÊñπÊ≥ïËøîÂõûÊâÄÂú®Á±ªÁöÑÁ±ªÂûãÔºåËÉΩÂ§üÁ°ÆÂÆöÂØπË±°ÁöÑÁ±ªÂûã„ÄÇÊúâÂà©‰∫éÂºÄÂèëËÄÖÂú®ÁºñËØëÈò∂ÊÆµÂèëÁé∞ÈîôËØØ„ÄÇÂÖ≥ËÅîËøîÂõûÁ±ªÂûãÔºàrelated result typesÔºâ1„ÄÅÁ±ªÊñπÊ≥ï‰∏≠Ôºå‰ª•allocÊàñnewÂºÄÂ§¥Ôºõ2„ÄÅÂÆû‰æãÊñπÊ≥ï‰∏≠Ôºå‰ª•autoreleaseÔºåinitÔºåretainÊàñselfÂºÄÂ§¥Ôºõ instancetypeÂíåidÁöÑÂºÇÂêå:1„ÄÅÁõ∏ÂêåÁÇπ:ÈÉΩÂèØ‰ª•‰Ωú‰∏∫ÊñπÊ≥ïÁöÑËøîÂõûÁ±ªÂûã2„ÄÅ‰∏çÂêåÁÇπ‚ë†instancetypeÂèØ‰ª•ËøîÂõûÂíåÊñπÊ≥ïÊâÄÂú®Á±ªÁõ∏ÂêåÁ±ªÂûãÁöÑÂØπË±°ÔºåidÂè™ËÉΩËøîÂõûÊú™Áü•Á±ªÂûãÁöÑÂØπË±°Ôºõ‚ë°instancetypeÂè™ËÉΩ‰Ωú‰∏∫ËøîÂõûÂÄºÔºå‰∏çËÉΩÂÉèidÈÇ£Ê†∑‰Ωú‰∏∫ÂèÇÊï∞Ôºõ 51.Ê≤ôÁõíÁõÆÂΩïÔºö1„ÄÅMyApp.appÂ≠òÊîæÂ∫îÁî®Á®ãÂ∫èÊú¨Ë∫´ÁöÑÊï∞ÊçÆÔºåÊï¥‰∏™ÁõÆÂΩïÊòØÂè™ËØªÁöÑÔºå‰∏çËÉΩË¢´iTunesÂêåÊ≠•„ÄÇ2„ÄÅDocumentsÂ≠òÊîæ‰∏çÂèØÂÜçÁîüÁöÑÁöÑÊï∞ÊçÆÊñá‰ª∂Ôºå‰ºöË¢´iTunesÂêåÊ≠•„ÄÇ3„ÄÅLibraryÂ≠òÊîæÈªòËÆ§ËÆæÁΩÆÊàñÂÖ∂ÂÆÉÁä∂ÊÄÅ‰ø°ÊÅØ„ÄÇÈô§‰∫ÜCachesÂ≠êÁõÆÂΩïÂ§ñÔºå‰ºöË¢´iTunesÂêåÊ≠•„ÄÇ4„ÄÅLibrary/CachesÂ≠òÊîæÁºìÂ≠òÊñá‰ª∂Ôºå‰øùÂ≠òÈÇ£‰∫õÂèØÂÜçÁîüÁöÑÊñá‰ª∂Ôºå‰∏ç‰ºöË¢´iTunesÂêåÊ≠•„ÄÇ5„ÄÅLibrary/PreferencesÂ≠òÊîæÂ∫îÁî®Á®ãÂ∫èÁöÑÂÅèÂ•ΩËÆæÁΩÆÊñá‰ª∂„ÄÇÊàë‰ª¨‰ΩøÁî®NSUserDefaultsÂÜôÁöÑËÆæÁΩÆÊï∞ÊçÆÈÉΩ‰ºö‰øùÂ≠òÂà∞ËØ•ÁõÆÂΩï‰∏ãÁöÑ‰∏Ä‰∏™plistÊñá‰ª∂‰∏≠Ôºå‰ºöË¢´iTunesÂêåÊ≠•„ÄÇ6„ÄÅtmpÂ≠òÊîæÂêÑÁßç‰∏¥Êó∂Êñá‰ª∂Ôºå‰∏ç‰ºöË¢´iTunesÂêåÊ≠•„ÄÇ 52.Á©∫NULLÊú¨Ë¥®‰∏äÊòØÔºö(void*)0ÔºåË°®Á§∫CÊåáÈíà‰∏∫Á©∫ÔºåÂ¶Çcharchar *string = NULL;„ÄÇnilÊú¨Ë¥®‰∏äÊòØÔºö(void *)0ÔºåË°®Á§∫ÊåáÂêëÂØπË±°ÁöÑÊåáÈíà‰∏∫Á©∫„ÄÇNilÊú¨Ë¥®‰∏ä‰πüÊòØÔºö(void *)0,Ë°®Á§∫ClassÁ±ªÂûãÁöÑÂèòÈáèÂÄº‰∏∫Á©∫ÔºåClass anyClass = Nil;„ÄÇ 53.NSNullÊòØ‰∏Ä‰∏™Objective-CÁ±ªÔºåËØ•Á±ªÈÄöÂ∏∏Áî®‰∫éÂú®ÈõÜÂêàÂØπË±°‰∏≠‰øùÂ≠ò‰∏Ä‰∏™Á©∫ÁöÑÂç†‰ΩçÂØπË±°„ÄÇ // ÈÅáÂà∞nilÊà™Êñ≠NSArray *arr = [NSArray arrayWithObjects:@"wang",@"zz",nil,@"foogry"]; // Â≠òÂÇ®Á©∫ÁöÑÂç†‰ΩçÂØπË±°NSArray *arr = [NSArray arrayWithObjects:@"wang",@"zz",[NSNull null], @"foogry"]; 54.imageNamedimageNamedÁöÑ‰ºòÁÇπÂú®‰∫éÂèØ‰ª•ÁºìÂ≠òÂ∑≤ÁªèÂä†ËΩΩÁöÑÂõæÁâá„ÄÇËøôÁßçÊñπÊ≥ï‰ºöÈ¶ñÂÖàÂú®Á≥ªÁªüÁºìÂ≠ò‰∏≠Ê†πÊçÆÊåáÂÆöÁöÑÂêçÂ≠óÂØªÊâæÂõæÁâáÔºåÂ¶ÇÊûúÊâæÂà∞‰∫ÜÂ∞±ËøîÂõû„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂú®ÁºìÂ≠ò‰∏≠ÊâæÂà∞ÂõæÁâáÔºåËØ•ÊñπÊ≥ï‰ºö‰ªéÊåáÂÆöÁöÑÊñá‰ª∂‰∏≠Âä†ËΩΩÂõæÁâáÊï∞ÊçÆÔºåÂπ∂Â∞ÜÂÖ∂ÁºìÂ≠òËµ∑Êù•ÔºåÁÑ∂ÂêéÂÜçÊääÁªìÊûúËøîÂõû„ÄÇimageWithContentsOfFileÊñπÊ≥ïÂè™ÊòØÁÆÄÂçïÁöÑÂä†ËΩΩÂõæÁâáÔºåÂπ∂‰∏ç‰ºöÂ∞ÜÂõæÁâáÁºìÂ≠òËµ∑Êù•ÔºåÂõæÂÉè‰ºöË¢´Á≥ªÁªü‰ª•Êï∞ÊçÆÊñπÂºèÂä†ËΩΩÂà∞Á®ãÂ∫è„ÄÇÂΩì‰∏çÈúÄË¶ÅÈáçÁî®ËØ•ÂõæÂÉèÔºåÊàñËÄÖÈúÄË¶ÅÂ∞ÜÂõæÂÉè‰ª•Êï∞ÊçÆÊñπÂºèÂ≠òÂÇ®Âà∞Êï∞ÊçÆÂ∫ìÔºåÂèàÊàñËÄÖË¶ÅÈÄöËøáÁΩëÁªú‰∏ãËΩΩ‰∏Ä‰∏™ÂæàÂ§ßÁöÑÂõæÂÉèÊó∂ÔºåÂèØ‰ª•‰ΩøÁî®ËøôÁßçÊñπÂºè„ÄÇ ËØªÂÆå‰ªñ‰ª¨ÁöÑÂçöÂÆ¢Ôºå‰ªø‰ΩõÁúãÂà∞Êú™Êù•ÁöÑËá™Â∑±‚Ä¶‚Ä¶ ÂêëÂâçËæàËá¥Ë∞¢ÔºöÁéã‰∏≠Âë®ÁöÑ‰∏™‰∫∫ÂçöÂÆ¢M‰∫Ü‰∏™JÂèÇËÄÉÔºöCËØ≠Ë®Ä‰∏≠ÊñáÁΩë]]></content>
      <tags>
        <tag>CËØ≠Ë®Ä</tag>
        <tag>iOSÂºÄÂèë</tag>
        <tag>Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CËØ≠Ë®Ä‰∫§Êç¢‰∏§‰∏™Êï∞ÂÄºÁöÑÂÖ´ÁßçÊñπÊ≥ï]]></title>
    <url>%2F2016%2F10%2F23%2FC%E8%AF%AD%E8%A8%80%E4%BA%A4%E6%8D%A2%E4%B8%A4%E4%B8%AA%E6%95%B0%E5%80%BC%E7%9A%84%E5%85%AB%E7%A7%8D%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÁÆÄÂçïÊÄªÁªìÔºå‰ª•Èû≠Á¨ûÂ≤ÅÊúà„ÄÇ ÁºñËØëÂô®:XCode8.0 ÂºÇÊàñint main(int argcÔºå const char * argv[]) &#123; int m = 5Ôºå n = 3; m = m ^ n; n = m ^ n; m = m ^ n; printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; ÂºÇÊàñ‰∏ÄËà¨ÊòØÈíàÂØπ‰∫åËøõÂà∂Êï∞. ‰∏§Êï∞ÂºÇÊàñÔºåÁõ∏ÂêåÂàôÂæó0Ôºå‰∏çÂêåÂàôÂæó1„ÄÇ x ^ x = 0Ôºåx ^ 0 = xÁ¨¨‰∫åË°å: m:0101 n:0011Á¨¨‰∏âË°å: m:0110 n:0011Á¨¨ÂõõË°å: n:0101 m:0110Á¨¨‰∫îË°å: m:0011 n:0101Ê≠§Êó∂ÔºåÂ∑≤ÂÆåÊàê‰∫§Êç¢. ËøêÁÆóÁ¨¶int main(int argcÔºå const char * argv[]) &#123; int m = 2147483648Ôºå n = 2147483647; m = m + n - (n = m); printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; ‰ªéÂ∑¶ÂêëÂè≥‰æùÊ¨°ËøõË°åÔºåÈ¶ñÂÖàËé∑Âèñm‰∏énÁöÑÂíåÔºåÊé•ÁùÄÂà©Áî®()ËøêÁÆóÁ¨¶Áõ¥Êé•Â∞ÜmÁöÑÂÄºËµã‰∫ànÔºåÊ≠§Êó∂nÂÆåÊàê‰∫§Êç¢„ÄÇ ÂêåÊó∂()ÂÜÖÁöÑÂÄºÊòØmÁöÑÂÄºÔºå‰∏§Êï∞‰πãÂíåÂáèÂéªmÂÄº‰æøÊòØnÁöÑÂÄºÔºåÂÜçÂ∞ÜnÁöÑÂÄºËµã‰∫àmÔºåÂà∞ËøôÈáåmÂÆåÊàê‰∫§Êç¢„ÄÇ ‰ΩçËøêÁÆóint main(int argcÔºå const char * argv[]) &#123; int m = 5Ôºå n = 3; n = (long)((long)m &lt;&lt; 32 | (m = n)) &gt;&gt; 32; printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; Ê≥®:__int64Ë°®Á§∫64‰ΩçÊï¥ÂûãÂèòÈáèÔºåXcode‰∏≠Áî®long‰ª£ÊõøÔºåVC6.0ÂèØÁõ¥Êé•‰ΩøÁî®__int64ÔºåÂç≥: b = (__int64)((__int64)a &lt;&lt; 32 | (a = b)) &gt;&gt; 32Ôºõ (m = n):ÂÆåÊàêmÁöÑ‰∫§Êç¢Ôºå()ÂÜÖÁöÑÂÄºÊòØn„ÄÇ (long)((long)m &lt;&lt; 32 | n):ÂæóÂà∞ÁöÑÁªìÊûúÊòØ 00...0 0101 00...0 11Á¨¨‰∏ÄÈÉ®ÂàÜ28‰∏™0ÔºåÁ¨¨‰∏âÈÉ®ÂàÜ30‰∏™0 „ÄÇ ((long)((long)m &lt;&lt; 32 ) &gt;&gt; 32:ÂæóÂà∞ÁöÑÁªìÊûú:ÊääÁ¨¨‰∏âÁ¨¨ÂõõÈÉ®ÂàÜÂéªÊéâÔºåÂç≥00...0 0101 Ê≠£Â•Ω32‰ΩçÔºå‰∏îÊ≠§ÂÄº‰∏∫mÁöÑÂÄºÔºåÂÜçÂ∞ÜÂÖ∂Ëµã‰∫ànÔºåÂÆåÊàênÁöÑ‰∫§Êç¢„ÄÇ ÂÆèÂÆö‰πâ#define swap(xÔºå yÔºå z) ((z) = (x)Ôºå (x) = (y)Ôºå (y) = (z)) int main(int argcÔºå const char * argv[]) &#123; int m = 5Ôºå n = 3Ôºåt = 0; swap(mÔºå nÔºå t); printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; ÊØîËæÉÂ∑ßÂ¶ôÔºåÊää‰∏≠Èó¥ÂèòÈáèÊîæÂú®ÂÆè‰∏≠„ÄÇ ‰∏§Êï∞‰πãÂíåint main(int argcÔºå char *argv[]) &#123; int m = 5Ôºå n = 3; m = m + n; n = m - n; m = m - n; printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; ÁÆóÊòØ‰∏ÄÁßçÊï∞Â≠¶ÊñπÊ≥ïÂêßÔºå‰ΩÜÂèØËÉΩÊ∫¢Âá∫„ÄÇ ‰∏§Êï∞‰πãÁßØint main(int argcÔºå const char * argv[]) &#123; int m = 5Ôºå n = 3; m = m * n; n = m / n; m = m / n; printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; ‰∏§Êï∞‰πãÂíåÊñπÊ≥ïÁöÑÂèòÂΩ¢Ôºån‰∏çËÉΩ‰∏∫0ÔºåmÊõ¥ÂèØËÉΩÊ∫¢Âá∫„ÄÇ ÂèñÂùÄvoid swap(int *aÔºå int *b) &#123; int temp = 0; temp = *a; *a = *b; *b = temp;&#125; int main(int argcÔºå const char * argv[]) &#123; int m = 2147483648Ôºå n = 2147483647; swap(&amp;mÔºå&amp;n); printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; ÂºïÁî®void swap(int &amp;a, int &amp;b) &#123; int temp = a; a = b; b = temp;&#125;int main(int argcÔºå const char * argv[]) &#123; int m = 2019Ôºå n = 2010; swap(mÔºån); printf("m:%d---n:%d"ÔºåmÔºån); return 0;&#125; Áü•ËØÜintÊúÄÂ§ßÂÄºÔºåÊ†πÊçÆÁºñËØëÂô®Á±ªÂûã‰∏çÂêåËÄåÂèòÂåñ„ÄÇ ÂØπ‰∫é16‰ΩçÁºñËØëÂô®ÔºåintÂç†16‰Ωç(2Â≠óËäÇ)„ÄÇintÁöÑÊúÄÂ§ßÂÄº‰∏∫32767„ÄÇ ÂØπ‰∫é32‰ΩçÂíå64‰ΩçÁºñËØëÂô®ÔºåintÂç†32‰Ωç(4Â≠óËäÇ)„ÄÇintÁöÑÊúÄÂ§ßÂÄº‰∏∫2147483647„ÄÇ ÂèØ‰ª•ÈÄöËøáÊâìÂç∞sizeof(int)Êü•ÁúãÂπ≥Âè∞ÂØπÂ∫îÁöÑintÂç†Áî®Â≠óËäÇÊï∞„ÄÇ‰πò8ÂêéÂç≥‰∏∫‰ΩçÊï∞„ÄÇÊúÄÈ´ò‰Ωç‰∏∫Á¨¶Âè∑‰ΩçÔºåÂ¶Ç‰ΩçÊï∞‰∏∫nÔºåÂàôÊúÄÂ§ßÂÄº‰∏∫2^(n-1) Âç≥2ÁöÑn-1Ê¨°ÂπÇ„ÄÇ printf("%lu"Ôºåsizeof(int));int a = 2147483648; ÂÅö‰∫Ü‰∏ÄÊ¨°Ê†áÈ¢òÂÖö„ÄÇ„ÄÇ„ÄÇ ÂèÇËÄÉÂπ∂Ëá¥Ë∞¢:CËØ≠Ë®Ä‰∫§Êç¢‰∏§‰∏™ÂèòÈáèÊï∞ÂÄºÁöÑÂá†ÁßçÊñπÊ≥ï‰∏ÄÈÅìÈù¢ËØïÈ¢òÔºöÁî®Â§öÁßçÊñπÊ≥ïÂÆûÁé∞‰∏§‰∏™Êï∞ÁöÑ‰∫§Êç¢]]></content>
      <tags>
        <tag>CËØ≠Ë®Ä</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CocoaPodsÁöÑÂÆâË£Ö‰∏é‰ΩøÁî®]]></title>
    <url>%2F2016%2F10%2F10%2FCocoaPods%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[CocoaPodsÊòØÈùûÂ∏∏Â•ΩÁî®ÁöÑÁ¨¨‰∏âÊñπÂ∫ìÁÆ°ÁêÜÂ∑•ÂÖ∑„ÄÇ ÂçáÁ∫ßGemsudo gem update --system ÂàáÊç¢CocoaPodsÁöÑÊï∞ÊçÆÊ∫ê# 1.Âà†Èô§gem sources --remove https://rubygems.org/ # 2.Ê∑ªÂä†Ê∑òÂÆùÊï∞ÊçÆÊ∫êgem sources -a https://ruby.taobao.org/ # 3.Êü•Áúãgem sources -l ÂÆâË£ÖCocoaPodssudo gem install CocoaPodsÊàñËÄÖÔºàÂ¶Ç10.11Á≥ªÁªüÔºâsudo gem install -n /usr/local/bin CocoaPods Êä•ÈîôËß£ÂÜ≥Error installing pods:activesupport requires Ruby version &gt;= 2.2.2 Ëß£ÂÜ≥ÊñπÂºè: ÂÆâË£Ö RVMcurl -L get.rvm.io | bash -s stable Á≠âÂæÖ„ÄÇ source ~/.bashrc source ~/.bash_profile ÊµãËØïÊòØÂê¶ÂÆâË£ÖÊàêÂäü„ÄÇ rvm -v Áî®RVMÂçáÁ∫ßRuby# 1.Êü•ÁúãÂΩìÂâçrubyÁâàÊú¨ ruby -v # ÊòæÁ§∫ ruby 1.8.7 # 2.ÂàóÂá∫Â∑≤Áü•ÁöÑrubyÁâàÊú¨ rvm list known # 3.ÂÆâË£Öruby 2.3 rvm install 2.3 ÂÆâË£ÖÂÆåÊàê‰πãÂêéruby -vÊü•ÁúãÊòØÂê¶ÂÆâË£ÖÊàêÂäü„ÄÇ Êõ¥Êç¢ÊâòÁÆ°Âú∞ÂùÄ Â∞ÜPodspecÊñá‰ª∂ÊâòÁÆ°Âú∞ÂùÄ‰ªégithubÂàáÊç¢Âà∞ÂõΩÂÜÖÁöÑoschinaÊàñËÄÖcoding„ÄÇ Ê≥®ÊÑè:Â¶ÇÊûúpod setup ÂèØ‰ª•Â∞ÜgithubÁöÑ‰ª£Á†Å‰∏ãËΩΩÂæóÂä®ÔºåÈÇ£Â∞±‰∏çÁî®ÂéªÊõ¥Êç¢ÊâòÁÆ°Âú∞ÂùÄ‰∫Ü„ÄÇ # 1.ÂÖàÁßªÈô§pod repo remove master # 2.ÂÜçÊ∑ªÂä†pod repo add master https://git.coding.net/CocoaPods/Specs.git # 3.ÂÜçÊõ¥Êñ∞pod repo update ËÆæÁΩÆpod‰ªìÂ∫ì(ÂàùÂßãÂåñCocoaPods)pod setup # ‰ºöÂ∞ÜSpecs.gitÁöÑ‰ª£Á†Å‰∏ãËΩΩÂà∞~/.CocoaPods/repo/master,Ëá™Â∑±ÂâçÂæÄÊü•ÁúãÊòØÂê¶ÊúâÊñá‰ª∂# Â¶ÇÊûúËøòÊòØÂ§™ÊÖ¢ÔºåÂ∞ùËØï‰∏ãpod install --verbose Êä•ÈîôËß£ÂÜ≥[!] To setup the master specs repo, please run `pod setup`. ÊâãÂä®‰∏ãËΩΩ‰ª£Á†ÅËß£ÂÜ≥:# 1.ÊâãÂä®ÂÖãÈöÜÊñá‰ª∂Ëá≥ËØ•ÁõÆÂΩïgit clone https://git.coding.net/CocoaPods/Specs.git ~/.CocoaPods/repos/master # 2.ÂàùÂßãÂåñ,ÂÆåÊàêÂêéÊòæÁ§∫Setup completedpod setup ÊµãËØï# Â¶ÇÊûúÊúâÁâàÊú¨Âè∑ÔºåÂàôËØ¥ÊòéÂ∑≤ÁªèpodÂÆâË£ÖÊàêÂäüpod --version# Â¶ÇÊûú~/.CocoaPods/repo/masterÁõÆÂΩï‰∏ãÊúâÊñá‰ª∂,ËØ¥ÊòéÊñá‰ª∂‰∏ãËΩΩÊàêÂäü ‰ΩøÁî®‰ªãÁªçÂà©Áî®CocoaPodsÊù•ÂÆâË£ÖÁ¨¨‰∏âÊñπÊ°ÜÊû∂„ÄÇ ËøõÂÖ•Ë¶ÅÂÆâË£ÖÊ°ÜÊû∂ÁöÑÈ°πÁõÆÁöÑ.xcodeprojÂêåÁ∫ßÊñá‰ª∂Â§π„ÄÇ Âú®ËØ•Êñá‰ª∂Â§π‰∏≠Êñ∞Âª∫‰∏Ä‰∏™Êñá‰ª∂podfile„ÄÇ Âú®Êñá‰ª∂‰∏≠ÂëäËØâCocoaPodsÈúÄË¶ÅÂÆâË£ÖÁöÑÊ°ÜÊû∂‰ø°ÊÅØ„ÄÇ a.ËØ•Ê°ÜÊû∂ÊîØÊåÅÁöÑÂπ≥Âè∞b.ÈÄÇÁî®ÁöÑiOSÁâàÊú¨c.Ê°ÜÊû∂ÁöÑÂêçÁß∞d.Ê°ÜÊû∂ÁöÑÁâàÊú¨ PodfileÊñá‰ª∂Ê†ºÂºèplatform :ios, '9.0'target '‰Ω†ÁöÑÈ°πÁõÆÂêçÁß∞' dopod 'AFNetworking', '~&gt; 3.0'end ÂàõÂª∫PodfileÊñá‰ª∂ËøõÂÖ•.xcodeprojÂêåÁ∫ßÊñá‰ª∂Â§π‰∏ã # ÂàùÂßãÂåñ:‰ºöÁîüÊàêÊ®°ÊùøÁöÑPodfileÊñá‰ª∂pod init # ÊàñËÄÖÊâãÂä®ÂàõÂª∫PodfileÊñá‰ª∂touch Podfile Ê∑ªÂä†Ëá™Â∑±ÈúÄË¶ÅÁöÑÁ¨¨‰∏âÊñπÂ∫ìpod 'AFNetworking', '~&gt; 3.0' # If you are using Swift, be sure to add use_frameworks! and set your target to iOS 8+:pod 'SDWebImage', '~&gt;3.8'use_frameworks! pod 'Masonry' pod 'MBProgressHUD', '~&gt; 1.0.0' pod 'MJExtension' pod 'MJRefresh' pod 'SVProgressHUD' ÂºÄÂßãÂÆâË£Öpod install --verbose --no-repo-update# ÊòæÁ§∫# Pod installation complete! There is 1 dependency from the Podfile and 1 total pod installed. Start!‰ª•ÂêéÊâìÂºÄÈ°πÁõÆÁÇπÂáªxcworksapceÂêéÁºÄÁöÑÊñá‰ª∂Ôºå‰∏çË¶ÅÁÇπÂáªÂéüÊù•ÁöÑÈ°πÁõÆÊñá‰ª∂„ÄÇÂØºÂÖ•Â§¥Êñá‰ª∂Â∫îËØ•‰ΩøÁî®: #import &lt;&lt;#header#&gt;&gt; ËØ¥Êòéplatform :ios, ‚Äò9.0‚Äô Áî®Êù•ËÆæÁΩÆÊâÄÊúâÁ¨¨‰∏âÊñπÂ∫ìÊâÄÊîØÊåÅÁöÑiOSÊúÄ‰ΩéÁâàÊú¨pod ‚ÄòSDWebImage‚Äô,‚Äô~&gt;2.6‚Äô ËÆæÁΩÆÊ°ÜÊû∂ÁöÑÂêçÁß∞ÂíåÁâàÊú¨Âè∑ ÁâàÊú¨Âè∑ÁöÑËßÑÂàôÔºö‚Äò&gt;1.0‚Äô ÂèØ‰ª•ÂÆâË£Ö‰ªª‰ΩïÈ´ò‰∫é1.0ÁöÑÁâàÊú¨‚Äò&gt;=1.0‚Äô ÂèØ‰ª•ÂÆâË£Ö‰ªª‰ΩïÈ´ò‰∫éÊàñÁ≠â‰∫é1.0ÁöÑÁâàÊú¨‚Äò&lt;1.0‚Äô ‰ªª‰Ωï‰Ωé‰∫é1.0ÁöÑÁâàÊú¨‚Äò&lt;=1.0‚Äô ‰ªª‰Ωï‰Ωé‰∫éÊàñÁ≠â‰∫é1.0ÁöÑÁâàÊú¨‚Äò~&gt;0.1‚Äô ‰ªª‰ΩïÈ´ò‰∫éÊàñÁ≠â‰∫é0.1ÁöÑÁâàÊú¨Ôºå‰ΩÜÊòØ‰∏çÂåÖÂê´È´ò‰∫é1.0ÁöÑÁâàÊú¨‚Äò~&gt;0‚Äô ‰ªª‰ΩïÁâàÊú¨ÔºåÁõ∏ÂΩì‰∫é‰∏çÊåáÂÆöÁâàÊú¨ÔºåÈªòËÆ§ÈááÁî®ÊúÄÊñ∞ÁâàÊú¨Âè∑ pod installËøáÁ®ã ÂàÜÊûê‰æùËµñ:ËØ•Ê≠•È™§‰ºöÂàÜÊûêPodfile,Êü•Áúã‰∏çÂêåÁ±ªÂ∫ì‰πãÈó¥ÁöÑ‰æùËµñÊÉÖÂÜµ„ÄÇÂ¶ÇÊûúÊúâÂ§ö‰∏™Á±ªÂ∫ì‰æùËµñ‰∫éÂêå‰∏Ä‰∏™Á±ªÂ∫ìÔºå‰ΩÜÊòØ‰æùËµñ‰∫é‰∏çÂêåÁöÑÁâàÊú¨ÔºåÈÇ£‰πàCocoaPods‰ºöËá™Âä®ËÆæÁΩÆ‰∏Ä‰∏™ÂÖºÂÆπÁöÑÁâàÊú¨„ÄÇ ‰∏ãËΩΩ‰æùËµñ:Ê†πÊçÆÂàÜÊûê‰æùËµñÁöÑÁªìÊûúÔºå‰∏ãËΩΩÊåáÂÆöÁâàÊú¨ÁöÑÁ±ªÂ∫ìÂà∞Êú¨Âú∞È°πÁõÆ‰∏≠„ÄÇ ÁîüÊàêPodsÈ°πÁõÆÔºöÂàõÂª∫‰∏Ä‰∏™PodsÈ°πÁõÆ‰∏ìÈó®Áî®Êù•ÁºñËØëÂíåÁÆ°ÁêÜÁ¨¨‰∏âÊñπÊ°ÜÊû∂ÔºåCocoaPods‰ºöÂ∞ÜÊâÄÈúÄÁöÑÊ°ÜÊû∂ÔºåÂ∫ìÁ≠âÂÜÖÂÆπÊ∑ªÂä†Âà∞È°πÁõÆ‰∏≠ÔºåÂπ∂‰∏îËøõË°åÁõ∏Â∫îÁöÑÈÖçÁΩÆ„ÄÇ Êï¥ÂêàPodsÈ°πÁõÆÔºöÂ∞ÜPodsÂíåÈ°πÁõÆÊï¥ÂêàÂà∞‰∏Ä‰∏™Â∑•‰ΩúÁ©∫Èó¥‰∏≠ÔºåÂπ∂‰∏îËÆæÁΩÆÊñá‰ª∂ÈìæÊé•„ÄÇ Ë°•ÂÖÖMacÊòæÁ§∫ÈöêËóèÁöÑÊñá‰ª∂Ôºö defaults write com.apple.finder AppleShowAllFiles -boolean true ; killall Finder MacÂèñÊ∂àÊòæÁ§∫ÈöêËóèÊñá‰ª∂Ôºö defaults write com.apple.finder AppleShowAllFiles -boolean false ; killall Finder ÂèÇËÄÉÂπ∂Ëá¥Ë∞¢:Mac‰∏äÊõ¥Êñ∞RubycocoapodsÁöÑÂÆâË£ÖÂíå‰ΩøÁî®‰ª•ÂèäÁâàÊú¨ÂçáÁ∫ßÈÅáÂà∞ÁöÑÈóÆÈ¢ò]]></content>
      <tags>
        <tag>iOSÂºÄÂèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Objective-CÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2016%2F05%2F12%2FObjective-C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[2016.10.28 Êõ¥Ê≠£ÈÉ®ÂàÜÈîôËØØ2019.03.29 Êï¥ÂêàÊâÄÊúâÂÖ≥‰∫éObjective-CÁöÑÁ¨îËÆ∞ ÂÖ≥‰∫éObjective-CÁöÑÂ≠¶‰π†Á¨îËÆ∞„ÄÇ 1.Á±ªÁöÑËÆæËÆ°‰∏âË¶ÅÁ¥†Ôºö‰∫ãÁâ©ÂêçÁß∞ÔºàÁ±ªÂêçÔºâÔºõÂ±ûÊÄßÔºõË°å‰∏∫ÔºàÂäüËÉΩÔºâ„ÄÇÂÖ∑ÊúâÁõ∏ÂêåÔºàÊàñËÄÖÁ±ª‰ººÔºâÂ±ûÊÄßÂíåË°å‰∏∫ÁöÑÂØπË±°ÂèØ‰ª•ÊäΩË±°Âá∫‰∏Ä‰∏™Á±ª„ÄÇ 2.Á±ªÁöÑÂ£∞ÊòéÁ±ªÂêç1ÔºåÈ¶ñÂ≠óÊØçÂ§ßÂÜôÔºõ2Ôºå‰∏çËÉΩÊúâ‰∏ãÂàíÁ∫øÔºõ3ÔºåÂ§ö‰∏™Ëã±ÊñáÂçïËØçÔºå‰ΩøÁî®È©ºÂ≥∞Ê†áËØÜÔºõ Ë°å‰∏∫Âì™‰∏™ÂØπË±°ÊúÄÊ∏ÖÊ•öË°å‰∏∫ÊÄé‰πàÂÅöÔºåÂ∞±ÊääË°å‰∏∫ËÆæËÆ°Âú®Âì™‰∏™ÂØπË±°Ë∫´‰∏ä„ÄÇ @interface Person : NSObject &#123;@public int _age; bool _sex;&#125; - (void)print;@end Â§ßÊã¨Âè∑ÂÜÖÁî®Êù•Â£∞ÊòéÂØπË±°ÁöÑÊàêÂëòÂèòÈáèÔºà‰πüÂç≥ÂÆû‰æãÂèòÈáèÔºâÔºå@publicËÆ©Â§ñÁïåÊåáÈíàÂèØ‰ª•Èó¥Êé•ËÆøÈóÆÂØπË±°ÂÜÖÈÉ®ÁöÑÊàêÂëòÂèòÈáè„ÄÇÂÄºÁ±ªÂûãÁöÑÊàêÂëòÂèòÈáèÈªòËÆ§‰ºöÂàùÂßãÂåñ‰∏∫0ÔºåÂºïÁî®Á±ªÂûãÁöÑÊàêÂëòÂèòÈáèÈªòËÆ§‰ºöÂàùÂßãÂåñ‰∏∫nil„ÄÇnilË°®Á§∫ÊåáÂêë‰∏Ä‰∏™ÂØπË±°ÁöÑÁ©∫ÊåáÈíàÔºåNilË°®Á§∫ÊåáÂêë‰∏Ä‰∏™Á±ªÁöÑÁ©∫ÊåáÈíà„ÄÇ : NSObjectÔºöË°®Á§∫ÁªßÊâøËá™NSObjectÁ±ª„ÄÇ 3.Á±ªÁöÑÂÆûÁé∞ÈúÄË¶ÅÂØºÂÖ•Â£∞ÊòéÊñá‰ª∂#import &quot;Person.h&quot; @implementation Person- (void)print &#123; NSLog(@"ËæìÂá∫ÂÜÖÂÆπ");&#125;@end Á±ªÁöÑÂÆûÁé∞‰∏ªË¶ÅÊòØÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ 4.ÂàõÂª∫ÂØπË±°Person *p = [[Person alloc] init];[p print]; ÂØπË±°ÁöÑÊú¨Ë¥®ÊòØÁªìÊûÑ‰ΩìÔºåÂØπË±°ÈúÄË¶ÅÈÄöËøáÊåáÈíàÊìçÁ∫µ„ÄÇ Á±ªÂú®ÂÜÖÂ≠ò‰∏≠‰πüÂç†ÊçÆÂ≠òÂÇ®Á©∫Èó¥ÔºåÂú®ÂàõÂª∫ÂØπË±°‰πãÂâç‰∏∫Á±ªÂàÜÈÖç‰∏Ä‰ªΩÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂ∞ÜÁ±ªÂä†ËΩΩËøõÂÜÖÂ≠òÔºåËÄå‰∏îÂè™Â≠òÂÇ®ÊñπÊ≥ïÂàóË°®ÔºåÂÖ∂‰∏≠Áî±Á±ª‰∫ßÁîüÁöÑÂØπË±°ÔºåÈÉΩÊúâ‰∏Ä‰∏™isaÊåáÈíàÊåáÂêëÁ±ª„ÄÇ ÊñπÊ≥ïË∞ÉÁî®Ôºö[Ë°å‰∏∫ÊâßË°åËÄÖ Ë°å‰∏∫ÂêçÁß∞]; [Person new]ÊâßË°åPersonËøô‰∏™Á±ªÁöÑnewË°å‰∏∫ÔºåÂàõÂª∫ÂØπË±°ÔºåËøîÂõûÂØπË±°Âú∞ÂùÄ„ÄÇ Person *p = [Person new];ÂÆö‰πâ‰∏Ä‰∏™Person Á±ªÂûãÁöÑÊåáÈíàÂèòÈáèpÔºåÊåáÂêëPersonÁ±ªÂûãÁöÑÂØπË±°„ÄÇÊåáÈíàÁöÑÁ±ªÂûãÊòØPerson *ÔºåÊåáÈíàÊåáÂêëÁöÑÁ±ªÂûãÊòØPerson„ÄÇ [p print];Ë°®Á§∫ÁªôpÊåáÂêëÁöÑÂØπË±°ÂèëÈÄÅ‰∏ÄÊù°printÊ∂àÊÅØ„ÄÇ Person p = [Person new];Á≠â‰ª∑‰∫é Person p; p = [Person new];Âè¶Â§ñPerson *p2 = p;Ë°®Á§∫p2„ÄÅpÊåáÂêëÂêå‰∏Ä‰∏™ÂÜÖÂÆπ„ÄÇp2 = p:Â∞ÜpÂ≠òÂÇ®ÁöÑÊåáÈíà‰∫§Áªôp2Ôºå‰Ωøp2Â≠òÂÇ®ÁöÑ‰πüÊòØpÂ≠òÂÇ®ÁöÑÂÜÖÂÆπ„ÄÇ 5.ÊñπÊ≥ï‰∏éÂáΩÊï∞ÁöÑÂå∫Âà´‰ª•ÂèäÊ≥®ÊÑè ÊñπÊ≥ïÂè™ËÉΩÂ£∞ÊòéÂú®@interfaceÂíå@end‰πãÈó¥ÔºåÂè™ËÉΩÂÆûÁé∞Âú®@implementationÂíå@end‰πãÈó¥„ÄÇ‰πüÂ∞±ÊòØËØ¥ÊñπÊ≥ï‰∏çËÉΩÁã¨Á´ã‰∫éÁ±ªÂ≠òÂú®„ÄÇ CÂáΩÊï∞‰∏çÂ±û‰∫éÁ±ªÔºåË∑üÁ±ªÊ≤°ÊúâËÅîÁ≥ªÔºåCÂáΩÊï∞Âè™ÂΩíÂÆö‰πâÂáΩÊï∞ÁöÑÊñá‰ª∂ÊâÄÊúâ„ÄÇ CÂáΩÊï∞‰∏çËÉΩËÆøÈóÆÂØπË±°ÁöÑÊàêÂëòÂèòÈáè„ÄÇ ÂØπË±°ÊñπÊ≥ïÂΩíÁ±ªÔºèÂØπË±°ÊâÄÊúâÔºåÂáΩÊï∞Â±û‰∫éÊï¥‰∏™Êñá‰ª∂ÊâÄÊúâÔºå‰ªª‰ΩïÂú∞ÊñπÈÉΩÂèØ‰ª•ÊîæÁΩÆÂáΩÊï∞ÔºàÂ¶ÇÊûúÊîæÂú®@interface‰∏é@end‰πãÈó¥ÔºåÂ∞Ü‰ºöÂøΩÁï•ÊéâÂáΩÊï∞ÔºåÂç≥Êú™ÂÆö‰πâÔºâ„ÄÇ ÊñπÊ≥ïÂè™ÊúâÂ£∞ÊòéÔºåÊ≤°ÊúâÂÆûÁé∞ÔºàÁªèÂÖ∏ÈîôËØØÔºâ ÊñπÊ≥ïÊ≤°ÊúâÂ£∞ÊòéÔºåÂè™ÊúâÂÆûÁé∞ÔºàÁºñËØëÂô®Ë≠¶ÂëäÔºå‰ΩÜÊòØËÉΩË∞ÉÁî®ÔºåÂº±ËØ≠Ê≥ïÔºâ„ÄÇ ÁºñËØëÁöÑÊó∂ÂÄôÔºöËÆøÈóÆÊ≤°ÊúâÁöÑÊàêÂëòÂèòÈáèÁõ¥Êé•Êä•ÈîôÔºåËÆøÈóÆÊ≤°ÊúâÁöÑÊñπÊ≥ïÔºåÂè™ÊòØË≠¶Âëä„ÄÇ Âêå‰∏Ä‰∏™Á±ª‰∏≠‰∏çÂÖÅËÆ∏‰∏§‰∏™ÂØπË±°ÊñπÊ≥ïÂêåÂêç„ÄÇ 6.ÂåøÂêçÂØπË±°Â±ûÊÄßËÆøÈóÆ [Car new]-&gt;speed = 200;ÊñπÊ≥ïË∞ÉÁî®[[Car new] run]; 7.ÂØπË±°ÊñπÊ≥ï‰∏çÂ∏¶ÂèÇÊï∞ÁöÑÂØπË±°ÊñπÊ≥ïÔºö // ÊñπÊ≥ïÂêç print- (void)print; Â∏¶‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂØπË±°ÊñπÊ≥ïÔºö // ÊñπÊ≥ïÂêç print:- (void)print:(int) a; Â∏¶Â§ö‰∏™ÂèÇÊï∞ÁöÑÂØπË±°ÊñπÊ≥ïÔºö // ÊñπÊ≥ïÂêç print:WithOther:- (void)print:(int)a WithOther:(int)b; 8.Êûö‰∏æCËØ≠Ë®Ä‰∏≠ÁöÑÊûö‰∏æÔºötypedef enumÔΩõ SexMan, SexWomanÔΩùSex; Âª∫ËÆÆ‰ΩøÁî®Objective-CÈ£éÊ†ºÁöÑÊûö‰∏æÔºåÁ§∫‰æãÔºötypedef NS_ENUM(NSInteger, YAViewType) &#123; YAViewTypeDefault = 0, // ÈªòËÆ§ value YAViewTypeButton = 1, YAViewTypeCell = 2&#125;; 9.ÁªìÊûÑ‰Ωìtypedef struct&#123; int year; int month; int day;&#125; Date; ËÆøÈóÆÊûö‰∏æÔºös-&gt;sex = SexMan;ËÆøÈóÆÁªìÊûÑ‰ΩìÔºös-&gt;birthday.year = 2016;ÂÆö‰πâÁªìÊûÑ‰ΩìÔºöDate d = {2016,4,30};ËÆøÈóÆÁªìÊûÑ‰ΩìÔºö s-&gt;birthday.year = 2016;s-&gt;birthday.month = 4;s-&gt;birthday.day = 16; Á≠â‰ª∑‰∫éÔºö Date d = &#123;2016,4,16&#125;; s-&gt;birthday = d; 10.Ê≥®ÊÑè‰∫ãÈ°π Âú®‰ΩøÁî®ÊâìÂç∞ÂáΩÊï∞NSLogÊó∂Ê≥®ÊÑèÔºÖ‰∏é%ÁöÑÂå∫Âà´„ÄÇ ÂÆö‰πâÊûö‰∏æ„ÄÅÁªìÊûÑ‰ΩìÁ≠âÂª∫ËÆÆÊîæÂú®@interfaceÁöÑÂâçÈù¢‰ΩøÁî®„ÄÇ ÊñπÊ≥ï‰∏≠‰∏Ä‰∏™ÂèÇÊï∞ÂØπÂ∫î‰∏Ä‰∏™ÂÜíÂè∑„ÄÇ ÂØπË±°‰∏≠ÁöÑÊàêÂëòÂèòÈáèÊåáÂêëÂè¶‰∏Ä‰∏™ÂØπË±°Ôºö @interface Student : NSObject &#123;@public// ÁãóDog *dog;&#125; - (void)letDogRun &#123; [dog run];&#125; // main.mÊñá‰ª∂Student *stu = [Student new];Dog *dog = [Dog new];stu-&gt;dog = dog;[stu letDogRun]; 11.Â∞ÅË£ÖËøáÊª§‰∏çÂêàÁêÜÁöÑÂÄºÔºåÂ±èËîΩÂÜÖÈÉ®ÁöÑËµãÂÄºËøáÁ®ãÔºåËÆ©Â§ñÁïå‰∏çÂøÖÂÖ≥Ê≥®ÂÜÖÈÉ®ÁöÑÁªÜËäÇ„ÄÇ ÊàêÂëòÂèòÈáèÁöÑÂëΩÂêçÔºö‰ª•‰∏ãÂàíÁ∫øÂºÄÂ§¥„ÄÇÁî®‰∫éÂå∫ÂàÜgetÊñπÊ≥ïÂêçÁß∞ÂíåÂ±ÄÈÉ®ÂèòÈáèÂêçÁß∞„ÄÇÂ∞ΩÈáè‰∏çËÆæÁΩÆ‰∏∫@publicÂÖ¨ÊúâÂ±ûÊÄßÔºåÂ¶ÇÔºö &#123; int _speed;&#125; setÊñπÊ≥ïÔºöËÆæÁΩÆÊàêÂëòÂèòÈáèÔºåËøáÊª§‰∏Ä‰∫õ‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑÂÄº„ÄÇ‰ª•setÂºÄÂ§¥ÔºåËøîÂõûÁ±ªÂûã‰∏∫voidÔºåÂêéÈù¢Ë∑ü‰∏äÊàêÂëòÂèòÈáèÂêçÔºåÂΩ¢ÂèÇ‰∏ç‰∏éÊàêÂëòÂèòÈáèÈáçÂêçÔºåÂΩ¢ÂèÇÁ±ªÂûã‰∏éÊàêÂëòÂèòÈáèÁõ∏ÂêåÔºåÊàêÂëòÂèòÈáèÁöÑÈ¶ñÂ≠óÊØçÂ§ßÂÜô„ÄÇ- (void)setSpeed:(int)s;- (void)setSpeed:(int)s &#123; _speed = s+20;&#125; getÊñπÊ≥ïÔºöËé∑ÂèñÂØπË±°ÂÜÖÈÉ®ÁöÑÊàêÂëòÂèòÈáèÔºå‰∏çÊé•Êî∂ÂèÇÊï∞ÔºåËøîÂõûÁ±ªÂûã‰∏éÊàêÂëòÂèòÈáèÁ±ªÂûãÁõ∏ÂêåÔºåÊñπÊ≥ïÂêçÁß∞‰∏éÊàêÂëòÂèòÈáèÂêçÁß∞Áõ∏ÂêåÔºà‰∏çÂê´‰∏ãÂàíÁ∫øÔºâ„ÄÇ‰∏çÊé®Ëçê‰ª•getÂºÄÂ§¥„ÄÇ - (int)speed; - (int)speed &#123; return _speed; &#125; Âè™ËØªÔºöÂè™Êèê‰æõgetÊñπÊ≥ï„ÄÇÂèØËØªÂèØÂÜôÔºöÊèê‰æõgetÂíåsetÊñπÊ≥ï„ÄÇ 12.Ë∞ÉÁî®Êú™Â£∞Êòé„ÄÅÊú™ÂÆûÁé∞ÁöÑÂØπË±°ÊñπÊ≥ïÁºñËØëÊä•ÈîôÔºö No visible @interface for ‚ÄòDog‚Äô declares the selector ‚Äòssss‚Äô„ÄÇÈìæÊé•ËøêË°åÊä•ÈîôÔºöreason: ‚Äò-[Dog ssss]: unrecognized selector sent to instance 0x1002014a0‚ÄôÔºåË°®Á§∫ÁªôDogÂØπË±°ÂèëÈÄÅ‰∏çËÉΩËØÜÂà´ÁöÑÊ∂àÊÅØ„ÄÇ 13.Ë∞ÉÁî®Â∑≤Â£∞Êòé„ÄÅÊú™ÂÆûÁé∞ÁöÑÂØπË±°ÊñπÊ≥ïÁºñËØëË≠¶ÂëäÔºöMethod definition for ‚Äòssss‚Äô not found Êú™ÂÆûÁé∞ÊñπÊ≥ï„ÄÇÈìæÊé•Ê≠£Â∏∏ÔºåËøêË°åÊä•ÈîôÔºöreason: ‚Äò-[Dog ssss]: unrecognized selector sent to instance 0x1001002a0‚Äô„ÄÇ 14.Ë∞ÉÁî®Êú™Â£∞Êòé„ÄÅÂ∑≤ÂÆûÁé∞ÁöÑÂØπË±°ÊñπÊ≥ïÁºñËØëÈîôËØØÔºö No visible @interface for ‚ÄòDog‚Äô declares the selector ‚Äòssss‚Äô„ÄÇ 15.Á±ªÊñπÊ≥ïÁ±ªÊú¨Ë∫´Âú®ÂÜÖÂ≠ò‰∏≠Âç†ÊçÆÂ≠òÂÇ®Á©∫Èó¥ÔºåÈáåÈù¢ÊúâÁ±ª\ÂØπË±°ÊñπÊ≥ïÂàóË°®„ÄÇÁõ¥Êé•ÈÄöËøáÁ±ªÂêçÊâßË°åÁöÑÊñπÊ≥ï‰ª•+ÂºÄÂ§¥ÔºåÂè™ËÉΩÁî±Á±ªÂêçË∞ÉÁî®ÔºåÁ±ªÊñπÊ≥ï‰∏≠‰∏çËÉΩËÆøÈóÆÊàêÂëòÂèòÈáèÔºàÂÆû‰æãÂèòÈáèÔºâ„ÄÇÂÖÅËÆ∏Á±ªÊñπÊ≥ï‰∏éÂØπË±°ÊñπÊ≥ïÈáçÂêç„ÄÇ‰ΩøÁî®Âú∫ÂêàÔºöÂΩì‰∏çÈúÄË¶ÅËÆøÈóÆÊàêÂëòÂèòÈáèÁöÑÊó∂ÂÄôÔºåÂ∞ΩÈáè‰ΩøÁî®Á±ªÊñπÊ≥ïÔºåÊèêÂçáÊïàÁéá„ÄÇ ËæìÂá∫Á±ªÁöÑÂêçÁß∞Ôºö + (void)showClassName;+ (void)showClassName &#123; NSLog(@"Á±ªÁöÑÂêçÁß∞ÊòØÔºö%@",NSStringFromClass([self class]));&#125; Ë∞ÉÁî®Ôºö[Dog showClassName]; 16.selfÂÖ≥ÈîÆÂ≠óselfÊòØÊåáÈíàÔºåÊåáÂêëÂΩìÂâçÂØπË±°ÊñπÊ≥ïÊàñÁ±ªÊñπÊ≥ïÁöÑË∞ÉÁî®ËÄÖ„ÄÇÂá∫Áé∞Âú®ÂØπË±°ÊñπÊ≥ï‰∏≠Ôºå‰ª£Ë°®ÂΩìÂâçÂØπË±°ÔºåÂá∫Áé∞Âú®Á±ªÊñπÊ≥ï‰∏≠Ôºå‰ª£Ë°®ÂΩìÂâçÁ±ª„ÄÇ‰∏çËÉΩÂá∫Áé∞Âú®ÂáΩÊï∞‰∏≠Ôºà‰ºöÊä•ÈîôÔºöUse of undeclared identifier ‚Äòself‚Äô‰ΩøÁî®Êú™Â£∞ÊòéÁöÑÊ†áËØÜÁ¨¶Ôºâ„ÄÇ Áî®ÈÄîÔºö self-&gt;ÊàêÂëòÂèòÈáèÂêç Âú®ÂØπË±°ÊñπÊ≥ï‰∏≠ËÆøÈóÆÂΩìÂâçÊñπÊ≥ïË∞ÉÁî®ÁöÑÊàêÂëòÂèòÈáèÔºå‰πüÂç≥ÂΩìÊàêÂëòÂèòÈáè‰∏éÂ±ÄÈÉ®ÂèòÈáèÂêåÂêçÊó∂ÔºåÁî®Êù•Âå∫ÂàÜÂêåÂêçÁöÑÂ±ÄÈÉ®ÂèòÈáè„ÄÇ - (void)showSelfOfObject;- (void)showSelfOfObject &#123; NSLog(@"showSelfOfObjectÊñπÊ≥ïË¢´Ë∞ÉÁî®"); int _speed; self-&gt;_speed=200; _speed += 1000; int result = self-&gt;_speed+10; NSLog(@"resultÁöÑÂÄºÊòØÔºö%i",result); NSLog(@"_speedÁöÑÂÄºÊòØÔºö%i",_speed);&#125; ÂΩìÊàêÂëòÂèòÈáè‰∏éÂ±ÄÈÉ®ÂèòÈáèÂêåÂêçÊó∂ÔºàÁºñËØëË≠¶ÂëäLocal declaration of ‚Äò_speed‚Äô hides the instance variableÂ±ÄÈÉ®ÂèòÈáèÈöêËóè‰∫ÜÊàêÂëòÂèòÈáèÔºâÔºåÈááÁî®Â∞±ËøëÂéüÂàôÔºåËÆøÈóÆÂ±ÄÈÉ®ÂèòÈáè„ÄÇÂõ†Ê≠§ÈúÄË¶ÅÁî®selfËÆøÈóÆÊàêÂëòÂèòÈáè„ÄÇ ÊñπÊ≥ïÁöÑË∞ÉÁî®:Âú®ÂØπË±°ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂΩìÂâçÂØπË±°ÁöÑÂØπË±°ÊñπÊ≥ï‰ª•ÂèäÂú®Á±ªÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂΩìÂâçÁ±ªÁöÑÁ±ªÊñπÊ≥ï„ÄÇ Âú®ÂØπË±°ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂΩìÂâçÂØπË±°ÁöÑÂØπË±°ÊñπÊ≥ïÔºö - (void)showSelfOfObject;- (void)showTestObject;- (void)showSelfOfObject &#123; NSLog(@"showSelfOfObjectÊñπÊ≥ïË¢´Ë∞ÉÁî®");&#125; - (void)showTestObject &#123; [self showSelfOfObject];&#125; Âú®Á±ªÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂΩìÂâçÁ±ªÁöÑÁ±ªÊñπÊ≥ïÔºö + (void)showSelfOfClass;+ (void)showTestClass;+ (void)showSelfOfClass &#123; NSLog(@"showSelfOfClassÊñπÊ≥ïË¢´Ë∞ÉÁî®");&#125; + (void)showTestClass &#123; [self showSelfOfClass];&#125; Â∏∏ËßÅÈîôËØØÔºö Âú®ÂØπË±°ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®Á±ªÊñπÊ≥ïÔºàÁºñËØëÈîôËØØNo visible @interface for ‚ÄòDog‚Äô declares the selector ‚ÄòshowSelfOfClass‚ÄòÔºâÈîôËØØÁõ∏ÂΩì‰∫éÊú™Â£∞ÊòéÊú™ÂÆö‰πâÂç¥Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ï„ÄÇ Âú®Á±ªÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂØπË±°ÊñπÊ≥ïÔºàÁºñËØëÈîôËØØNo known class method for selector ‚ÄòshowSelfOfObject‚ÄòÔºâÊú™Áü•ÁöÑÁ±ªÊñπÊ≥ï„ÄÇ selfÁöÑÊ≠ªÂæ™ÁéØ:Ë∞ÉÁî®Êú¨Ë∫´ - (void)showSelfOfObject &#123; NSLog(@"showSelfOfObjectÊñπÊ≥ïË¢´Ë∞ÉÁî®"); [self showSelfOfObject];&#125; Ë∞ÉÁî®ÂáΩÊï∞ ÂáΩÊï∞‰∏ç‰æùËµñÂØπË±°„ÄÇvoid f(); [self f] ÈîôËØØ„ÄÇ 17.ÁªßÊâøÂú∫ÊôØÔºöÂΩì‰∏§‰∏™Á±ªÊã•ÊúâÁõ∏ÂêåÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïÊó∂ÔºåÂ∞ÜÁõ∏ÂêåÁöÑÂÜÖÂÆπÊäΩÂèñÂà∞Áà∂Á±ª‰∏≠„ÄÇÂΩìAÁ±ªÂÆåÂÖ®Êã•ÊúâBÁ±ªÁöÑÈÉ®ÂàÜÂ±ûÊÄßÊàñÊñπÊ≥ïÊó∂ÔºåËÄÉËôëAÁ±ª‰Ωú‰∏∫Áà∂Á±ª„ÄÇ Áà∂Á±ªÂøÖÈ°ªÂ£∞ÊòéÂú®Â≠êÁ±ªÂâçÈù¢„ÄÇ ‰∏çÂÖÅËÆ∏Â≠êÁ±ªÂíåÁà∂Á±ªÊã•ÊúâÁõ∏ÂêåÁöÑÊàêÂëòÂèòÈáèÔºàÂ¶ÇÊûúÂ≠êÁ±ªÊúâÂíåÁà∂Á±ªÊã•ÊúâÁõ∏ÂêåÁöÑÊàêÂëòÂèòÈáèÔºåÊÑèÂë≥ÁùÄÔºåÂêå‰∏ÄÊàêÂëòÂèòÈáèÂ£∞ÊòéÂÆö‰πâ‰∏§Ê¨°ÔºåÁºñËØëÈîôËØØ Duplicute member ‚Äò_age‚ÄôÔºåÂì™ÊÄïÊàêÂëòÂèòÈáèÁöÑËÆøÈóÆÂ±ûÊÄß‰∏çÂêåÔºåÂ≠êÁ±ªÂÖ¨ÂºÄÁà∂Á±ªÁßÅÊúâÔºåÊàñËÄÖÁà∂Á±ªÂÖ¨ÂºÄÂ≠êÁ±ªÁßÅÊúâÔºåÈÉΩ‰∏çË°åÔºÅÔºâ Â≠êÁ±ªÊñπÊ≥ïÂíåÂ±ûÊÄßÁöÑËÆøÈóÆËøáÁ®ãÔºöÂ¶ÇÊûúÂ≠êÁ±ªÊ≤°ÊúâÔºåÂÜçËÆøÈóÆÁà∂Á±ª„ÄÇÂç≥Áî±Â≠êÁ±ªÂºÄÂßã„ÄÇ Objective-C‰∏≠Âè™ÊúâÂçïÁªßÊâøÔºà‰∏éCÔºãÔºã‰∏çÂêåÔºâ„ÄÇ ÊñπÊ≥ïÁöÑÈáçÂÜô:Áà∂Á±ªÂíåÂ≠êÁ±ªÊã•ÊúâÁõ∏ÂêåÁ≠æÂêçÁöÑÁ±ªÊñπÊ≥ïÊàñËÄÖÂØπË±°ÊñπÊ≥ïÔºàÂ≠êÁ±ªÈáçÊñ∞ÂÆûÁé∞‰∫ÜÁà∂Á±ª‰∏≠ÁöÑÊñπÊ≥ïÔºâÔºåÂàô‰ºòÂÖàË∞ÉÁî®Â≠êÁ±ªÁöÑÂêåÂêçÊñπÊ≥ï„ÄÇ // Áà∂Á±ªPersonÔºö- (void)show &#123; NSLog(@"Ë∞ÉÁî®‰∫ÜPersonÁöÑshowÊñπÊ≥ï");&#125; // Â≠êÁ±ªStudentÔºö- (void)show &#123;// [super show];NSLog(@"Ë∞ÉÁî®‰∫ÜStudentÁöÑshowÊñπÊ≥ï");&#125; // Ë∞ÉÁî®ÔºöStudent *p = [[Student alloc] init]; [p show]; ÂæàÊòéÊòæÔºåË∞ÉÁî®ÁöÑÊòØÈáçÂÜôÁöÑÂ≠êÁ±ªStudentÁöÑshowÊñπÊ≥ï„ÄÇ 18.superÂú∫ÊôØÔºöÂ≠êÁ±ªÈáçÂÜôÁà∂Á±ªÁöÑÊñπÊ≥ïÊó∂ÔºåÊÉ≥Ë∞ÉÁî®Áà∂Á±ªÁöÑÊñπÊ≥ïÔºàÂåÖÊã¨Á±ªÊñπÊ≥ïÂíåÂØπË±°ÊñπÊ≥ïÔºâ„ÄÇ ÊïàÊûú‰∏éselfÁ±ª‰ººÔºåsuperÂú®ÂØπË±°ÊñπÊ≥ï‰∏≠Â∞±Ë∞ÉÁî®Áà∂Á±ªÁöÑÂØπË±°ÊñπÊ≥ïÔºåÂú®Á±ªÊñπÊ≥ï‰∏≠Â∞±Ë∞ÉÁî®Áà∂Á±ªÁöÑÁ±ªÊñπÊ≥ï„ÄÇ ÁªßÊâøÂèØ‰ª•Âú®‰∏çÊîπÂèòÂéüÊù•Ê®°ÂûãÁöÑÂü∫Á°Ä‰∏äÊãìÂÖÖÊñπÊ≥ïÔºåÊäΩÂèñÂÖ¨ÂÖ±‰ª£Á†ÅÔºåÂª∫Á´ãÁ±ª‰∏éÁ±ª‰πãÈó¥ÁöÑËÅîÁ≥ªÔºåÂáèÂ∞ë‰ª£Á†ÅÁöÑÂÜó‰ΩôÊÄßÔºå‰ΩÜÊòØÔºå‰ºöÂ¢ûÂä†ËÄ¶ÂêàÊÄß„ÄÇ 19.Â§öÊÄÅÊüê‰∏ÄÁßç‰∫ãÁâ©ÁöÑÂ§öÁßçÂΩ¢ÊÄÅ„ÄÇÂú®ÂÆûÁé∞ÁªßÊâøÁöÑÂâçÊèê‰∏ãÔºåÁà∂Á±ªÁ±ªÂûãÊåáÈíàÊåáÂêëÂ≠êÁ±ªÂØπË±°ÔºåÊåáÂêëÂ≠êÁ±ªÂØπË±°ÁöÑÁà∂Á±ªÊåáÈíàÂèØ‰ª•Ë∞ÉÁî®Â≠êÁ±ª‰∏≠ÈáçÂÜôÁà∂Á±ªÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÊåáÂêëÂ≠êÁ±ªÂØπË±°ÁöÑÁà∂Á±ªÊåáÈíà‰∏çËÉΩË∞ÉÁî®Â≠êÁ±ª‰∏≠ÊãìÂ±ïÁöÑÊñπÊ≥ïÔºàÁà∂Á±ª‰∏≠Ê≤°ÊúâÁöÑÊñπÊ≥ïÔºâ„ÄÇ Person *p = [[Student alloc] init]; [p show]; StudentÊòØPersonÔºåshowÊñπÊ≥ïÂú®Â≠êÁ±ªÂíåÁà∂Á±ª‰∏≠ÈÉΩÊúâÔºåËøôÈáåË∞ÉÁî®ÁöÑÊòØÂ≠êÁ±ªÁöÑshowÊñπÊ≥ï„ÄÇÂΩìÂ≠êÁ±ªÊãìÂ±ï‰∫Ü‰∏Ä‰∏™showStudentÂØπË±°ÊñπÊ≥ïÔºåÂ¶ÇÊûúËøòÊÉ≥Ë∞ÉÁî®ÔºåÂàôÂº∫Âà∂ËΩ¨Êç¢ÔºöÂ∞ÜÊåáÂêëÂ≠êÁ±ªÂØπË±°ÁöÑÁà∂Á±ªÊåáÈíàÂº∫Âà∂ËΩ¨Âåñ‰∏∫Â≠êÁ±ªÊåáÈíà„ÄÇ Person *p = [[Student alloc] init];Student *p2 = (Student *)p;[p2 showStudent]; Â∞ÜÁà∂Á±ªÊåáÈíàpÂº∫Âà∂ËΩ¨Êç¢‰∏∫Â≠êÁ±ªÊåáÈíàÔºå‰ΩøÂÆÉÂèØ‰ª•Ë∞ÉÁî®Â≠êÁ±ªStudentÊãìÂ±ïÁöÑshowStudentÊñπÊ≥ï„ÄÇ Â¶ÇÊûú‰∏çÂÅöÂº∫Âà∂ËΩ¨Êç¢ÔºåËÄåÁõ¥Êé•Ë∞ÉÁî®Â≠êÁ±ªÊãìÂ±ïÁöÑÊñπÊ≥ï Person *p = [[Student alloc] init];[p showStudent]; ÁºñËØëÊä•ÈîôÔºö No visible @interface for ‚ÄòPerson‚Äô declares the selector ‚ÄòshowStudent‚Äô ‰∏ªË¶ÅÂ∫îÁî®ÔºöÂä®ÊÄÅÁªëÂÆöÂ¶ÇÊûúÂèÇÊï∞‰ΩøÁî®Áà∂Á±ªÁ±ªÂûãÔºåÂèØ‰ª•‰º†ÂÖ•Áà∂Á±ª„ÄÅÂ≠êÁ±ªÂØπË±°ÔºåË∞ÉÁî®Áõ∏Â∫îÁöÑÊñπÊ≥ïÔºàÂ¶ÇÂ∞ÜÂ≠êÁ±ªÂØπË±°‰º†ÈÄíÁªôÂèÇÊï∞ÔºåË∞ÉÁî®Â≠êÁ±ªÁöÑÊñπÊ≥ïÔºõÂ∞ÜÁà∂Á±ªÂØπË±°‰º†ÈÄíÁªôÂèÇÊï∞ÔºåÂàôË∞ÉÁî®Áà∂Á±ªÁöÑÊñπÊ≥ïÔºâ 20.NSStringÁöÑ‰ΩøÁî® ÂàõÂª∫Â≠óÁ¨¶‰∏≤‰∏éËæìÂá∫Â≠óÁ¨¶‰∏≤ NSString *s = @"Sometimes";NSLog(@"%@",s); Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ int age = 85;NSString *s = [NSString stringWithFormat:@"‰º†ÂÖ•ÁöÑÂπ¥ÈæÑÂèÇÊï∞ÊòØ%d",age];NSLog(@"%@",s); Ë∞ÉÁî®NSStringÁ±ªÊñπÊ≥ï„ÄÇ lengthËøîÂõûÂ≠óÊï∞Ôºà‰∏çÊòØÂ≠óÁ¨¶Êï∞ÔºâÔºåËøîÂõûÁöÑÊòØ7ÔºåÂåÖÊã¨Á©∫Ê†º„ÄÇ NSString *s = @"123 456"; NSLog(@"%@",s);NSUInteger size = [s length];NSLog(@"%lu",(unsigned long)size); 21.ÁÇπËØ≠Ê≥ïÊú¨Ë¥®ÊòØÊñπÊ≥ïË∞ÉÁî®Ôºå‰∏çËÆøÈóÆÊàêÂëòÂèòÈáè„ÄÇÂâçÊèêÊòØÂ∑≤ÁªèÂ≠òÂú®getÂíåsetÊñπÊ≥ï(Âê¶ÂàôÊä•ÈîôÔºöProperty ‚Äòage‚Äô not found on object of type ‚ÄòPerson *‚Äô)„ÄÇ [p setAge:50];int result = [p age];NSLog(@"resultÁöÑÁªìÊûúÊòØÔºö%i",result); Áõ∏ÂΩì‰∫éÔºö p.age = 50;int result = p.age;NSLog(@"resultÁöÑÁªìÊûúÊòØÔºö%i",result); 22.ÊñπÊ≥ïÁöÑÂ±ïÂºÄÂéüÁêÜÔºö[p setAge:50];ÂØπÂ∫î p.age = 50; ËÄåint result = [p age];ÂØπÂ∫îint result = p.age; 23.Ê≠ªÂæ™ÁéØsetÊñπÊ≥ï‰∏≠ - (void)setAge:(int)a &#123; self.age=a;&#125; ÂÆûÈôÖ‰∏äÊòØÂú®setÊñπÊ≥ï‰∏≠Ë∞ÉÁî®setÊñπÊ≥ï„ÄÇ - (int)age &#123; return self.age;&#125; Âú®getÊñπÊ≥ï‰∏≠Ë∞ÉÁî®getÊñπÊ≥ï„ÄÇ‰ª•‰∏äÁºñËØëÈìæÊé•ÂùáÊó†Ë≠¶Âëä„ÄÅÊó†ÈîôËØØÔºå‰ΩÜÊòØËøêË°å‰ºöÊä•Èîô„ÄÇ 24.ÊàêÂëòÂèòÈáèÁöÑ‰ΩúÁî®Âüü@privateÁßÅÊúâ„ÄÇÂè™ËÉΩÂú®ÂΩìÂâçÁ±ªÁöÑÂØπË±°ÊñπÊ≥ï‰∏≠Áõ¥Êé•ËÆøÈóÆÔºàÂΩìÂâçÁ±ªÁöÑÂØπË±°ÊñπÊ≥ïÁöÑ@implementation‰∏≠ËÆøÈóÆÔºâÔºåÂ≠êÁ±ªËôΩÁÑ∂ÁªßÊâøÔºàÂÜÖÂ≠ò‰∏≠Â≠òÂú®ÔºâÔºå‰ΩÜÊó†ÊùÉÈôêËÆøÈóÆ„ÄÇ @protected‰øùÊä§ÔºàÈªòËÆ§ÊòØ‰øùÊä§Ôºå‰∏çÊòØÁßÅÊúâÔºâ„ÄÇÂèØ‰ª•Âú®ÂΩìÂâçÁ±ªÂíåÂ≠êÁ±ªÁöÑÂØπË±°ÊñπÊ≥ï‰∏≠Áõ¥Êé•ËÆøÈóÆÔºàÂΩìÂâçÁ±ªÂíåÂ≠êÁ±ªÁöÑ@implementation‰∏≠ËÆøÈóÆÔºâ„ÄÇÂÅáËÆæÁà∂Á±ªPersonÊúâ‰øùÊä§ÁöÑÊàêÂëòÂèòÈáè_numberÔºåÂ≠êÁ±ªÁªßÊâøÔºå‰ªÄ‰πàÂèòÈáèÈÉΩ‰∏çÂ¢ûÂä†ÔºåÈÇ£‰πàÂ≠êÁ±ªÂØπË±°ÊñπÊ≥ï‰∏≠ËÆøÈóÆÁöÑÊòØÁà∂Á±ªÁöÑ_number„ÄÇ - (void)show &#123; self-&gt;_number = 1000; int result = self-&gt;_number; _number = 5000; int result2 = _number; NSLog(@"self-&gt;_numberÁöÑÂÄºÊòØÔºö%i",result); NSLog(@"_numberÁöÑÂÄºÊòØÔºö%i",result2);&#125; @publicÂÖ¨ÂºÄ„ÄÇ‰ªª‰ΩïÂú∞ÊñπÈÉΩÂèØ‰ª•ËÆøÈóÆ„ÄÇ‰∏ÄËà¨Áî®‰∏çÂà∞„ÄÇ @packageÂêå‰∏Ä‰∏™Ê°ÜÊû∂ÂÜÖÂèØ‰ª•ËÆøÈóÆÔºå‰ªã‰∫é@publicÂíå@private‰πãÈó¥„ÄÇ Ê≥®ÊÑèÁÇπ Âú®Á±ªÊñπÊ≥ï‰∏≠‰∏çÂèØËÉΩËÆøÈóÆÊàêÂëòÂèòÈáè„ÄÇ ‰πüÂèØ‰ª•Âú®@implementation‰∏≠Â£∞ÊòéÊàêÂëòÂèòÈáè„ÄÇ @implementation Student:NSObject &#123; @public int age; @private int number; @protected int no;&#125;@end 25.@propertyÂíå@synthesizeÂ±ûÊÄßÂêàÊàê@propertyÁî®Âú®@interface‰∏≠Ôºå‰ª£ÊõøgetÂíåsetÊñπÊ≥ïÂ¶ÇÔºö@property int age;Á≠â‰ª∑‰∫é - (int)age;- (void)setAge:(int)age; Âç≥‰æøÊòØ@property int _age;ÈÇ£‰πü‰ºöÁîüÊàê - (int)_age;- (void)setAge:(int)_age; ËÄå@synthesizeÁî®Âú®@implementationÂÆûÁé∞‰∏≠Ôºö@synthesize age = ÊàêÂëòÂèòÈáèÂêç; ‰∏çÂÖÅËÆ∏ÂØπÊàêÂëòÂèòÈáèËøõË°åÊù°‰ª∂ËøáÊª§ÔºåÂ¶Ç@synthesize age = _age+100; @synthesize age=_age; Á≠â‰ª∑‰∫é - (int)age &#123; return _age;&#125;- (void)setAge:(int)age &#123; _age=age;&#125; ÊÄªÁªì 1ÔºåÂ¶ÇÊûú.hÊñá‰ª∂‰∏≠Ê≤°ÊúâËøô‰∏™_ageÊàêÂëòÂèòÈáè„ÄÇÈÇ£‰πàÔºåÂà©Áî®@propertyÂèØ‰ª•Ëá™Âä®ÁîüÊàêÁßÅÊúâ@privateÁöÑ_age„ÄÇËÄåÈªòËÆ§ÁöÑ_ageÂç¥ÊòØ@protectedÁöÑ„ÄÇ 2Ôºå@synthesize ageÂ∞Ü‰ºöËÆøÈóÆageËøô‰∏™ÊàêÂëòÂèòÈáèËÄåÈùû_age„ÄÇ 3ÔºåËã•ÊâãÂä®ÂÆûÁé∞getterÊñπÊ≥ïÔºåÁºñËØëÂô®Âè™‰ºöËá™Âä®ÁîüÊàêsetterÊñπÊ≥ïÔºõËã•ÊâãÂä®ÂÆûÁé∞setterÊñπÊ≥ïÔºåÁºñËØëÂô®Âè™‰ºöËá™Âä®ÁîüÊàêgetterÊñπÊ≥ï„ÄÇ Êñ∞ÁâπÊÄß@propertyÂ∑≤ÁªèÁã¨ÊèΩ@synthesizeÁöÑÂÆûÁé∞‰∫ÜÔºå‰πüÂç≥ @synthesize age=_age;ÂèØ‰ª•ÁúÅÁï•„ÄÇÂè™Áî®ÂÜô@property int ageÂ∞±Â•Ω‰∫Ü„ÄÇÔºàÂΩìÁÑ∂ÔºåÂâçÊèêÊòØ‰∏çÂØπÂèÇÊï∞ËøõË°åËøáÊª§ÔºåÁõ¥Êé•‰º†Âà∞ÊàêÂëòÂèòÈáè‰∏≠ÔºåÂ¶ÇÊûúË¶ÅËøáÊª§ÔºåËøòÊòØË¶ÅËá™Â∑±ÁîüÊàêÁõ∏Â∫îÁöÑÊñπÊ≥ï„ÄÇÔºâ 26.idÁõ∏ÂΩì‰∫éNSObject * ÔºåÊòØ‰∏áËÉΩÊåáÈíà„ÄÇ idÁ±ªÂûãÁöÑÂÆö‰πâtypedef struct objc_object &#123; Class isa;&#125;*id; 27.ÊûÑÈÄ†ÊñπÊ≥ïÁî®Êù•ÂàùÂßãÂåñÂØπË±°ÁöÑÊñπÊ≥ïÔºåÂÆåÊï¥Âú∞ÂàõÂª∫‰∏Ä‰∏™ÂèØÁî®ÂØπË±°„ÄÇ Person *p = [Person alloc];+allocÊñπÊ≥ïÂàÜÈÖçÂ≠òÂÇ®Á©∫Èó¥ÔºåËøîÂõûÂØπË±°„ÄÇ p = [p init];-initÊñπÊ≥ïÂàùÂßãÂåñ„ÄÇ 28.initÊñπÊ≥ïÁöÑÈáçÂÜôÁõÆÁöÑÔºöÂú®ÂØπË±°ÂàõÂª∫ÂÆåÊØï‰πãÂêéÔºå‰ΩøÊàêÂëòÂèòÈáèÂ∞±Êúâ‰∫Ü‰∏Ä‰∫õÈªòËÆ§ÁöÑÂÄº„ÄÇÊ≥®ÊÑèÔºö‰∏ÄÂÆöË¶ÅÂÖàË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåÂÜçËøõË°åÂ≠êÁ±ªÂÜÖÈÉ®ÊàêÂëòÂèòÈáèÁöÑÂàùÂßãÂåñ„ÄÇÂú®@implementation‰∏≠ËøõË°åÈáçÂÜôÔºö - (id)init &#123; // ‰∏ÄÂÆöË¶ÅÂÖàË∞ÉÁî®superÁöÑinitÊñπÊ≥ïÔºåËøôÊòØ‰∏∫‰∫ÜÂàùÂßãÂåñÁà∂Á±ªÁöÑ‰∏Ä‰∫õÊàêÂëòÂèòÈáèÂíåÂÖ∂‰ªñÂ±ûÊÄß self = [super init]; // Âà§Êñ≠ÂØπË±°ÊòØÂê¶ÂàùÂßãÂåñÊàêÂäüÔºåÂ¶ÇÊûúÂØπË±°ÂàùÂßãÂåñÊàêÂäüÔºåÂÜçËøõË°åÊé•‰∏ãÊù•ÁöÑËá™ÂÆö‰πâÂàùÂßãÂåñ if(self != nil) &#123; _age=10086; &#125; // ËøîÂõû‰∏Ä‰∏™Â∑≤ÁªèÂàùÂßãÂåñÂÆåÊØïÁöÑÂØπË±° return self;&#125; ‰∏äÈù¢‰ª£Á†Å‰∏çÂ§üÁÆÄÂåñÔºå‰∏ÄËà¨Áî®‰∏ãÈù¢‰ª£Á†Å„ÄÇ - (id)init &#123; // ÁÆÄÂåñÁâà if([super init]) &#123; _age=10086; &#125; return self;&#125; 29.Ëá™ÂÆö‰πâÊûÑÈÄ†ÊñπÊ≥ïË¶ÅÊ±ÇÔºöÊòØÂØπË±°ÊñπÊ≥ïÔºàÂØπË±°ÁöÑÂàùÂßãÂåñÔºâÔºåËøîÂõûÂÄºÊòØidÁ±ªÂûãÔºåÊñπÊ≥ïÂêç‰ª•initWithÂºÄÂ§¥„ÄÇÊ≥®ÊÑèÔºö-initÊñπÊ≥ïÈáçÂÜô‰∏çÈúÄË¶ÅÂú®@interface‰∏≠Â£∞ÊòéÔºåÂõ†‰∏∫Â∑≤ÁªèÂ£∞ÊòéËøá‰∫ÜÔºåËÄåËá™ÂÆö‰πâÁöÑÊûÑÈÄ†ÊñπÊ≥ïÈúÄË¶ÅÂú®@interface‰∏≠ÊòæÂºèÂ£∞Êòé„ÄÇ // Â£∞Êòé- (id)initWithAge:(int)age; // ÂÆûÁé∞- (id)initWithAge:(int)age &#123; if([super init]) &#123; _age=age+100; &#125; return self;&#125; Ë∞ÉÁî®Á§∫‰æãÔºö Person *p = [Person alloc];p = [p init];int r = p.age;NSLog(@"rÁöÑÂÄºÊòØ%i",r); p= [p initWithAge:110];int r2 = p.age;NSLog(@"r2ÁöÑÂÄºÊòØ%i",r2); Âê´ÊúâÂ§ö‰∏™ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºö- (id)initWithAge:(int)age andNumber:(int)number; 30. .hÊñá‰ª∂Âíå.mÊñá‰ª∂ÊØè‰∏™Á±ªÂàÜÂ∏ÉÂú®‰∏çÂêåÁöÑÊñá‰ª∂‰∏≠Á±ªÁöÑÂ£∞ÊòéÊîæÂú®.hÊñá‰ª∂‰∏≠ÔºåÁ±ªÁöÑÂÆûÁé∞ÊîæÂú®.mÊñá‰ª∂‰∏≠Ëã•ÊÉ≥‰ΩøÁî®Êüê‰∏™Á±ªÔºåÂ∞±ÂåÖÂê´Êüê‰∏™Á±ªÁöÑ.hÊñá‰ª∂Âç≥ÂèØ„ÄÇ 31.ÂàÜÁ±ªÂú∫ÂêàÔºöÂú®‰∏ç‰øÆÊîπÂéüÊù•Á±ªÊ®°ÂûãÁöÑÊÉÖÂÜµ‰∏ãÔºåÁªôÁ±ªÊâ©ÂÖÖ‰∏Ä‰∫õÊñπÊ≥ïÔºå‰∏î‰ªÖÊòØÊñπÊ≥ïÔºå‰∏çÊâ©ÂÖÖÊàêÂëòÂèòÈáè„ÄÇÂèØ‰ª•ÁªôÁ≥ªÁªüËá™Â∏¶ÁöÑÁ±ªÊ∑ªÂä†ÂàÜÁ±ªÔºåÊâ©ÂÖÖÊñπÊ≥ï„ÄÇÔºàÊ≥®ÊÑèÂºïÂÖ•ÂàÜÁ±ªÊñá‰ª∂ÔºâÂΩìÊ∑ªÂä†ÂàÜÁ±ªÁöÑÊñπÊ≥ïÊòØÈáçÂÜôÂéüÊù•Á±ª‰∏≠ÁöÑÊñπÊ≥ïÊó∂,‰∏çÈúÄË¶ÅÂºïÂÖ•ÂàÜÁ±ªÊñá‰ª∂„ÄÇÂ£∞ÊòéÊñá‰ª∂ÁöÑÂëΩÂêçÊñπÂºè „ÄêÁ±ª+ÂàÜÁ±ª.h„Äë @interface Á±ªÂêç (ÂàÜÁ±ªÂêç)@end ÂÆûÁé∞Êñá‰ª∂ÁöÑÂëΩÂêçÊñπÂºè „ÄêÁ±ª+ÂàÜÁ±ª.m„Äë@implementation Á±ªÂêç (ÂàÜÁ±ªÂêç)@end ÁâπÂæÅÔºöÁî®Êã¨Âè∑Êã¨‰ΩèÊ∑ªÂä†ÁöÑÂàÜÁ±ªÂ•ΩÂ§ÑÔºö‰∏Ä‰∏™Â∫ûÂ§ßÁöÑÁ±ªÂèØ‰ª•ÂàÜÊ®°ÂùóÂºÄÂèë„ÄÅÁî±Â§ö‰∏™‰∫∫ÁºñÂÜôÔºåÊúâÂà©‰∫éÂõ¢ÈòüÂêà‰Ωú„ÄÇ Ê≥®ÊÑèÁÇπ1ÔºåÂàÜÁ±ªÂèØ‰ª•ËÆøÈóÆÂéüÊù•Á±ª‰∏≠ÁöÑÊàêÂëòÂèòÈáèÔºå‰ΩÜ‰∏çËÉΩÂ¢ûÂä†ÊàêÂëòÂèòÈáèÔºàËã•Ë¶ÅÂ¢ûÂä†ÊàêÂëòÂèòÈáèÔºåÂèØ‰ª•‰ΩøÁî®ÁªßÊâøÔºâ„ÄÇ 2ÔºåÂàÜÁ±ªÁöÑ‰ºòÂÖàÁ∫ßÊúÄÈ´òÔºåÂΩìË∞ÉÁî®Á±ª‰∏≠ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÊó∂Ôºå‰ºòÂÖàÂéªÂàÜÁ±ª‰∏≠Êü•ÊâæÔºåÂÜçÂéªÂéüÁ±ª‰∏≠Êü•ÊâæÔºåÊúÄÂêéÂéªÁà∂Á±ª‰∏≠Êü•Êâæ„ÄÇ‰πüÂç≥ÔºåÂÄòËã•Âú®ÂàÜÁ±ª‰∏≠ÈáçÂÜô‰∫ÜÂéüÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÔºå‰ºö‚ÄúË¶ÜÁõñ‚ÄùÊéâÂéüÊù•ÁöÑÊñπÊ≥ïÔºåÂØºËá¥ÂéüÊù•ÁöÑÊñπÊ≥ïÊó†Ê≥ï‰ΩøÁî®„ÄÇÔºà‰∏çÂª∫ËÆÆÈáçÂÜôÂéüÊù•Á±ª‰∏≠ÁöÑÊñπÊ≥ïÔºâÈáçÂÜô‰ºöÂá∫Áé∞Ë≠¶ÂëäÔºöCategory is implementing a method which will also be implemented by its primary class. 3ÔºåÂ¶ÇÊûúÂ§ö‰∏™ÂàÜÁ±ª‰∏≠ÊúâÁõ∏ÂêåÔºàÊñπÊ≥ïÁ≠æÂêçÁõ∏ÂêåÔºå‰ΩÜ‰∏ç‰∏ÄÊ†∑ÔºâÁöÑÊñπÊ≥ïÔºåÂàôË∞ÉÁî®ÁöÑÊòØÊúÄÂêéÁºñËØëÁöÑÊñπÊ≥ï„ÄÇ 32.Á±ªÁöÑÁßÅÊúâÊñπÊ≥ï ÊñπÂºè1ÔºåÁõ¥Êé•Âú®.mÊñá‰ª∂‰∏≠ÂÜôÊñπÊ≥ïÂÆûÁé∞Ôºå‰∏çË¶ÅÂú®.hÊñá‰ª∂‰∏≠ËøõË°åÊñπÊ≥ïÂ£∞Êòé ÊñπÂºè2ÔºåÂú®.mÊñá‰ª∂‰∏≠ÂÆö‰πâ‰∏Ä‰∏™categoryÔºåÁÑ∂ÂêéÂú®category‰∏≠Â£∞Êòé‰∏Ä‰∫õÊñπÊ≥ïÔºåÊúÄÂêéÂú®@implementationÂíå@end‰πãÈó¥‰ΩúÊñπÊ≥ïÂÆûÁé∞„ÄÇ 33.Á±ªÁöÑÊú¨Ë¥®Á±ª‰πüÊòØ‰∏Ä‰∏™ÂØπË±°ÔºåÊòØClassÁ±ªÂûãÁöÑÂØπË±°ÔºåÁÆÄÁß∞Á±ªÂØπË±°ÔºåÁ±ªÂØπË±°Â∞±ÊòØÁ±ª„ÄÇclassÁ±ªÂûãÁöÑÂÆö‰πâ:typedef struct objc_class *Class;Á±ªÂêç‰ª£Ë°®ÁùÄÁ±ªÂØπË±°ÔºåÊØè‰∏™Á±ªÂè™Êúâ‰∏Ä‰∏™Á±ªÂØπË±°„ÄÇ 34.+loadÂú®Á®ãÂ∫èÂêØÂä®ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂä†ËΩΩÊâÄÊúâÁöÑÁ±ªÂíåÂàÜÁ±ªÔºåÂπ∂Ë∞ÉÁî®‰∏ÄÊ¨°ÊâÄÊúâÁ±ªÂíåÂàÜÁ±ªÁöÑ+loadÊñπÊ≥ï„ÄÇ ÂÖàÂä†ËΩΩÁà∂Á±ªÔºåÂÜçÂä†ËΩΩÂ≠êÁ±ªÔºå‰πüÂç≥ÂÖàË∞ÉÁî®Áà∂Á±ªÁöÑ+loadÊñπÊ≥ïÔºåÂÜçË∞ÉÁî®Â≠êÁ±ªÁöÑ+loadÊñπÊ≥ï„ÄÇ ÂÖàÂä†ËΩΩÂéüÂßãÁ±ªÔºåÂÜçÂä†ËΩΩÂàÜÁ±ªÔºàÈ°∫Â∫è‰πüÂç≥Áà∂Á±ª‚Äî‚ÄîÁà∂Á±ªÁöÑÂàÜÁ±ª‚Äî‚ÄîÂ≠êÁ±ªÔºâ„ÄÇ ‰∏çÁÆ°Á®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠ÊúâÊ≤°ÊúâÁî®Âà∞Ëøô‰∏™Á±ªÔºåÈÉΩ‰ºöË∞ÉÁî®+loadÂä†ËΩΩ„ÄÇ 35.+initializeÂú®Á¨¨‰∏ÄÊ¨°‰ΩøÁî®Êüê‰∏™Á±ªÊó∂ÔºàÊØîÂ¶ÇÂàõÂª∫ÂØπË±°ÔºâÔºåÂ∞±‰ºöË∞ÉÁî®‰∏ÄÊ¨°+initializeÊñπÊ≥ï„ÄÇ‰∏Ä‰∏™Á±ªÂè™‰ºöË∞ÉÁî®‰∏ÄÊ¨°+initializeÊñπÊ≥ïÔºåÂÖàË∞ÉÁî®Áà∂Á±ªÁöÑÔºåÂÜçË∞ÉÁî®Â≠êÁ±ªÁöÑ„ÄÇËé∑ÂèñÁ±ªÂØπË±°ÁöÑ‰∏§ÁßçÊñπÂºè Class c = [Person class];//Á±ªÊñπÊ≥ï ÊàñËÄÖ Person *p = [Person new];Class c = [p class];//ÂØπË±°ÊñπÊ≥ï ÂæàÊòéÊòæÔºå[p class]Âíå[Person class]ÊñπÊ≥ïËøîÂõûÁöÑÈÉΩÊòØÊòØclassÁ±ªÂûãÁ±ªÂØπË±°Ë∞ÉÁî®Á±ªÊñπÊ≥ïÔºö Class c = [Person class];Person *p2 = [c new]; 36.descriptionÊñπÊ≥ïÁ±ª‰ººÂÖ∂‰ªñËØ≠Ë®ÄÁöÑToStringÊñπÊ≥ïÔºåNSObjectËá™Â∏¶ÁöÑÊñπÊ≥ï„ÄÇËøîÂõûÂÄºÁ±ªÂûãÊòØNSString Ôºä„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî®NSLogÂíå%@ÊâìÂç∞‰∏Ä‰∏™ÂØπË±°ÔºåËæìÂá∫ÁöÑÊòØ&lt;Á±ªÂêç:ÂÜÖÂ≠òÂú∞ÂùÄ&gt;ÔºåÂ¶ÇÔºö&lt;Person: 0x1002070a0&gt;ÔºåËÄåNSLog(@&quot;%@&quot;,p)‰ºöË∞ÉÁî®-descriptionÊñπÊ≥ï„ÄÇ -descriptionÊñπÊ≥ï‰ΩøÁî®NSLogÂíå%@ËæìÂá∫Êüê‰∏™ÂØπË±°Êó∂Ôºå‰ºöË∞ÉÁî®ÂØπË±°ÁöÑ-descriptionÊñπÊ≥ï„ÄÇ +descriptionÊñπÊ≥ï‰ΩøÁî®NSLogÂíå%@ËæìÂá∫Êüê‰∏™Á±ªÂØπË±°Êó∂Ôºå‰ºöË∞ÉÁî®Á±ªÂØπË±°ÁöÑ+descriptionÊñπÊ≥ï„ÄÇ ÂèØ‰ª•ÈáçÂÜô+descriptionÂíå-descriptionÊñπÊ≥ï‰øÆÊîπNSLogÁöÑÈªòËÆ§ËæìÂá∫Ê≥®ÊÑèÔºöÂ¶ÇÊûúÂú®-descriptionÊñπÊ≥ï‰∏≠‰ΩøÁî®NSLogÊâìÂç∞selfÔºå‰ºöÈÄ†ÊàêÊ≠ªÂæ™ÁéØ„ÄÇ // ÈáçÂÜô-descriptionÊñπÊ≥ï- (NSString *)description &#123; return [NSString stringWithFormat:@"%@", self]; &#125; ÁºñËØëÊó†Ë≠¶ÂëäÔºåÊó†Êä•ÈîôÔºåËøêË°åÂá∫Èîô„ÄÇÁúüÊ≠£ÈáçÂÜôÔºö // ÈáçÂÜô-descriptionÊñπÊ≥ï- (NSString *)description &#123; return [NSString stringWithFormat:@"ÂßìÂêçÔºö%@ Âπ¥ÈæÑÔºö%d", _name,_age];&#125; 37.SELÊØè‰∏™Á±ªÁöÑÊñπÊ≥ïÂàóË°®ÈÉΩÂ≠òÂÇ®Âú®Á±ªÂØπË±°‰∏≠ÔºåÊØè‰∏™ÊñπÊ≥ïÈÉΩÊúâ‰∏Ä‰∏™‰∏é‰πãÂØπÂ∫îÁöÑSELÔºåÊ†πÊçÆ‰∏Ä‰∏™SELÂ∞±ÂèØ‰ª•ÊâæÂà∞ÊñπÊ≥ïÁöÑÂú∞ÂùÄÔºåËøõËÄåË∞ÉÁî®ÊñπÊ≥ï„ÄÇSELÁ±ªÂûãÂÆö‰πâ typedef struct objc_selector *SEL;SELÁöÑËé∑ÂèñÔºö SEL s = @selector(test);SEL s2 = NSSelectorFromString(@"test"); Â∞ÜSELËΩ¨Êç¢‰∏∫NSStringÂØπË±°:NSString *s3=NSStringFromSelector(s); Ë∞ÉÁî®ÂØπË±°pÁöÑshowÊñπÊ≥ïÔºö // ÂàõÂª∫pÂØπË±°Person *p = [[Person alloc] init];// Â∞ÜshowÊñπÊ≥ïÂ∞ÅË£Ö‰∏∫SELÁ±ªÂûãÊï∞ÊçÆÁöÑsSEL s = @selector(show);// Ë∞ÉÁî®sÈó¥Êé•Ë∞ÉÁî®showÊñπÊ≥ï[p performSelector:s]; 38. [p test]ÂéüÁêÜËß£Èáä ÊäätestÂåÖË£ÖÊàêSELÁ±ªÂûãÁöÑÊï∞ÊçÆ„ÄÇ Ê†πÊçÆSELÊï∞ÊçÆÊâæÂà∞ÂØπÂ∫îÁöÑÊñπÊ≥ïÂú∞ÂùÄ„ÄÇ Ê†πÊçÆÊñπÊ≥ïÂú∞ÂùÄË∞ÉÁî®Áõ∏Â∫îÁöÑÊñπÊ≥ï„ÄÇÊ∂àÊÅØÂ∞±ÊòØSEL„ÄÇ 39.NSLogÊñπÊ≥ïÊÄªÁªì ÊâìÂç∞ÂØπË±°ÁöÑÂÜÖÂ≠òÂú∞ÂùÄ NSLog(@&quot;%p&quot;,p); ÊâìÂç∞ÊåáÈíàÁöÑÂÜÖÂ≠òÂú∞ÂùÄÔºà&amp;pÂèñÂá∫Âú∞ÂùÄÔºâ NSLog(@&quot;%p&quot;,&amp;p); ÊâìÂç∞Êüê‰∏ÄÂØπË±°ÔºàÈªòËÆ§ËøîÂõûÁ±ªÂêç+ÂÜÖÂ≠òÂú∞ÂùÄÔºåÂèØ‰ª•ÈÄöËøáÈáçÂÜô-descriptionÊñπÊ≥ïÊîπÂèòËæìÂá∫ÂÜÖÂÆπÔºâ NSLog(@&quot;%@&quot;,p); ÊâìÂç∞‰ª£Á†ÅË°åÂè∑ NSLog(@&quot;%d&quot;,__LINE__); ÊâìÂç∞Êñá‰ª∂Ë∑ØÂæÑ NSLog(@&quot;%d&quot;,__FILE__); Ê≥®ÊÑèÔºöÂ¶ÇÊûúÊñá‰ª∂Ë∑ØÂæÑ‰∏≠Â≠òÂú®‰∏≠ÊñáÔºåÂàôÊó†Ê≥ïËæìÂá∫ËøôÊó∂ÂèØ‰ª•‰ΩøÁî®Ôºö printf(&quot;%s\n&quot;__FILE__);ËæìÂá∫ÂåÖÂê´‰∏≠ÊñáÂ≠óÁ¨¶ÁöÑË∑ØÂæÑÔºà\nÂè™ÊòØ‰∏∫‰∫ÜËßÇÁúãÊ∏ÖÊô∞Ôºâ ÊâìÂç∞ÂΩìÂâçÂáΩÊï∞ÂêçÁß∞ NSLog(@&quot;%s&quot;,__func__); 40.‰ª£ÁêÜ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÁöÑÂàóË°®Ôºà‰∏çËÉΩÂ¢ûÂä†ÊàêÂëòÂèòÈáèÔºâ„ÄÇÂÖ∂‰∏≠Â£∞ÊòéÁöÑÊñπÊ≥ïÂèØ‰ª•Ë¢´‰ªª‰ΩïÁ±ªÂÆûÁé∞ÔºåËøôÁßçÊ®°Âºè‰∏ÄËà¨Áß∞‰Ωú‰ª£ÁêÜÔºàdelegationÔºâ„ÄÇÂ¶ÇÊûú‰∏Ä‰∫õÁ±ª‰πãÈó¥Ê≤°ÊúâÁªßÊâøÁöÑÂÖ≥Á≥ªÔºå‰ΩÜÊòØÊúâÊüê‰∫õÁõ∏ÂêåÁöÑË°å‰∏∫ÔºåËøôÊó∂Ë¶ÅËÄÉËôë‰ΩøÁî®‰ª£ÁêÜ„ÄÇ‰ª£ÁêÜÁöÑÂÆö‰πâÔºöÂΩì‰∏Ä‰ª£ÁêÜÂè™ÈíàÂØπÊüê‰∏™Á±ª‰∏≠Ôºå‰ª£ÁêÜÊúÄÂ•ΩÊîæÂú®‰∏Ä‰∏™Á±ªÁöÑ.hÊñá‰ª∂‰∏≠Ôºå‰ΩøÁî®Êó∂ÂºïÂÖ•Âç≥ÂèØ„ÄÇÔºàÂÅáÂÆöÂú®Person.hÊñá‰ª∂‰∏≠Ôºâ #import &lt;Foundation/Foundation.h&gt;@interface Person : NSObject@end // Ë¶ÅÂú®@interface‰πãÂ§ñËÆæÁΩÆ‰ª£ÁêÜ@protocol MyProtocol &lt;NSObject&gt;// ÂøÖÈ°ªÂÆûÁé∞ÁöÑÊñπÊ≥ï@required- (void)show;- (void)myShow;// ÂèØÈÄâÂÆûÁé∞ÁöÑÊñπÊ≥ï@optional+ (void)herShow;@end Âú®Dog.hÊñá‰ª∂‰∏≠ÈÅµÂÆàÂçèËÆÆÔºö #import &lt;Foundation/Foundation.h&gt;// Â£∞ÊòéÂçèËÆÆ@protocol MyProtocol;@protocol MyProtocol; @interface Dog : NSObject&lt;MyProtocol&gt;// ÈÅµÂÆàÊüê‰∏™ÂçèËÆÆ// Ê≥®ÊÑèÂØºÂÖ•ÂçèËÆÆÊñá‰ª∂#import "Person.h"ÊàñËÄÖÂ£∞ÊòéÂçèËÆÆ@protocol MyProtocol;- (void)show;- (void)myShow;@end ÂΩìÊüê‰∏Ä‰ª£ÁêÜÁî®Âú®Â§ö‰∏™Á±ª‰∏≠ÔºåÂçèËÆÆÈúÄË¶ÅÊîæÂú®ÂçïÁã¨ÂàõÂª∫ÁöÑ.hÊñá‰ª∂‰∏≠Ê≠§Êó∂ÂàõÂª∫ÁöÑÂè™Êúâ‰∏Ä‰∏™Âêç‰∏∫BigProtocolÁöÑ.hÊñá‰ª∂„ÄÇ #import &lt;Foundation/Foundation.h&gt; @protocol BigProtocol &lt;NSObject&gt;@required- (void)bigShow;@optional- (void)bigShow2;@end Âú®Cat.hÊñá‰ª∂‰∏≠ÈÅµÂÆàÂçèËÆÆ #import &lt;Foundation/Foundation.h&gt;//@protocol BigProtocol;#import "BigProtocol.h"@interface Cat : NSObject&lt;BigProtocol&gt;- (void)bigShow;@end Âú®Dog.hÊñá‰ª∂‰∏≠ÈÅµÂÆàÂçèËÆÆ #import &lt;Foundation/Foundation.h&gt;//@protocol BigProtocol;#import "BigProtocol.h"@interface _Dog : NSObject&lt;BigProtocol&gt;- (void)bigShow;- (void)bigShow2;@end Ê≥®ÊÑèÁÇπ Âú®ÈÅµÂÆàÂçèËÆÆÊó∂ÔºåÂ¶ÇÊûú‰ΩøÁî®@protocol BigProtocol;ÁºñËØëÂô®‰ºöË≠¶ÂëäÔºöÊó†Ê≥ïÊâæÂà∞ÂçèËÆÆÁöÑÂÆö‰πâËÄå‰ΩøÁî®#import &quot;BigProtocol.h&quot;ÔºåÂàôÂÆåÂÖ®Ê≤°ÊúâÈóÆÈ¢ò„ÄÇ Â¶ÇÊûúÊüê‰∏™Á±ªÈÅµÂÆàÂ§ö‰∏™ÂçèËÆÆÔºåÂçèËÆÆ‰πãÈó¥Áî®ÈÄóÂè∑ÂàÜÈöîÔºö @interface Cat : NSObject&lt;BigProtocol,MyProtocol&gt; ‰∏Ä‰∏™ÂçèËÆÆÊú¨Ë∫´ÂèØ‰ª•ÈÅµÂÆàÂÖ∂‰ªñÂçèËÆÆÔºåÂ¶ÇÈÅµÂÆàÂêçÂ≠óÂè´NSObjectÁöÑÂçèËÆÆÔºàÈªòËÆ§ÊòØËøôÁßçÊÉÖÂÜµÔºåÂü∫ÂçèËÆÆNSObjectÔºâÂ¶ÇÊûúAÂçèËÆÆÈÅµÂÆàBÂçèËÆÆÔºåËøôÊó∂AÂçèËÆÆÂ∞±ËÉΩÊã•ÊúâBÂçèËÆÆÁöÑÊâÄÊúâÊñπÊ≥ïÂ£∞Êòé„ÄÇ @protocol BigProtocol &lt;NSObject&gt; @end BigProtocolÊã•ÊúâNSObjectÂçèËÆÆÁöÑÊâÄÊúâÊñπÊ≥ïÂ£∞Êòé„ÄÇ Á∫¶ÂÆöÊ°ÜÊû∂‰∏≠ÂêéÁºÄ‰∏∫DelegateÁöÑÈÉΩÊòØÂçèËÆÆ„ÄÇÔºàÂçèËÆÆÁ±ª‰ººÂÖ∂‰ªñËØ≠Ë®ÄÁöÑÊé•Âè£ÔºåÂ∞±ÂÉèC#‰∏≠ÈªòËÆ§‰ª•IÂºÄÂ§¥ÁöÑÈÉΩÊòØÊé•Âè£ Ôºâ Ë¶ÅÊ±ÇÊüê‰∏™ÂØπË±°ÂøÖÈ°ªÈÅµÂÆàÊüê‰∏™ÂçèËÆÆÔºàÂ¶ÇË¶ÅÊ±Çobj‰øùÂ≠òÁöÑÂØπË±°ÈÅµÂÆàÂçèËÆÆMyProtocolÔºåÂπ∂‰∏îÁªßÊâøPersonÔºâ Person&lt;MyProtocol&gt; *obj = [[Person alloc] init]; Âà©Áî®conformsToProtocol:Âà§Êñ≠Êüê‰∏™Á±ªÊòØÂê¶ÂÆûÁé∞‰∫ÜÊüê‰∏™ÂçèËÆÆ Cat *c = [[Cat alloc] init ]; bool result = [c conformsToProtocol:@protocol(BigProtocol)]; NSLog(@&quot;%@&quot;,result?@&quot;YES&quot;:@&quot;NO&quot;); [c conformsToProtocol:@protocol(BigProtocol)];ËøîÂõûÁöÑÊòØboolÁ±ªÂûã„ÄÇ 41.blockÂùó„ÄÇÊúâËøîÂõûÂÄºÔºàvoid‰πüÂèØ‰ª•Ôºâ„ÄÅÊúâÂΩ¢ÂèÇ„ÄÇblockÂ∞ÅË£Ö‰∫Ü‰∏ÄÊÆµ‰ª£Á†ÅÔºåÂèØ‰ª•Âú®‰ªª‰ΩïÊó∂ÂÄôÊâßË°å„ÄÇblockÂèØ‰ª•‰Ωú‰∏∫ÂáΩÊï∞ÂèÇÊï∞ÊàñËÄÖÂáΩÊï∞ËøîÂõûÂÄºÔºåËÄåÂÖ∂Êú¨Ë∫´ÂèàÂèØ‰ª•Â∏¶ËæìÂÖ•ÂèÇÊï∞ÂíåËøîÂõûÂÄº„ÄÇÂú®Â§öÁ∫øÁ®ãÔºåÂºÇÊ≠•‰ªªÂä°ÔºåÈõÜÂêàÈÅçÂéÜÔºåÈõÜÂêàÊéíÂ∫èÔºåÂä®Áîª‰∏ìÂú∫‰ΩøÁî®ËæÉÂ§ö„ÄÇ ÂÆö‰πâ: ËøîÂõûÂÄºÁ±ªÂûã (^+blockÂêçÁß∞)(ÂèÇÊï∞Á±ªÂûãÂàóË°®)=^(ÂèÇÊï∞ÂàóË°®){ ‰ª£Á†ÅÂÜÖÂÆπ }; Ê≥®ÊÑèÂ§ßÊã¨Âè∑ÂêéÈù¢ÊúâÂàÜÂè∑ ÂØπÊØîÂáΩÊï∞ int (^MySum)(int ,int )=^(int a,int b)&#123; return a+b;&#125;;int MySum (int a,int b)&#123;return a+b;&#125; blockÂèØ‰ª•ËÆøÈóÆÂ±ÄÈÉ®ÂèòÈáèÔºå‰ΩÜ‰∏çËÉΩÊõ¥ÊîπÂ±ÄÈÉ®ÂèòÈáè„ÄÇÂ¶ÇÊûúÊõ¥ÊîπÂàôÊä•ÈîôÔºöVariable is not assignable (missing__block type specifier)ÔºåÂ¶ÇÔºö int c = 10;// BlockÁöÑÂÆö‰πâint (^MySum)(int ,int ) = ^(int a,int b) &#123; c = 21; return a + b + c;&#125;;NSLog(@"%i",MySum(10,20)); Â¶ÇÊûúÁ°¨ÊòØË¶Å‰øÆÊîπÔºöÂú®Â±ÄÈÉ®ÂèòÈáèÂâçÈù¢Âä†‰∏ä__block ÔºåÂ¶Ç __block int c=21;ËøôÊó∂Ôºå‰æøÂèØ‰ª•Âú®block‰∏≠‰øÆÊîπÂ±ÄÈÉ®ÂèòÈáè‰∫Ü„ÄÇ __block int c=10;// BlockÁöÑÂÆö‰πâint (^MySum)(int ,int ) = ^(int a,int b) &#123; c = 21; return a + b + c;&#125;;NSLog(@"%i",MySum(10,20)); blockÁöÑË∞ÉÁî®ÔºåÂíåÂáΩÊï∞‰∏ÄÊ†∑Ôºå‰ΩøÁî®ÂêçÁß∞Âç≥ÂèØÔºöMySum(ÂΩ¢ÂèÇÂàóË°®); Â¶ÇÊûúblockÊ≤°ÊúâÂΩ¢ÂèÇÔºåÂàôÂèØ‰ª•ÁúÅÁï•Á≠âÂè∑ÂêéÈù¢ÁöÑ()Â¶ÇÔºö int (^SomeSum)()=^{return 25;};‰ΩÜÊòØÁ≠âÂè∑ÂâçÈù¢ÁöÑ‰∏§ÂØπÊã¨Âè∑‰∏çÂèØÁúÅÁï•„ÄÇ Âà©Áî®typedefÂ£∞ÊòéÁ±ªÂûã Ê†ºÂºèÔºötypedef ËøîÂõûÂÄºÁ±ªÂûã (^blockÂùóÂêçÁß∞)(ÂèÇÊï∞_Á±ªÂûãÂàóË°®)‰æãÂ¶ÇÔºötypedef int (^MyBlock)(int,int); ‰ª•ÂêéÂ∞±ÂèØ‰ª•Áî®MyBlockËøôÁßçÁ±ªÂûãÂÆö‰πâBlockÂèòÈáèMyBlock m = ^(int a,int b)&#123;return a+b;&#125;;int c = m(15,25);NSLog(@"%i",c);]]></content>
      <tags>
        <tag>Objective-C</tag>
        <tag>Á¨îËÆ∞</tag>
      </tags>
  </entry>
</search>
