<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="读「FDFullscreenPopGesture」"/>




  <meta name="keywords" content="iOS开发,阅读," />




  <link rel="alternate" href="/atom.xml" title="Ya">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.4.x" />



<link rel="canonical" href="http://blog.chenyalun.com/2019/04/25/读「FDFullscreenPopGesture」/"/>


<meta name="description" content="优雅地开启全屏侧滑手势。">
<meta name="keywords" content="iOS开发,阅读">
<meta property="og:type" content="article">
<meta property="og:title" content="读「FDFullscreenPopGesture」">
<meta property="og:url" content="http://blog.chenyalun.com/2019/04/25/读「FDFullscreenPopGesture」/index.html">
<meta property="og:site_name" content="Ya">
<meta property="og:description" content="优雅地开启全屏侧滑手势。">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="https://image.chenyalun.com/2019/04/23/001.png">
<meta property="og:image" content="https://image.chenyalun.com/2019/04/23/002.png">
<meta property="og:updated_time" content="2019-04-24T02:25:10.903Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="读「FDFullscreenPopGesture」">
<meta name="twitter:description" content="优雅地开启全屏侧滑手势。">
<meta name="twitter:image" content="https://image.chenyalun.com/2019/04/23/001.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.4.x" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  



    <title> 读「FDFullscreenPopGesture」 · Ya </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Ya</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags/阅读/">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Ya</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              时间线
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags/阅读/">
            
            
              阅读
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          读「FDFullscreenPopGesture」
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2019年4月25日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用"><span class="toc-text">使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原理"><span class="toc-text">原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#接口"><span class="toc-text">接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#源码阅读"><span class="toc-text">源码阅读</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FDFullscreenPopGestureRecognizerDelegate"><span class="toc-text">_FDFullscreenPopGestureRecognizerDelegate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UIViewController-FDFullscreenPopGesturePrivate"><span class="toc-text">UIViewController (FDFullscreenPopGesturePrivate)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UINavigationController-FDFullscreenPopGesture"><span class="toc-text">UINavigationController (FDFullscreenPopGesture)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UIViewController-FDFullscreenPopGesture"><span class="toc-text">UIViewController (FDFullscreenPopGesture)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method-Swizzling复习"><span class="toc-text">Method Swizzling复习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#实例方法交换"><span class="toc-text">实例方法交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类方法交换"><span class="toc-text">类方法交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法二次交换是否会影响第一次交换（造成第一次交换失效）？"><span class="toc-text">方法二次交换是否会影响第一次交换（造成第一次交换失效）？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义侧滑手势"><span class="toc-text">自定义侧滑手势</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p></p><p align="center"> 优雅地开启全屏侧滑手势。 </p><br><a id="more"></a><p></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>作者给UINavigationController和UIViewController都添加了分类，并进行了默认的参数设置，因此不做任何配置就能拥有这个功能。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>作者通过方法交换，hook到系统原生push方法中的手势中的target和动画调用selector，创建自己的UIPanGestureRecognizer，并设置它的target和selector。</p>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2> <figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@interface</span> UINavigationController (FDFullscreenPopGesture)</span><br><span class="line"><span class="comment">// 获取重新实现的侧滑返回手势对象</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, strong, readonly) UIPanGestureRecognizer *fd_fullscreenPopGestureRecognizer;</span><br><span class="line"><span class="comment">// 是否允许视图控制器单独管理它对应的NavigationBar显示与隐藏.默认是YES</span></span><br><span class="line"><span class="comment">// 这个需要配合视图控制器的fd_prefersNavigationBarHidden属性来使用</span></span><br><span class="line"><span class="comment">// 也就是说如果把这个属性设置为NO, 视图控制器对应的导航栏的隐藏与否不由视图控制器决定</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, assign) BOOL fd_viewControllerBasedNavigationBarAppearanceEnabled;</span><br><span class="line"><span class="variable">@end</span></span><br><span class="line">  </span><br><span class="line"><span class="variable">@interface</span> UIViewController (FDFullscreenPopGesture)</span><br><span class="line"><span class="comment">// 是否禁用全屏侧滑手势(默认NO)</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, assign) BOOL fd_interactivePopDisabled;</span><br><span class="line"><span class="comment">// 表明当前控制器的导航栏是显示还是隐藏, 默认NO (显示导航栏)</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, assign) BOOL fd_prefersNavigationBarHidden;</span><br><span class="line"><span class="comment">// 设置能够响应侧滑的最大边界(距离)</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, assign) CGFloat fd_interactivePopMaxAllowedInitialDistanceToLeftEdge;</span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure>
<h2 id="源码阅读"><a href="#源码阅读" class="headerlink" title="源码阅读"></a>源码阅读</h2><h3 id="FDFullscreenPopGestureRecognizerDelegate"><a href="#FDFullscreenPopGestureRecognizerDelegate" class="headerlink" title="_FDFullscreenPopGestureRecognizerDelegate"></a>_FDFullscreenPopGestureRecognizerDelegate</h3><p><code>_FDFullscreenPopGestureRecognizerDelegate</code>对象。遵循<code>UIGestureRecognizerDelegate</code>协议，主要用于决定控制器是否能响应手势。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">_FDFullscreenPopGestureRecognizerDelegate</span> : <span class="title">NSObject</span> &lt;<span class="title">UIGestureRecognizerDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="built_in">UINavigationController</span> *navigationController;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">_FDFullscreenPopGestureRecognizerDelegate</span></span></span><br><span class="line">- (<span class="built_in">BOOL</span>)gestureRecognizerShouldBegin:(<span class="built_in">UIPanGestureRecognizer</span> *)gestureRecognizer &#123;</span><br><span class="line">    <span class="comment">// 栈的最顶层, 不需要响应手势</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.navigationController.viewControllers.count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 打开了禁用手势的开关</span></span><br><span class="line">    <span class="built_in">UIViewController</span> *topViewController = <span class="keyword">self</span>.navigationController.viewControllers.lastObject;</span><br><span class="line">    <span class="keyword">if</span> (topViewController.fd_interactivePopDisabled) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 超过自己设置的left edge</span></span><br><span class="line">    <span class="built_in">CGPoint</span> beginningLocation = [gestureRecognizer locationInView:gestureRecognizer.view];</span><br><span class="line">    <span class="built_in">CGFloat</span> maxAllowedInitialDistance = topViewController.fd_interactivePopMaxAllowedInitialDistanceToLeftEdge;</span><br><span class="line">    <span class="keyword">if</span> (maxAllowedInitialDistance &gt; <span class="number">0</span> &amp;&amp; beginningLocation.x &gt; maxAllowedInitialDistance) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 正在执行Transition动画</span></span><br><span class="line">    <span class="keyword">if</span> ([[<span class="keyword">self</span>.navigationController valueForKey:<span class="string">@"_isTransitioning"</span>] boolValue]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 手机横屏状态下, 适配侧滑方向</span></span><br><span class="line">    <span class="comment">// It tells you how far the touch moved since it was last reset. It resets when the touch goes down or if you reset it yourself.</span></span><br><span class="line">    <span class="built_in">CGPoint</span> translation = [gestureRecognizer translationInView:gestureRecognizer.view];</span><br><span class="line">    <span class="built_in">BOOL</span> isLeftToRight = [<span class="built_in">UIApplication</span> sharedApplication].userInterfaceLayoutDirection == <span class="built_in">UIUserInterfaceLayoutDirectionLeftToRight</span>;</span><br><span class="line">    <span class="built_in">CGFloat</span> multiplier = isLeftToRight ? <span class="number">1</span> : - <span class="number">1</span>; <span class="comment">// 只能是从左向右滑</span></span><br><span class="line">    <span class="keyword">if</span> ((translation.x * multiplier) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="UIViewController-FDFullscreenPopGesturePrivate"><a href="#UIViewController-FDFullscreenPopGesturePrivate" class="headerlink" title="UIViewController (FDFullscreenPopGesturePrivate)"></a>UIViewController (FDFullscreenPopGesturePrivate)</h3><p>UIViewController的分类。给其添加关联属性<code>fd_willAppearInjectBlock</code>。hook <code>viewWillAppear</code>方法并在其中调用<code>fd_willAppearInjectBlock</code>回调，hook <code>viewWillDisappear</code>方法，并在其中根据控制器的<code>fd_prefersNavigationBarHidden</code>属性来设置状态栏的显示与否。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (^_FDViewControllerWillAppearInjectBlock)(<span class="built_in">UIViewController</span> *viewController, <span class="built_in">BOOL</span> animated);</span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIViewController</span> (<span class="title">FDFullscreenPopGesturePrivate</span>)</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) _FDViewControllerWillAppearInjectBlock fd_willAppearInjectBlock;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIViewController</span> (<span class="title">FDFullscreenPopGesturePrivate</span>)</span></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="comment">// 方法交换, viewWillAppear和fd_viewWillAppear互换, viewWillDisappear和fd_viewWillDisappear互换</span></span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        Method viewWillAppear_originalMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(viewWillAppear:));</span><br><span class="line">        Method viewWillAppear_swizzledMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(fd_viewWillAppear:));</span><br><span class="line">        method_exchangeImplementations(viewWillAppear_originalMethod, viewWillAppear_swizzledMethod);</span><br><span class="line">    </span><br><span class="line">        Method viewWillDisappear_originalMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(viewWillDisappear:));</span><br><span class="line">        Method viewWillDisappear_swizzledMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(fd_viewWillDisappear:));</span><br><span class="line">        method_exchangeImplementations(viewWillDisappear_originalMethod, viewWillDisappear_swizzledMethod);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)fd_viewWillAppear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    <span class="comment">// 主类的实现 Forward to primary implementation.</span></span><br><span class="line">    [<span class="keyword">self</span> fd_viewWillAppear:animated];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.fd_willAppearInjectBlock) &#123;</span><br><span class="line">        <span class="keyword">self</span>.fd_willAppearInjectBlock(<span class="keyword">self</span>, animated);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)fd_viewWillDisappear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    <span class="comment">// Forward to primary implementation.</span></span><br><span class="line">    [<span class="keyword">self</span> fd_viewWillDisappear:animated];</span><br><span class="line">    <span class="comment">// 延迟为0相当于直接调用异步</span></span><br><span class="line">    <span class="comment">// dispatch_async(dispatch_get_main_queue(), ^&#123;&#125;);</span></span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">0</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        <span class="built_in">UIViewController</span> *viewController = <span class="keyword">self</span>.navigationController.viewControllers.lastObject;</span><br><span class="line">        <span class="comment">// viewController存在而且它的fd_prefersNavigationBarHidden为NO, 把NavigationBar显示出来</span></span><br><span class="line">        <span class="keyword">if</span> (viewController &amp;&amp; !viewController.fd_prefersNavigationBarHidden) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.navigationController setNavigationBarHidden:<span class="literal">NO</span> animated:<span class="literal">NO</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (_FDViewControllerWillAppearInjectBlock)fd_willAppearInjectBlock &#123;</span><br><span class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, _cmd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFd_willAppearInjectBlock:(_FDViewControllerWillAppearInjectBlock)block &#123;</span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, <span class="keyword">@selector</span>(fd_willAppearInjectBlock), block, OBJC_ASSOCIATION_COPY_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="UINavigationController-FDFullscreenPopGesture"><a href="#UINavigationController-FDFullscreenPopGesture" class="headerlink" title="UINavigationController (FDFullscreenPopGesture)"></a>UINavigationController (FDFullscreenPopGesture)</h3><p>UINavigationController的分类。hook<code>pushViewController:animated:</code>方法，给响应push手势的view添加自定义的<code>fd_fullscreenPopGestureRecognizer</code>手势。当然，<code>fd_fullscreenPopGestureRecognizer</code>的target和selector与push原生手势的target及selector保持一致。除此之外，<code>fd_fullscreenPopGestureRecognizer</code>手势的代理是上面的<code>_FDFullscreenPopGestureRecognizerDelegate</code>对象，目的是决定是否响应手势。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UINavigationController</span> (<span class="title">FDFullscreenPopGesture</span>)</span></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    <span class="comment">// Inject "-pushViewController:animated:"</span></span><br><span class="line">    <span class="comment">// 交换pushViewController与fd_pushViewController</span></span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        Class <span class="keyword">class</span> = [<span class="keyword">self</span> <span class="keyword">class</span>];</span><br><span class="line">        </span><br><span class="line">        SEL originalSelector = <span class="keyword">@selector</span>(pushViewController:animated:);</span><br><span class="line">        SEL swizzledSelector = <span class="keyword">@selector</span>(fd_pushViewController:animated:);</span><br><span class="line">        </span><br><span class="line">        Method originalMethod = class_getInstanceMethod(<span class="keyword">class</span>, originalSelector);</span><br><span class="line">        Method swizzledMethod = class_getInstanceMethod(<span class="keyword">class</span>, swizzledSelector);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">BOOL</span> success = class_addMethod(<span class="keyword">class</span>, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod));</span><br><span class="line">        <span class="keyword">if</span> (success) &#123;</span><br><span class="line">            class_replaceMethod(<span class="keyword">class</span>, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            method_exchangeImplementations(originalMethod, swizzledMethod);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)fd_pushViewController:(<span class="built_in">UIViewController</span> *)viewController</span><br><span class="line">                     animated:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    <span class="comment">// 保证view只添加一次fd_fullscreenPopGestureRecognizer手势</span></span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.interactivePopGestureRecognizer.view.gestureRecognizers containsObject:<span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Add our own gesture recognizer to where the onboard screen edge pan gesture recognizer is attached to.</span></span><br><span class="line">        [<span class="keyword">self</span>.interactivePopGestureRecognizer.view addGestureRecognizer:<span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取私有变量target和selector</span></span><br><span class="line">        <span class="built_in">NSArray</span> *internalTargets = [<span class="keyword">self</span>.interactivePopGestureRecognizer valueForKey:<span class="string">@"targets"</span>];</span><br><span class="line">        <span class="keyword">id</span> internalTarget = [internalTargets.firstObject valueForKey:<span class="string">@"target"</span>];</span><br><span class="line">        SEL internalAction = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"handleNavigationTransition:"</span>);</span><br><span class="line">        <span class="comment">// 设置滑动手势的代理</span></span><br><span class="line">        <span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer.delegate = <span class="keyword">self</span>.fd_popGestureRecognizerDelegate;</span><br><span class="line">        [<span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer addTarget:internalTarget action:internalAction];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用原生的手势</span></span><br><span class="line">        <span class="keyword">self</span>.interactivePopGestureRecognizer.enabled = <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 处理navigation bar 的显示与隐藏</span></span><br><span class="line">    [<span class="keyword">self</span> fd_setupViewControllerBasedNavigationBarAppearanceIfNeeded:viewController];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 调用原来的方法实现(加一个判断, 避免重复push)</span></span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.viewControllers containsObject:viewController]) &#123;</span><br><span class="line">        [<span class="keyword">self</span> fd_pushViewController:viewController animated:animated];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)fd_setupViewControllerBasedNavigationBarAppearanceIfNeeded:(<span class="built_in">UIViewController</span> *)appearingViewController &#123;</span><br><span class="line">    <span class="comment">// 如果fd_viewControllerBasedNavigationBarAppearanceEnabled设置为NO, 直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.fd_viewControllerBasedNavigationBarAppearanceEnabled) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 配合fd_prefersNavigationBarHidden来使用</span></span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line">    _FDViewControllerWillAppearInjectBlock block = ^(<span class="built_in">UIViewController</span> *viewController, <span class="built_in">BOOL</span> animated) &#123;</span><br><span class="line">        __<span class="keyword">strong</span> <span class="keyword">typeof</span>(weakSelf) strongSelf = weakSelf;</span><br><span class="line">        <span class="keyword">if</span> (strongSelf) &#123;</span><br><span class="line">            [strongSelf setNavigationBarHidden:viewController.fd_prefersNavigationBarHidden animated:animated];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置appearingViewController、disappearingViewController的fd_willAppearInjectBlock</span></span><br><span class="line">    appearingViewController.fd_willAppearInjectBlock = block;</span><br><span class="line">    <span class="built_in">UIViewController</span> *disappearingViewController = <span class="keyword">self</span>.viewControllers.lastObject;</span><br><span class="line">    <span class="keyword">if</span> (disappearingViewController &amp;&amp; !disappearingViewController.fd_willAppearInjectBlock) &#123;</span><br><span class="line">        disappearingViewController.fd_willAppearInjectBlock = block;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (_FDFullscreenPopGestureRecognizerDelegate *)fd_popGestureRecognizerDelegate &#123;</span><br><span class="line">    _FDFullscreenPopGestureRecognizerDelegate *delegate = objc_getAssociatedObject(<span class="keyword">self</span>, _cmd);</span><br><span class="line">    <span class="comment">// 只初始化delegate一次</span></span><br><span class="line">    <span class="keyword">if</span> (!delegate) &#123;</span><br><span class="line">        delegate = [[_FDFullscreenPopGestureRecognizerDelegate alloc] init];</span><br><span class="line">        delegate.navigationController = <span class="keyword">self</span>;</span><br><span class="line">        </span><br><span class="line">        objc_setAssociatedObject(<span class="keyword">self</span>, _cmd, delegate, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> delegate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIPanGestureRecognizer</span> *)fd_fullscreenPopGestureRecognizer &#123;</span><br><span class="line">    <span class="built_in">UIPanGestureRecognizer</span> *panGestureRecognizer = objc_getAssociatedObject(<span class="keyword">self</span>, _cmd);</span><br><span class="line">    <span class="comment">// 只初始化panGestureRecognizer一次</span></span><br><span class="line">    <span class="keyword">if</span> (!panGestureRecognizer) &#123;</span><br><span class="line">        panGestureRecognizer = [[<span class="built_in">UIPanGestureRecognizer</span> alloc] init];</span><br><span class="line">        panGestureRecognizer.maximumNumberOfTouches = <span class="number">1</span>;</span><br><span class="line">        objc_setAssociatedObject(<span class="keyword">self</span>, _cmd, panGestureRecognizer, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> panGestureRecognizer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)fd_viewControllerBasedNavigationBarAppearanceEnabled &#123;</span><br><span class="line">    <span class="built_in">NSNumber</span> *number = objc_getAssociatedObject(<span class="keyword">self</span>, _cmd);</span><br><span class="line">    <span class="keyword">if</span> (number) &#123; <span class="comment">// BOOL值被封装成对象了</span></span><br><span class="line">        <span class="keyword">return</span> number.boolValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 走到这一步说明还没有设置过关联属性, 手动设置</span></span><br><span class="line">    <span class="keyword">self</span>.fd_viewControllerBasedNavigationBarAppearanceEnabled = <span class="literal">YES</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFd_viewControllerBasedNavigationBarAppearanceEnabled:(<span class="built_in">BOOL</span>)enabled &#123;</span><br><span class="line">    SEL key = <span class="keyword">@selector</span>(fd_viewControllerBasedNavigationBarAppearanceEnabled);</span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, key, @(enabled), OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="UIViewController-FDFullscreenPopGesture"><a href="#UIViewController-FDFullscreenPopGesture" class="headerlink" title="UIViewController (FDFullscreenPopGesture)"></a>UIViewController (FDFullscreenPopGesture)</h3><p>UIViewController的分类。给其添加关联属性<code>fd_interactivePopDisabled</code>、<code>fd_interactivePopMaxAllowedInitialDistanceToLeftEdge</code>和<code>fd_prefersNavigationBarHidden</code>。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIViewController</span> (<span class="title">FDFullscreenPopGesture</span>)</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)fd_interactivePopDisabled &#123;</span><br><span class="line">    <span class="comment">// 关于_cmd: 这行代码等价于 return [objc_getAssociatedObject(self, @selector(fd_interactivePopDisabled)) boolValue];</span></span><br><span class="line">    <span class="keyword">return</span> [objc_getAssociatedObject(<span class="keyword">self</span>, _cmd) boolValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFd_interactivePopDisabled:(<span class="built_in">BOOL</span>)disabled &#123;</span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, <span class="keyword">@selector</span>(fd_interactivePopDisabled), @(disabled), OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)fd_prefersNavigationBarHidden &#123;</span><br><span class="line">    <span class="keyword">return</span> [objc_getAssociatedObject(<span class="keyword">self</span>, _cmd) boolValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFd_prefersNavigationBarHidden:(<span class="built_in">BOOL</span>)hidden &#123;</span><br><span class="line">    <span class="comment">// 存储的时候需要把基本数据类型包装成对象 @(hidden)</span></span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, <span class="keyword">@selector</span>(fd_prefersNavigationBarHidden), @(hidden), OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)fd_interactivePopMaxAllowedInitialDistanceToLeftEdge &#123;</span><br><span class="line"><span class="meta">#if CGFLOAT_IS_DOUBLE // CGFLOAT_IS_DOUBLE宏: 64位下是1 否则0, 特别严谨</span></span><br><span class="line">    <span class="keyword">return</span> [objc_getAssociatedObject(<span class="keyword">self</span>, _cmd) doubleValue];</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">    <span class="keyword">return</span> [objc_getAssociatedObject(<span class="keyword">self</span>, _cmd) floatValue];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setFd_interactivePopMaxAllowedInitialDistanceToLeftEdge:(<span class="built_in">CGFloat</span>)distance &#123;</span><br><span class="line">    SEL key = <span class="keyword">@selector</span>(fd_interactivePopMaxAllowedInitialDistanceToLeftEdge);</span><br><span class="line">    <span class="comment">// 使用@(MAX(0, distance), 适配distance被外界设置为负值的情况</span></span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, key, @(MAX(<span class="number">0</span>, distance)), OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h2 id="Method-Swizzling复习"><a href="#Method-Swizzling复习" class="headerlink" title="Method Swizzling复习"></a>Method Swizzling复习</h2><h3 id="实例方法交换"><a href="#实例方法交换" class="headerlink" title="实例方法交换"></a>实例方法交换</h3><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line">- (<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"原始的方法实现"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span> (<span class="title">MethodSwizzling</span>)</span></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        Method viewWillAppear_originalMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(viewWillAppear:));</span><br><span class="line">        Method viewWillAppear_swizzledMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(ya_viewWillAppear:));</span><br><span class="line">        method_exchangeImplementations(viewWillAppear_originalMethod, viewWillAppear_swizzledMethod);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)ya_viewWillAppear:(<span class="built_in">BOOL</span>)animated  &#123;</span><br><span class="line">    [<span class="keyword">self</span> ya_viewWillAppear:animated];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"第一次在分类里面互换"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span> (<span class="title">MethodSwizzling2</span>)</span></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        Method viewWillAppear_originalMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(viewWillAppear:));</span><br><span class="line">        Method viewWillAppear_swizzledMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(ya2_viewWillAppear:));</span><br><span class="line">        method_exchangeImplementations(viewWillAppear_originalMethod, viewWillAppear_swizzledMethod);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)ya2_viewWillAppear:(<span class="built_in">BOOL</span>)animated  &#123;</span><br><span class="line">    [<span class="keyword">self</span> ya2_viewWillAppear:animated];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"第二次在分类里面互换"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="类方法交换"><a href="#类方法交换" class="headerlink" title="类方法交换"></a>类方法交换</h3><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 交换类方法</span></span><br><span class="line">+ (BOOL)swizzleClassMethod:(SEL)originalSel with:(SEL)newSel &#123;</span><br><span class="line">    Class <span class="class"><span class="keyword">class</span> = <span class="title">object_getClass</span></span>(self);</span><br><span class="line">    Method originalMethod = class_getInstanceMethod(<span class="class"><span class="keyword">class</span>, <span class="type">originalSel);</span></span></span><br><span class="line">    Method newMethod = class_getInstanceMethod(<span class="class"><span class="keyword">class</span>, <span class="type">newSel);</span></span></span><br><span class="line">    <span class="keyword">if</span> (!originalMethod || !newMethod) <span class="keyword">return</span> NO;</span><br><span class="line">    method_exchangeImplementations(originalMethod, newMethod);</span><br><span class="line">    <span class="keyword">return</span> YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法二次交换是否会影响第一次交换（造成第一次交换失效）？"><a href="#方法二次交换是否会影响第一次交换（造成第一次交换失效）？" class="headerlink" title="方法二次交换是否会影响第一次交换（造成第一次交换失效）？"></a>方法二次交换是否会影响第一次交换（造成第一次交换失效）？</h3><p>很明显不会。</p>
<p>原因: <code>Compile Sources</code>中设定了分类的编译顺序为<code>ViewController+MethodSwizzling.m --&gt; ViewController+MethodSwizzling2.m</code>，<code>load</code>方法的调用顺序也是这样。最新先调用主类的<code>viewWillAppear:</code>方法不必多说，接着调用分类<code>ViewController+MethodSwizzling</code>中的方法互换逻辑，使得第一次方法互换成功。紧接着调用分类<code>ViewController+MethodSwizzling2</code>中的方法互换逻辑，这个不会影响第一次方法互换的逻辑，相当于在第一次的方法互换之后再互换一次。<br><img src="https://image.chenyalun.com/2019/04/23/001.png" style="zoom:50%"></p>
<p>第一次: <code>ya_viewWillAppear</code>的实现与<code>viewWillAppear</code>的实现互换<br>第二次: <code>ya2_viewWillAppear</code>的实现与<code>ya_viewWillAppear</code>的实现互换，因为<code>viewWillAppear</code>的实现被<code>ya_viewWillAppear</code>代替了。所以主类和各个分类的方法都被清晰地调用了。<br><img src="https://image.chenyalun.com/2019/04/23/002.png" style="zoom:50%"></p>
<h2 id="自定义侧滑手势"><a href="#自定义侧滑手势" class="headerlink" title="自定义侧滑手势"></a>自定义侧滑手势</h2><p>除了全屏侧滑之外，有些情况下需要自定义侧滑手势，这时可以使用<code>UIScreenEdgePanGestureRecognizer</code>实现。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="built_in">UIView</span> *orangeView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="keyword">self</span>.view.bounds];</span><br><span class="line">    orangeView.backgroundColor = <span class="built_in">UIColor</span>.orangeColor;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:orangeView];</span><br><span class="line">    <span class="built_in">UIScreenEdgePanGestureRecognizer</span> *pan = [[<span class="built_in">UIScreenEdgePanGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(handlePop:)];</span><br><span class="line">    pan.edges = <span class="built_in">UIRectEdgeLeft</span>;</span><br><span class="line">    [orangeView addGestureRecognizer:pan];</span><br><span class="line">    <span class="keyword">self</span>.orangeView = orangeView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)handlePop:(<span class="built_in">UIScreenEdgePanGestureRecognizer</span> *)pan &#123;</span><br><span class="line">    <span class="keyword">void</span> (^setOriginX)(<span class="built_in">UIView</span> *, <span class="built_in">CGFloat</span>) = ^(<span class="built_in">UIView</span> *view, <span class="built_in">CGFloat</span> x) &#123;</span><br><span class="line">        [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.15</span> animations:^&#123;</span><br><span class="line">            <span class="built_in">CGRect</span> frame = view.frame;</span><br><span class="line">            frame.origin.x = x;</span><br><span class="line">            view.frame = frame;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIView</span> *targetView = pan.view;</span><br><span class="line">    <span class="built_in">CGFloat</span> offsetX = [pan translationInView:targetView].x;</span><br><span class="line">    <span class="keyword">if</span> (pan.state == <span class="built_in">UIGestureRecognizerStateChanged</span>) &#123;</span><br><span class="line">        targetView.center = <span class="built_in">CGPointMake</span>(targetView.center.x + offsetX, targetView.center.y);</span><br><span class="line">        [pan setTranslation:<span class="built_in">CGPointZero</span> inView:targetView.superview];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pan.state == <span class="built_in">UIGestureRecognizerStateEnded</span> || pan.state == <span class="built_in">UIGestureRecognizerStateCancelled</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (targetView.frame.origin.x / targetView.frame.size.width &gt; <span class="number">0.3</span>) &#123;</span><br><span class="line">            setOriginX(targetView, targetView.bounds.size.width);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            setOriginX(targetView, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>参考资料<br><a href="http://blog.sunnyxx.com/2015/06/07/fullscreen-pop-gesture/" target="_blank" rel="noopener">http://blog.sunnyxx.com/2015/06/07/fullscreen-pop-gesture/</a><br><a href="https://www.jianshu.com/p/d39f7d22db6c" target="_blank" rel="noopener">https://www.jianshu.com/p/d39f7d22db6c</a><br><a href="https://juejin.im/entry/5bea8d6de51d454fbd6b472f" target="_blank" rel="noopener">https://juejin.im/entry/5bea8d6de51d454fbd6b472f</a></p>
</blockquote>

      
    </div>

    
      
      



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/iOS开发/">iOS开发</a>
            
              <a href="/tags/阅读/">阅读</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
    
      <a class="next" href="/2019/03/21/基础百搭款「PageMenu」/">
        <span class="next-text nav-default">基础百搭款「PageMenu」</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/ChenYalun" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="https://weibo.com/icqk" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
    
      
    
      
        
          <a href="https://stackoverflow.com/users/7026915/allen" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
        
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    May Be 
  </span>
  
  <span class="theme-info">
    Better  
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even"> </a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2014 - 
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Ya</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  
  <script>
    var cloudTieConfig = {
      url: document.location.href, 
      sourceId: "",
      productKey: "f132359147224247aa1c3ad32d20490b",
      target: "cloud-tie-wrapper"
    };
  </script>
  <script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>





    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.4.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.4.x"></script>

    
  </body>
</html>
