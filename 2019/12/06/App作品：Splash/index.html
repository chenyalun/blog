<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="Appä½œå“ï¼šSplash">




  <meta name="keywords" content="iOSå¼€å‘,å¼€æºé¡¹ç›®,">




  <link rel="alternate" href="/atom.xml" title="Ya">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.4.x">



<link rel="canonical" href="http://blog.chenyalun.com/2019/12/06/Appä½œå“ï¼šSplash/">


<meta name="description" content="å®è·µä¸€äº›æƒ³æ³•ã€‚">
<meta name="keywords" content="iOSå¼€å‘,å¼€æºé¡¹ç›®">
<meta property="og:type" content="article">
<meta property="og:title" content="Appä½œå“ï¼šSplash">
<meta property="og:url" content="http://blog.chenyalun.com/2019/12/06/Appä½œå“ï¼šSplash/index.html">
<meta property="og:site_name" content="Ya">
<meta property="og:description" content="å®è·µä¸€äº›æƒ³æ³•ã€‚">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="https://image.chenyalun.com/2019/12/26/splash_001.png">
<meta property="og:image" content="https://image.chenyalun.com/2019/12/26/splash_002.png">
<meta property="og:image" content="https://image.chenyalun.com/2019/12/26/splash_003.png">
<meta property="og:image" content="https://image.chenyalun.com/2019/12/26/splash_004.png">
<meta property="og:updated_time" content="2020-01-02T03:49:30.241Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Appä½œå“ï¼šSplash">
<meta name="twitter:description" content="å®è·µä¸€äº›æƒ³æ³•ã€‚">
<meta name="twitter:image" content="https://image.chenyalun.com/2019/12/26/splash_001.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.4.x">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  



    <title> Appä½œå“ï¼šSplash Â· Ya </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Ya</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags/é˜…è¯»/">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Ya</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              æ—¶é—´çº¿
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags/é˜…è¯»/">
            
            
              é˜…è¯»
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              å…³äº
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Appä½œå“ï¼šSplash
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2019å¹´12æœˆ6æ—¥
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ä¸€ã€å‰è¨€"><span class="toc-text">ä¸€ã€å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#äºŒã€æ€è·¯"><span class="toc-text">äºŒã€æ€è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1ï¼Œä»£ç ç»“æ„"><span class="toc-text">1ï¼Œä»£ç ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2ï¼Œå…¬æœ‰ç‰¹æ€§"><span class="toc-text">2ï¼Œå…¬æœ‰ç‰¹æ€§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3ï¼Œç½‘ç»œå±‚è®¾è®¡"><span class="toc-text">3ï¼Œç½‘ç»œå±‚è®¾è®¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4ï¼Œä»MVCã€MVVMåˆ°å»ModelåŒ–"><span class="toc-text">4ï¼Œä»MVCã€MVVMåˆ°å»ModelåŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5ï¼Œç½‘ç»œä¼˜åŒ–"><span class="toc-text">5ï¼Œç½‘ç»œä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6ï¼ŒæŒä¹…åŒ–"><span class="toc-text">6ï¼ŒæŒä¹…åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7ï¼ŒåŠ¨æ€éƒ¨ç½²æ–¹æ¡ˆ"><span class="toc-text">7ï¼ŒåŠ¨æ€éƒ¨ç½²æ–¹æ¡ˆ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ä¸‰ã€æ€»ç»“"><span class="toc-text">ä¸‰ã€æ€»ç»“</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p></p><p align="center"> å®è·µä¸€äº›æƒ³æ³•ã€‚ </p><br><a id="more"></a><p></p>
<h1 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h1><p>æ‹œè¯»äº†Casaå‰è¾ˆçš„<a href="https://casatwy.com/iosying-yong-jia-gou-tan-kai-pian.html" target="_blank" rel="noopener">ã€ŠiOSåº”ç”¨æ¶æ„è°ˆã€‹</a>ç³»åˆ—æ–‡ç« ï¼Œæ”¶è·é¢‡ä¸°ï¼ŒèŒç”Ÿäº†æƒ³å®è·µçš„æƒ³æ³•ã€‚2017å¹´åˆ°ç°åœ¨ï¼Œè™½ç„¶å†™è¿‡ä¸å°‘é¡¹ç›®ï¼Œä½†æ˜¯å§‹ç»ˆæ²¡æœ‰Appä½œå“åœ¨App Storeä¸Šæ¶è¿‡ï¼Œä¹Ÿä¸€ç›´æœ‰è¿™ä¸ªå°å¿ƒæ„¿ã€‚æ‰‹æœºé‡Œé¢æœ‰ä¸ªå«Splasherçš„Appï¼Œæ˜¯å£çº¸ç±»å‹çš„Appï¼Œè™½ç„¶å£çº¸è´¨é‡ä¸é”™ï¼Œä½†æ˜¯Appä½“éªŒä¸å¤ªå¥½ï¼ŒåŠ è½½æ…¢ï¼Œç•Œé¢å†·é…·æ— æƒ…ã€‚åæ¥æ‰“å¬åˆ°å®ƒçš„APIæ¥è‡ªæ— ç‰ˆæƒå¯ä»¥å•†ç”¨çš„UnSplashã€‚å¤©æ—¶åœ°åˆ©äººå’Œéƒ½æœ‰äº†ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ªæœŸæœ›ä¸Šæ¶App Storeçš„ä½œå“ï¼šSplashï¼Œè¯ç”Ÿäº†ã€‚</p>
<p>è™½ç„¶åªæ˜¯å£çº¸ç±»çš„æ²¡æœ‰å¤šå°‘åŠŸèƒ½çš„ä¸éœ€è¦å¤šå°‘é“è¡Œå°±èƒ½å†™å‡ºæ¥çš„Appï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³ç®€å•èŠä¸€èŠã€‚</p>
<h1 id="äºŒã€æ€è·¯"><a href="#äºŒã€æ€è·¯" class="headerlink" title="äºŒã€æ€è·¯"></a>äºŒã€æ€è·¯</h1><h2 id="1ï¼Œä»£ç ç»“æ„"><a href="#1ï¼Œä»£ç ç»“æ„" class="headerlink" title="1ï¼Œä»£ç ç»“æ„"></a>1ï¼Œä»£ç ç»“æ„</h2><p>ä¸ä¿ºç›®å‰çš„ä¹ æƒ¯ä¸€è‡´ï¼šæ–¹æ³•ç»“æ„æŒ‰ç…§life cycleã€Delegateæ–¹æ³•å®ç°ã€event responseã€getters and settersé¡ºåºã€‚<br><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - Life cycle</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - Event response</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - Getter and setter</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - Private methods</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - Public methods</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - UITableViewDelegate</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - UITableViewDataSource</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>åœ¨viewDidloadé‡Œé¢åªåšaddSubviewçš„äº‹æƒ…ï¼Œåœ¨viewDidLoadé‡Œé¢å¼€ä¸€ä¸ªlayoutPageSubviewsçš„æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªé‡Œé¢åˆ›å»ºConstraintså¹¶æ·»åŠ ï¼Œåœ¨viewDidAppearé‡Œé¢åšNotificationçš„ç›‘å¬ä¹‹ç±»çš„äº‹æƒ…ã€‚æ‰€æœ‰çš„å±æ€§éƒ½ä½¿ç”¨getterå’Œsetterï¼Œå¹¶ä¸”å…¨éƒ¨éƒ½æ”¾åœ¨æœ€åã€‚</p>
</blockquote>
<p>æˆ‘è§‰å¾—ä½œè€…è¯´çš„è¿˜æ˜¯æœ‰é“ç†çš„ï¼Œè™½ç„¶æŸäº›getterä¸€å®šä¼šç”¨åˆ°ï¼Œå†åšä¸€å±‚æ‡’åŠ è½½è²Œä¼¼æ˜¾å¾—å†—ä½™ï¼Œä½†æ˜¯ä»ç»“æ„ä¸Šçœ‹æ›´æ¸…æ™°ã€‚</p>
<h2 id="2ï¼Œå…¬æœ‰ç‰¹æ€§"><a href="#2ï¼Œå…¬æœ‰ç‰¹æ€§" class="headerlink" title="2ï¼Œå…¬æœ‰ç‰¹æ€§"></a>2ï¼Œå…¬æœ‰ç‰¹æ€§</h2><p>é¢å‘åˆ‡ç‰‡ç¼–ç¨‹</p>
<ul>
<li>ä»€ä¹ˆæ˜¯åˆ‡ç‰‡ï¼Ÿ<br>ç¨‹åºè¦å®Œæˆä¸€ä»¶äº‹æƒ…ï¼Œä¸€å®šä¼šæœ‰ä¸€äº›æ­¥éª¤ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4è¿™æ ·ã€‚è¿™é‡Œåˆ†è§£å‡ºæ¥çš„æ¯ä¸€ä¸ªæ­¥éª¤æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªåˆ‡ç‰‡ã€‚</li>
<li>ä»€ä¹ˆæ˜¯é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ï¼Ÿ<br>ä½ é’ˆå¯¹æ¯ä¸€ä¸ªåˆ‡ç‰‡çš„é—´éš™ï¼Œå¡ä¸€äº›ä»£ç è¿›å»ï¼Œåœ¨ç¨‹åºæ­£å¸¸è¿›è¡Œ1ï¼Œ2ï¼Œ3ï¼Œ4æ­¥çš„é—´éš™å¯ä»¥è·‘åˆ°ä½ å¡è¿›å»çš„ä»£ç ï¼Œé‚£ä¹ˆä½ å†™è¿™äº›ä»£ç å°±æ˜¯é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ã€‚</li>
<li>ä¸ºä»€ä¹ˆä¼šå‡ºç°é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ï¼Ÿ<br>ä½ è¦æƒ³åšåˆ°åœ¨æ¯ä¸€ä¸ªæ­¥éª¤ä¸­é—´åšä½ è‡ªå·±çš„äº‹æƒ…ï¼Œä¸ç”¨AOPä¹Ÿä¸€æ ·å¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œç›´æ¥å¾€æ­¥éª¤ä¹‹é—´å¡ä»£ç å°±å¥½äº†ã€‚ä½†æ˜¯äº‹å®æƒ…å†µå¾€å¾€å¾ˆå¤æ‚ï¼Œç›´æ¥æŠŠä»£ç å¡è¿›å»ï¼Œä¸»è¦é—®é¢˜å°±åœ¨äºï¼šå¡è¿›å»çš„ä»£ç å¾ˆæœ‰å¯èƒ½æ˜¯è·ŸåŸä¸šåŠ¡æ— å…³çš„ä»£ç ï¼Œåœ¨åŒä¸€ä»½ä»£ç æ–‡ä»¶é‡Œé¢æºæ‚å¤šç§ä¸šåŠ¡ï¼Œè¿™ä¼šå¸¦æ¥ä¸šåŠ¡é—´è€¦åˆã€‚ä¸ºäº†é™ä½è¿™ç§è€¦åˆåº¦ï¼Œæˆ‘ä»¬å¼•å…¥äº†AOPã€‚</li>
<li>å¦‚ä½•å®ç°AOPï¼Ÿ<br>Method Swizzlingæˆ–è€…protocolçš„æ–¹å¼æ¥å®ç°æ‹¦æˆªå™¨ï¼ˆbeforePerformã€afterPerformï¼‰</li>
</ul>
<p>ä½¿ç”¨AOPè€Œéç»§æ‰¿æ¥å®ç°å…¬æœ‰ç‰¹æ€§ã€‚æ¯”å¦‚æ¯ä¸ªViewControlleréƒ½æœ‰ä¸€ä¸ªé€šç”¨çš„navigationHeaderBar:</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YAObjectIntercepter</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    [YAObjectIntercepter sharedInstance];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="keyword">static</span> YAObjectIntercepter *sharedInstance;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        sharedInstance = [YAObjectIntercepter new];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> sharedInstance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        <span class="comment">// æ–¹æ³•æ‹¦æˆª</span></span><br><span class="line">        [<span class="built_in">UIViewController</span> aspect_hookSelector:<span class="keyword">@selector</span>(viewDidLoad) withOptions:AspectPositionBefore usingBlock:^(<span class="keyword">id</span> &lt;AspectInfo&gt; aspectInfo)&#123;</span><br><span class="line">            [<span class="keyword">self</span> viewDidLoadWithViewController:[aspectInfo instance]];</span><br><span class="line">        &#125; error:<span class="literal">NULL</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - fake methods</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoadWithViewController:(<span class="built_in">UIViewController</span> *)viewController &#123;</span><br><span class="line">    <span class="keyword">if</span> ([viewController isKindOfClass:<span class="built_in">UIViewController</span>.class] &amp;&amp; [<span class="built_in">NSStringFromClass</span>(viewController.class) hasPrefix:<span class="string">@"YA"</span>]) &#123;</span><br><span class="line">        viewController.view.backgroundColor = <span class="built_in">UIColor</span>.whiteColor;</span><br><span class="line">        viewController.navigationHeaderBar.backgroundColor = <span class="built_in">UIColor</span>.whiteColor;</span><br><span class="line">        [viewController.view addSubview:viewController.navigationHeaderBar];</span><br><span class="line">        viewController.navigationHeaderBar.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, kIPHONEX_TOP, kScreenWidth, kNavigationBarHeight);</span><br><span class="line">        [viewController.navigationHeaderBar.leftButton setBackgroundImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"feed_back"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [viewController.navigationHeaderBar.leftButton setBackgroundImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"feed_back"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [viewController.navigationHeaderBar.leftButton addTarget:viewController action:<span class="keyword">@selector</span>(popViewControllerWithAnimation) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h2 id="3ï¼Œç½‘ç»œå±‚è®¾è®¡"><a href="#3ï¼Œç½‘ç»œå±‚è®¾è®¡" class="headerlink" title="3ï¼Œç½‘ç»œå±‚è®¾è®¡"></a>3ï¼Œç½‘ç»œå±‚è®¾è®¡</h2><blockquote>
<p>1ï¼Œç½‘ç»œå±‚æ•°æ®é€šä¿¡ä»¥Delegateä¸ºä¸»ï¼ŒNotificationä¸ºè¾…ï¼ˆç½‘ç»œä¿¡å·ä»2Gå˜æˆ3Gå˜æˆ4Gå˜æˆWi-Fiï¼‰ã€‚<br>2ï¼Œæä¾›reformeræœºåˆ¶æ¥å¤„ç†ç½‘ç»œå±‚åé¦ˆçš„æ•°æ®ï¼Œäº¤ä»˜NSDictionaryç»™ä¸šåŠ¡å±‚ï¼Œä½¿ç”¨Constå­—ç¬¦ä¸²ä½œä¸ºKeyæ¥ä¿æŒå¯è¯»æ€§ã€‚<br>3ï¼Œç½‘ç»œå±‚ä¸Šéƒ¨åˆ†ä½¿ç”¨ç¦»æ•£å‹è®¾è®¡ï¼Œä¸‹éƒ¨åˆ†ä½¿ç”¨é›†çº¦å‹è®¾è®¡ã€‚è®¾è®¡åˆç†çš„ç»§æ‰¿æœºåˆ¶ï¼Œè®©æ´¾ç”Ÿå‡ºæ¥çš„APIManagerå—åˆ°é™åˆ¶ï¼Œé¿å…æ··ä¹±ã€‚<br>å…³äºé›†çº¦å‹çš„APIè°ƒç”¨å’Œç¦»æ•£å‹çš„APIè°ƒç”¨ï¼Œæˆ‘å€¾å‘äºè¿™æ ·ï¼šå¯¹å¤–æä¾›ä¸€ä¸ªBaseAPIManageræ¥ç»™ä¸šåŠ¡æ–¹åšæ´¾ç”Ÿï¼Œåœ¨BaseManageré‡Œé¢é‡‡ç”¨é›†çº¦åŒ–çš„æ‰‹æ®µç»„è£…è¯·æ±‚ï¼Œæ”¾é£è¯·æ±‚ï¼Œç„¶è€Œä¸šåŠ¡æ–¹è°ƒç”¨APIçš„æ—¶å€™ï¼Œåˆ™æ˜¯ä»¥ç¦»æ•£çš„APIè°ƒç”¨æ–¹å¼æ¥è°ƒç”¨ã€‚å¦‚æœä½ çš„Appåªæä¾›äº†é›†çº¦åŒ–çš„æ–¹å¼ï¼Œè€Œæ²¡æœ‰ç¦»æ•£æ–¹å¼çš„é€šé“ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ å†å°è£…ä¸€å±‚ï¼Œä¾¿äºä¸šåŠ¡æ–¹ä½¿ç”¨ç¦»æ•£çš„APIè°ƒç”¨æ–¹å¼æ¥æ”¾é£è¯·æ±‚ã€‚</p>
</blockquote>
<p>å¤§å‹Appå¯ä»¥ä½¿ç”¨å°è£…AFNçš„YTKNetworkï¼Œè€Œå°å‹Appç”±äºAPIå°‘ï¼Œå‚æ•°ä¸å¤æ‚ï¼Œå¾ˆå¤šå°±ç›´æ¥ä½¿ç”¨ä¸€ä¸ªç±»ï¼Œæš´éœ²Getå’ŒPostæ¥å£å°±å¯ä»¥äº†ã€‚</p>
<p><strong>ä¸‹å±‚ï¼šç»Ÿä¸€æ¥å£ï¼Œä»¥ç¦»æ•£å‹å°è£…AFNetworking</strong><br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NSString</span> *YAServerInterfaceName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¦–é¡µFeedæ¥å£</span></span><br><span class="line"><span class="keyword">extern</span> YAServerInterfaceName <span class="keyword">const</span> kYAServerInterfaceFeed;</span><br><span class="line"><span class="comment">// æœç´¢æ¥å£</span></span><br><span class="line"><span class="keyword">extern</span> YAServerInterfaceName <span class="keyword">const</span> kYAServerInterfaceSearch;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YANetworkManager</span> : <span class="title">NSObject</span></span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)manager;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSURLSessionDataTask</span> *)requestWithInterfaceName:(YAServerInterfaceName)interfaceName</span><br><span class="line">                                        parameters:(<span class="built_in">NSDictionary</span> *)parameters</span><br><span class="line">                                          progress:(<span class="keyword">void</span> (^)(<span class="built_in">NSProgress</span> *))downloadProgress</span><br><span class="line">                                           success:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSessionDataTask</span> *, <span class="keyword">id</span>))success</span><br><span class="line">                                           failure:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSessionDataTask</span> *, <span class="built_in">NSError</span> *))failure;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>æŠŠæ¥å£ä»¥åŠå…¬å…±å‚æ•°è¿›è¡Œå°è£…ï¼Œé¿å…æ•£è½ä¸€åœ°ã€‚ä½¿ç”¨æ—¶åªéœ€è¦ä¼ å…¥InterfaceNameå³å¯ã€‚æ¯ä¸ªä¸šåŠ¡éƒ½å¯ä»¥æœ‰è‡ªå·±çš„managerï¼ŒæˆåŠŸæˆ–è€…å¤±è´¥å›è°ƒä»¥blockçš„å½¢å¼å›ä¼ ï¼Œä¾›å„ä¸ªä¸šåŠ¡è‡ªå·±å‘æŒ¥ã€‚</p>
<p><strong>ä¸Šå±‚ï¼šç»Ÿä¸€APIManagerï¼Œä»¥é›†çº¦å‹çš„delegateè¿›è¡Œå›è°ƒ</strong><br><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// API managerçš„åŸºç±»</span></span><br><span class="line"><span class="variable">@interface</span> <span class="attribute">YABaseAPIManager </span>: NSObject</span><br><span class="line"><span class="variable">@property</span> (nonatomic, assign) BOOL noMoreData;</span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">fetchNetworkDataWithParameters</span><span class="selector-pseudo">:(NSDictionary</span> *)<span class="selector-tag">parameters</span>;</span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">cancelPreviousRequest</span>;</span><br><span class="line">@<span class="selector-tag">end</span></span><br></pre></td></tr></table></figure></p>
<p>BaseAPIManagerè´Ÿè´£æ´¾ç”Ÿå„ä¸ªä¸šåŠ¡çš„APIManagerï¼Œæä¾›æ•°æ®è¯·æ±‚åŠå–æ¶ˆæ•°æ®è¯·æ±‚æ¥å£ã€‚BaseAPIManagerè¿˜çº¦å®šäº†å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•ï¼šæˆåŠŸå›è°ƒã€å¤±è´¥å›è°ƒã€ä»¥åŠæ¥å£åç§°ã€‚å…·ä½“è¯·æ±‚çš„å‚æ•°æ€ä¹ˆé…ç½®ã€æˆåŠŸå›è°ƒæ€ä¹ˆå¤„ç†ã€å¤±è´¥å›è°ƒæ€ä¹ˆå¤„ç†éƒ½ç”±å­ç±»å†³å®šã€‚</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@protocol</span> YABaseAPIManagerChildProtocol &lt;NSObject&gt;</span><br><span class="line"><span class="variable">@required</span></span><br><span class="line">- (YAServerInterfaceName)interfaceName;</span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">APIManager</span><span class="selector-pseudo">:(YABaseAPIManager</span> *)<span class="selector-tag">manager</span> <span class="selector-tag">finishedWithFailedError</span><span class="selector-pseudo">:(NSError</span> *)<span class="selector-tag">error</span>;</span><br><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">APIManager</span><span class="selector-pseudo">:(YABaseAPIManager</span> *)<span class="selector-tag">manager</span> <span class="selector-tag">finishedWithSuccessResult</span><span class="selector-pseudo">:(id)result</span>;</span><br><span class="line">@<span class="selector-tag">end</span></span><br></pre></td></tr></table></figure>
<h2 id="4ï¼Œä»MVCã€MVVMåˆ°å»ModelåŒ–"><a href="#4ï¼Œä»MVCã€MVVMåˆ°å»ModelåŒ–" class="headerlink" title="4ï¼Œä»MVCã€MVVMåˆ°å»ModelåŒ–"></a>4ï¼Œä»MVCã€MVVMåˆ°å»ModelåŒ–</h2><p><strong>MVC</strong><br>Måº”è¯¥åšçš„äº‹ï¼š<br>ç»™ViewControlleræä¾›æ•°æ®ï¼›<br>ç»™ViewControllerå­˜å‚¨æ•°æ®æä¾›æ¥å£ï¼›<br>æä¾›ç»è¿‡æŠ½è±¡çš„ä¸šåŠ¡åŸºæœ¬ç»„ä»¶ï¼Œä¾›Controllerè°ƒåº¦ï¼›</p>
<p>Cåº”è¯¥åšçš„äº‹ï¼š<br>ç®¡ç†View Containerçš„ç”Ÿå‘½å‘¨æœŸï¼›<br>è´Ÿè´£ç”Ÿæˆæ‰€æœ‰çš„Viewå®ä¾‹ï¼Œå¹¶æ”¾å…¥View Containerï¼›<br>ç›‘å¬æ¥è‡ªViewä¸ä¸šåŠ¡æœ‰å…³çš„äº‹ä»¶ï¼Œé€šè¿‡ä¸Modelçš„åˆä½œï¼Œæ¥å®Œæˆå¯¹åº”äº‹ä»¶çš„ä¸šåŠ¡ï¼›</p>
<p>Våº”è¯¥åšçš„äº‹ï¼š<br>å“åº”ä¸ä¸šåŠ¡æ— å…³çš„äº‹ä»¶ï¼Œå¹¶å› æ­¤å¼•å‘åŠ¨ç”»æ•ˆæœï¼Œç‚¹å‡»åé¦ˆï¼ˆå¦‚æœåˆé€‚çš„è¯ï¼Œå°½é‡è¿˜æ˜¯æ”¾åœ¨Viewå»åšï¼‰ç­‰ï¼›<br>ç•Œé¢å…ƒç´ è¡¨è¾¾</p>
<p><strong>MVVM</strong><br>åœ¨MVCçš„åŸºç¡€ä¸Šï¼ŒæŠŠCæ‹†å‡ºä¸€ä¸ªViewModelä¸“é—¨è´Ÿè´£æ•°æ®å¤„ç†çš„äº‹æƒ…ï¼Œå°±æ˜¯MVVMã€‚ç„¶åï¼Œä¸ºäº†è®©Viewå’ŒViewModelä¹‹é—´èƒ½å¤Ÿæœ‰æ¯”è¾ƒæ¾æ•£çš„ç»‘å®šå…³ç³»ï¼Œäºæ˜¯æˆ‘ä»¬ä½¿ç”¨ReactiveCocoaï¼Œå› ä¸ºè‹¹æœæœ¬èº«å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªæ¯”è¾ƒé€‚åˆè¿™ç§æƒ…å†µçš„ç»‘å®šæ–¹æ³•ã€‚iOSé¢†åŸŸé‡ŒKVOï¼ŒNotificationï¼Œblockï¼Œdelegateå’Œtarget-actionéƒ½å¯ä»¥ç”¨æ¥åšæ•°æ®é€šä¿¡ï¼Œä»è€Œæ¥å®ç°ç»‘å®šï¼Œä½†éƒ½ä¸å¦‚ReactiveCocoaæä¾›çš„RACSignalæ¥çš„ä¼˜é›…ï¼Œå¦‚æœä¸ç”¨ReactiveCocoaï¼Œç»‘å®šå…³ç³»å¯èƒ½å°±åšä¸åˆ°é‚£ä¹ˆæ¾æ•£é‚£ä¹ˆå¥½ï¼Œä½†å¹¶ä¸å½±å“å®ƒè¿˜æ˜¯MVVMã€‚</p>
<p><strong>å»ModelåŒ–</strong><br>ä¿ç•™åŸå§‹æ•°æ®ï¼Œå®šä¹‰reformåè®®ï¼Œéµå®ˆè¯¥åè®®çš„å¯¹è±¡æ¥å¤„ç†managerçš„åŸå§‹æ•°æ®ï¼Œå¤„ç†åçš„æ•°æ®ä¾ç„¶æ˜¯å­—å…¸æˆ–è€…æ•°ç»„ã€‚</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@protocol</span> YAFeedReformerProtocol &lt;NSObject&gt;</span><br><span class="line">- (NSArray *)<span class="attribute">reformData</span>:(id)data <span class="attribute">manager</span>:(YAFeedAPIManager *)manager;</span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure>
<p>æ¯ç±»æ•°æ®å¯¹åº”ä¸€ä¸ªReformerï¼š<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPropertyListDataKeyFeedID;             <span class="comment">///&lt; id</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPropertyListDataKeyFeedThumbUrl;       <span class="comment">///&lt; æ‹‡æŒ‡å›¾url</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPropertyListDataKeyFeedSmallUrl;       <span class="comment">///&lt; å°å›¾url</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPropertyListDataKeyFeedRegularUrl;     <span class="comment">///&lt; å¸¸è§„å›¾url</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YAFeedReformer</span> : <span class="title">NSObject</span> &lt;<span class="title">YAFeedReformerProtocol</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>æ ¹æ®å­—å…¸çš„keyå¯ä»¥ç›´æ¥ä½¿ç”¨:<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setPhotoInfo:(<span class="built_in">NSDictionary</span> *)photoInfo &#123;</span><br><span class="line">    <span class="built_in">NSURL</span> *url = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">if</span> (YASettingManager.columnCount &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">        url = [<span class="built_in">NSURL</span> URLWithString:photoInfo[kPropertyListDataKeyFeedRegularUrl]];</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="5ï¼Œç½‘ç»œä¼˜åŒ–"><a href="#5ï¼Œç½‘ç»œä¼˜åŒ–" class="headerlink" title="5ï¼Œç½‘ç»œä¼˜åŒ–"></a>5ï¼Œç½‘ç»œä¼˜åŒ–</h2><p><strong>é’ˆå¯¹é“¾æ¥å»ºç«‹ç¯èŠ‚çš„ä¼˜åŒ–</strong></p>
<ul>
<li>ä½¿ç”¨ç¼“å­˜æ‰‹æ®µå‡å°‘è¯·æ±‚çš„å‘èµ·æ¬¡æ•°ï¼ˆAPIåå­—å’Œå‚æ•°æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ç„¶åå–MD5ä½œä¸ºkeyï¼Œå­˜å‚¨å¯¹åº”è¿”å›çš„æ•°æ®ï¼‰</li>
<li>ä½¿ç”¨ç­–ç•¥æ¥å‡å°‘è¯·æ±‚çš„å‘èµ·æ¬¡æ•°ï¼ˆä¸‹æ‹‰åˆ·æ–°ã€æ¡ä»¶ç­›é€‰å–æ¶ˆåŸå…ˆå­˜åœ¨çš„è¯·æ±‚ï¼Œç”¨æˆ·æ—¥å¿—æ»¡è¶³ä¸€å®šæ•°é‡å†ä¸Šä¼ ï¼‰</li>
</ul>
<p><strong>é’ˆå¯¹DNSåŸŸåè§£æåšçš„ä¼˜åŒ–</strong><br>åŸå› ï¼šAPIè¯·æ±‚åœ¨DNSè§£æé˜¶æ®µçš„è€—æ—¶ä¼šå¾ˆå¤šï¼ˆç½‘ç»œä¿¡å·æºä¼šç»å¸¸å˜æ¢ã€è‡ªå·±çš„Appæ‰€åšçš„DNSç¼“å­˜ä¼šè¢«åˆ«çš„DNSç¼“å­˜ç»™æŒ¤å‡ºå»è¢«æ¸…ç†æ‰ã€å¢™ è¿™ä¸‰ä¸ªåŸå› é€ æˆé“¾è·¯çš„DNSç¼“å­˜å¾ˆå¿«å¤±æ•ˆç›¸å½“äºæ²¡æœ‰ï¼Œäºæ˜¯ç›´æ¥èµ°IPè¯·æ±‚ï¼Œç»•è¿‡DNSæœåŠ¡çš„è€—æ—¶ï¼‰<br>æ–¹æ¡ˆï¼šæœ¬åœ°æœ‰ä¸€ä»½IPåˆ—è¡¨ï¼Œè¿™äº›IPæ˜¯æ‰€æœ‰æä¾›APIçš„æœåŠ¡å™¨çš„IPï¼Œæ¯æ¬¡åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œé’ˆå¯¹è¿™ä¸ªåˆ—è¡¨é‡Œçš„æ‰€æœ‰IPå–pingå»¶æ—¶æ—¶é—´ï¼Œç„¶åå–å»¶æ—¶æ—¶é—´æœ€å°çš„é‚£ä¸ªIPä½œä¸ºä»Šåå‘èµ·è¯·æ±‚çš„IPåœ°å€ã€‚ä¸€èˆ¬éƒ½æ˜¯åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™è·å¾—æœ¬åœ°åˆ—è¡¨ä¸­æ‰€æœ‰IPçš„pingå€¼ï¼Œç„¶åé€šè¿‡NSURLProtocolçš„æ‰‹æ®µå°†URLä¸­çš„HOSTä¿®æ”¹ä¸ºæˆ‘ä»¬æ‰¾åˆ°çš„æœ€å¿«çš„IPã€‚å¦å¤–ï¼Œè¿™ä¸ªæœ¬åœ°IPåˆ—è¡¨ä¹Ÿä¼šéœ€è¦é€šè¿‡ä¸€ä¸ªAPIæ¥ç»´æŠ¤ï¼Œä¸€èˆ¬æ˜¯æ¯å¤©ç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™è¯»ä¸€æ¬¡APIï¼Œç„¶åæ›´æ–°åˆ°æœ¬åœ°ã€‚</p>
<p><strong>é’ˆå¯¹é“¾æ¥ä¼ è¾“æ•°æ®é‡çš„ä¼˜åŒ–</strong><br>å‹ç¼©ã€‚</p>
<p><strong>é’ˆå¯¹é“¾æ¥å¤ç”¨çš„ä¼˜åŒ–</strong><br>HTTP/2.0ã€‚</p>
<p><strong>åˆ¤æ–­APIçš„è°ƒç”¨è¯·æ±‚æ˜¯æ¥è‡ªäºç»è¿‡æˆæƒçš„APPï¼Ÿ</strong><br>è®¾è®¡ç­¾å<br>æœåŠ¡ç«¯éœ€è¦ç»™ä½ ä¸€ä¸ªå¯†é’¥ï¼Œæ¯æ¬¡è°ƒç”¨APIæ—¶ï¼Œä½ ä½¿ç”¨è¿™ä¸ªå¯†é’¥å†åŠ ä¸ŠAPIåå­—å’ŒAPIè¯·æ±‚å‚æ•°ç®—ä¸€ä¸ªhashå‡ºæ¥ï¼Œç„¶åè¯·æ±‚çš„æ—¶å€™å¸¦ä¸Šè¿™ä¸ªhashã€‚æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ä¹‹åï¼ŒæŒ‰ç…§åŒæ ·çš„å¯†é’¥åŒæ ·çš„ç®—æ³•ä¹Ÿç®—ä¸€ä¸ªhashå‡ºæ¥ï¼Œç„¶åè·Ÿè¯·æ±‚å¸¦æ¥çš„hashåšä¸€ä¸ªæ¯”è¾ƒï¼Œå¦‚æœä¸€è‡´ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºè¿™ä¸ªAPIçš„è°ƒç”¨è€…ç¡®å®æ˜¯ä½ çš„APPã€‚ä¸ºäº†ä¸è®©åˆ«äººä¹Ÿè·å–åˆ°è¿™ä¸ªå¯†é’¥ï¼Œä½ æœ€å¥½ä¸è¦æŠŠè¿™ä¸ªå¯†é’¥å­˜å‚¨åœ¨æœ¬åœ°ï¼Œç›´æ¥å†™æ­»åœ¨ä»£ç é‡Œé¢å°±å¥½äº†ã€‚å¦å¤–é€‚å½“å¢åŠ ä¸€ä¸‹æ±‚Hashçš„ç®—æ³•çš„å¤æ‚åº¦ï¼Œé‚£å°±æ˜¯å„ç§Hashç®—æ³•ï¼ˆæ¯”å¦‚MD5ï¼‰åŠ ç‚¹ç›ï¼Œå†å›ç‚‰è·‘ä¸€æ¬¡Hashå•¥çš„ã€‚è¿™æ ·å°±èƒ½è§£å†³ç¬¬ä¸€ä¸ªç›®çš„äº†ï¼šç¡®ä¿ä½ çš„APIæ˜¯æ¥è‡ªäºä½ è‡ªå·±çš„Appã€‚</p>
<p>ç½‘ç»œä¼˜åŒ–åœ¨Splashä¸Šçš„å®è·µä¸»è¦æ˜¯<strong>ipç›´è¿</strong>ã€‚Casaå‰è¾ˆç»™å‡ºäº†NSEtcHostsï¼Œä½†æ˜¯å®ƒå¤„ç†NSURLConnectionï¼Œè¿‡æ—¶äº†ï¼Œæˆ‘å­¦ä¹ å€Ÿé‰´å†™äº†ä¸ªNSURLSessionç‰ˆæœ¬çš„ã€‚å½“ç„¶ï¼Œæ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè‡ªå®šä¹‰NSURLProtocolã€‚å¢åŠ äº†ä¸€ç‚¹ç‚¹åŠŸèƒ½ï¼š</p>
<ul>
<li>æ”¯æŒHTTPS</li>
<li>ç›´è¿ipå¤±è´¥åè‡ªåŠ¨åˆ‡å›host</li>
<li>æ”¯æŒAFN</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">YAHostsConfiguration</span></span></span><br><span class="line"><span class="comment">// é…ç½®hostä¸IPçš„æ˜ å°„</span></span><br><span class="line">- (<span class="keyword">void</span>)resolveHostName:(<span class="built_in">NSString</span> *)hostName</span><br><span class="line">           mapIPAddress:(<span class="built_in">NSString</span> *)IPAddress;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YADomainURLProtocol</span> : <span class="title">NSURLProtocol</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)configureHostsWithBlock:(<span class="keyword">void</span> (^)(<span class="keyword">id</span> &lt;YAHostsConfiguration&gt; configuration))block;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YAHostsConfiguration</span> : <span class="title">NSObject</span> &lt;<span class="title">YAHostsConfiguration</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSMutableDictionary</span> *mutableIPAddressesByHostName;</span><br><span class="line">- (<span class="built_in">NSString</span> *)IPAddressForHostName:(<span class="built_in">NSString</span> *)hostName;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YAHostsConfiguration</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        _mutableIPAddressesByHostName = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)IPAddressForHostName:(<span class="built_in">NSString</span> *)hostName &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.mutableIPAddressesByHostName[hostName.lowercaseString];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)resolveHostName:(<span class="built_in">NSString</span> *)hostName mapIPAddress:(<span class="built_in">NSString</span> *)IPAddress &#123;</span><br><span class="line">    <span class="keyword">self</span>.mutableIPAddressesByHostName[hostName.lowercaseString] = IPAddress;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kURLProtocolHostModifiedKey = <span class="string">@"kURLProtocolHostModifiedKey"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YADomainURLProtocol</span> () &lt;<span class="title">NSURLSessionTaskDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (atomic, <span class="keyword">strong</span>, <span class="keyword">readwrite</span>) <span class="built_in">NSURLSession</span> *session;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YADomainURLProtocol</span></span></span><br><span class="line">+ (YAHostsConfiguration *)sharedConfiguration &#123;</span><br><span class="line">    <span class="keyword">static</span> YAHostsConfiguration * sharedConfiguration = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        sharedConfiguration = [YAHostsConfiguration new];</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sharedConfiguration;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)configureHostsWithBlock:(<span class="keyword">void</span> (^)(<span class="keyword">id</span> &lt;YAHostsConfiguration&gt; configuration))block &#123;</span><br><span class="line">    <span class="keyword">if</span> (block) block([<span class="keyword">self</span> sharedConfiguration]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">BOOL</span>)canInitWithRequest:(<span class="built_in">NSURLRequest</span> *)request &#123;</span><br><span class="line">    <span class="built_in">BOOL</span> isHttps = [request.URL.scheme caseInsensitiveCompare:<span class="string">@"https"</span>] == <span class="built_in">NSOrderedSame</span>;</span><br><span class="line">    <span class="keyword">if</span> (isHttps) &#123;</span><br><span class="line">        <span class="comment">// æ²¡æœ‰å¤„ç†è¿‡ä¸”æœ‰æ˜ å°„</span></span><br><span class="line">        <span class="keyword">if</span> (![<span class="keyword">self</span> propertyForKey:kURLProtocolHostModifiedKey inRequest:request] &amp;&amp; [[<span class="keyword">self</span> sharedConfiguration] IPAddressForHostName:request.URL.host]) &#123;</span><br><span class="line">            YALog(<span class="string">@"å‘½ä¸­ipç›´è¿"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSURLRequest</span> *)canonicalRequestForRequest:(<span class="built_in">NSURLRequest</span> *)request &#123;</span><br><span class="line">    <span class="comment">// å®¹é”™</span></span><br><span class="line">    <span class="keyword">if</span> (request.URL.host.length == <span class="number">0</span>) <span class="keyword">return</span> request;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSMutableURLRequest</span> *mutableRequest = [request mutableCopy];</span><br><span class="line">    <span class="built_in">NSURLComponents</span> *URLComponents = [<span class="built_in">NSURLComponents</span> componentsWithString:mutableRequest.URL.absoluteString];</span><br><span class="line">    URLComponents.scheme = <span class="string">@"https"</span>;</span><br><span class="line">    URLComponents.host = [[<span class="keyword">self</span> sharedConfiguration] IPAddressForHostName:URLComponents.host];</span><br><span class="line">    mutableRequest.URL = [URLComponents URL];</span><br><span class="line">    [<span class="keyword">self</span> setProperty:@(<span class="literal">YES</span>) forKey:kURLProtocolHostModifiedKey inRequest:mutableRequest];</span><br><span class="line">    <span class="comment">// è®¾ç½®åŸå…ˆçš„host</span></span><br><span class="line">    [mutableRequest setValue:request.URL.host forHTTPHeaderField:<span class="string">@"host"</span>];</span><br><span class="line">    <span class="keyword">return</span> mutableRequest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startLoading &#123;</span><br><span class="line">    <span class="keyword">self</span>.session = [<span class="built_in">NSURLSession</span> sessionWithConfiguration:[<span class="built_in">NSURLSessionConfiguration</span> ephemeralSessionConfiguration] delegate:<span class="keyword">self</span> delegateQueue:[<span class="built_in">NSOperationQueue</span> new]];</span><br><span class="line">    [[<span class="keyword">self</span>.session dataTaskWithRequest:<span class="keyword">self</span>.request] resume];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stopLoading &#123;</span><br><span class="line">    [<span class="keyword">self</span>.session finishTasksAndInvalidate];</span><br><span class="line">    <span class="keyword">self</span>.session = <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - NSURLSessionDataDelegate</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session task:(<span class="built_in">NSURLSessionTask</span> *)task didCompleteWithError:(<span class="built_in">NSError</span> *)error &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="comment">// åŠ è½½å®Œæˆ: errorå›è°ƒ</span></span><br><span class="line">        [<span class="keyword">self</span>.client URLProtocol:<span class="keyword">self</span> didFailWithError:error];</span><br><span class="line">        <span class="comment">// å‡ºé”™: å–æ¶ˆipç›´è¿</span></span><br><span class="line">        <span class="built_in">NSString</span> *host = [<span class="keyword">self</span>.request valueForHTTPHeaderField:<span class="string">@"host"</span>];</span><br><span class="line">        [YADomainURLProtocol sharedConfiguration].mutableIPAddressesByHostName[host.lowercaseString] = <span class="literal">nil</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// åŠ è½½å®Œæˆ: successå›è°ƒ</span></span><br><span class="line">        [<span class="keyword">self</span>.client URLProtocolDidFinishLoading:<span class="keyword">self</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session</span><br><span class="line">          dataTask:(<span class="built_in">NSURLSessionDataTask</span> *)dataTask</span><br><span class="line">didReceiveResponse:(<span class="built_in">NSURLResponse</span> *)response</span><br><span class="line"> completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSessionResponseDisposition</span>))completionHandler &#123;</span><br><span class="line">    <span class="comment">// æ¥æ”¶responseå›è°ƒ</span></span><br><span class="line">    [<span class="keyword">self</span>.client URLProtocol:<span class="keyword">self</span> didReceiveResponse:response cacheStoragePolicy:<span class="built_in">NSURLCacheStorageNotAllowed</span>];</span><br><span class="line">    completionHandler(<span class="built_in">NSURLSessionResponseAllow</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session</span><br><span class="line">          dataTask:(<span class="built_in">NSURLSessionDataTask</span> *)dataTask</span><br><span class="line">    didReceiveData:(<span class="built_in">NSData</span> *)data &#123;</span><br><span class="line">    <span class="comment">// æ¥æ”¶æ•°æ®å›è°ƒ</span></span><br><span class="line">    [<span class="keyword">self</span>.client URLProtocol:<span class="keyword">self</span> didLoadData:data];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - è¯ä¹¦</span></span><br><span class="line"><span class="comment">// https: è¯ä¹¦</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session didReceiveChallenge:(<span class="built_in">NSURLAuthenticationChallenge</span> *)challenge completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSessionAuthChallengeDisposition</span>, <span class="built_in">NSURLCredential</span> *))completionHandler &#123;</span><br><span class="line">    <span class="keyword">if</span> (!challenge) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSURLSessionAuthChallengeDisposition</span> disposition = <span class="built_in">NSURLSessionAuthChallengePerformDefaultHandling</span>;</span><br><span class="line">    <span class="built_in">NSURLCredential</span> *credential = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *host = [<span class="keyword">self</span>.request.allHTTPHeaderFields objectForKey:<span class="string">@"host"</span>];</span><br><span class="line">    <span class="keyword">if</span> (!host) host = <span class="keyword">self</span>.request.URL.host;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ([challenge.protectionSpace.authenticationMethod isEqualToString:<span class="built_in">NSURLAuthenticationMethodServerTrust</span>] &amp;&amp; [<span class="keyword">self</span> createServerTrust:challenge.protectionSpace.serverTrust forDomain:host]) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æœåŠ¡å™¨è‡ªåˆ¶è¯ä¹¦ï¼Œå‚ç…§AFN</span></span><br><span class="line">        disposition = <span class="built_in">NSURLSessionAuthChallengeUseCredential</span>;</span><br><span class="line">        credential = [<span class="built_in">NSURLCredential</span> credentialForTrust:challenge.protectionSpace.serverTrust];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        disposition = <span class="built_in">NSURLSessionAuthChallengePerformDefaultHandling</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    completionHandler(disposition, credential);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éªŒè¯SSLæ¡æ‰‹è¿‡ç¨‹ä¸­æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦æ˜¯å¦å¯ä¿¡ä»»</span></span><br><span class="line"><span class="comment">// å‚è€ƒAFNä¸­ AFSecurityPolicy æ¨¡å—çš„ä»£ç </span></span><br><span class="line"><span class="comment">// æ³¨ï¼šåªé€‚ç”¨äºä¸€å°æœåŠ¡å™¨çš„IPåªé…ç½®äº†ä¸€ä¸ªé»˜è®¤çš„åŸŸåå’ŒSSLè¯ä¹¦çš„æƒ…å†µ</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)createServerTrust:(SecTrustRef)serverTrust</span><br><span class="line">                  forDomain:(<span class="built_in">NSString</span> *)domain &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¯ä¹¦æ ¡éªŒç­–ç•¥</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *policies = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="comment">// éœ€è¦éªŒè¯è¯·æ±‚çš„åŸŸåä¸è¯ä¹¦ä¸­å£°æ˜çš„CNå­—æ®µæ˜¯å¦ä¸€è‡´</span></span><br><span class="line">    <span class="keyword">if</span> (domain) &#123;</span><br><span class="line">        [policies addObject:(__bridge_transfer <span class="keyword">id</span>)SecPolicyCreateSSL(<span class="literal">true</span>, (__bridge <span class="built_in">CFStringRef</span>)domain)];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [policies addObject:(__bridge_transfer <span class="keyword">id</span>)SecPolicyCreateBasicX509()];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç»‘å®šæ ¡éªŒç­–ç•¥åˆ°æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦ä¸Š</span></span><br><span class="line">    SecTrustSetPolicies(serverTrust, (__bridge <span class="built_in">CFArrayRef</span>)policies);</span><br><span class="line">    SecTrustResultType result;</span><br><span class="line">    <span class="built_in">CFErrorRef</span> error;</span><br><span class="line">    SecTrustEvaluate(serverTrust, &amp;result);</span><br><span class="line">    <span class="comment">// è¯„ä¼°å½“å‰serverTrustæ˜¯å¦å¯ä¿¡ä»»ï¼Œ</span></span><br><span class="line">    <span class="comment">// å½“ result ä¸º kSecTrustResultUnspecified æˆ– kSecTrustResultProceed çš„æƒ…å†µä¸‹ï¼ŒserverTrust å¯ä»¥è¢«éªŒè¯é€šè¿‡</span></span><br><span class="line">    <span class="keyword">return</span> (result == kSecTrustResultUnspecified || result == kSecTrustResultProceed);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>åªéœ€è¦è¿™ä¹ˆä½¿ç”¨ï¼š<br><figure class="highlight scheme"><table><tr><td class="code"><pre><span class="line">[<span class="name">NSURLProtocol</span> registerClass:YADomainURLProtocol.class]<span class="comment">;</span></span><br><span class="line">[<span class="name">YADomainURLProtocol</span> configureHostsWithBlock:^(<span class="name">id&lt;YAHostsConfiguration&gt;</span> configuration) &#123;</span><br><span class="line">    [<span class="name">configuration</span> resolveHostName:@<span class="string">"www.baidu.com"</span> mapIPAddress:@<span class="string">"220.181.38.150"</span>]<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºAFNï¼Œé…ç½®configurationå³å¯<br><figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">NSURLSessionConfiguration *configuration = <span class="comment">[NSURLSessionConfiguration defaultSessionConfiguration]</span>;</span><br><span class="line">configuration.protocolClasses = @<span class="comment">[YADomainURLProtocol.class]</span>;</span><br><span class="line">AFHTTPSessionManager *sessionManager = <span class="comment">[<span class="comment">[AFHTTPSessionManager alloc]</span> initWithSessionConfiguration:configuration]</span>;</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼šç›®å‰æ²¡æœ‰è€ƒè™‘å•IPå¤šåŸŸåè¯ä¹¦ï¼ˆSNIï¼‰ã€‚</p>
<blockquote>
<p>å¯¹äºè¿™ç§åœºæ™¯ï¼ŒiOSä¸Šå±‚ç½‘ç»œ API NSURLConnection/NSURLSession éƒ½æ²¡æœ‰æä¾›ç›¸å…³æ–¹æ³•è¿›è¡Œ SNI å­—æ®µçš„é…ç½®ï¼Œå› æ­¤éœ€è¦ Socket å±‚çº§çš„åº•å±‚ç½‘ç»œåº“ï¼Œä¾‹å¦‚ CFNetworkï¼Œæ¥å®ç° IP ç›´è¿ç½‘ç»œè¯·æ±‚é€‚é…æ–¹æ¡ˆã€‚<br>å¯ä»¥å‚è€ƒï¼šé˜¿é‡Œäº‘çš„ã€Š<a href="https://help.aliyun.com/knowledge_detail/60147.html" target="_blank" rel="noopener">iOS HTTPS SNI ä¸šåŠ¡åœºæ™¯â€œIPç›´è¿â€æ–¹æ¡ˆè¯´æ˜</a>ã€‹</p>
</blockquote>
<h2 id="6ï¼ŒæŒä¹…åŒ–"><a href="#6ï¼ŒæŒä¹…åŒ–" class="headerlink" title="6ï¼ŒæŒä¹…åŒ–"></a>6ï¼ŒæŒä¹…åŒ–</h2><p><strong>æŒä¹…åŒ–æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ</strong></p>
<ul>
<li>NSUserDefaultï¼š å°è§„æ¨¡æ•°æ®ï¼Œå¼±ä¸šåŠ¡ç›¸å…³æ•°æ®ï¼Œéƒ½å¯ä»¥æ”¾åˆ°NSUserDefaulté‡Œé¢ï¼Œå†…å®¹æ¯”è¾ƒå¤šçš„æ•°æ®ï¼Œå¼ºä¸šåŠ¡ç›¸å…³çš„æ•°æ®å°±ä¸å¤ªé€‚åˆNSUserDefaultäº†ã€‚</li>
<li>Keychain ï¼š Keychainæ˜¯è‹¹æœæä¾›çš„å¸¦æœ‰å¯é€†åŠ å¯†çš„å­˜å‚¨æœºåˆ¶ï¼Œæ™®éç”¨åœ¨å„ç§å­˜å¯†ç çš„éœ€æ±‚ä¸Šã€‚å¦å¤–ï¼Œç”±äºAppå¸è½½åªè¦ç³»ç»Ÿä¸é‡è£…ï¼ŒKeychainä¸­çš„æ•°æ®ä¾æ—§èƒ½å¤Ÿå¾—åˆ°ä¿ç•™ï¼Œä»¥åŠå¯è¢«iCloudåŒæ­¥çš„ç‰¹æ€§ï¼Œå¤§å®¶éƒ½ä¼šåœ¨è¿™é‡Œå­˜å‚¨ç”¨æˆ·å”¯ä¸€æ ‡è¯†ä¸²ã€‚æ‰€ä»¥æœ‰éœ€è¦åŠ å¯†ã€éœ€è¦å­˜iCloudçš„æ•æ„Ÿå°æ•°æ®ï¼Œä¸€èˆ¬éƒ½ä¼šæ”¾åœ¨Keychainã€‚</li>
<li>æ–‡ä»¶å­˜å‚¨ï¼šæ–‡ä»¶å­˜å‚¨åŒ…æ‹¬äº†Plistã€archiveã€Streamç­‰æ–¹å¼ï¼Œä¸€èˆ¬ç»“æ„åŒ–çš„æ•°æ®æˆ–è€…éœ€è¦æ–¹ä¾¿æŸ¥è¯¢çš„æ•°æ®ï¼Œéƒ½ä¼šä»¥Plistçš„æ–¹å¼å»æŒä¹…åŒ–ã€‚Archiveæ–¹å¼é€‚åˆå­˜å‚¨å¹³æ—¶ä¸å¤ªç»å¸¸ä½¿ç”¨ä½†å¾ˆå¤§é‡çš„æ•°æ®ï¼Œæˆ–è€…è¯»å–ä¹‹åå¸Œæœ›ç›´æ¥å¯¹è±¡åŒ–çš„æ•°æ®ï¼Œå› ä¸ºArchiveä¼šå°†å¯¹è±¡åŠå…¶å¯¹è±¡å…³ç³»åºåˆ—åŒ–ï¼Œä»¥è‡³äºè¯»å–æ•°æ®çš„æ—¶å€™éœ€è¦Decodeå¾ˆèŠ±æ—¶é—´ï¼ŒDecodeçš„è¿‡ç¨‹å¯ä»¥æ˜¯è§£å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡åŒ–ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®å…·ä½“<nscoding>ä¸­çš„å®ç°æ¥å†³å®šã€‚Streamå°±æ˜¯ä¸€èˆ¬çš„æ–‡ä»¶å­˜å‚¨äº†ï¼Œä¸€èˆ¬ç”¨æ¥å­˜å­˜å›¾ç‰‡å•Šå•¥çš„ï¼Œé€‚ç”¨äºæ¯”è¾ƒç»å¸¸ä½¿ç”¨ï¼Œç„¶è€Œæ•°æ®é‡åˆä¸ç®—éå¸¸å¤§çš„é‚£ç§ã€‚</nscoding></li>
<li>æ•°æ®åº“å­˜å‚¨ï¼šè‹¹æœè‡ªå¸¦äº†ä¸€ä¸ªCore Dataï¼Œå…¶ä»–è¿˜æœ‰FMDBã€‚æ•°æ®åº“æ–¹æ¡ˆä¸»è¦æ˜¯ä¸ºäº†ä¾¿äºå¢åˆ æ”¹æŸ¥ï¼Œå½“æ•°æ®æœ‰çŠ¶æ€å’Œç±»åˆ«çš„æ—¶å€™æœ€å¥½è¿˜æ˜¯é‡‡ç”¨æ•°æ®åº“æ–¹æ¡ˆæ¯”è¾ƒå¥½ã€‚å› ä¸ºä½ ä¸å¯èƒ½é€šè¿‡æ–‡ä»¶ç³»ç»Ÿéå†æ–‡ä»¶å»ç”„åˆ«ä½ éœ€è¦è·å–çš„å±äºæŸä¸ªçŠ¶æ€æˆ–ç±»åˆ«çš„æ•°æ®ï¼Œè¿™ä¹ˆåšæˆæœ¬å°±å¤ªå¤§äº†ã€‚å½“ç„¶ï¼Œç‰¹åˆ«å¤§é‡çš„æ•°æ®ä¹Ÿä¸é€‚åˆç›´æ¥å­˜å‚¨æ•°æ®åº“ï¼Œæ¯”å¦‚å›¾ç‰‡æˆ–è€…æ–‡ç« è¿™æ ·çš„æ•°æ®ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œéƒ½æ˜¯æ•°æ®åº“å­˜ä¸€ä¸ªæ–‡ä»¶åï¼Œç„¶åè¿™ä¸ªæ–‡ä»¶åæŒ‡å‘çš„æ˜¯æŸä¸ªå›¾ç‰‡æˆ–è€…æ–‡ç« çš„æ–‡ä»¶ã€‚å¦‚æœçœŸçš„è¦åšå…¨æ–‡ç´¢å¼•è¿™ç§éœ€æ±‚ï¼Œå»ºè®®æœ€å¥½è¿˜æ˜¯æŒ‚ä¸ªAPIä¸¢åˆ°æœåŠ¡ç«¯å»åšã€‚</li>
</ul>
<p>ä¸Šé¢æ˜¯å‰è¾ˆæ€»ç»“çš„é¢è¯•é¢˜ç­”æ¡ˆğŸ˜‚</p>
<p>æ¥ä¸‹æ¥æ˜¯æŒä¹…åŒ–çš„å®è·µï¼š<br>ä¸ä»¥å¾€ä¸åŒçš„æ˜¯ï¼Œä¹‹å‰é‡‡ç”¨MVCæˆ–è€…MVVMæ¨¡å¼ï¼Œå­˜åœ¨æ•°æ®åº“çš„æ˜¯Modelï¼Œè€Œç°åœ¨å»ModelåŒ–äº†ï¼Œå­˜åŸå§‹æ•°æ®å‘¢ï¼Œè¿˜æ˜¯å­˜Reformä¹‹åçš„æ•°æ®ã€‚æˆ‘é€‰æ‹©å­˜å‚¨åŸå§‹æ•°æ®ï¼ŒåŸå› æœ‰äºŒï¼š<br>1ï¼ŒReformeræœ‰å¤šä¸ªï¼Œä½†æ˜¯åŸå§‹æ•°æ®åªæœ‰ä¸€ä»½ï¼Œåªå­˜å‚¨ä¸€ä»½åŸå§‹æ•°æ®é¿å…å†—ä½™ã€‚<br>2ï¼Œå¦‚æœå­˜å‚¨åŸå§‹æ•°æ®ï¼Œé‚£ä»æ•°æ®åº“å–å‡ºçš„æ•°æ®å’Œä»ç½‘ç»œè·å–çš„æ•°æ®ï¼Œæ ¼å¼å°†ä¼šæ˜¯ä¸€æ ·çš„ï¼Œåªéœ€è¦ä¸€ç§å¤„ç†æ–¹å¼ã€‚</p>
<p>æ€ä¹ˆå­˜å‚¨ï¼Ÿæ¯æ¡photoä¿¡æ¯ä¸­çš„photo_idä½œä¸ºä¸»é”®ï¼Œå†åŠ ä¸Šæ—¶é—´æˆ³ç”¨äºç­›é€‰ï¼Œphoto_contentè‡ªç„¶å°±æ˜¯å­˜å‚¨çš„åŸå§‹ä¿¡æ¯äº†ï¼š<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">"t_photoList"</span> (</span><br><span class="line"><span class="string">"photo_id"</span> <span class="built_in">text</span>,</span><br><span class="line"><span class="string">"photo_content"</span> <span class="built_in">text</span>,</span><br><span class="line"><span class="string">"photo_date"</span> <span class="built_in">INTEGER</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(<span class="string">"photo_id"</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ ·èŒè´£æ›´æ¸…æ™°äº†ï¼šAPIManagerè´Ÿè´£ä»ç½‘ç»œæˆ–è€…æ•°æ®åº“å–æ•°æ®ä»¥åŠæŒä¹…åŒ–æ•°æ®ï¼ŒReformeråªè´Ÿè´£æ ¼å¼åŒ–APIManagerçš„æ•°æ®ã€‚å¯¹äºæ§åˆ¶å™¨æ¥è¯´ï¼Œå®ƒåšçš„ä¹Ÿå¾ˆç®€å•äº†ï¼š<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)feedAPIDidSuccessWithManager:(YAFeedAPIManager *)manager</span><br><span class="line">                           isNewData:(<span class="built_in">BOOL</span>)isNewData &#123;</span><br><span class="line">    <span class="built_in">NSArray</span> &lt;<span class="built_in">NSDictionary</span> *&gt; *array = [manager fetchDataWithReformer:<span class="keyword">self</span>.feedReformer];</span><br><span class="line">    <span class="keyword">if</span> (isNewData) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.photoArray removeAllObjects];</span><br><span class="line">        [<span class="keyword">self</span>.refreshHeader endRefreshing];</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="keyword">self</span>.photoArray addObjectsFromArray:array];</span><br><span class="line">    <span class="keyword">if</span> (manager.noMoreData) &#123;</span><br><span class="line">        <span class="comment">// æ²¡æœ‰æ›´å¤šæ•°æ®</span></span><br><span class="line">        [<span class="keyword">self</span>.refreshFooter endRefreshingWithNoMoreData];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.refreshFooter endRefreshing];</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="keyword">self</span>.feedCollectionView reloadData];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="7ï¼ŒåŠ¨æ€éƒ¨ç½²æ–¹æ¡ˆ"><a href="#7ï¼ŒåŠ¨æ€éƒ¨ç½²æ–¹æ¡ˆ" class="headerlink" title="7ï¼ŒåŠ¨æ€éƒ¨ç½²æ–¹æ¡ˆ"></a>7ï¼ŒåŠ¨æ€éƒ¨ç½²æ–¹æ¡ˆ</h2><p>ï¼ˆ1ï¼‰Web App<br>å…¶å®æ‰€è°“çš„web appï¼Œå°±æ˜¯é€šè¿‡æ‰‹æœºä¸Šçš„æµè§ˆå™¨è¿›è¡Œè®¿é—®çš„H5é¡µé¢ã€‚è¿™ä¸ªH5é¡µé¢æ˜¯é’ˆå¯¹ç§»åŠ¨åœºæ™¯ç‰¹åˆ«ä¼˜åŒ–çš„ï¼Œæ¯”å¦‚UIäº¤äº’ç­‰ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<br>æ— éœ€èµ°è‹¹æœæµç¨‹ï¼Œæ‰€æœ‰è‹¹æœæµç¨‹å¸¦æ¥çš„æˆæœ¬éƒ½èƒ½é¿å…ï¼ŒåŒ…æ‹¬å®¡æ ¸å‘¨æœŸã€è¯ä¹¦æˆæœ¬ç­‰ã€‚<br>ç‰ˆæœ¬æ›´æ–°è·Ÿç½‘é¡µä¸€æ ·ï¼Œéšæ—¶ç”Ÿæ•ˆã€‚<br>ä¸éœ€è¦Native Appå·¥ç¨‹å¸ˆçš„å‚ä¸ï¼Œè€Œä¸”å¸‚é¢ä¸Šå·²ç»æœ‰å¾ˆå¤šé’ˆå¯¹è¿™ç§åœºæ™¯çš„æ¡†æ¶ã€‚</li>
<li>ç¼ºç‚¹<br>é‡åº¦ä¾èµ–ç½‘ç»œç¯å¢ƒã€æµç•…åº¦ä¸å¦‚Nativeã€å¾ˆéš¾åšå¥½æœ¬åœ°æŒä¹…åŒ–ï¼ˆåªèƒ½æä¾›è´¦æˆ·ä½“ç³»ï¼Œå¯¹åº”è´¦æˆ·çš„æŒä¹…åŒ–æ•°æ®å…¨éƒ¨å­˜åœ¨æœåŠ¡ç«¯ï¼‰ã€å³æ—¶å“åº”æ–¹æ¡ˆã€è¿œç¨‹é€šçŸ¥å®ç°æ–¹æ¡ˆã€ç§»åŠ¨ç«¯ä¼ æ„Ÿå™¨çš„ä½¿ç”¨æ–¹æ¡ˆå¤æ‚ï¼Œç»´æŠ¤éš¾åº¦å¤§ã€‚<br>å®‰å…¨é—®é¢˜ï¼ŒH5é¡µé¢ç­‰äºæ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½æš´éœ²ç»™äº†ç”¨æˆ·ï¼Œå¦‚æœå¯¹å®‰å…¨è¦æ±‚æ¯”è¾ƒé«˜çš„ï¼Œå¾ˆå¤šé¢å¤–çš„å®‰å…¨æœºåˆ¶éƒ½éœ€è¦åœ¨æœåŠ¡ç«¯å®ç°ã€‚</li>
<li>æ€»ç»“<br>web appä¸€èˆ¬æ˜¯åˆ›ä¸šåˆæœŸä¼šé‡ç‚¹è€ƒè™‘çš„æ–¹æ¡ˆï¼Œå› ä¸ºè¿­ä»£éå¸¸å¿«ï¼Œè€Œä¸”åˆ›ä¸šåˆæœŸçš„ä¸»è¦ç›®æ ‡æ˜¯éœ€è¦éªŒè¯æ¨¡å¼çš„æ­£ç¡®æ€§ï¼Œå¹¶ä¸åœ¨äºæä¾›éå¸¸å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œåªéœ€è¦å®Œæˆé—­ç¯å³å¯ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰Hybrid App<br>é€šè¿‡å¸‚é¢ä¸Šå„ç§Hybridæ¡†æ¶ï¼Œæ¥åšH5å’ŒNativeçš„æ··åˆåº”ç”¨ï¼Œæˆ–è€…é€šè¿‡JS Bridgeæ¥åšåˆ°H5å’ŒNativeä¹‹é—´çš„æ•°æ®äº’é€šã€‚</p>
<ul>
<li>ä¼˜ç‚¹<br>é™¤äº†è¦æ‰¿æ‹…è‹¹æœæµç¨‹å¯¼è‡´çš„æˆæœ¬ä»¥å¤–ï¼Œå…·å¤‡æ‰€æœ‰web appçš„ä¼˜åŠ¿ã€èƒ½å¤Ÿè®¿é—®æœ¬åœ°æ•°æ®ã€è®¾å¤‡ä¼ æ„Ÿå™¨ç­‰</li>
<li>ç¼ºç‚¹<br>è·Ÿweb appä¸€æ ·å­˜åœ¨è¿‡åº¦ä¾èµ–ç½‘ç»œç¯å¢ƒçš„é—®é¢˜ã€ç”¨æˆ·ä½“éªŒä¹Ÿå¾ˆéš¾åšåˆ°å¾ˆå¥½ã€å®‰å…¨æ€§é—®é¢˜ä¾æ—§å­˜åœ¨ã€å¤§è§„æ¨¡çš„æ•°æ®äº¤äº’å¾ˆéš¾å®ç°ï¼Œä¾‹å¦‚å›¾ç‰‡åœ¨æœ¬åœ°å¤„ç†åï¼Œå°†å›¾ç‰‡ä¼ é€’ç»™H5</li>
<li>æ€»ç»“<br>Hybridæ–¹æ¡ˆæ›´åŠ é€‚åˆè·Ÿæœ¬åœ°èµ„æºäº¤äº’ä¸æ˜¯å¾ˆå¤šï¼Œç„¶åä¸»è¦ä»¥å†…å®¹å±•ç¤ºä¸ºä¸»çš„Appã€‚åœ¨å¤©çŒ«Appä¸­ï¼Œå¤§é‡åœ°é‡‡ç”¨äº†JS Bridgeçš„æ–¹å¼æ¥è®©H5è·ŸNativeåšäº¤äº’ï¼Œå› ä¸ºå¤©çŒ«Appæ˜¯ä¸€ä¸ªä»¥å†…å®¹å±•ç¤ºä¸ºä¸»çš„Appï¼Œä¸”è¥é”€æ´»åŠ¨å¤šï¼Œå‘¨æœŸçŸ­ï¼Œæ¯”è¾ƒé€‚åˆHybridã€‚</li>
</ul>
<p>ï¼ˆ3ï¼‰React-Native</p>
<ul>
<li>ä¼˜ç‚¹<br>å“åº”é€Ÿåº¦å¾ˆå¿«ï¼Œåªæ¯”Nativeæ…¢ä¸€ç‚¹ï¼Œæ¯”webviewå¿«å¾ˆå¤šã€‚<br>èƒ½å¤Ÿåšåˆ°ä¸€å®šç¨‹åº¦ä¸Šçš„åŠ¨æ€éƒ¨ç½²</li>
<li>ç¼ºç‚¹<br>ç»„è£…é¡µé¢çš„å…ƒç´ éœ€è¦Nativeæä¾›æ”¯æŒï¼Œä¸€å®šç¨‹åº¦ä¸Šé™åˆ¶äº†åŠ¨æ€éƒ¨ç½²çš„çµæ´»æ€§ã€‚</li>
<li>æ€»ç»“<br>ç”±äºViewçš„å±•ç¤ºå’ŒViewçš„äº‹ä»¶å“åº”åˆ†å±äºä¸åŒçš„ç«¯ï¼Œå±•ç¤ºéƒ¨åˆ†çš„æè¿°åœ¨JSç«¯ï¼Œå“åº”äº‹ä»¶çš„ç›‘å¬å’Œæè¿°éƒ½åœ¨Nativeç«¯ï¼Œé€šè¿‡Nativeè½¬å‘ç»™JSç«¯ã€‚æ‰€ä»¥ï¼Œä»åšåŠ¨æ€éƒ¨ç½²çš„è§’åº¦ä¸Šè®²ï¼ŒReact-Nativeåªèƒ½åŠ¨æ€éƒ¨ç½²æ–°Viewï¼Œä¸èƒ½åŠ¨æ€éƒ¨ç½²æ–°Viewå¯¹åº”çš„äº‹ä»¶ã€‚<br>Viewçš„åŸå‹éœ€è¦ä»Nativeä¸­å–ï¼Œä»¥åæŸä¸ªé¡µé¢éœ€è¦æ·»åŠ æŸä¸ªå¤æ‚çš„viewçš„æ—¶å€™ï¼Œéœ€è¦ä»ç°æœ‰çš„ç»„ä»¶ä¸­æ‹¼è£…ã€‚<br>å®ƒè§£å†³çš„æ˜¯å¦‚ä½•ä¸ä½¿ç”¨Objc/Swiftæ¥å†™iOS Appçš„Viewçš„é—®é¢˜ï¼Œå¯¹äºå¦‚ä½•é€šè¿‡ä¸å‘ç‰ˆæ¥ç»™å·²å‘ç‰ˆçš„Appæ›´æ–°åŠŸèƒ½è¿™æ ·çš„é—®é¢˜ï¼Œå¸®åŠ©æœ‰é™ã€‚</li>
</ul>
<p>ï¼ˆ4ï¼‰Lua Patch<br>waxPatchçš„ä¸»è¦åŸç†æ˜¯é€šè¿‡luaæ¥é’ˆå¯¹objcçš„æ–¹æ³•è¿›è¡Œæ›¿æ¢ï¼Œç”±äºluaæœ¬èº«æ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œå¯ä»¥é€šè¿‡åŠ¨æ€ä¸‹è½½å¾—åˆ°ï¼Œå› æ­¤å…·å¤‡äº†ä¸€å®šçš„åŠ¨æ€éƒ¨ç½²èƒ½åŠ›ã€‚ç„¶è€ŒiOSç³»ç»ŸåŸç”Ÿå¹¶ä¸æä¾›luaçš„è§£é‡Šåº“ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ‰“åŒ…æ—¶æŠŠluaçš„è§£é‡Šåº“ç¼–è¯‘è¿›appã€‚</p>
<ul>
<li>ä¼˜ç‚¹<br>èƒ½å¤Ÿé€šè¿‡ä¸‹è½½è„šæœ¬æ›¿æ¢æ–¹æ³•çš„æ–¹å¼ï¼Œä¿®æ”¹æœ¬åœ°Appçš„è¡Œä¸ºã€‚<br>æ‰§è¡Œæ•ˆç‡è¾ƒé«˜</li>
<li>ç¼ºç‚¹<br>å¯¹äºæ›¿æ¢åŠŸèƒ½æ¥è¯´ï¼Œluaæ˜¯å¾ˆä¸é”™çš„é€‰æ‹©ã€‚ä½†å¦‚æœè¦æ·»åŠ æ–°å†…å®¹ï¼Œå®é™…æ“ä½œä¼šå¾ˆå¤æ‚ï¼Œå¾ˆå®¹æ˜“æ”¹é”™ï¼Œå°é—®é¢˜å˜æˆå¤§é—®é¢˜</li>
<li>æ€»ç»“<br>luaçš„è§£å†³æ–¹æ¡ˆåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†åŠ¨æ€éƒ¨ç½²çš„é—®é¢˜ã€‚å®é™…æ“ä½œæ—¶ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨å®ƒæ¥åšæ–°åŠŸèƒ½çš„åŠ¨æ€éƒ¨ç½²ï¼Œä¸»è¦è¿˜æ˜¯ç”¨äºä¿®å¤bugæ—¶ä»£ç çš„åŠ¨æ€éƒ¨ç½²ã€‚</li>
</ul>
<p>ï¼ˆ5ï¼‰Javascript Patch<br>è¿™ä¸ªå·¥ä½œåŸç†å…¶å®è·Ÿä¸Šé¢è¯´çš„luaé‚£å¥—æ–¹æ¡ˆçš„å·¥ä½œåŸç†ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨javascriptå®ç°ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<br>æ‰“åŒ…æ—¶ä¸ç”¨å°†è§£é‡Šå™¨ä¹Ÿç¼–è¯‘è¿›å»ï¼ŒiOSè‡ªå¸¦JavaScriptçš„è§£é‡Šå™¨ã€‚</li>
<li>ç¼ºç‚¹<br>åŒLuaæ–¹æ¡ˆçš„ç¼ºç‚¹</li>
<li>æ€»ç»“<br>åœ¨å¯¹appæ‰“è¡¥ä¸çš„æ–¹æ¡ˆä¸­ï¼Œç›®å‰æˆ‘æ›´å€¾å‘äºä½¿ç”¨JSPatchçš„æ–¹æ¡ˆï¼Œåœ¨èƒ½å¤Ÿå®ŒæˆLuaåšåˆ°çš„æ‰€æœ‰äº‹æƒ…çš„åŒæ—¶ï¼Œè¿˜ä¸ç”¨ç¼–ä¸€ä¸ªJSè§£é‡Šå™¨è¿›å»ï¼Œè€Œä¸”ä¼šjavascriptçš„äººæ¯”ä¼šluaçš„äººå¤šï¼ŒæŠ€æœ¯å‚¨å¤‡æ¯”è¾ƒå¥½åšã€‚</li>
</ul>
<p>ï¼ˆ6ï¼‰JSON Descripted View<br>ä½¿ç”¨JSONæ¥æè¿°ä¸€ä¸ªViewåº”è¯¥æœ‰å“ªäº›å…ƒç´ ï¼Œä»¥åŠå…ƒç´ çš„ä½ç½®ï¼Œä»¥åŠç›¸å…³çš„å±æ€§ï¼Œæ¯”å¦‚èƒŒæ™¯è‰²ï¼Œåœ†è§’ç­‰ç­‰ã€‚ç„¶åæœ¬åœ°æœ‰ä¸€ä¸ªè§£é‡Šå™¨æ¥æŠŠJSONæè¿°çš„Viewç”Ÿæˆå‡ºæ¥ã€‚<br>è¿™è·ŸReact-Nativeæœ‰ç‚¹å„¿åƒï¼Œä¸€ä¸ªæ˜¯JSè½¬Nativeï¼Œä¸€ä¸ªæ˜¯JSONè½¬Nativeã€‚ä½†æ˜¯åŒæ ·æœ‰çš„é—®é¢˜å°±æ˜¯äº‹ä»¶å¤„ç†çš„é—®é¢˜ï¼Œåœ¨äº‹ä»¶å¤„ç†ä¸Šï¼ŒReact-Nativeåšå¾—ç›¸å¯¹æ›´å¥½ã€‚å› ä¸ºJSONä¸èƒ½å¤Ÿæè¿°äº‹ä»¶é€»è¾‘ï¼Œæ‰€ä»¥JSONç”Ÿæˆçš„Viewæ‰€éœ€è¦çš„äº‹ä»¶å¤„ç†éƒ½å¿…é¡»è¦æœ¬åœ°äº‹å…ˆæŒ‚å¥½ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<br>èƒ½å¤Ÿè‡ªç”±ç”ŸæˆViewå¹¶åŠ¨æ€éƒ¨ç½²</li>
<li>ç¼ºç‚¹<br>å¤©çŒ«å®é™…ä½¿ç”¨ä¸‹æ¥ï¼Œå‘ç°è¿˜æ˜¯å­˜åœ¨ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œä¸å¤Ÿå¿«<br>äº‹ä»¶éœ€è¦æœ¬åœ°äº‹å…ˆå†™å¥½ï¼Œæ— æ³•åŠ¨æ€éƒ¨ç½²äº‹ä»¶</li>
<li>æ€»ç»“<br>å…¶å®JSONæè¿°çš„Viewæ¯”React-Nativeçš„Viewæœ‰ä¸ªå¥½å¤„å°±åœ¨äºå¯¹äºè¿™ä¸ªViewè€Œè¨€ï¼Œä¸éœ€è¦æœ¬åœ°ä¹Ÿæœ‰ä¸€å¥—å¯¹åº”çš„Viewï¼Œå®ƒå¯ä»¥ä¾æ®JSONçš„æè¿°æ¥è‡ªå·±ç”Ÿæˆã€‚ç„¶è€Œå¯¹äºäº‹ä»¶çš„å¤„ç†æ˜¯å®ƒçš„ç¡¬ä¼¤ï¼Œæ‰€ä»¥JSONæè¿°Viewçš„æ–¹æ¡ˆï¼Œä¸€èˆ¬æ¯”è¾ƒé€‚ç”¨äºæ¢è‚¤ï¼Œæˆ–è€…å›ºå®šäº‹ä»¶ä¸åŒæ ·å¼çš„Viewï¼Œæ¯”å¦‚è´´çº¸ã€‚</li>
</ul>
<p>ä½œè€…æ€»ç»“åœ°å®åœ¨æ˜¯å¤ªå…¨é¢å¤ªå¥½äº†ï¼ˆå´‡æ‹œè„¸ğŸ˜ï¼‰ã€‚<br>ç›®å‰æ¥çœ‹ï¼Œä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„æ˜¯JS Patchã€‚æ‰‹ç™¾å‚è€ƒäº†ä¸€ä¸‹å®ƒçš„åŸç†ï¼Œè‡ªå·±åˆå†™äº†ä¸€ä¸ªï¼Œç”¨äºçƒ­ä¿®å¤ï¼Œä¹‹å‰è€æ¿è®©è°ƒç ”è¿‡ï¼Œæœ€è¿‘ç”¨äº†å‡ æ¬¡ã€‚</p>
<p>åœ¨Splashä¸­ç›®å‰è¿˜æ²¡æœ‰å®è·µçƒ­æ›´æ–°æ–¹æ¡ˆã€‚</p>
<h1 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h1><p>1.0.0ç‰ˆæœ¬å·²ç»å‘å¸ƒäº†ï¼Œä½†æ˜¯æœ€è¿‘å¼€å‘äººå‘˜æ³¨å†Œå¥½åƒå‡ºäº†ç‚¹é—®é¢˜ï¼Œä»˜æ¬¾è€æ˜¯å¤±è´¥ï¼Œç„¶åå°±æ²¡ä¸Šçº¿ã€‚</p>
<p>githubæ”¾è¿™äº†ï¼š<a href="https://github.com/chenYalun/Splash" target="_blank" rel="noopener">https://github.com/chenYalun/Splash</a></p>
<p><img src="https://image.chenyalun.com/2019/12/26/splash_001.png" style="zoom:20%"><img src="https://image.chenyalun.com/2019/12/26/splash_002.png" style="zoom:20%"><img src="https://image.chenyalun.com/2019/12/26/splash_003.png" style="zoom:20%"><img src="https://image.chenyalun.com/2019/12/26/splash_004.png" style="zoom:20%"></p>

      
    </div>

    
      
      



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/iOSå¼€å‘/">iOSå¼€å‘</a>
            
              <a href="/tags/å¼€æºé¡¹ç›®/">å¼€æºé¡¹ç›®</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
    
      <a class="next" href="/2019/09/30/å¤šçº¿ç¨‹ä¸Runloopæ‹¾é—/">
        <span class="next-text nav-default">å¤šçº¿ç¨‹ä¸Runloopæ‹¾é—</span>
        <span class="prev-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/ChenYalun" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="https://weibo.com/icqk" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
    
      
    
      
        
          <a href="https://stackoverflow.com/users/7026915/allen" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
        
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    May Be 
  </span>
  
  <span class="theme-info">
    Better  
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even"> </a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2014 - 
    
    2020

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Ya</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  
  <script>
    var cloudTieConfig = {
      url: document.location.href, 
      sourceId: "",
      productKey: "f132359147224247aa1c3ad32d20490b",
      target: "cloud-tie-wrapper"
    };
  </script>
  <script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>





    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.4.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.4.x"></script>

    
  </body>
</html>
